<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>InDesign Scripting SDK: Scripting Tutorial</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="adobe_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">InDesign Scripting SDK
   &#160;<span id="projectnumber">19.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('id_scripting_tutorial.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Scripting Tutorial </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="id_introduction"></a>
Introduction</h1>
<p>This document is for end users and developers alike. If you never created a script before, we show you how to get started. If you wrote scripts for other applications, we show you how to apply your knowledge to InDesign scripting.</p>
<p>The document also covers how to install and run an InDesign script and describes what InDesign scripting can and cannot do. We discuss the software you need to start writing your own scripts.</p>
<p>After you learn the basics of InDesign scripting in this tutorial, you can move on to the Adobe InDesign Scripting Guide, which explores scripting in more depth. The Adobe InDesign Scripting Guide contains hundreds of tutorial scripts covering topics like text formatting, finding and changing text, associating scripts with menu items, drawing objects on a page, and exporting documents.</p>
<h1><a class="anchor" id="id_getting_started"></a>
Getting started</h1>
<p>Almost anything you can do with the user interface; you can do with a script. You can draw frames, enter and format text, place graphics, and print or export the pages of the document. Any action that can change a document or its contents can be scripted. There even are a few things you can do in scripting that you cannot do using the user interface.</p>
<p>Scripts can create menus, add menu items, create and display dialog boxes and panels, and respond to user-interface selections. Scripts can read and write text files, parse XML data, and communicate with other applications.</p>
<p>Scripts can do everything from very small tasks (like setting a tab stop at the location of the text cursor) to providing complete features. You can start with simple scripts that do only one thing and move on to scripts that automate your entire publishing workflow.</p>
<p>Most of the things scripting cannot do-like setting up a workspace or defining a set of keyboard shortcuts-are things that have to do with the user interface. In addition, scripts cannot add new types of objects to an InDesign document or add new, fundamental capabilities to the program, like a new text-composition engine. For that type of extensibility, you must use the InDesign Software Development Kit (SDK), which shows you to write compiled plug-ins using C++.</p>
<p>We tend to think of scripting in terms of long, repetitive tasks, like laying out a phone book. It also is good for things like the following:</p>
<ul>
<li>Automating the myriad, small, annoying tasks that you face every day.</li>
<li>Customizing InDesign to match your work habits and layouts.</li>
<li>Achieving creative effects that would be difficult or impossible to attain by other means.</li>
</ul>
<h2><a class="anchor" id="id_installing_scripts"></a>
Installing scripts</h2>
<p>Installing an InDesign script is easy: put the script file in the Scripts Panel folder inside the Scripts folder in your InDesign application folder. (Create the Scripts folder if it does not already exist.) Note: this may require admin access.</p>
<p>Alternately, put the script inside the Scripts Panel folder in your preferences folder. Your preferences folder is at:</p>
<ul>
<li>Windows: C:\Users\&lt;username&gt;\AppData\Roaming\Adobe\InDesign\Version 18.0\&lt;locale&gt;\Scripts</li>
<li>Mac: /Users/&lt;username&gt;/Library/Preferences/Adobe InDesign/Version 18.0/&lt;locale&gt;/Scripts</li>
</ul>
<p>where &lt;username&gt; is your user name and &lt;locale&gt; references your location and language, for example, en_US.</p>
<p>Once the script is in the folder, it appears on the Scripts panel inside InDesign. To display the panel, choose Window &gt; Utilities &gt; Scripts.</p>
<p>You also can put aliases/shortcuts to scripts (or to folders containing scripts) in the Scripts Panel folder, and they will appear in the Scripts panel.</p>
<p>To run a specific script when InDesign starts, put the script inside a folder named "Startup Scripts" inside the Scripts folder (create this folder if it does not already exist).</p>
<h2><a class="anchor" id="id_running_a_script"></a>
Running a script</h2>
<p>To run a script, display the Scripts panel (choose Window &gt; Utilities &gt; Scripts), then double-click the script name in the Scripts panel. Many scripts display user-interface items (like dialog boxes or panels) and display alerts if necessary.</p>
<h2><a class="anchor" id="id_using_the_scripts_panel"></a>
Using the scripts panel</h2>
<p>The InDesign Scripts panel is the easiest and best way to run most InDesign scripts. If the panel is not already visible, you can display it by choosing Window &gt; Utilities &gt; Scripts.</p>
<p>Scripts run from the Scripts panel run faster than scripts run from the Finder (Mac) or Explorer (Windows).</p>
<p>Another way to make scripts run faster is to turn off screen redraw while the script is running. To do this, turn off the Enable Redraw from the Scripts panel menu. To view the script actions as they execute, turn this option on.</p>
<p>The Scripts panel can run compiled or uncompiled AppleScripts (files with the file extension .spt, .as, or .applescript), JavaScripts (files with the file extension .js or .jsx), VBScripts (files with the extension .vbs), or executable programs from the Scripts panel.</p>
<p>To edit a script shown in the Scripts panel, select the script and choose Edit Script from the Scripts panel menu. Alternatively, you can hold down Option (Mac OS) or Alt (Windows) key and double-click the script's name. This opens the script in the editor you defined for the script file type.</p>
<p>To open the folder containing a script shown in the Scripts panel, select the script and choose Reveal in Finder (Mac OS) or Reveal in Explorer (Windows). Alternatively, you can hold down the Command (Mac OS) or Ctrl-Shift (Windows) keys and double-click the script's name. The folder containing the script opens in the Finder (Mac OS) or Explorer (Windows).</p>
<p>Scripts generally run as a series of actions, which means you can undo the changes the script made to a document by choosing Undo from the Edit menu. This can help you troubleshoot a script, as you can step backward through each change. Scripts can change the undo mode and store all of the script actions as a single undo step. This can significantly speed up script execution. For more on how to do this, refer to the Adobe InDesign Scripting Guide for the scripting language of your choice.</p>
<p>To add a keyboard shortcut for a script, choose Edit &gt; Keyboard Shortcuts, select an editable shortcut set from the Set menu, then choose Product Area &gt; Scripts. A list of the scripts in your Scripts panel appears. Select a script and assign a keyboard shortcut as you would for any other InDesign feature.</p>
<h2><a class="anchor" id="id_about_scripting_languages"></a>
About scripting languages</h2>
<p>The language you use to write scripts depends on the scripting system of your platform: AppleScript for Mac OS, VBScript for Windows, or JavaScript for either platform. Although the scripting languages differ, the ways they work with InDesign are very similar.</p>
<p>Each sample script in this document is shown in all three scripting languages. Translating a script from one language to another is fairly easy.</p>
<p><b>JavaScript</b></p>
<p>InDesign supports JavaScript for cross-platform scripting in both Mac OS and Windows. InDesign's JavaScript support is based on an Adobe implementation of JavaScript known as ExtendScript. The ExtendScript interpreter conforms to the ECMA 262 standard for JavaScript. All language features of JavaScript 1.5 are supported. Illustrator, Photoshop, and other Adobe Creative Cloud products also use the ExtendScript JavaScript interpreter.</p>
<p>Although you can write scripts using other versions of JavaScript, such as Microsoft JScript (in Windows) or Late Night Software's OSA JavaScript (on the Mac OS), the terms you use in those languages are not the same as the terms you use in ExtendScript. ExtendScript examples do not work in other JavaScript versions.</p>
<dl class="section note"><dt>Note</dt><dd>Because ExtendScript tools and features are used in several Adobe products, we consolidated all ExtendScript documentation. To learn more about JavaScript utilities like the ScriptUI user-interface module and the ExtendScript Toolkit (a JavaScript development environment and object-model inspector), see the JavaScript Tools Guide which is part of ExtendScript Toolkit.</dd></dl>
<h3><a class="anchor" id="id_win"></a>
Windows</h3>
<p>To use InDesign scripting on Windows, you can use either JavaScript or some version of Microsoft Visual Basic, such as VBScript.</p>
<p>The Visual Basic tutorial scripts are written in VBScript. We chose VBScript because no added software is required to run or edit VBScripts; you can edit them with any text editor (like Notepad) and run them using the InDesign Scripts panel.</p>
<p>Other versions of Visual Basic, that ship with Microsoft Visual Studio, do not work well, because they lack the Variant data type, which is used extensively in InDesign scripting.</p>
<p>Many applications contain Visual Basic for Applications (VBA), like Microsoft Word, Microsoft Excel, Microsoft Visio, or AutoCAD. Although you can use VBA to create InDesign scripts, InDesign does not include VBA.</p>
<p>To use VBScript or Visual Basic for InDesign scripting in Windows, you must install InDesign from a user account that has Administrator privileges. After you complete the installation, any user can run InDesign scripts, and any user with Power User or Administrator privileges can add scripts to the InDesign Scripts panel.</p>
<h3><a class="anchor" id="id_mac_os"></a>
Mac OS</h3>
<p>To use InDesign scripting on Mac OS, you can use either JavaScript or AppleScript. To write AppleScripts, you must have AppleScript version 1.6 or higher and an AppleScript script editor. AppleScript comes with all Apple systems, and it can be downloaded free from the Apple Web site. The Apple Script Editor is included with the Mac OS; access it from the menus:</p>
<ul>
<li>Applications &gt; Utilities &gt; Script Editor</li>
</ul>
<p><b>Which scripting language should you use?</b></p>
<p>If you have written scripts before, use whatever language you know. If you have never written scripts before or if you need to make your scripts work on both the Mac OS and Windows versions of InDesign, use JavaScript. If you need to communicate with other, non-Adobe applications on your system, use the appropriate, platform standard language (AppleScript on Mac OS or VBScript in Windows).</p>
<p>We cannot fully document the language features of AppleScript, JavaScript, or VBScript, so you may need documentation for any or all those scripting languages.</p>
<dl class="section note"><dt>Note</dt><dd>You also can use almost any other programming language (like Python or C#) that can connect to the platform standard automation system; that is beyond the scope of this document.</dd></dl>
<h2><a class="anchor" id="id_how_to_use_the_scripts_in_this_document"></a>
How to use the scripts in this document</h2>
<p>To view or edit any script shown in this document, open the corresponding tutorial script file (the filename is given before each script) in the script editing application of your choice.</p>
<p>To run a script, install the script in your Scripts Panel folder (see <a class="el" href="id_scripting_tutorial.html#id_installing_scripts">Installing scripts</a>), then:</p>
<ol type="1">
<li>Choose Windows &gt; Utilities &gt; Scripts to display the Scripts panel.</li>
<li>Double-click the script name in the Scripts panel to run the script.</li>
</ol>
<p>To save a script you've edited, save the script as a plain text file in the Scripts Panel folder (see <a class="el" href="id_scripting_tutorial.html#id_installing_scripts">Installing scripts</a>), using the appropriate file extension: </p>
<pre class="fragment">AppleScript:    .applescript
JavaScript:     .jsx
VBScript:       .vbs
</pre><dl class="section note"><dt>Note</dt><dd>If you are entering the JavaScript examples shown in this document, it is very important to use the same capitalization shown in the example. JavaScript is case-sensitive, and the scripts will fail if they do not use the capitalization shown. The AppleScript and VBScript examples are not case-sensitive. Again, it's better to use the script files that come with this tutorial.</dd>
<dd>
If you are copying and pasting scripts from this document, be aware that line breaks caused by the layout of the document can cause errors in your script. As it can be very difficult to find such errors, we recommend that you use the scripts that come with this tutorial.</dd></dl>
<h2><a class="anchor" id="id_your_first_indesign_script"></a>
Your first InDesign script</h2>
<p>Next, we will create an InDesign script that creates a new document, adds a text frame, and enters text in the text frame. This demonstrates how to do the following:</p>
<ul>
<li>Establish communication with InDesign.</li>
<li>Create a new document.</li>
<li>Create a text frame on a specific page.</li>
<li>Add text to a text frame.</li>
</ul>
<p><b>AppleScript</b></p>
<p>Start the Script Editor application. Enter the following script:</p>
<div class="fragment"><div class="line">--HelloWorld.applescript</div>
<div class="line">--An InDesign AppleScript</div>
<div class="line">--</div>
<div class="line">tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">    <span class="keyword">set</span> myDocument to make document</div>
<div class="line">    tell page 1 of myDocument</div>
<div class="line">        <span class="keyword">set</span> myTextFrame to make text frame</div>
<div class="line">        <span class="keyword">set</span> geometric bounds of myTextFrame to {<span class="stringliteral">&quot;6p&quot;</span>, <span class="stringliteral">&quot;6p&quot;</span>, <span class="stringliteral">&quot;24p&quot;</span>, <span class="stringliteral">&quot;24p&quot;</span>}</div>
<div class="line">        <span class="keyword">set</span> contents of myTextFrame to <span class="stringliteral">&quot;Hello World!&quot;</span></div>
<div class="line">    end tell</div>
<div class="line">end tell</div>
</div><!-- fragment --><p>Save the script as text with the file extension .applescript to the Scripts Panel folder (see <a class="el" href="id_scripting_tutorial.html#id_installing_scripts">Installing scripts</a>). To run the script, double-click the script name in the Scripts panel or click Run in the Script Editor window.</p>
<p><b>JavaScript</b></p>
<p>Start the ExtendScript Toolkit (or a text editor) and enter the following script:</p>
<div class="fragment"><div class="line">ï»¿<span class="comment">//HelloWorld.jsx</span></div>
<div class="line"><span class="comment">//An InDesign JavaScript</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//Creates a new document, adds a text frame, </span></div>
<div class="line"><span class="comment">//resizes the text frame, and adds text.</span></div>
<div class="line">var myDocument = app.documents.add();</div>
<div class="line">var myTextFrame = myDocument.pages.item(0).textFrames.add();</div>
<div class="line">myTextFrame.geometricBounds = [<span class="stringliteral">&quot;6p&quot;</span>, <span class="stringliteral">&quot;6p&quot;</span>, <span class="stringliteral">&quot;24p&quot;</span>, <span class="stringliteral">&quot;24p&quot;</span>];</div>
<div class="line">myTextFrame.contents = <span class="stringliteral">&quot;Hello World!&quot;</span>;</div>
</div><!-- fragment --><p>Save the script as a plain-text file with the .jsx file extension to the Scripts Panel folder (see <a class="el" href="id_scripting_tutorial.html#id_installing_scripts">Installing scripts</a>). To run the script, double-click the script name in the Scripts panel, or select InDesign from the application target pop-up menu in the ExtendScript Toolkit and then click the Run button).</p>
<p><b>VBScript</b></p>
<p>Start a text editor (for example, Notepad) and enter the following script:</p>
<div class="fragment"><div class="line">Rem HelloWorld.vbs</div>
<div class="line">Rem An InDesign VBScript</div>
<div class="line">Rem</div>
<div class="line">Set myInDesign = CreateObject(<span class="stringliteral">&quot;InDesign.Application.2024&quot;</span>)</div>
<div class="line">Set myDocument = myInDesign.Documents.Add</div>
<div class="line">Set myTextFrame = myDocument.Pages.Item(1).TextFrames.Add</div>
<div class="line">myTextFrame.GeometricBounds = Array(&quot;6p&quot;, &quot;6p&quot;, &quot;24p&quot;, &quot;24p&quot;)</div>
<div class="line">myTextFrame.Contents = &quot;Hello World!&quot;</div>
</div><!-- fragment --><p>Save the script as a text file with the .vbs file extension to the Scripts Panel folder (see <a class="el" href="id_scripting_tutorial.html#id_installing_scripts">Installing scripts</a>). To run the script, double-click the script name in the Scripts panel.</p>
<p><b>Walking through the script</b></p>
<p>Here is a step-by-step analysis of what the Hello World script does (in each scripting language):</p>
<ol type="1">
<li>Establish communication with the InDesign application object:<ul>
<li>AppleScript: tell application "Adobe InDesign 2024"</li>
<li>JavaScript: Refer to the application as app.</li>
<li>VBScript: Set myInDesign = CreateObject("InDesign.Application.2024")</li>
</ul>
</li>
<li>Create a new document and a reference to the document:<ul>
<li>AppleScript: set myDocument to make document</li>
<li>JavaScript: var myDocument = app.documents.add();</li>
<li>VBScript: Set myDocument = myInDesign.Documents.Add</li>
</ul>
</li>
<li>Create a new text frame on the first page and a create a reference to the text frame.:<ul>
<li>AppleScript: tell page 1 of myDocument set myTextFrame to make text frame</li>
<li>JavaScript: var myTextFrame = myDocument.pages.item(0).textFrames.add();</li>
<li>VBScript: Set myTextFrame = myDocument.Pages.Item(1).TextFrames.Add</li>
</ul>
</li>
<li>Set the geometric bounds (the location of the top, left, bottom, and right edges) of the text frame. In this step, the script uses measurement overrides ("p" for picas) to ensure the text frame is the correct size, regardless of your default measurement units. The locations are provided as a list, or array, of values; each scripting language has a slightly different way of creating an array. For more on array variables, see <a class="el" href="id_scripting_tutorial.html#id_array_variables">Array variables</a>.<ul>
<li>AppleScript: set geometric bounds of myTextFrame to {"6p", "6p", "24p", "24p"}</li>
<li>JavaScript: myTextFrame.geometricBounds = ["6p", "6p", "24p", "24p"];</li>
<li>VBScript: myTextFrame.GeometricBounds = Array("6p", "6p", "24p", "24p")</li>
</ul>
</li>
<li>Add text to the text frame by setting the contents property to a string:<ul>
<li>AppleScript: set contents of myTextFrame to "Hello World!"</li>
<li>JavaScript: myTextFrame.contents = "Hello World!";</li>
<li>VBScript: myTextFrame.Contents = "Hello World!"</li>
</ul>
</li>
</ol>
<h1><a class="anchor" id="id_scripting_and_the_indesign_object_model"></a>
Scripting and the InDesign object model</h1>
<p>This section discusses the terminology of scripting languages in general and InDesign scripting in particular.</p>
<h2><a class="anchor" id="id_scripting_terminology"></a>
Scripting terminology</h2>
<p>This section discusses common scripting terms and concepts.</p>
<p><b>Comments</b></p>
<p>Comments give you a way to add descriptive text to a script. The scripting system ignores comments as the script executes; this prevents comments from producing errors when you run your script. Comments are useful to document the operation of a script (for yourself or someone else). In this document, we use comments in the tutorial scripts.</p>
<p>To include a comment:</p>
<ul>
<li>In an AppleScript, type - to the left of your comment or surround the comment with(* and *). For example: <div class="fragment"><div class="line">--<span class="keyword">this</span> is a comment</div>
<div class="line">(* and so is <span class="keyword">this</span> *)</div>
</div><!-- fragment --></li>
<li>In JavaScript, type //to the left of the comment, or surround the comment with /* and */. For example: <div class="fragment"><div class="line"><span class="comment">// this is a comment</span></div>
<div class="line"><span class="comment">/* and so is this */</span></div>
</div><!-- fragment --></li>
<li>In VBScript, type Rem (for "remark") or '(a single straight quote) to the left of the comment. Type the comment marker at the beginning of a line, to make the entire line a comment. For example: <div class="fragment"><div class="line">Rem <span class="keyword">this</span> is a comment</div>
<div class="line"><span class="stringliteral">&#39; and so is this</span></div>
</div><!-- fragment --></li>
</ul>
<h2><a class="anchor" id="id_values"></a>
Values</h2>
<p>The point size of a character of text, the location of a text frame on a page, and the color of stroke of a rectangle are examples of values used in InDesign scripting. Values are the data your scripts use to do their work.</p>
<p>The type of a value defines what sort of data the value contains. For example, the value type of the contents of a word is a text string, and the value type of the leading of a paragraph is a number. Usually, the values used in scripts are numbers or text. The following table explains the value types most commonly used in InDesign scripting:</p>
<table class="doxtable">
<tr>
<th>Value type </th><th>What it is </th><th>Example </th></tr>
<tr>
<td>Boolean </td><td>Logical True or False. </td><td>True </td></tr>
<tr>
<td>Integer </td><td>Whole numbers (no decimal points). Integers can be positive or negative.<br/>
 In VBScript, you can use the long data type for integers. In AppleScript,<br/>
 you also can use the fixed or long data types for both integers and real numbers. </td><td>14 </td></tr>
<tr>
<td>Double (VBScript), <br/>
 fixed or real (AppleScript), <br/>
 number (JavaScript) </td><td>A high-precision number that can contain a decimal point. </td><td>13.9972 </td></tr>
<tr>
<td>String </td><td>A series of text characters. Strings appear inside (straight) quotation marks. </td><td>"I am a string" </td></tr>
<tr>
<td>Array (VBScript, JavaScript) <br/>
 or list (AppleScript) </td><td>A list of values (the values can be any type). </td><td>AppleScript: {"0p0", "0p0", "16p4", "20p6"} <br/>
 VBScript: Array("0p0", "0p0", "16p4", "20p6") <br/>
 JavaScript: ["0p0", "0p0", "16p4","20p6"] </td></tr>
</table>
<h3><a class="anchor" id="id_converting_values_from_one_type_to_another"></a>
Converting values from one type to another</h3>
<p>All scripting languages supported by InDesign provide ways to convert variable values from one type to another. The most common conversions involve converting numbers to strings (so you can enter them in text or display them in dialog boxes) or converting strings to numbers (so you can use them to set a point size or page location). See the following examples.</p>
<p><b>AppleScript</b></p>
<div class="fragment"><div class="line">--To convert from a number to a <span class="keywordtype">string</span>:</div>
<div class="line"><span class="keyword">set</span> myNumber to 2</div>
<div class="line"><span class="keyword">set</span> myString to (myNumber as <span class="keywordtype">string</span>)</div>
<div class="line">--To convert from a <span class="keywordtype">string</span> to a number:</div>
<div class="line"><span class="keyword">set</span> myString to <span class="stringliteral">&quot;2&quot;</span></div>
<div class="line"><span class="keyword">set</span> myNumber to (myString as integer)</div>
<div class="line">--<span class="keywordflow">if</span> your <span class="keywordtype">string</span> contains a decimal value, use <span class="stringliteral">&quot;as real&quot;</span> rather than <span class="stringliteral">&quot;as integer&quot;</span></div>
</div><!-- fragment --><p><b>Javascript</b></p>
<div class="fragment"><div class="line"><span class="comment">//To convert from a number to a string:</span></div>
<div class="line">myNumber = 2;myString = myNumber + <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="comment">//To convert from a string to an integer:</span></div>
<div class="line">myString = <span class="stringliteral">&quot;2&quot;</span>;</div>
<div class="line">myNumber = parseInt(myString);</div>
<div class="line"><span class="comment">//If your string contains a decimal value, use &quot;parseFloat&quot; rather than &quot;parseInt&quot;:</span></div>
<div class="line">myNumber = parseFloat(myString);</div>
<div class="line"><span class="comment">//You can also convert strings to numbers using the following:</span></div>
<div class="line">myNumber = +myString;</div>
</div><!-- fragment --><p><b>VBScript</b></p>
<div class="fragment"><div class="line">Rem To convert from a number to a <span class="keywordtype">string</span>:</div>
<div class="line">myNumber = 2</div>
<div class="line">myString = cstr(myNumber)</div>
<div class="line">Rem To convert from a <span class="keywordtype">string</span> to an integer:</div>
<div class="line">myString = &quot;2&quot;</div>
<div class="line">myNumber = cInt(myString)</div>
<div class="line">Rem If your <span class="keywordtype">string</span> contains a decimal value, use &quot;cDbl&quot; rather than &quot;cInt&quot;:</div>
<div class="line">myNumber = cDbl(myString)</div>
</div><!-- fragment --><h3><a class="anchor" id="id_variables"></a>
Variables</h3>
<p>A variable is a container for a value. They are called "variables" because the values they contain might change. A variable might hold a number, a string of text, or a reference to an InDesign object. Variables have names, and you refer to a variable by its name. To put a value into a variable, you assign the data to the variable.</p>
<p>In our first sample script, above, we used the variables myDocument and myTextFrame to avoid having to provide the full specification of the object (such as text frame 1 of page 1 of document 1 or app.documents.item(0).pages.item(0).textFrames.item(0)) every time we refer to the object.</p>
<p>In all the sample and tutorial scripts that come with InDesign, all variables start with my. This way, you can easily differentiate variables we created in a script from the scripting language terms.</p>
<p><b>Assigning a value to a variable</b></p>
<p>Assigning values or strings to variables is fairly simple, as shown in the following table:</p>
<table class="doxtable">
<tr>
<th>Language </th><th>Examples of assigning a value to a variable </th></tr>
<tr>
<td>AppleScript </td><td>set myNumber to 10 <br/>
 set myString to "Hello, World!" <br/>
 set myTextFrame to make text frame at page 1 of myDocument </td></tr>
<tr>
<td>JavaScript </td><td>var myNumber = 10; <br/>
 var myString = "Hello, World!"; <br/>
 var myTextFrame = myDocument.pages.item(0).textFrames.add(); </td></tr>
<tr>
<td>VBScript </td><td>myNumber = 10 <br/>
 myString = "Hello, World!" <br/>
 Set myTextFrame = myDocument.Pages.Item(1).TextFrames.Add </td></tr>
</table>
<dl class="section note"><dt>Note</dt><dd>In JavaScript, all variables that are not preceded by var are considered global by default; that is, they are not bound to a specific function. The var is not required, but we recommend that you use var in any script with more than one function. In AppleScript and VBScript, variables are local unless specifically defined as global variables. This means that the variables do not persist outside the function in which they are created.</dd></dl>
<p>Try to use descriptive names for your variables, such as firstPage or corporateLogo, rather than x or c. This makes your script easier to read. Longer names do not affect the execution speed of the script.</p>
<p>Variable names must be one word, but you can use internal capitalization (myFirstPage) or underscore characters (my_first_page) to create more readable names. Variable names cannot begin with a number, and they cannot contain punctuation or quotation marks.</p>
<h3><a class="anchor" id="id_array_variables"></a>
Array variables</h3>
<p>AppleScript, JavaScript, and VBScript support arrays, which is a variable type that is a list of values. In AppleScript, an array is called a list. Examples of how to define arrays are shown in the following table:</p>
<table class="doxtable">
<tr>
<th>Language </th><th>Examples of how to define arrays </th></tr>
<tr>
<td>AppleScript </td><td>set myArray to {1, 2, 3, 4} </td></tr>
<tr>
<td>JavaScript </td><td>myArray = [1, 2, 3, 4]; </td></tr>
<tr>
<td>VBScript </td><td>myArray = Array(1, 2, 3, 4) </td></tr>
<tr>
<td>Visual Basic </td><td>myArray = New Double (1, 2, 3, 4) </td></tr>
</table>
<p>To refer to an item in an array, refer to the item by its index in the array. The first item in an array in VBScript and JavaScript is item 0; in AppleScript, item 1. Examples of referring to items in an array are shown in the following table:</p>
<table class="doxtable">
<tr>
<th>Language </th><th>Examples of referring to the first item in an array </th></tr>
<tr>
<td>AppleScript </td><td>set myFirstArrayItem to item 1 of myArray </td></tr>
<tr>
<td>JavaScript </td><td>var myFirstArrayItem = myArray[0]; </td></tr>
<tr>
<td>VBScript </td><td>myFirstArrayItem = myArray(0) </td></tr>
</table>
<dl class="section note"><dt>Note</dt><dd>The Visual Basic OptionBase statement can be used to change the first item of an array so that it is item 1 instead of item 0. In the examples in this document, the first item in an array is item 0, not item 1, because that is the default. If you set OptionBase to 1, you must adjust all array references in the sample scripts accordingly.</dd></dl>
<p>Arrays can include other arrays, as shown in the following table:</p>
<table class="doxtable">
<tr>
<th>Language </th><th>Examples of including arrays within an array </th></tr>
<tr>
<td>AppleScript </td><td>set myArray to {{0, 0}, {72, 72}} </td></tr>
<tr>
<td>JavaScript </td><td>var myArray = [[0,0], [72,72]]; </td></tr>
<tr>
<td>VBScript </td><td>myArray = Array(Array(0,0), Array(72, 72)) </td></tr>
<tr>
<td>Visual Basic </td><td>myArray = New Array(New Double(0,0), NewDouble (0,0)) </td></tr>
</table>
<h3><a class="anchor" id="id_finding_the_value_type_of_a_variable"></a>
Finding the value type of a variable</h3>
<p>Sometimes, your scripts must make decisions based on the value type of an object. For example, if you are working on a script that operates on a text selection, you might want that script to stop if the type of the selection is a page item. All the scripting languages allow you to determine the type of a variable.</p>
<p><b>AppleScript</b></p>
<div class="fragment"><div class="line">-- Given a variable of unknown type, <span class="stringliteral">&quot;myMysteryVariable&quot;</span>...</div>
<div class="line">set myType to <span class="keyword">class </span>of myMysteryVariable</div>
<div class="line">--myType will be an AppleScript type (e.g., rectangle)</div>
</div><!-- fragment --><p><b>Javascript</b></p>
<div class="fragment"><div class="line"><span class="comment">//Given a variable of unknown type, &quot;myMysteryVariable&quot;...</span></div>
<div class="line">myType = myMysteryVariable.constructor.name;</div>
<div class="line"><span class="comment">//myType will be a string corresponding to the JavaScript type (e.g., &quot;Rectangle&quot;)</span></div>
</div><!-- fragment --><p><b>VBScript</b></p>
<div class="fragment"><div class="line">Rem Given a variable of unknown type, <span class="stringliteral">&quot;myMysteryVariable&quot;</span>...</div>
<div class="line">myType = TypeName(myMysteryVariable)</div>
<div class="line">Rem myType will be a <span class="keywordtype">string</span> corresponding to the variable type (e.g., &quot;Rectangle&quot;)</div>
</div><!-- fragment --><h3><a class="anchor" id="id_math_operators"></a>
Math operators</h3>
<p>Operators use variables or values to perform calculations (addition, subtraction, multiplication, and division) and return a value. For example: </p>
<div class="fragment"><div class="line">MyWidth/2</div>
</div><!-- fragment --><p>This returns a value equal to half of the content of the variable myWidth.</p>
<p>You also can use operators to perform comparisons: equal to (=), not equal to(&lt;&gt;), greater than(&gt;), or less than(&lt;). For example: </p>
<div class="fragment"><div class="line">MyWidth &gt; myHeight</div>
</div><!-- fragment --><p>This returns true (or 1) if myWidth is greater than myHeight; otherwise, false (0).</p>
<h3><a class="anchor" id="text_string_operators"></a>
Text (string) operators</h3>
<p>All the scripting languages provide additional utility operators. In AppleScript and VBScript, the ampersand concatenates (or joins) two strings: </p>
<div class="fragment"><div class="line"><span class="stringliteral">&quot;Pride &quot;</span> &amp; <span class="stringliteral">&quot;and Prejudice&quot;</span></div>
</div><!-- fragment --><p>This returns the following string: </p>
<div class="fragment"><div class="line"><span class="stringliteral">&quot;Pride and Prejudice&quot;</span></div>
</div><!-- fragment --><p>In JavaScript, use the plus sign ( + ) to join the two strings: </p>
<div class="fragment"><div class="line"><span class="stringliteral">&quot;Pride &quot;</span> + <span class="stringliteral">&quot;and Prejudice&quot;</span></div>
<div class="line"><span class="comment">//returns the string: &quot;Pride and Prejudice&quot;</span></div>
</div><!-- fragment --><h3><a class="anchor" id="id_conditional_statements"></a>
Conditional statements</h3>
<p>Conditional statements make a decision based on an evaluation. For example, "If the selected object is a rectangle, set its stroke weight to 12 points" is a conditional statement. Conditional statements make decisions; they give your scripts a way to evaluate something (like the color of the selected object, the number of pages in the publication, or the date) and act based on the result. Conditional statements almost always start with if.</p>
<dl class="section note"><dt>Note</dt><dd>Conditional statements often make logical comparisons. In AppleScript and VBScript, use the equal sign ( = ) to compare objects. In JavaScript, the equal sign assigns a value to a variable; to compare objects, use a double equal sign ( == ).</dd></dl>
<p>This simple example uses a conditional statement to evaluate whether any documents are open. If one or more documents are open , the code that is pasted instead of the comment is executed. If no documents are open, a message window opens. It can be a useful way to check if the script is being used in the context that it should be.</p>
<p><b>AppleScript</b></p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (count documents) &gt; 0 then</div>
<div class="line">    --Your code goes here </div>
<div class="line"><span class="keywordflow">else</span> </div>
<div class="line">    display dialog <span class="stringliteral">&quot;No documents are open. Please open a document and try again.&quot;</span></div>
</div><!-- fragment --><p><b>JavaScript</b></p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (app.documents.length &gt; 0) {</div>
<div class="line">    <span class="comment">//Your code goes here.</span></div>
<div class="line">}<span class="keywordflow">else</span>{</div>
<div class="line">    alert (<span class="stringliteral">&quot;No documents are open. Please open a document and try again.&quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment --><p><b>VBScript</b></p>
<div class="fragment"><div class="line">If app.Documents.Count &gt; 0 Then</div>
<div class="line">    Rem Your code goes here.</div>
<div class="line">Else</div>
<div class="line">    MsgBox (<span class="stringliteral">&quot;No documents are open. Please open a document and try again.&quot;</span>)</div>
</div><!-- fragment --><h3><a class="anchor" id="id_control_structures"></a>
Control structures</h3>
<p>If you could talk to InDesign, you might say, "Repeat the following procedure 20 times." In scripting terms, this is a control structure. Control structures provide repetitive processes, or loops. The idea of a loop is to repeat an action over and over, with or without changes between instances (or iterations) of the loop, until a specific condition is met. Control structures usually start with <b>repeat</b> (in AppleScript) or <b>for</b> (in JavaScript and VBScript).</p>
<p>Note: Code examples for control structures. Loops a procedure 20 times.</p>
<p><b>AppleScript</b></p>
<div class="fragment"><div class="line">repeat with myCounter from 1 to 20</div>
<div class="line">    --Your procedure goes here</div>
<div class="line">end repeat</div>
</div><!-- fragment --><p><b>JavaScript</b></p>
<div class="fragment"><div class="line"><span class="keywordflow">for</span> (var myCounter = 0; myCounter &lt; 20; myCounter++) {</div>
<div class="line">    <span class="comment">//Your procedure goes here</span></div>
<div class="line">}</div>
</div><!-- fragment --><p><b>VBScript</b></p>
<div class="fragment"><div class="line">For myCounter = 1 To 20</div>
<div class="line">    Rem Your procedure goes here</div>
<div class="line">Next</div>
</div><!-- fragment --><h3><a class="anchor" id="id_functions_and_handlers"></a>
Functions and handlers</h3>
<p>Functions (in VBScript or JavaScript) or handlers (in AppleScript) are scripting modules to which you can refer from within your script. Typically, you send a value or series of values to a function (or handler) and get back some other value or values. The code used in functions and handlers is simply a convenience to avoid having to type the same lines of code repeatedly in your script.</p>
<p>In AppleScript, handlers start with on. In JavaScript and VBScript, functions start with <b>function</b>.</p>
<dl class="section note"><dt>Note</dt><dd>Code example of function/handler syntax.</dd></dl>
<p>Using parameters and/or return values is entirely optional. To use the code below simply assign a value to myReturnValue, substitute the comment with a procedure and call the function.</p>
<p>If you do not want your function to return anything, remove the line with myReturnValue variable.</p>
<p><b>AppleScript</b></p>
<div class="fragment"><div class="line">on myFunction(myParameter)</div>
<div class="line">--Your procedure goes here</div>
<div class="line"><span class="keywordflow">return</span> myReturnValue (optional)</div>
<div class="line">end myFunction</div>
</div><!-- fragment --><p><b>JavaScript</b></p>
<div class="fragment"><div class="line"><span class="keyword">function</span> myFunction(myParameter){</div>
<div class="line"><span class="comment">//Your procedure goes here</span></div>
<div class="line"><span class="keywordflow">return</span> myReturnValue; (optional)</div>
<div class="line">}</div>
</div><!-- fragment --><p><b>VBScript</b></p>
<div class="fragment"><div class="line">Function myFunction(myParameter)</div>
<div class="line">Rem Your procedure goes here</div>
<div class="line">myFunction = myReturnValue (optional)</div>
<div class="line">End Function</div>
</div><!-- fragment --><p>To call any of the functions above use:</p>
<div class="fragment"><div class="line">myFunction(<span class="stringliteral">&quot;Your value&quot;</span>)</div>
</div><!-- fragment --><h1><a class="anchor" id="id_understanding_the_indesign_object_model"></a>
Understanding the InDesign object model</h1>
<p>When you think about InDesign and InDesign documents, you probably organize the program and its components in your mind. You know that paragraphs are contained by text frames which, in turn, appear on a page. A page is a part of a spread, and one or more spreads make up a document. Documents contain colors, styles, layers, and master spreads. As you think about the layouts you create, you intuitively understand that there is an order to them.</p>
<p>InDesign "thinks" about the contents of a document in the same way. A document contains pages, which contain page items (text frames, rectangles, ellipses, and so on). Text frames contain characters, words, paragraphs, and anchored frames; graphics frames contain images, EPS files, or PDF files; and groups contain other page items. The things we mention here are the objects that make up an InDesign publication, and they are what we work with when we write InDesign scripts.</p>
<p>Objects in your publication are arranged in a specific order: frames are on pages, which are inside a document, which is inside the InDesign application object. When we speak of an object model or a hierarchy, we are talking about this structure. Understanding the object model is the key to finding the object you want to work with, and your best guide to InDesign scripting is your knowledge of InDesign itself.</p>
<p>Objects have properties (attributes). For example, the properties of a text object include the font used to format the text, the point size, and the leading applied to the text.</p>
<p>Properties have values; for example, the point size of text can be either a number (in points) or the string "Auto" for auto leading. The fill color property of text can be set to a color, a gradient, a mixed ink, or a swatch.</p>
<p>Properties also can be read/write or read only. Read/write properties can be set to other values; read only properties cannot.</p>
<p>Objects also have methods-the verbs of the scripting world, or the actions an object can perform. For example, the document object has print, export, and save methods.</p>
<p>Methods have parameters, or values that define the effect of the method. For example, the place method of a document has a parameter that defines the file you want to place. Parameters can be required or optional, depending on the method.</p>
<p>The following figure is an overview of the InDesign object model. The diagram is not a comprehensive list of the objects available to InDesign scripting; instead, it is a conceptual framework for understanding the relationships between the types of objects. </p>
<div class="image">
<img src="InDesign_ScriptingTutorial-1.gif" alt="InDesign_ScriptingTutorial-1.gif"/>
</div>
<p>The objects in the diagram are explained in the following table:</p>
<table class="doxtable">
<tr>
<th>Term </th><th>What it represents </th></tr>
<tr>
<td>Application </td><td>InDesign. </td></tr>
<tr>
<td>Application defaults </td><td>Application default settings, such as colors, paragraph styles, and object styles. Application defaults affect all new documents. </td></tr>
<tr>
<td>Application events </td><td>The things that happen as a user or script works with the application. Events are generated by opening, closing, or saving a document or choosing a menu item. Scripts can be triggered by events. </td></tr>
<tr>
<td>Application menus </td><td>The menus, submenus, and context menus displayed in the InDesign user interface. Scripts can be attached to menu choices and can execute menu actions. </td></tr>
<tr>
<td>Application methods </td><td>The actions the application can take; for example, finding and changing text, copying the selection, creating new documents, and opening libraries. </td></tr>
<tr>
<td>Application preferences </td><td>For example, text preferences, PDF export preferences, and document preferences. Many of the preferences objects also exist at the document level. Just as in the user interface, application preferences are applied to new documents. Document preferences change the settings of a specific document. </td></tr>
<tr>
<td>Application properties </td><td>The properties of the application; for example, the full path to the application, the locale of the application, and the user name. </td></tr>
<tr>
<td>Books </td><td>A collection of open books. </td></tr>
<tr>
<td>Document </td><td>An InDesign document. </td></tr>
<tr>
<td>Document defaults </td><td>Document default settings, such as colors, paragraph styles, and text formatting defaults. </td></tr>
<tr>
<td>Document elements </td><td>For example, the stories, imported graphics, and pages of a document. The figure that precedes this table shows pages and stories, because those objects are very important containers for other objects, but document elements also include rectangles, ovals, groups, XML elements, and any other type of object you can import or create. </td></tr>
<tr>
<td>Document events </td><td>Events that occur at the document level, like importing text. See "Application events" in this table. </td></tr>
<tr>
<td>Document methods </td><td>The actions the document can take; for example, closing a document, printing a document, and exporting a document. </td></tr>
<tr>
<td>Document preferences </td><td>The preferences of a document, such as guide preferences, view preferences, and document preferences. </td></tr>
<tr>
<td>Document properties </td><td>For example, the document filename, number of pages, and zero point location. </td></tr>
<tr>
<td>Documents </td><td>A collection of open documents. </td></tr>
<tr>
<td>Libraries </td><td>A collection of open libraries. </td></tr>
<tr>
<td>Page </td><td>A single page in an InDesign document. </td></tr>
<tr>
<td>Page items </td><td>Any object you can create or place on a page. There are many types of page items, such as text frames, rectangles, graphic lines, or groups. </td></tr>
<tr>
<td>Pages or spreads </td><td>The pages or spreads in an InDesign document. </td></tr>
<tr>
<td>Stories </td><td>The text in an InDesign document. </td></tr>
<tr>
<td>Text objects </td><td>Characters, words, lines, paragraphs, and text columns are examples of text objects in an InDesign story. </td></tr>
</table>
<p><b>Looking at the InDesign object model</b></p>
<p>You can view the InDesign object model from inside your script-editing application. All reference information on objects and their properties and methods is stored in the model and can be viewed</p>
<p><b>AppleScript</b></p>
<p>To view the InDesign AppleScript dictionary:</p>
<ol type="1">
<li>Start InDesign.</li>
<li>Start the Apple Script Editor.</li>
<li>In the Script Editor, choose File &gt; Open Dictionary. The Script Editor displays a list of scriptable applications: <div class="image">
<img src="InDesign_ScriptingTutorial-2.gif" alt="InDesign_ScriptingTutorial-2.gif"/>
</div>
</li>
<li>Select your copy of InDesign, and click Choose. The Script Editor displays a list of InDesign's suites (collections of related objects): <div class="image">
<img src="InDesign_ScriptingTutorial-3.gif" alt="InDesign_ScriptingTutorial-3.gif"/>
</div>
</li>
<li>Select a suite to see the objects and methods (commands) that it contains. Select an object to see its properties.</li>
</ol>
<p><b>JavaScript</b></p>
<p>To view the InDesign object model in the ExtendScript Toolkit:</p>
<ol type="1">
<li>Start the ExtendScript Toolkit.</li>
<li>Choose Help &gt; Object Model Viewer.</li>
<li>Select Adobe InDesign 2024 Object Model in the Browser pane. The ExtendScript Toolkit loads the object model help file and displays a list of InDesign scripting objects in the Classes pane.</li>
<li>From the list of objects in the Classes pane, select the object you want to view, then click the property or method you want to view in more detail in the Properties and Methods list. The ExtendScript toolkit displays more information on the property or method you selected: <div class="image">
<img src="InDesign_ScriptingTutorial-4.gif" alt="InDesign_ScriptingTutorial-4.gif"/>
</div>
</li>
</ol>
<p>For more information on using the ExtendScript Toolkit Object Model Viewer, see the JavaScript Tools Guide.</p>
<dl class="section note"><dt>Note</dt><dd>The class (object) name shown in the Object Model Viewer uses a different capitalization from the way an instance of the same object appears in a script. Because JavaScript is case-sensitive, you need to use the proper capitalization when you enter the term in a script. For example, the term "Documents" appears in the list of classes, but you would use "app.documents" to refer to that class in a script. The correct capitalization will always be shown in the Properties and Methods pane in the Object Model Viewer when the parent of the object is selected in the Class pane.</dd></dl>
<p><b>VBScript</b></p>
<p>To view the InDesign object model, you need a VBScript editor/debugger or some version of Visual Basic, or an application that incorporates Visual Basic for Applications.</p>
<ul>
<li>Visual Basic</li>
</ul>
<p>To view the object model using Visual Basic:</p>
<ol type="1">
<li>Create a new Visual Basic project. You can do this from inside Visual Studio. Then choose Project &gt; Add Reference. Visual Basic displays the Add Reference dialog box.</li>
<li>Select the COM tab.</li>
<li>From the list of available references, select Adobe InDesign 2024 Type Library, and click Select. Visual Basic adds the reference to the Selected Components list. If the library does not appear in the list of available references, click Browse and locate and select the Resources for Visual .tlb file, which usually is in C:\Users\&lt;username&gt;\AppData\Local\Adobe\InDesign\Version 18.0\&lt;locale&gt;\Caches\Scripting Support\ . Once you find the file, click Open to add the reference to your project: <div class="image">
<img src="InDesign_ScriptingTutorial-5.gif" alt="InDesign_ScriptingTutorial-5.gif"/>
</div>
</li>
<li>Click OK.</li>
<li>Choose View &gt; Object Browser. Visual Basic displays the Object Browser tab.</li>
<li>From the list of open libraries in the Objects window, choose interop.indesign. Visual Basic displays the objects that make up the InDesign object model.</li>
<li>Click an object class. Visual Basic displays the properties and methods of the object. For more information on a property or method, select the item; Visual Basic displays the definition of the item at the bottom of the Object Browser window: <div class="image">
<img src="InDesign_ScriptingTutorial-6.gif" alt="InDesign_ScriptingTutorial-6.gif"/>
</div>
</li>
</ol>
<ul>
<li>Visual Basic for Applications</li>
</ul>
<p>To view the object model using Visual Basic for Applications from Microsoft Excel:</p>
<ol type="1">
<li>Start Excel.</li>
<li>Choose Developer &gt; Visual Basic. Make sure Developer Tab is marked as visible in your Excel Options (File &gt; Options &gt; Customize Ribbon). Excel displays the Visual Basic Editor window.</li>
<li>Choose Tools &gt; References. The Visual Basic Editor displays the Add References dialog box: <div class="image">
<img src="InDesign_ScriptingTutorial-7.gif" alt="InDesign_ScriptingTutorial-7.gif"/>
</div>
</li>
</ol>
<ol type="1">
<li>From the list of available references, select Adobe InDesign 2024 Type Library option, and click OK. Visual Basic adds the reference to the Selected Components list. If the library does not appear in the list of available references, click Browse and locate and select the Resources for Visual Basic.tlb file, which usually is in ~:C:\Users\&lt;username&gt;\AppData\Local\Adobe\InDesign\Version 18.0\&lt;locale&gt;\Caches\Scripting Support\ . Once you find the file, click OK to add the reference to your project.</li>
<li>Choose View &gt; Object Browser. The Visual Basic Editor displays the Object Browser window.</li>
<li>From the Libraries pop-up menu, choose InDesign. The Visual Basic Editor displays a list of the objects in the InDesign object library.</li>
<li>Click an object name. The Visual Basic Editor displays the properties and methods of the object. For more information on a property or method, select the item; the Visual Basic Editor displays the definition of the item at the bottom of the Object Browser window: <div class="image">
<img src="InDesign_ScriptingTutorial-8.gif" alt="InDesign_ScriptingTutorial-8.gif"/>
</div>
</li>
</ol>
<p><b>Measurements and positioning</b></p>
<p>All items and objects in InDesign are positioned on the page according to measurements you choose. It is useful to know how the InDesign coordinate system works and what measurement units it uses.</p>
<p><b>Coordinates</b></p>
<p>InDesign, like every other page-layout and drawing program, uses simple, two-dimensional geometry to set the position of objects on a page or spread. The horizontal component of a coordinate pair is referred to as x; the vertical component, y. You can see these coordinates in the Transform panel or Control when you select an object using the Selection tool. As in the InDesign user interface, coordinates are measured relative to the current location of the ruler's zero point.</p>
<p>There is one difference between the coordinates used in InDesign and the coordinate system used in a Geometry textbook: on InDesign's vertical (or y) axis, coordinates below the zero point are positive numbers; coordinates above the zero point are negative numbers.</p>
<dl class="section note"><dt>Note</dt><dd>When you ask InDesign for the location of a path point, the coordinates are returned in x, y order. When you set the location of a path point, InDesign expects you to provide the coordinates in the same order. InDesign returns some coordinates in a different order, however, and it expects you to supply them in that order. Geometric bounds and visible bounds are arrays containing four coordinates, which define (in order) the top, left, bottom, and right edges of the object's bounding box (or y1, x1, y2,x2).</dd></dl>
<p><b>Working with measurement units</b></p>
<p>When you send measurement values to InDesign, you can send numbers (for example, 14.65) or measurement strings (for example, "1p7.1"). If you send numbers, InDesign uses the publication's current units of measurement. If you send measurement strings (see the table below), InDesign uses the units of measurement specified in the string.</p>
<p>InDesign returns coordinates and other measurement values using the publication's current measurement units. In some cases, these units do not resemble the measurement values shown in the InDesign Transform panel. For example, if the current measurement system is picas, InDesign returns fractional values as decimals, rather than using the picas-and-points notation used by the Transform panel. "1p6," for example, is returned as "1.5." InDesign does this because your scripting system would have trouble trying to perform arithmetic operations using measurement strings; for instance, trying to add "0p3.5" to "13p4" produces a script error, while adding .2916 to 13.333 (the converted pica measurements) does not.</p>
<p>If your script depends on adding, subtracting, multiplying, or dividing specific measurement values, you might want to set the corresponding measurement units at the beginning of the script. At the end of the script, you can set the measurement units back to whatever they were before you ran the script. Alternately, you can use measurement overrides, like many of the sample scripts. A measurement override is a string containing a special character, as shown in the following table:</p>
<table class="doxtable">
<tr>
<th>Override </th><th>Meaning </th><th>Example </th></tr>
<tr>
<td>c </td><td>Ciceros (add didots after the c, if necessary) </td><td>1.4c </td></tr>
<tr>
<td>cm </td><td>Centimeters </td><td>.635cm </td></tr>
<tr>
<td>i (or in) </td><td>Inches </td><td>.25i </td></tr>
<tr>
<td>mm </td><td>Millimeters </td><td>6.35mm </td></tr>
<tr>
<td>p </td><td>Picas (add points after the p, if necessary) </td><td>1p6 </td></tr>
<tr>
<td>pt </td><td>Points </td><td>18pt </td></tr>
</table>
<h2><a class="anchor" id="id_adding_features_to_"></a>
Adding features to "Hello World"</h2>
<p>Next, we create a new script that makes changes to the "Hello World" publication that we created with our first script. Our second script demonstrates how to do the following:</p>
<ul>
<li>Get the active document.</li>
<li>Use a function (or handler in AppleScript).</li>
<li>Get the page dimensions and page margins of the active document.</li>
<li>Resize a text frame.</li>
<li>Change the formatting of the text in the text frame.</li>
</ul>
<h3><a class="anchor" id="id_applescript"></a>
AppleScript</h3>
<p>Make sure you have the Hello World document open-this script relies on objects we created in that script. If you closed the document without saving it, simply run the HelloWorld.applescript script again to make a new document.</p>
<p>Either open the ImprovedHelloWorld.applescript tutorial script, or perform the following steps to create the script:</p>
<ol type="1">
<li>In the Script Editor, choose File &gt; New to create a new script.</li>
<li>Enter the following code: <div class="fragment"><div class="line">--Improved <span class="stringliteral">&quot;Hello World&quot;</span></div>
<div class="line">tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">    --Get a reference to a font.</div>
<div class="line">    <span class="keywordflow">try</span></div>
<div class="line">        --Enter the name of a font on your system, <span class="keywordflow">if</span> necessary.</div>
<div class="line">        <span class="keyword">set</span> myFont to font <span class="stringliteral">&quot;Helvetica&quot;</span></div>
<div class="line">    end <span class="keywordflow">try</span></div>
<div class="line">    --Get the active document and assign the result to the variable <span class="stringliteral">&quot;myDocument.&quot;</span></div>
<div class="line">    <span class="keyword">set</span> myDocument to document 1</div>
<div class="line">    tell myDocument</div>
<div class="line">        --Use the handler <span class="stringliteral">&quot;myGetBounds&quot;</span> to <span class="keyword">get</span> the bounds of the</div>
<div class="line">        --<span class="stringliteral">&quot;live area&quot;</span> inside the margins of page 1.</div>
<div class="line">        <span class="keyword">set</span> myBounds to my myGetBounds(myDocument, page 1)</div>
<div class="line">        tell text frame 1 of page 1</div>
<div class="line">            --Resize the text frame to match the page margins.</div>
<div class="line">            set geometric bounds to myBounds</div>
<div class="line">            tell paragraph 1</div>
<div class="line">                --Change the font, size, and paragraph alignment.</div>
<div class="line">                try</div>
<div class="line">                    set applied font to myFont</div>
<div class="line">                end try</div>
<div class="line">                set point size to 72</div>
<div class="line">                set justification to center align</div>
<div class="line">            end tell</div>
<div class="line">        end tell</div>
<div class="line">    end tell</div>
<div class="line">end tell</div>
<div class="line">--myGetBounds is a handler that returns the bounds of the &quot;live area&quot; of a page.</div>
<div class="line">on myGetBounds(myDocument, myPage)</div>
<div class="line">    tell application &quot;Adobe InDesign 2024&quot;</div>
<div class="line">        tell document preferences of myDocument</div>
<div class="line">            set myPageWidth to page width</div>
<div class="line">            set myPageHeight to page height</div>
<div class="line">        end tell</div>
<div class="line">        tell margin preferences of myPage</div>
<div class="line">            if side of myPage is left hand then</div>
<div class="line">                set myX2 to left</div>
<div class="line">                set myX1 to right</div>
<div class="line">            else</div>
<div class="line">                set myX1 to left</div>
<div class="line">                set myX2 to right</div>
<div class="line">            end if</div>
<div class="line">            set myY1 to top</div>
<div class="line">            set myY2 to bottom</div>
<div class="line">        end tell</div>
<div class="line">        set myX2 to myPageWidth - myX2</div>
<div class="line">        set myY2 to myPageHeight - myY2</div>
<div class="line">        return {myY1, myX1, myY2, myX2}</div>
<div class="line">    end tell</div>
<div class="line">end myGetBounds</div>
</div><!-- fragment --></li>
<li>Save the script as a plain text file with the file extension .applescript in the Scripts Panel folder (see <a class="el" href="id_scripting_tutorial.html#id_installing_scripts">Installing scripts</a>).</li>
</ol>
<p>Once you've opened or created the script file, you can run the script from the Script Editor or from the InDesign Scripts panel.</p>
<h3><a class="anchor" id="id_javascript"></a>
JavaScript</h3>
<p>Make sure that you have the Hello World document open-this script relies on objects we created in that script. If you closed the document without saving it, simply run the HelloWorld.jsx script again to make a new document.</p>
<p>Either open the ImprovedHelloWorld.jsx tutorial script, or perform the following steps to create the script:</p>
<ol type="1">
<li>Enter the following JavaScript in a new text file: <div class="fragment"><div class="line">ï»¿<span class="comment">//ImprovedHelloWorld.jsx</span></div>
<div class="line"><span class="comment">//An InDesign JavaScript</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//Enter the name of a font on your system, if necessary.</span></div>
<div class="line">var myFont = app.fonts.item(<span class="stringliteral">&quot;Arial&quot;</span>);</div>
<div class="line">var myDocument = app.activeDocument;</div>
<div class="line">var myPage = myDocument.pages.item(0);</div>
<div class="line"><span class="comment">//Get page width and page height using the function &quot;myGetBounds&quot;.</span></div>
<div class="line">var myBounds = myGetBounds(myDocument, myPage);</div>
<div class="line">var myTextFrame = myPage.textFrames.item(0);</div>
<div class="line"><span class="comment">//Resize the text frame to match the publication margins.</span></div>
<div class="line">myTextFrame.geometricBounds = myBounds;</div>
<div class="line">var myParagraph = myTextFrame.paragraphs.item(0);</div>
<div class="line"><span class="comment">//Change the font, size, and alignment.</span></div>
<div class="line">myParagraph.appliedFont = myFont;</div>
<div class="line">myParagraph.pointSize = 48;</div>
<div class="line">myParagraph.justification = Justification.centerAlign;</div>
<div class="line"><span class="keyword">function</span> myGetBounds(myDocument, myPage){</div>
<div class="line">    var myPageWidth = myDocument.documentPreferences.pageWidth;</div>
<div class="line">    var myPageHeight = myDocument.documentPreferences.pageHeight</div>
<div class="line">    <span class="keywordflow">if</span>(myPage.side == PageSideOptions.leftHand){</div>
<div class="line">        var myX2 = myPage.marginPreferences.left;</div>
<div class="line">        var myX1 = myPage.marginPreferences.right;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span>{</div>
<div class="line">        var myX1 = myPage.marginPreferences.left;</div>
<div class="line">        var myX2 = myPage.marginPreferences.right;</div>
<div class="line">    }</div>
<div class="line">    var myY1 = myPage.marginPreferences.top;</div>
<div class="line">    var myX2 = myPageWidth - myX2;</div>
<div class="line">    var myY2 = myPageHeight - myPage.marginPreferences.bottom;</div>
<div class="line">    <span class="keywordflow">return</span> [myY1, myX1, myY2, myX2];</div>
<div class="line">}</div>
</div><!-- fragment --></li>
<li>Save the script as a plain text file with the file extension .jsx in the Scripts Panel folder (see <a class="el" href="id_scripting_tutorial.html#id_installing_scripts">Installing scripts</a>).</li>
</ol>
<p>Once you've opened or created the script file, you can run the script from the ExtendScript Toolkit or from the InDesign Scripts panel.</p>
<h3><a class="anchor" id="id_vbscript"></a>
VBScript</h3>
<p>Make sure you have the Hello World document open-this script relies on objects we created in that script. If you closed the document without saving it, simply run the HelloWorld.vbs script again to make a new document.</p>
<p>Either open the ImprovedHelloWorld.vbs tutorial script, or perform the following steps to create the script:</p>
<ol type="1">
<li>Start any text editor (for example, Notepad).</li>
<li>Enter the following code: <div class="fragment"><div class="line">Rem ImprovedHelloWorld.vbs</div>
<div class="line">Rem An InDesign VBScript</div>
<div class="line">Rem</div>
<div class="line">Rem Changes the size of an existing text frame and</div>
<div class="line">Rem formats the text.</div>
<div class="line">Set myInDesign = CreateObject(<span class="stringliteral">&quot;InDesign.Application.2024&quot;</span>)</div>
<div class="line">Rem Enter the name of a font on your system, if necessary.</div>
<div class="line">On Error Resume Next</div>
<div class="line">Set myFont = myInDesign.Fonts.Item(&quot;Arial&quot;)</div>
<div class="line">On Error Goto 0</div>
<div class="line">Set myDocument = myInDesign.ActiveDocument</div>
<div class="line">Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">Rem Get page width and page height using the function &quot;myGetBounds&quot;.</div>
<div class="line">myBounds = myGetBounds(myDocument, myPage)</div>
<div class="line">Set myTextFrame = myPage.TextFrames.Item(1)</div>
<div class="line">Rem Resize the text frame to match the publication margins.</div>
<div class="line">myTextFrame.GeometricBounds = myBounds</div>
<div class="line">Set myParagraph = myTextFrame.Paragraphs.Item(1)</div>
<div class="line">Rem Change the font, size, and alignment.</div>
<div class="line">If TypeName(myFont) &lt;&gt; &quot;Nothing&quot; Then</div>
<div class="line">    myParagraph.AppliedFont = myFont</div>
<div class="line">End If</div>
<div class="line">myParagraph.PointSize = 48</div>
<div class="line">myParagraph.Justification = idJustification.idCenterAlign</div>
<div class="line">Rem myGetBounds is a function that returns the bounds </div>
<div class="line">Rem of the &quot;live area&quot; of a page.</div>
<div class="line">Function myGetBounds(myDocument, myPage)</div>
<div class="line">    myPageWidth = myDocument.DocumentPreferences.PageWidth</div>
<div class="line">    myPageHeight = myDocument.DocumentPreferences.PageHeight</div>
<div class="line">    If myPage.Side = idPageSideOptions.idLeftHand Then</div>
<div class="line">        myX2 = myPage.MarginPreferences.Left</div>
<div class="line">        myX1 = myPage.MarginPreferences.Right</div>
<div class="line">    Else</div>
<div class="line">        myX1 = myPage.MarginPreferences.Left</div>
<div class="line">        myX2 = myPage.MarginPreferences.Right</div>
<div class="line">    End If</div>
<div class="line">    myY1 = myPage.marginPreferences.Top</div>
<div class="line">    myX2 = myPageWidth - myX2</div>
<div class="line">    myY2 = myPageHeight - myPage.MarginPreferences.Bottom</div>
<div class="line">    myGetBounds =  Array(myY1, myX1, myY2, myX2)</div>
<div class="line">End Function</div>
</div><!-- fragment --></li>
<li>Save the text as a plain text file with the file extension .vbs in the Scripts folder (see <a class="el" href="id_scripting_tutorial.html#id_installing_scripts">Installing scripts</a>).</li>
</ol>
<p>Once you've opened or created the script file, you can run the script from the InDesign Scripts panel.</p>
<p>Obviously, our "Hello World!" script would not be very useful in your daily work, but it has shown you the basics of InDesign scripting. In the following section, we'll show a script that does a bit more and that demonstrates scripting techniques you're likely to use in your own scripts.</p>
<p>While you can use an InDesign script at any point in your production process, we will start by creating a script that starts at the same point you do: We'll create a new document, set page margins, and define and apply master pages. The following figure shows a block diagram that represents the objects we'll work with. </p>
<div class="image">
<img src="InDesign_ScriptingTutorial-9.gif" alt="InDesign_ScriptingTutorial-9.gif"/>
</div>
<p>In this section, we will look at the DocumentTemplate tutorial script. We'll break the script into a series of blocks; each block demonstrates a specific area or task in InDesign scripting.</p>
<dl class="section note"><dt>Note</dt><dd>The preceding figure uses the JavaScript version of the scripting terms. For AppleScript, you would add spaces between words (view preferences, rather than viewPreferences); for VBScript, you would use an item index starting at 1, rather than 0 (masterSpreads.item(1), rather than masterSpreads.item(0)). Apart from these very minor differences in spacing and capitalization, and for a few reserved words in each language, the terms used in the different languages are the same.</dd></dl>
<p>The objects in the object model generally correspond to the names of controls in the user interface, as shown in the following diagram (which, again, uses the JavaScript form of the scripting terms): </p>
<div class="image">
<img src="InDesign_ScriptingTutorial-10.gif" alt="InDesign_ScriptingTutorial-10.gif"/>
</div>
<p>In the following sections, we'll discuss each functional area in the DocumentConstruction script. Open this script in the script editor for the language of your choice if you'd like to follow along.</p>
<h3><a class="anchor" id="id_setting_up_measurement_units_and_master_spread_margins"></a>
Setting up measurement units and master spread margins</h3>
<p>The following script fragment shows how to create a new document and set the margins of the first master spread.</p>
<p><b>AppleScript</b></p>
<div class="fragment"><div class="line">tell application <span class="stringliteral">&quot;Adobe InDesign 2024&quot;</span></div>
<div class="line">    --Create a <span class="keyword">new</span> document.</div>
<div class="line">    <span class="keyword">set</span> myDocument to make document</div>
<div class="line">    --Set the measurement units and ruler origin.</div>
<div class="line">    <span class="keyword">set</span> horizontal measurement units of view preferences to points</div>
<div class="line">    <span class="keyword">set</span> vertical measurement units of view preferences to points</div>
<div class="line">    <span class="keyword">set</span> ruler origin of view preferences to page origin</div>
<div class="line">    --Get a reference to the first master spread.</div>
<div class="line">    <span class="keyword">set</span> myMasterSpread to master spread 1 of myDocument</div>
<div class="line">    --Get a reference to the margin preferences of the first page in the master spread.</div>
<div class="line">    tell margin preferences of page 1 of myMasterSpread</div>
<div class="line">        --Now <span class="keyword">set</span> up the page margins and columns.</div>
<div class="line">        <span class="keyword">set</span> left to 84</div>
<div class="line">        <span class="keyword">set</span> top to 70</div>
<div class="line">        <span class="keyword">set</span> right to 70</div>
<div class="line">        <span class="keyword">set</span> bottom to 78</div>
<div class="line">        <span class="keyword">set</span> column count to 3</div>
<div class="line">        <span class="keyword">set</span> column gutter to 14</div>
<div class="line">    end tell</div>
<div class="line">    --Page margins and columns <span class="keywordflow">for</span> the right-hand page.</div>
<div class="line">    tell margin preferences of page 2 of myMasterSpread</div>
<div class="line">        <span class="keyword">set</span> left to 84</div>
<div class="line">        <span class="keyword">set</span> top to 70</div>
<div class="line">        <span class="keyword">set</span> right to 70</div>
<div class="line">        <span class="keyword">set</span> bottom to 78</div>
<div class="line">        <span class="keyword">set</span> column count to 3</div>
<div class="line">        <span class="keyword">set</span> column gutter to 14</div>
<div class="line">    end tell</div>
</div><!-- fragment --><p> <b>JavaScript</b></p>
<div class="fragment"><div class="line"><span class="comment">//Create a new document.</span></div>
<div class="line">var myDocument = app.documents.add();</div>
<div class="line"></div>
<div class="line"><span class="comment">//Set the measurement units and ruler origin.</span></div>
<div class="line">myDocument.viewPreferences.horizontalMeasurementUnits = MeasurementUnits.points;</div>
<div class="line">myDocument.viewPreferences.verticalMeasurementUnits = MeasurementUnits.points;</div>
<div class="line">myDocument.viewPreferences.rulerOrigin = RulerOrigin.pageOrigin;</div>
<div class="line"></div>
<div class="line"><span class="comment">//Get a reference to the first master spread.</span></div>
<div class="line">var myMasterSpread = myDocument.masterSpreads.item(0);</div>
<div class="line"></div>
<div class="line"><span class="comment">//Get a reference to the margin preferences of the first page in the master spread.</span></div>
<div class="line">var myMarginPreferences = myMasterSpread.pages.item(0).marginPreferences;</div>
<div class="line"></div>
<div class="line"><span class="comment">//Now set up the page margins and columns.</span></div>
<div class="line">myMarginPreferences.left = 84;</div>
<div class="line">myMarginPreferences.top = 70;</div>
<div class="line">myMarginPreferences.right = 70;</div>
<div class="line">myMarginPreferences.bottom = 78;</div>
<div class="line">myMarginPreferences.columnCount = 3;</div>
<div class="line">myMarginPreferences.columnGutter = 14;</div>
<div class="line"></div>
<div class="line"><span class="comment">//Page margins and columns for the right-hand page.</span></div>
<div class="line">var myMarginPreferences = myMasterSpread.pages.item(1).marginPreferences;</div>
<div class="line">myMarginPreferences.left = 84;</div>
<div class="line">myMarginPreferences.top = 70;</div>
<div class="line">myMarginPreferences.right = 70;</div>
<div class="line">myMarginPreferences.bottom = 78;</div>
<div class="line">myMarginPreferences.columnCount = 3;</div>
<div class="line">myMarginPreferences.columnGutter = 14;</div>
</div><!-- fragment --><p> <b>VBScript</b></p>
<p>Either enter the following code in your script or text editor, or open the DocumentConstruction.vbs tutorial script.</p>
<div class="fragment"><div class="line">Set myInDesign = CreateObject(<span class="stringliteral">&quot;InDesign.Application.2024&quot;</span>)</div>
<div class="line">Rem Create a new document.</div>
<div class="line">Set myDocument = myInDesign.Documents.Add()</div>
<div class="line">Rem Set the measurement units and ruler origin.</div>
<div class="line">myDocument.ViewPreferences.HorizontalMeasurementUnits = idMeasurementUnits.idPoints</div>
<div class="line">myDocument.ViewPreferences.VerticalMeasurementUnits = idMeasurementUnits.idPoints</div>
<div class="line">myDocument.ViewPreferences.RulerOrigin = idRulerOrigin.idPageOrigin</div>
<div class="line">Rem Get a reference to the first master spread.</div>
<div class="line">Set myMasterSpread = myDocument.MasterSpreads.Item(1)</div>
<div class="line">Rem Get a reference to the margin preferences of the first page in the master spread.</div>
<div class="line">Set myMarginPreferences = myMasterSpread.Pages.Item(1).MarginPreferences</div>
<div class="line">Rem Now set up the page margins and columns.</div>
<div class="line">myMarginPreferences.Left = 84</div>
<div class="line">myMarginPreferences.Top = 70</div>
<div class="line">myMarginPreferences.Right = 70</div>
<div class="line">myMarginPreferences.Bottom = 78</div>
<div class="line">myMarginPreferences.ColumnCount = 3</div>
<div class="line">myMarginPreferences.ColumnGutter = 14</div>
<div class="line">Rem Page margins and columns for the right-hand page.</div>
<div class="line">Set myMarginPreferences = myMasterSpread.Pages.Item(2).MarginPreferences</div>
<div class="line">myMarginPreferences.Left = 84</div>
<div class="line">myMarginPreferences.Top = 70</div>
<div class="line">myMarginPreferences.Right = 70</div>
<div class="line">myMarginPreferences.Bottom = 78</div>
<div class="line">myMarginPreferences.ColumnCount = 3</div>
<div class="line">myMarginPreferences.ColumnGutter = 14</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_adding_a_baseline_grid"></a>
Adding a baseline grid</h3>
<p>Now that we have a master spread set up, we will add a baseline grid. Here is a block diagram that shows the relationship between the objects we'll be working with (the diagram uses the JavaScript form of the scripting terms): </p>
<div class="image">
<img src="InDesign_ScriptingTutorial-11.gif" alt="InDesign_ScriptingTutorial-11.gif"/>
</div>
<p><b>AppleScript</b></p>
<div class="fragment"><div class="line">    <span class="keyword">set</span> myGridPreferences to grid preferences</div>
<div class="line">    <span class="keyword">set</span> baseline division of myGridPreferences to 14</div>
<div class="line">    <span class="keyword">set</span> baseline start of myGridPreferences to 70</div>
<div class="line">    <span class="keyword">set</span> baseline grid shown of myGridPreferences to <span class="keyword">true</span></div>
</div><!-- fragment --><p> <b>JavaScript</b></p>
<div class="fragment"><div class="line">var myGridPreferences = myDocument.gridPreferences;</div>
<div class="line">myGridPreferences.baselineDivision = 14;</div>
<div class="line">myGridPreferences.baselineStart = 70;</div>
<div class="line">myGridPreferences.baselineGridShown = <span class="keyword">true</span>;</div>
</div><!-- fragment --><p> <b>VBScript</b></p>
<div class="fragment"><div class="line">Set myGridPreferences = myDocument.GridPreferences</div>
<div class="line">myGridPreferences.BaselineDivision = 14</div>
<div class="line">myGridPreferences.BaselineStart = 70</div>
<div class="line">myGridPreferences.BaselineGridShown = True</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_adding_master_page_items"></a>
Adding master page items</h3>
<p>Next, we add two text frames to the master pages. These frames will contain the auto-page-number special character and will be positioned at the bottom of the page.</p>
<p>In the "Hello World" example, we created a text frame and specified its position and size using the geometric bounds property-an array containing the top, left, bottom, and right coordinates for the frame. The coordinates correspond to the corners of the frame, just as they would appear in the Control panel. The geometric bounds are: top = 728, left = 70, bottom = 742, and right = 528, as shown in the following two figures: </p>
<div class="image">
<img src="InDesign_ScriptingTutorial-12.gif" alt="InDesign_ScriptingTutorial-12.gif"/>
</div>
 <div class="image">
<img src="InDesign_ScriptingTutorial-13.gif" alt="InDesign_ScriptingTutorial-13.gif"/>
</div>
<p> <b>AppleScript</b></p>
<div class="fragment"><div class="line">    <span class="keyword">set</span> myLeftPage to page 1 of myMasterSpread</div>
<div class="line">    <span class="keyword">set</span> myRightPage to page 2 of myMasterSpread</div>
<div class="line">    tell myLeftPage</div>
<div class="line">        <span class="keyword">set</span> myLeftFooter to make text frame</div>
<div class="line">        <span class="keyword">set</span> geometric bounds of myLeftFooter to {728, 70, 742, 528}</div>
<div class="line">        <span class="keyword">set</span> first baseline offset of text frame preferences of myLeftFooter to leading offset</div>
<div class="line">        <span class="keyword">set</span> contents of myLeftFooter to <span class="keyword">auto</span> page number</div>
<div class="line">        <span class="keyword">set</span> point size of character 1 of parent story of myLeftFooter to 11</div>
<div class="line">        <span class="keyword">set</span> leading of character 1 of myLeftFooter to 14</div>
<div class="line">    end tell</div>
<div class="line">    tell myRightPage</div>
<div class="line">        <span class="keyword">set</span> myRightFooter to make text frame</div>
<div class="line">        <span class="keyword">set</span> geometric bounds of myRightFooter to {728, 84, 742, 542}</div>
<div class="line">        <span class="keyword">set</span> first baseline offset of text frame preferences of myRightFooter to leading offset</div>
<div class="line">        <span class="keyword">set</span> contents of myRightFooter to <span class="keyword">auto</span> page number</div>
<div class="line">        <span class="keyword">set</span> point size of character 1 of parent story of myRightFooter to 11</div>
<div class="line">        <span class="keyword">set</span> leading of character 1 of myRightFooter to 14</div>
<div class="line">        <span class="keyword">set</span> justification of character 1 of myRightFooter to right align</div>
<div class="line">    end tell</div>
</div><!-- fragment --><p> <b>JavaScript</b></p>
<div class="fragment"><div class="line">var myMasterSpread = myDocument.masterSpreads.item(0);</div>
<div class="line">var myLeftPage = myMasterSpread.pages.item(0);</div>
<div class="line">var myRightPage = myMasterSpread.pages.item(1);</div>
<div class="line">var myLeftFooter = myLeftPage.textFrames.add();</div>
<div class="line">myLeftFooter.geometricBounds = [728, 70, 742, 528];</div>
<div class="line">myLeftFooter.textFramePreferences.firstBaselineOffset = FirstBaseline.leadingOffset;</div>
<div class="line">myLeftFooter.contents = SpecialCharacters.autoPageNumber;</div>
<div class="line">myLeftFooter.parentStory.characters.item(0).pointSize = 11;</div>
<div class="line">myLeftFooter.parentStory.characters.item(0).leading = 14;</div>
<div class="line">var myRightFooter = myRightPage.textFrames.add();</div>
<div class="line">myRightFooter.geometricBounds = [728, 84, 742, 542];</div>
<div class="line">myRightFooter.textFramePreferences.firstBaselineOffset = FirstBaseline.leadingOffset;</div>
<div class="line">myRightFooter.contents = SpecialCharacters.autoPageNumber;</div>
<div class="line">myRightFooter.parentStory.characters.item(0).pointSize = 11;</div>
<div class="line">myRightFooter.parentStory.characters.item(0).leading = 14;</div>
<div class="line">myRightFooter.parentStory.characters.item(0).justification = Justification.rightAlign;</div>
</div><!-- fragment --><p> <b>VBScript</b></p>
<div class="fragment"><div class="line">Set myMasterSpread = myDocument.MasterSpreads.Item(1)</div>
<div class="line">Set myLeftPage = myMasterSpread.Pages.Item(1)</div>
<div class="line">Set myRightPage = myMasterSpread.Pages.Item(2)</div>
<div class="line">Set myLeftFooter = myLeftPage.TextFrames.Add</div>
<div class="line">myLeftFooter.GeometricBounds = Array(728, 70, 742, 528)</div>
<div class="line">myLeftFooter.TextFramePreferences.FirstBaselineOffset = idFirstBaseline.idLeadingOffset</div>
<div class="line">myLeftFooter.Contents = idSpecialCharacters.idAutoPageNumber</div>
<div class="line">myLeftFooter.ParentStory.Characters.Item(1).PointSize = 11</div>
<div class="line">myLeftFooter.ParentStory.Characters.Item(1).Leading = 14</div>
<div class="line">Set myRightFooter = myRightPage.TextFrames.Add()</div>
<div class="line">myRightFooter.GeometricBounds = Array(728, 84, 742, 542)</div>
<div class="line">myRightFooter.TextFramePreferences.FirstBaselineOffset = idFirstBaseline.idLeadingOffset</div>
<div class="line">myRightFooter.Contents = idSpecialCharacters.idAutoPageNumber</div>
<div class="line">myRightFooter.ParentStory.Characters.Item(1).PointSize = 11</div>
<div class="line">myRightFooter.ParentStory.Characters.Item(1).Leading = 14</div>
<div class="line">myRightFooter.ParentStory.Characters.Item(1).Justification = idJustification.idRightAlign</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_adding_master_text_frames"></a>
Adding master text frames</h3>
<p>Next, we add master text frames. The following block diagram shows the objects and properties we'll be working with (the diagram uses the JavaScript form of the scripting terms): </p>
<div class="image">
<img src="InDesign_ScriptingTutorial-14.gif" alt="InDesign_ScriptingTutorial-14.gif"/>
</div>
<p><b>AppleScript</b></p>
<div class="fragment"><div class="line">    tell myLeftPage</div>
<div class="line">        <span class="keyword">set</span> myLeftTextFrame to make text frame</div>
<div class="line">        <span class="keyword">set</span> geometric bounds of myLeftTextFrame to {70, 70, 714, 528}</div>
<div class="line">        <span class="keyword">set</span> first baseline offset of text frame preferences of myLeftTextFrame to leading offset</div>
<div class="line">        <span class="keyword">set</span> text column count of text frame preferences of myLeftTextFrame to 3</div>
<div class="line">        <span class="keyword">set</span> text column gutter of text frame preferences of myLeftTextFrame to 14</div>
<div class="line">        --Add a label to make the frame easier to find later on.</div>
<div class="line">        <span class="keyword">set</span> label of myLeftTextFrame to <span class="stringliteral">&quot;BodyTextFrame&quot;</span></div>
<div class="line">    end tell</div>
<div class="line">    tell myRightPage</div>
<div class="line">        <span class="keyword">set</span> myRightTextFrame to make text frame</div>
<div class="line">        <span class="keyword">set</span> geometric bounds of myRightTextFrame to {70, 84, 714, 542}</div>
<div class="line">        <span class="keyword">set</span> first baseline offset of text frame preferences of myRightTextFrame to leading offset</div>
<div class="line">        <span class="keyword">set</span> text column count of text frame preferences of myRightTextFrame to 3</div>
<div class="line">        <span class="keyword">set</span> text column gutter of text frame preferences of myRightTextFrame to 14</div>
<div class="line">        --Add a label to make the frame easier to find later on.</div>
<div class="line">        <span class="keyword">set</span> label of myRightTextFrame to <span class="stringliteral">&quot;BodyTextFrame&quot;</span></div>
<div class="line">    end tell</div>
<div class="line">    --Link the two frames <span class="keyword">using</span> the next text frame <span class="keyword">property</span>.</div>
<div class="line">    <span class="keyword">set</span> next text frame of myLeftTextFrame to myRightTextFrame</div>
</div><!-- fragment --><p> <b>JavaScript</b></p>
<div class="fragment"><div class="line">var myLeftPage = myMasterSpread.pages.item(0);</div>
<div class="line">var myRightPage = myMasterSpread.pages.item(1);</div>
<div class="line">var myLeftTextFrame = myLeftPage.textFrames.add();</div>
<div class="line">myLeftTextFrame.geometricBounds = [70, 70, 714, 528];</div>
<div class="line">myLeftTextFrame.textFramePreferences.firstBaselineOffset = FirstBaseline.leadingOffset;</div>
<div class="line">myLeftTextFrame.textFramePreferences.textColumnCount = 3;</div>
<div class="line">myLeftTextFrame.textFramePreferences.textColumnGutter = 14;</div>
<div class="line"></div>
<div class="line"><span class="comment">//Add a label to make the frame easier to find later on.</span></div>
<div class="line">myLeftTextFrame.label = <span class="stringliteral">&quot;BodyTextFrame&quot;</span>;</div>
<div class="line">var myRightTextFrame = myRightPage.textFrames.add();</div>
<div class="line">myRightTextFrame.geometricBounds = [70, 84, 714, 542];</div>
<div class="line">myRightTextFrame.textFramePreferences.firstBaselineOffset = FirstBaseline.leadingOffset;</div>
<div class="line">myRightTextFrame.textFramePreferences.textColumnCount = 3;</div>
<div class="line">myRightTextFrame.textFramePreferences.textColumnGutter = 14;</div>
<div class="line"></div>
<div class="line"><span class="comment">//Add a label to make the frame easier to find later on.</span></div>
<div class="line">myRightTextFrame.label = <span class="stringliteral">&quot;BodyTextFrame&quot;</span>;</div>
<div class="line"></div>
<div class="line"><span class="comment">//Link the two frames using the nextTextFrame property.</span></div>
<div class="line">myLeftTextFrame.nextTextFrame = myRightTextFrame;</div>
</div><!-- fragment --><p> <b>VBScript</b></p>
<div class="fragment"><div class="line">Set myLeftTextFrame = myLeftPage.TextFrames.Add</div>
<div class="line">myLeftTextFrame.GeometricBounds = Array(70, 70, 714, 528)</div>
<div class="line">myLeftTextFrame.TextFramePreferences.FirstBaselineOffset = idFirstBaseline.idLeadingOffset</div>
<div class="line">myLeftTextFrame.TextFramePreferences.TextColumnCount = 3</div>
<div class="line">myLeftTextFrame.TextFramePreferences.TextColumnGutter = 14</div>
<div class="line">Rem Add a label to make the frame easier to find later on.</div>
<div class="line">myLeftTextFrame.Label = &quot;BodyTextFrame&quot;</div>
<div class="line">Set myRightTextFrame = myRightPage.TextFrames.Add</div>
<div class="line">myRightTextFrame.GeometricBounds = Array(70, 84, 714, 542)</div>
<div class="line">myRightTextFrame.TextFramePreferences.FirstBaselineOffset = idFirstBaseline.idLeadingOffset</div>
<div class="line">myRightTextFrame.TextFramePreferences.TextColumnCount = 3</div>
<div class="line">myRightTextFrame.TextFramePreferences.TextColumnGutter = 14</div>
<div class="line">Rem Add a label to make the frame easier to find later on.</div>
<div class="line">myRightTextFrame.Label = &quot;BodyTextFrame&quot;</div>
<div class="line">Rem Link the two frames using the nextTextFrame property.</div>
<div class="line">myLeftTextFrame.NextTextFrame = myRightTextFrame</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_overriding_master_page_items_and_adding_text"></a>
Overriding master page items and adding text</h3>
<p>Next, we override one of the master text frames that we created and add text to it.</p>
<p><b>AppleScript</b></p>
<div class="fragment"><div class="line">    tell text frame 1 of page 2 of master spread 1 of myDocument</div>
<div class="line">        <span class="keyword">set</span> myTextFrame to <span class="keyword">override</span> destination page page 1 of myDocument</div>
<div class="line">    end tell</div>
<div class="line">    --Add text by setting the contents of an insertion point to a <span class="keywordtype">string</span>.</div>
<div class="line">    --In AppleScript, <span class="stringliteral">&quot;return&quot;</span> is a <span class="keywordflow">return</span> character.</div>
<div class="line">    <span class="keyword">set</span> contents of insertion point 1 of myTextFrame to <span class="stringliteral">&quot;Headline!&quot;</span> &amp; <span class="keywordflow">return</span></div>
</div><!-- fragment --><p> <b>JavaScript</b></p>
<div class="fragment"><div class="line">var myTextFrame = myDocument.masterSpreads.item(0).pages.item(1).textFrames.item(0).override(myDocument.pages.item(0));</div>
<div class="line"><span class="comment">//Add text by setting the contents of an insertion point to a string.</span></div>
<div class="line"><span class="comment">//In JavaScript, &quot;\r&quot; is a return character.</span></div>
<div class="line">myTextFrame.insertionPoints.item(0).contents = <span class="stringliteral">&quot;Headline!\r&quot;</span>;</div>
</div><!-- fragment --><p> <b>VBScript</b></p>
<div class="fragment"><div class="line">Set myTextFrame = myDocument.MasterSpreads.Item(1).Pages.Item(2).TextFrames.Item(1).Override(myDocument.Pages.Item(1))</div>
<div class="line">Rem Add text by setting the contents of an insertion point to a <span class="keywordtype">string</span>.</div>
<div class="line">Rem In VBScript, vbCr is a <span class="keywordflow">return</span> character.</div>
<div class="line">myTextFrame.InsertionPoints.Item(1).Contents = <span class="stringliteral">&quot;Headline!&quot;</span> &amp; vbCr</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_adding_and_applying_a_paragraph_style"></a>
Adding and applying a paragraph style</h3>
<p>Our headline looks plain, so we will format it using a paragraph style. To do that, we must create the paragraph style. The following diagram shows the objects and properties we will work with (again, the text in this diagram uses the JavaScript form of the scripting terms): </p>
<div class="image">
<img src="InDesign_ScriptingTutorial-15.gif" alt="InDesign_ScriptingTutorial-15.gif"/>
</div>
<p><b>AppleScript</b></p>
<div class="fragment"><div class="line">    --First, check to see <span class="keywordflow">if</span> the paragraph style already exists.</div>
<div class="line">    <span class="keywordflow">try</span></div>
<div class="line">        <span class="keyword">set</span> myParagraphStyle to paragraph style <span class="stringliteral">&quot;Heading 1&quot;</span> of myDocument</div>
<div class="line">    on error</div>
<div class="line">        --The paragraph style did not exist, so create it.</div>
<div class="line">        tell myDocument</div>
<div class="line">            <span class="keyword">set</span> myParagraphStyle to make paragraph style with properties {name:<span class="stringliteral">&quot;Heading 1&quot;</span>}</div>
<div class="line">        end tell</div>
<div class="line">    end <span class="keywordflow">try</span></div>
<div class="line">    --We<span class="stringliteral">&#39;ll need to create a color. Check to see if the color already exists.</span></div>
<div class="line"><span class="stringliteral">    try</span></div>
<div class="line"><span class="stringliteral">        set myColor to color &quot;Red&quot; of myDocument</span></div>
<div class="line"><span class="stringliteral">    on error</span></div>
<div class="line"><span class="stringliteral">        --The color did not exist, so create it.</span></div>
<div class="line"><span class="stringliteral">        tell myDocument</span></div>
<div class="line"><span class="stringliteral">            set myColor to make color with properties {name:&quot;Red&quot;, model:process, color value:{0, 100, 100, 0}}</span></div>
<div class="line"><span class="stringliteral">        end tell</span></div>
<div class="line"><span class="stringliteral">    end try</span></div>
<div class="line"><span class="stringliteral">    --Now set the formatting of the paragraph style.</span></div>
<div class="line"><span class="stringliteral">    try</span></div>
<div class="line"><span class="stringliteral">        set applied font of myParagraphStyle to &quot;Arial&quot;</span></div>
<div class="line"><span class="stringliteral">        set font style of myParagraphStyle to &quot;Bold&quot;</span></div>
<div class="line"><span class="stringliteral">    end try</span></div>
<div class="line"><span class="stringliteral">    set point size of myParagraphStyle to 24</span></div>
<div class="line"><span class="stringliteral">    set space after of myParagraphStyle to 24</span></div>
<div class="line"><span class="stringliteral">    set space before of myParagraphStyle to 24</span></div>
<div class="line"><span class="stringliteral">    set fill color of myParagraphStyle to color &quot;Red&quot; of myDocument</span></div>
<div class="line"><span class="stringliteral">    --Apply the style to the paragraph.</span></div>
<div class="line"><span class="stringliteral">    tell paragraph 1 of myTextFrame to apply paragraph style using myParagraphStyle with clearing overrides</span></div>
<div class="line"><span class="stringliteral">    --You could also use:</span></div>
<div class="line"><span class="stringliteral">    --set applied paragarph style of paragraph 1 of myTextFrame to myParagraphStyle</span></div>
</div><!-- fragment --><p> <b>JavaScript</b></p>
<div class="fragment"><div class="line"><span class="comment">//First, check to see if the paragraph style already exists.</span></div>
<div class="line">var myParagraphStyle = myDocument.paragraphStyles.item(<span class="stringliteral">&quot;Heading 1&quot;</span>);</div>
<div class="line"><span class="keywordflow">try</span> {</div>
<div class="line">    var myName = myParagraphStyle.name;</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">catch</span> (myError){</div>
<div class="line">    <span class="comment">//The paragraph style did not exist, so create it.</span></div>
<div class="line">    myParagraphStyle = myDocument.paragraphStyles.add({name:<span class="stringliteral">&quot;Heading 1&quot;</span>});</div>
<div class="line">}</div>
<div class="line"><span class="comment">//We&#39;ll need to create a color. Check to see if the color already exists.</span></div>
<div class="line">var myColor = myDocument.colors.item(<span class="stringliteral">&quot;Red&quot;</span>);</div>
<div class="line"><span class="keywordflow">try</span> {</div>
<div class="line">    myName = myColor.name;</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">catch</span> (myError){</div>
<div class="line">    <span class="comment">//The color did not exist, so create it.</span></div>
<div class="line">    myColor = myDocument.colors.add({name:<span class="stringliteral">&quot;Red&quot;</span>, model:ColorModel.process, </div>
<div class="line">    colorValue:[0,100,100,0]});</div>
<div class="line">}</div>
<div class="line"><span class="comment">//Now set the formatting of the paragraph style.</span></div>
<div class="line">myParagraphStyle.appliedFont = <span class="stringliteral">&quot;Arial&quot;</span>;</div>
<div class="line">myParagraphStyle.fontStyle = <span class="stringliteral">&quot;Bold&quot;</span>;</div>
<div class="line">myParagraphStyle.pointSize = 24;</div>
<div class="line">myParagraphStyle.spaceAfter = 24;</div>
<div class="line">myParagraphStyle.spaceBefore = 24;</div>
<div class="line">myParagraphStyle.fillColor = myDocument.colors.item(<span class="stringliteral">&quot;Red&quot;</span>);</div>
<div class="line"><span class="comment">//Apply the style to the paragraph.</span></div>
<div class="line">myDocument.pages.item(0).textFrames.item(0).paragraphs.item(0).applyParagraphStyle(</div>
<div class="line">myParagraphStyle, <span class="keyword">true</span>);</div>
<div class="line"><span class="comment">//You could also use:</span></div>
<div class="line"><span class="comment">//myDocument.pages.item(0).textFrames.item(0).paragraphs.item(0).appliedParagraphStyle = myParagraphStyle;</span></div>
</div><!-- fragment --><p> <b>VBScript</b></p>
<div class="fragment"><div class="line">Rem First, check to see <span class="keywordflow">if</span> the paragraph style already exists.</div>
<div class="line">Rem to <span class="keywordflow">do</span> <span class="keyword">this</span>, we disable error checking:</div>
<div class="line">On Error Resume Next</div>
<div class="line">Set myParagraphStyle = myDocument.ParagraphStyles.Item(<span class="stringliteral">&quot;Heading 1&quot;</span>)</div>
<div class="line">Rem <span class="keywordflow">if</span> an error occurred on the previous line, then the paragraph</div>
<div class="line">Rem style did not exist.</div>
<div class="line">If Error.Number &lt;&gt; 0 Then</div>
<div class="line">    Set myParagraphStyle = myDocument.ParagraphStyles.Add</div>
<div class="line">    myParagraphStyle.Name = <span class="stringliteral">&quot;Heading 1&quot;</span></div>
<div class="line">    Error.Clear</div>
<div class="line">End If</div>
<div class="line">Rem We<span class="stringliteral">&#39;ll need to create a color. Check to see if the color already exists.</span></div>
<div class="line"><span class="stringliteral">Set myColor = myDocument.Colors.Item(&quot;Red&quot;)</span></div>
<div class="line"><span class="stringliteral">If Error.Number &lt;&gt; 0 Then</span></div>
<div class="line"><span class="stringliteral">    Set myColor = myDocument.Colors.Add</span></div>
<div class="line"><span class="stringliteral">    myColor.Name = &quot;Red&quot;</span></div>
<div class="line"><span class="stringliteral">    myColor.Model = idColorModel.idProcess</span></div>
<div class="line"><span class="stringliteral">    myColor.colorValue = Array(0, 100, 100, 0)</span></div>
<div class="line"><span class="stringliteral">    Error.Clear</span></div>
<div class="line"><span class="stringliteral">End If</span></div>
<div class="line"><span class="stringliteral">Rem Resume normal error handling.</span></div>
<div class="line"><span class="stringliteral">On Error GoTo 0</span></div>
<div class="line"><span class="stringliteral">Rem Now set the formatting of the paragraph style.</span></div>
<div class="line"><span class="stringliteral">myParagraphStyle.AppliedFont = &quot;Arial&quot;</span></div>
<div class="line"><span class="stringliteral">myParagraphStyle.FontStyle = &quot;Bold&quot;</span></div>
<div class="line"><span class="stringliteral">myParagraphStyle.PointSize = 24</span></div>
<div class="line"><span class="stringliteral">myParagraphStyle.SpaceAfter = 24</span></div>
<div class="line"><span class="stringliteral">myParagraphStyle.SpaceBefore = 24</span></div>
<div class="line"><span class="stringliteral">myParagraphStyle.FillColor = myDocument.Colors.Item(&quot;Red&quot;)</span></div>
<div class="line"><span class="stringliteral">Rem Apply the style to the paragraph.</span></div>
<div class="line"><span class="stringliteral">myDocument.Pages.Item(1).TextFrames.Item(1).Paragraphs.Item(1).ApplyParagraphStyle myParagraphStyle, True</span></div>
<div class="line"><span class="stringliteral">Rem You could also use:</span></div>
<div class="line"><span class="stringliteral">Rem myDocument.pages.item(1).textFrames.item(1).paragraphs.item(1).appliedParagraphStyle = myParagraphStyle</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_placing_a_text_file"></a>
Placing a text file</h3>
<p>Next, we import a text file. We add the text after the headline in the first text frame on the first page. The script displays a dialog box that you can use to select the text file to import.</p>
<p><b>AppleScript</b></p>
<div class="fragment"><div class="line">    --Display a standard open file dialog box to select a text file.</div>
<div class="line">    <span class="keyword">set</span> myTextFile to choose file (<span class="stringliteral">&quot;Choose a text file&quot;</span>)</div>
<div class="line">    --If a text file was selected, and <span class="keywordflow">if</span> you didn<span class="stringliteral">&#39;t press Cancel, </span></div>
<div class="line"><span class="stringliteral">    --place the text file at the first insertion point after the headline.</span></div>
<div class="line"><span class="stringliteral">    if myTextFile is not &quot;&quot; then</span></div>
<div class="line"><span class="stringliteral">        tell insertion point -1 of myTextFrame to place myTextFile</span></div>
<div class="line"><span class="stringliteral">    end if</span></div>
</div><!-- fragment --><p> <b>JavaScript</b></p>
<div class="fragment"><div class="line"><span class="comment">//Display a standard open file dialog box to select a text file.</span></div>
<div class="line">var myTextFile = File.openDialog(<span class="stringliteral">&quot;Choose a text file&quot;</span>);</div>
<div class="line"><span class="comment">//If a text file was selected, and if you didn&#39;t press Cancel, </span></div>
<div class="line"><span class="comment">//place the text file at the first insertion point after the headline.</span></div>
<div class="line"><span class="keywordflow">if</span>((myTextFile != <span class="stringliteral">&quot;&quot;</span>)&amp;&amp;(myTextFile != null)){</div>
<div class="line">    myTextFrame.insertionPoints.item(-1).place(myTextFile);</div>
<div class="line">}</div>
</div><!-- fragment --><p> <b>VBScript</b></p>
<div class="fragment"><div class="line">Rem Display a standard open file dialog box to select a text file.</div>
<div class="line">Rem VBScript does not have the ability to <span class="keywordflow">do</span> <span class="keyword">this</span>, so we<span class="stringliteral">&#39;ll use</span></div>
<div class="line"><span class="stringliteral">Rem a JavaScript to get a file name. We&#39;</span>ll run the JavaScript <span class="keyword">using</span></div>
<div class="line">Rem InDesign<span class="stringliteral">&#39;s DoScript feature.</span></div>
<div class="line"><span class="stringliteral">Rem Disable normal error handling.</span></div>
<div class="line"><span class="stringliteral">On Error Resume Next</span></div>
<div class="line"><span class="stringliteral">Rem Create a JavaScript as a string.</span></div>
<div class="line"><span class="stringliteral">myJavaScriptString = &quot;var myTextFile = File.openDialog(&quot;&quot;Choose a text file&quot;&quot;);myTextFile.fsName;&quot;</span></div>
<div class="line"><span class="stringliteral">Rem Run the JavaScript using DoScript.</span></div>
<div class="line"><span class="stringliteral">myFileName = myInDesign.DoScript(myJavaScriptString, idScriptLanguage.idJavascript)</span></div>
<div class="line"><span class="stringliteral">If Error.Number = 0 Then</span></div>
<div class="line"><span class="stringliteral">    Rem Place the text file at the end of the text frame.</span></div>
<div class="line"><span class="stringliteral">    myTextFrame.InsertionPoints.Item(-1).Place myFileName</span></div>
<div class="line"><span class="stringliteral">    Error.Clear</span></div>
<div class="line"><span class="stringliteral">End If</span></div>
<div class="line"><span class="stringliteral">Rem Restore normal error handling.</span></div>
<div class="line"><span class="stringliteral">On Error GoTo 0</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_placing_a_graphic"></a>
Placing a graphic</h3>
<p>Placing a graphic is like importing a text file. Again, the script displays a dialog box that you can use to select the graphic to place. When we place the graphic, InDesign returns a reference to the graphic itself, rather than to the frame containing the graphic. To get a reference to the frame, use the parent property of the graphic. Once we have that reference, we can apply an object style to the frame.</p>
<p><b>AppleScript</b></p>
<div class="fragment"><div class="line">    --Display a standard open file dialog box to select a graphic file.</div>
<div class="line">    <span class="keyword">set</span> myGraphicFile to choose file <span class="stringliteral">&quot;Choose graphic file.&quot;</span></div>
<div class="line">    --If a graphic file was selected, and <span class="keywordflow">if</span> you didn<span class="stringliteral">&#39;t press Cancel, </span></div>
<div class="line"><span class="stringliteral">    --place the graphic file on the page.</span></div>
<div class="line"><span class="stringliteral">    if myGraphicFile is not &quot;&quot; then</span></div>
<div class="line"><span class="stringliteral">        set myGraphic to place myGraphicFile on page 1 of myDocument</span></div>
<div class="line"><span class="stringliteral">        --Since you can place multiple graphics at once, the place method</span></div>
<div class="line"><span class="stringliteral">        --returns an array. To get the graphic you placed, get the first</span></div>
<div class="line"><span class="stringliteral">        --item in the array.</span></div>
<div class="line"><span class="stringliteral">        set myGraphic to item 1 of myGraphic</span></div>
<div class="line"><span class="stringliteral">        --Create an object style to apply to the graphic frame.</span></div>
<div class="line"><span class="stringliteral">        try</span></div>
<div class="line"><span class="stringliteral">            set myObjectStyle to object style &quot;GraphicFrame&quot; of myDocument</span></div>
<div class="line"><span class="stringliteral">        on error</span></div>
<div class="line"><span class="stringliteral">            --The object style did not exist, so create it.</span></div>
<div class="line"><span class="stringliteral">            tell myDocument</span></div>
<div class="line"><span class="stringliteral">                set myObjectStyle to make object style with properties {name:&quot;GraphicFrame&quot;}</span></div>
<div class="line"><span class="stringliteral">            end tell</span></div>
<div class="line"><span class="stringliteral">        end try</span></div>
<div class="line"><span class="stringliteral">        set enable stroke of myObjectStyle to true</span></div>
<div class="line"><span class="stringliteral">        set stroke weight of myObjectStyle to 3</span></div>
<div class="line"><span class="stringliteral">        set stroke type of myObjectStyle to stroke style &quot;Solid&quot; of myDocument</span></div>
<div class="line"><span class="stringliteral">        set stroke color of myObjectStyle to color &quot;Red&quot; of myDocument</span></div>
<div class="line"><span class="stringliteral">        --The frame containing the graphic is the parent of the graphic.</span></div>
<div class="line"><span class="stringliteral">        set myFrame to parent of myGraphic</span></div>
<div class="line"><span class="stringliteral">        tell myFrame to apply object style using myObjectStyle</span></div>
<div class="line"><span class="stringliteral">        --Resize the frame to a specific size.</span></div>
<div class="line"><span class="stringliteral">        set geometric bounds of myFrame to {0, 0, 144, 144}</span></div>
<div class="line"><span class="stringliteral">        --Fit the graphic to the frame proportionally.</span></div>
<div class="line"><span class="stringliteral">        fit myFrame given proportionally</span></div>
<div class="line"><span class="stringliteral">        --Next, fit frame to the resized graphic.</span></div>
<div class="line"><span class="stringliteral">        fit myFrame given frame to content</span></div>
<div class="line"><span class="stringliteral">        set myBounds to geometric bounds of myFrame</span></div>
<div class="line"><span class="stringliteral">        set myGraphicWidth to (item 4 of myBounds) - (item 2 of myBounds)</span></div>
<div class="line"><span class="stringliteral">        --Move the graphic frame.</span></div>
<div class="line"><span class="stringliteral">        set myPageWidth to page width of document preferences of myDocument</span></div>
<div class="line"><span class="stringliteral">        set myMarginPreferences to margin preferences of page 1 of myDocument</span></div>
<div class="line"><span class="stringliteral">        set myTopMargin to top of myMarginPreferences</span></div>
<div class="line"><span class="stringliteral">        move myFrame to {myPageWidth - myGraphicWidth, myTopMargin}</span></div>
<div class="line"><span class="stringliteral">        --Apply a text wrap to the graphic frame.</span></div>
<div class="line"><span class="stringliteral">        set text wrap mode of text wrap preferences of myFrame to bounding box text wrap</span></div>
<div class="line"><span class="stringliteral">        set text wrap offset of text wrap preferences of myFrame to {24, 12, 24, 12}</span></div>
<div class="line"><span class="stringliteral">    end if</span></div>
<div class="line"><span class="stringliteral">end tell</span></div>
</div><!-- fragment --><p> <b>JavaScript</b></p>
<div class="fragment"><div class="line"><span class="comment">//Display a standard open file dialog box to select a graphic file.</span></div>
<div class="line">var myGraphicFile = File.openDialog(<span class="stringliteral">&quot;Choose a graphic file&quot;</span>);</div>
<div class="line"><span class="comment">//If a graphic file was selected, and if you didn&#39;t press Cancel, </span></div>
<div class="line"><span class="comment">//place the graphic file on the page.</span></div>
<div class="line"><span class="keywordflow">if</span>((myGraphicFile != <span class="stringliteral">&quot;&quot;</span>)&amp;&amp;(myGraphicFile != null)){</div>
<div class="line">    var myGraphic = myDocument.pages.item(0).place(myGraphicFile);</div>
<div class="line">    <span class="comment">//Since you can place multiple graphics at once, the place method</span></div>
<div class="line">    <span class="comment">//returns an array. To get the graphic you placed, get the first</span></div>
<div class="line">    <span class="comment">//item in the array (JavaScript arrays start with item 0).</span></div>
<div class="line">    myGraphic = myGraphic[0];</div>
<div class="line">    <span class="comment">//Create an object style to apply to the graphic frame.</span></div>
<div class="line">    var myObjectStyle = myDocument.objectStyles.item(<span class="stringliteral">&quot;GraphicFrame&quot;</span>);</div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line">        var myName = myObjectStyle.name;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span> (myError){</div>
<div class="line">        <span class="comment">//The object style did not exist, so create it.</span></div>
<div class="line">        myObjectStyle = myDocument.objectStyles.add({name:<span class="stringliteral">&quot;GraphicFrame&quot;</span>});</div>
<div class="line">    }</div>
<div class="line">    myObjectStyle.enableStroke = <span class="keyword">true</span>;</div>
<div class="line">    myObjectStyle.strokeWeight = 3;</div>
<div class="line">    myObjectStyle.strokeType = myDocument.strokeStyles.item(<span class="stringliteral">&quot;Solid&quot;</span>);</div>
<div class="line">    myObjectStyle.strokeColor = myDocument.colors.item(<span class="stringliteral">&quot;Red&quot;</span>);</div>
<div class="line">    <span class="comment">//The frame containing the graphic is the parent of the graphic.</span></div>
<div class="line">    var myFrame = myGraphic.parent;</div>
<div class="line">    myFrame.applyObjectStyle(myObjectStyle, <span class="keyword">true</span>);</div>
<div class="line">    <span class="comment">//Resize the frame to a specific size.</span></div>
<div class="line">    myFrame.geometricBounds = [0,0,144,144];</div>
<div class="line">    <span class="comment">//Fit the graphic to the frame proportionally.</span></div>
<div class="line">    myFrame.fit(FitOptions.proportionally);</div>
<div class="line">    <span class="comment">//Next, fit frame to the resized graphic.</span></div>
<div class="line">    myFrame.fit(FitOptions.frameToContent);</div>
<div class="line">    var myBounds = myFrame.geometricBounds;</div>
<div class="line">    var myGraphicWidth = myBounds[3]-myBounds[1];</div>
<div class="line">    <span class="comment">//Move the graphic frame.</span></div>
<div class="line">    var myPageWidth = myDocument.documentPreferences.pageWidth;</div>
<div class="line">    var myTopMargin = myDocument.pages.item(0).marginPreferences.top;</div>
<div class="line">    myFrame.move([myPageWidth-myGraphicWidth, myTopMargin]);</div>
<div class="line">    <span class="comment">//Apply a text wrap to the graphic frame.</span></div>
<div class="line">    myFrame.textWrapPreferences.textWrapMode = TextWrapModes.BOUNDING_BOX_TEXT_WRAP;</div>
<div class="line">    myFrame.textWrapPreferences.textWrapOffset = [24, 12, 24, 12];</div>
<div class="line">}</div>
</div><!-- fragment --><p> <b>VBScript</b></p>
<div class="fragment"><div class="line">Rem create an <span class="keywordtype">object</span> style</div>
<div class="line">On Error Resume Next</div>
<div class="line">Set myObjectStyle = myDocument.ObjectStyles.Item(<span class="stringliteral">&quot;GraphicFrame&quot;</span>)</div>
<div class="line">If Error.Number &lt;&gt; 0 Then</div>
<div class="line">    Set myObjectStyle = myDocument.ObjectStyles.Add</div>
<div class="line">    myObjectStyle.Name = <span class="stringliteral">&quot;GraphicFrame&quot;</span></div>
<div class="line">    Error.Clear</div>
<div class="line">End If</div>
<div class="line">On Error GoTo 0</div>
<div class="line">myObjectStyle.EnableStroke = True</div>
<div class="line">myObjectStyle.StrokeWeight = 3</div>
<div class="line">myObjectStyle.StrokeType = myDocument.StrokeStyles.Item(<span class="stringliteral">&quot;Solid&quot;</span>)</div>
<div class="line">myObjectStyle.StrokeColor = myDocument.Colors.Item(<span class="stringliteral">&quot;Red&quot;</span>)</div>
<div class="line">Rem Again, we<span class="stringliteral">&#39;ll use a JavaScript to get a file name.</span></div>
<div class="line"><span class="stringliteral">Rem Disable normal error handling.</span></div>
<div class="line"><span class="stringliteral">On Error Resume Next</span></div>
<div class="line"><span class="stringliteral">Rem Create a JavaScript as a string.</span></div>
<div class="line"><span class="stringliteral">myJavaScriptString = &quot;var myTextFile = File.openDialog(&quot;&quot;Choose a graphic file&quot;&quot;);myTextFile.fsName;&quot;</span></div>
<div class="line"><span class="stringliteral">Rem Run the JavaScript using DoScript.</span></div>
<div class="line"><span class="stringliteral">myGraphicFileName = myInDesign.DoScript(myJavaScriptString, idScriptLanguage.idJavascript)</span></div>
<div class="line"><span class="stringliteral">If Error.Number = 0 Then</span></div>
<div class="line"><span class="stringliteral">    On Error GoTo 0</span></div>
<div class="line"><span class="stringliteral">    Set myGraphic = myDocument.Pages.Item(1).Place(myGraphicFileName)</span></div>
<div class="line"><span class="stringliteral">    Rem Since you can place multiple graphics at once, the place method</span></div>
<div class="line"><span class="stringliteral">    Rem returns an object collection. To get the graphic you placed, get the first</span></div>
<div class="line"><span class="stringliteral">    Rem item in the collection.</span></div>
<div class="line"><span class="stringliteral">    Set myGraphic = myGraphic.Item(1)</span></div>
<div class="line"><span class="stringliteral">    Rem Create an object style to apply to the graphic frame.</span></div>
<div class="line"><span class="stringliteral">    Rem The frame containing the graphic is the parent of the graphic.</span></div>
<div class="line"><span class="stringliteral">    Set myFrame = myGraphic.Parent</span></div>
<div class="line"><span class="stringliteral">    myFrame.ApplyObjectStyle myObjectStyle, True</span></div>
<div class="line"><span class="stringliteral">    Rem Resize the frame to a specific size.</span></div>
<div class="line"><span class="stringliteral">    myFrame.GeometricBounds = Array(0, 0, 144, 144)</span></div>
<div class="line"><span class="stringliteral">    Rem Fit the graphic to the frame proportionally.</span></div>
<div class="line"><span class="stringliteral">    myFrame.Fit idFitOptions.idProportionally</span></div>
<div class="line"><span class="stringliteral">    Rem Next, fit frame to the resized graphic.</span></div>
<div class="line"><span class="stringliteral">    myFrame.Fit idFitOptions.idFrameToContent</span></div>
<div class="line"><span class="stringliteral">    myBounds = myFrame.GeometricBounds</span></div>
<div class="line"><span class="stringliteral">    myGraphicWidth = myBounds(3) - myBounds(1)</span></div>
<div class="line"><span class="stringliteral">    Rem Move the graphic frame.</span></div>
<div class="line"><span class="stringliteral">    myPageWidth = myDocument.DocumentPreferences.PageWidth</span></div>
<div class="line"><span class="stringliteral">    myTopMargin = myDocument.Pages.Item(1).MarginPreferences.Top</span></div>
<div class="line"><span class="stringliteral">    myFrame.Move Array(myPageWidth - myGraphicWidth, myTopMargin)</span></div>
<div class="line"><span class="stringliteral">    Rem Apply a text wrap to the graphic frame.</span></div>
<div class="line"><span class="stringliteral">    myFrame.TextWrapPreferences.TextWrapMode = idTextWrapModes.idBoundingBoxTextWrap</span></div>
<div class="line"><span class="stringliteral">    myFrame.TextWrapPreferences.TextWrapOffset = Array(24, 12, 24, 12)</span></div>
<div class="line"><span class="stringliteral">End If</span></div>
</div><!-- fragment --> <h2><a class="anchor" id="id_beyond_the_basics"></a>
Beyond the basics</h2>
<p>At this point, you know how to create a document, set up master page items, enter text, import text, create and apply paragraph styles, create and apply object styles, import graphics, fit graphics to frames, and apply a text wrap. While the document we created is not likely to win any design awards, you have learned the basics of InDesign scripting. In each example, we created objects, set object properties, and used object methods.</p>
<p>For your next step in learning about InDesign scripting, see the Adobe InDesign Scripting Guide. It offers more advanced tutorials on constructing documents, formatting text, finding and changing text, building user interfaces, adding menu items, and working with XML and XML rules.</p>
<p>For more information on InDesign scripting, you also can visit the InDesign Scripting User to User forum, at <a href="http://www.adobeforums.com">http://www.adobeforums.com </a>. In the forum, scripters can ask questions, post answers, and share their newest scripts. The forum contains hundreds of sample scripts. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sun Mar 3 2024 02:53:06 for InDesign Scripting SDK by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.3.1 </li>
  </ul>
</div>
</body>
</html>
