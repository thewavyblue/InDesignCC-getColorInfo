<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>InDesign Scripting SDK: JavaScript Guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="adobe_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">InDesign Scripting SDK
   &#160;<span id="projectnumber">19.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('id_js_adobe_indesign_cc_scripting_guide_javascript.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">JavaScript Guide </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="id_js_introduction"></a>
Introduction</h1>
<p>This document shows how to do the following:</p>
<ul>
<li>Work with the InDesign scripting environment.</li>
<li>Use advanced scripting features.</li>
<li>Perform basic document tasks like setting up master spreads, printing, and exporting.</li>
<li>Work with page items (rectangles, ellipses, graphic lines, polygons, text frames, and groups).</li>
<li>Work with text and type in an InDesign document, including finding and changing text.</li>
<li>Create dialog boxes and other user-interface items.</li>
<li>Customize and add menus and create menu actions.</li>
<li>Respond to user-interface events.</li>
<li>Work with XML, from creating XML elements and importing XML to adding XML elements to a layout.</li>
<li>Apply XML rules, a new scripting feature that makes working with XML in InDesign faster and easier.</li>
</ul>
<p>We assume that you have already read the Adobe InDesign Scripting Tutorial and know how to create, install, and run scripts. If you need to know how to connect with your scripting environment or view the InDesign scripting object model from your script editor, that information can be found in the Adobe InDesign Scripting Tutorial.</p>
<h2><a class="anchor" id="id_js_how_to_use_the_scripts_in_this_document"></a>
How to Use the Scripts in this Document</h2>
<p>For the most part, the scripts shown in this document are not complete scripts. They are only fragments of scripts, and are intended to show only the specific part of a script relevant to the point being discussed in the text. You can copy the script lines shown in this document and paste them into your script editor, but you should not expect them to run without further editing. Note, in addition, that scripts copied out of this document may contain line breaks and other characters (due to the document layout) that will prevent them from executing properly.</p>
<p>All of the scripts shown in this document are available in the scripts folder. Move the folders corresponding to the scripting language(s) of your choice into the Scripts Panel folder inside the Scripts folder in your InDesign folder. At that point, you can run the scripts from the Scripts panel inside InDesign.</p>
<h2><a class="anchor" id="id_js_about_the_structure_of_the_scripts"></a>
About the Structure of the Scripts</h2>
<p>The script examples are all written using a common template that includes the functions "main," "mySetup," "mySnippet," and "myTeardown." We did this to simplify automated testing and publication-there is no reason for you to construct your scripts this way. Most of the time, the part of the script you will be interested in will be inside the "mySnippet" function.</p>
<h2><a class="anchor" id="id_js_automatic_jsxbin_conversion"></a>
Automatic jsxbin Conversion</h2>
<p>The jsxbin format (Binary JavaScript) enables distributing a script without exposing its source code. The ExtendScript ToolKit offers an Export to Binary feature that instantly converts a js(x) file into jsxbin. The jsxbin export process can be done automatically without user interaction.</p>
<p>To do this:</p>
<ol type="1">
<li>Write a compiler script file that compiles .jsx files into a .jsxbin file.<ul>
<li>The script file must start with this target directive: <div class="fragment"><div class="line"><span class="preprocessor">#target estoolkit</span></div>
<div class="line"><span class="preprocessor">#dbg</span></div>
</div><!-- fragment --></li>
<li>Use the app.compile() method and pass the content of the script file as a String parameter.</li>
<li>In the script, store the result in a new file with the extension .jsxbin.</li>
</ul>
</li>
<li><p class="startli">Launch the ExtendScript ToolKit with the command-line parameter -cmd [path to compiler script file]:</p>
<p class="startli">Windows: </p>
<div class="fragment"><div class="line"><span class="stringliteral">&quot;ExtendScript Toolkit.exe&quot;</span> -cmd compiler.jsx</div>
</div><!-- fragment --><p> Mac: </p>
<div class="fragment"><div class="line"><span class="stringliteral">&quot;ExtendScript Toolkit.app/Contents/MacOS/ExtendScript Toolkit&quot;</span> \                -cmd compiler.jsx</div>
</div><!-- fragment --></li>
</ol>
<p>Here is a sample compiler script with the source script's file path hardcoded. </p>
<div class="fragment"><div class="line"><span class="preprocessor">#target estoolkit</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#dbgvar fileIn = File(&quot;/c/jsxbin_test/source.jsx&quot;);</span></div>
<div class="line"><span class="preprocessor"></span>fileIn.open(<span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line">var s = fileIn.read();</div>
<div class="line">fileIn.close();</div>
<div class="line">var t = app.compile(s);</div>
<div class="line">var fileOut = File( fileIn.absoluteURI + <span class="stringliteral">&quot;bin&quot;</span> ) ;</div>
<div class="line">fileOut.open(<span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line">fileOut.write(t);</div>
<div class="line">fileOut.close();</div>
</div><!-- fragment --><h2><a class="anchor" id="id_js_other_javascript_development_options"></a>
Other JavaScript development options</h2>
<p>You can use the ExtendScript Toolkit to create JavaScript scripts explicitly for InDesign, or you can develop HTML extensions that can potentially work in a variety of Adobe applications.</p>
<p>Applications have an extensibility infrastructure called CEP that allows developers to extend the capabilities of the applications by creating HTML extensions that run in an embedded version of Google Chrome (called CEF).</p>
<p>An example of an extension that ships with the InDesign (and other applications) is Adobe Kuler. Kuler has a consistent user interface across different Adobe applications, but has different logic in each, adapted to the host application.</p>
<h2><a class="anchor" id="id_js_for_more_information"></a>
For More Information</h2>
<p>For more information on InDesign scripting, you also can visit the InDesign Scripting User to User forum, at <a href="http://www.adobeforums.com">http://www.adobeforums.com </a>. In the forum, script writers can ask questions, post answers, and share their newest scripts. The forum contains hundreds of sample scripts.</p>
<h1><a class="anchor" id="id_js_scripting_features"></a>
Scripting Features</h1>
<p>This section covers scripting techniques related to InDesign's scripting environment. Almost every other object in the InDesign scripting model controls a feature that can change a document or the application defaults. By contrast, the features in this section control how scripts operate.</p>
<p>This document discusses the following:</p>
<ul>
<li>The scriptPreferences object and its properties.</li>
<li>Getting a reference to the executing script.</li>
<li>Running scripts in prior versions of the scripting object model.</li>
<li>Using the doScript method to run scripts.</li>
<li>Working with script labels.</li>
<li>Running scripts at InDesign start-up.</li>
<li>Controlling the ExtendScript engine in which scripts execute.</li>
</ul>
<p>We assume that you have already read Adobe InDesign Scripting Tutorial and know how to write, install, and run InDesign scripts in the scripting language of your choice.</p>
<h2><a class="anchor" id="id_js_script_preferences"></a>
Script Preferences</h2>
<p>The scriptPreferences object provides objects and properties related to the way InDesign runs scripts. The following table provides more detail on each property of the scriptPreferences object:</p>
<table class="doxtable">
<tr>
<th>Property </th><th>Description </th></tr>
<tr>
<td>enableRedraw </td><td>Turns screen redraw on or off while a script is running from the Scripts panel. </td></tr>
<tr>
<td>scriptsFolder </td><td>The path to the scripts folder. </td></tr>
<tr>
<td>scriptsList </td><td>A list of the available scripts. This property is an array of arrays, in the following form: [[fileName,filePath], ...] where fileName is the name of the script file and filePath is the full path to the script. You can use this feature to check for the existence of a script in the installed set of scripts. </td></tr>
<tr>
<td>userInteractionLevel </td><td>This property controls the alerts and dialogs InDesign presents to the user. When you set this property to UserInteractionLevels.neverInteract , InDesign does not display any alerts or dialogs. Set it to UserInteractionLevels.interactWithAlerts to enable alerts but disable dialogs. Set it to interactWithAll to restore the normal display of alerts and dialogs. The ability to turn off alert displays is very useful when you are opening documents via script; often, InDesign displays an alert for missing fonts or linked graphics files. To avoid this alert, set the user-interaction level to UserInteractionLevels.neverInteract before opening the document, then restore user interaction (set the property to interactWithAll) before completing script execution. </td></tr>
<tr>
<td>version </td><td>The version of the scripting environment in use. For more information, see <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_script_versioning">Script Versioning</a>. Note this property is not the same as the version of the application. </td></tr>
</table>
<h2><a class="anchor" id="id_js_getting_the_current_script"></a>
Getting the Current Script</h2>
<p>You can get a reference to the current script using the activeScript property of the application object. You can use this property to help you locate files and folders relative to the script, as shown in the following example (from the ActiveScript tutorial script): </p>
<div class="fragment"><div class="line">    var myScript = app.activeScript;</div>
<div class="line">    alert(<span class="stringliteral">&quot;The current script is: &quot;</span> + myScript);</div>
<div class="line">    var myParentFolder = File(myScript).parent;</div>
<div class="line">    alert(<span class="stringliteral">&quot;The folder containing the active script is: &quot;</span> + myParentFolder);</div>
</div><!-- fragment --><p> When you debug scripts using a script editor, the activeScript property returns an error. Only scripts run from the Scripts palette appear in the activeScript property.</p>
<p>When you debug scripts from the ExtendScript Toolkit, using the activeScript property returns an error. To avoid this error and create a way of debugging scripts that use the activeScript property, use the following error handler (from the GetScriptPath tutorial script):</p>
<div class="fragment"><div class="line"><span class="keyword">function</span> myGetScriptPath() {</div>
<div class="line">    <span class="keywordflow">try</span>{</div>
<div class="line">        <span class="keywordflow">return</span> app.activeScript;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span>(myError){</div>
<div class="line">        <span class="keywordflow">return</span> File(myError.fileName);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="id_js_script_versioning"></a>
Script Versioning</h2>
<p>InDesign can run scripts using earlier versions of the InDesign scripting object model. To run an older script in a newer version of InDesign, you must consider the following:</p>
<ul>
<li><b>Targeting</b> - Scripts must be targeted to the version of InDesign in which they are being run (i.e., the current version). The mechanics of targeting are language specific as described in <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_targeting">Targeting</a>.</li>
<li><b>Compilation</b> - This involves mapping the names in the script to the underlying script IDs, which are what InDesign understands. The mechanics of compilation are language specific as described in <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_compilation">Compilation</a>.</li>
<li><b>Interpretation</b> - This involves matching the IDs to the appropriate request handler within InDesign so that InDesign correctly interprets a script written for an earlier version of the scripting object model. To do this, either explicitly set the application's script preferences to the old object model within the script (as shown in <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_interpretation">Interpretation</a>) or run the script from a folder in the Scripts panel folder as follows:</li>
</ul>
<table class="doxtable">
<tr>
<th>Folder </th><th>For InDesign version of scripts </th></tr>
<tr>
<td>Version 19.0 Scripts </td><td>2024 </td></tr>
<tr>
<td>Version 18.0 Scripts </td><td>2023 </td></tr>
<tr>
<td>Version 17.0 Scripts </td><td>2022 </td></tr>
<tr>
<td>Version 16.0 Scripts </td><td>2021 </td></tr>
<tr>
<td>Version 15.0 Scripts </td><td>2020 </td></tr>
<tr>
<td>Version 14.0 Scripts </td><td>CC 2019 </td></tr>
<tr>
<td>Version 13.0 Scripts </td><td>CC 2018 </td></tr>
<tr>
<td>Version 12.0 Scripts </td><td>CC 2017 </td></tr>
<tr>
<td>Version 11.0 Scripts </td><td>CC 2015 </td></tr>
<tr>
<td>Version 10.0 Scripts </td><td>CC 2014 </td></tr>
<tr>
<td>Version 9.0 Scripts </td><td>CC </td></tr>
<tr>
<td>Version 8.0 Scripts </td><td>CS6 </td></tr>
<tr>
<td>Version 7.0 Scripts </td><td>CS5 and CS5.5 </td></tr>
<tr>
<td>Version 6.0 Scripts </td><td>CS4 </td></tr>
<tr>
<td>Version 5.0 Scripts </td><td>CS3 </td></tr>
<tr>
<td>Version 2.0 Scripts </td><td>CS2 </td></tr>
</table>
<h3><a class="anchor" id="id_js_targeting"></a>
Targeting</h3>
<p>A script must always target the version of InDesign under which it is running (the current version), either explicitly or implicitly. Targeting is implicit when the script is launched from the Scripts panel.</p>
<p>Otherwise, if the script is launched externally (from the ESTK), explicit targeting for JavaScripts is done using the target directive:</p>
<div class="fragment"><div class="line"><span class="comment">//target CC</span></div>
<div class="line"><span class="preprocessor">#target &quot;InDesign-13.0&quot;</span></div>
<div class="line"><span class="preprocessor"></span><span class="comment">//target the latest version of InDesign</span></div>
<div class="line"><span class="preprocessor">#target &quot;InDesign&quot; </span></div>
</div><!-- fragment --><h3><a class="anchor" id="id_js_compilation"></a>
Compilation</h3>
<p>JavaScripts are not precompiled. For compilation, InDesign uses the same version of the DOM that is set for interpretation.</p>
<h3><a class="anchor" id="id_js_interpretation"></a>
Interpretation</h3>
<p>The InDesign application object contains a scriptPreferences object, which allows a script to get/set the version of the scripting object model to use for interpreting scripts. The version defaults to the current version of the application and persists.</p>
<p>For example, to change the version of the scripting object model to CC 2017 (12.0): </p>
<div class="fragment"><div class="line"><span class="comment">//Set to 12.0 scripting object model</span></div>
<div class="line">app.scriptPreferences.version = 12.0;</div>
</div><!-- fragment --><h2><a class="anchor" id="id_js_using_the_doscript_method"></a>
Using the doScript Method</h2>
<p>The doScript method gives a script a way to execute another script. The script can be a string of valid scripting code or a file on disk. The script can be in the same scripting language as the current script or another scripting language. The available languages vary by platform: on Mac, you can run AppleScript or JavaScript; on Windows, VBScript or JavaScript.</p>
<p>The doScript method has many possible uses:</p>
<ul>
<li>Running a script in another language that provides a feature missing in your main scripting language. For example, VBScript lacks the ability to display a file or folder browser, which JavaScript has. AppleScript can be very slow to compute trigonometric functions (sine and cosine), but JavaScript performs these calculations rapidly. JavaScript does not have a way to query Microsoft&reg; Excel for the contents of a specific spreadsheet cell, but both AppleScript and VBScript have this capability. In all these examples, the doScript method can execute a snippet of scripting code in another language, to overcome a limitation of the language used for the body of the script.</li>
<li>Creating a script - "on the fly." Your script can create a script (as a string) during its execution, which it can then execute using the doScript method. This is a great way to create a custom dialog or panel based on the contents of the selection or the attributes of objects the script creates.</li>
<li>Embedding scripts in objects. Scripts can use the doScript method to run scripts that were saved as strings in the label property of objects. Using this technique, an object can contain a script that controls its layout properties or updates its content according to certain parameters. Scripts also can be embedded in XML elements as an attribute of the element or as the contents of an element. See <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_running_scripts_at_startup">Running Scripts at Startup</a>.</li>
</ul>
<h3><a class="anchor" id="id_js_sending_parameters_to_doscript"></a>
Sending parameters to doScript</h3>
<p>To send a parameter to a script executed by doScript, use the following form (from the DoScriptParameters tutorial script): </p>
<div class="fragment"><div class="line">    var myParameters = [<span class="stringliteral">&quot;Hello from DoScript&quot;</span>, <span class="stringliteral">&quot;Your message here.&quot;</span>];</div>
<div class="line">    var myJavaScript = <span class="stringliteral">&quot;alert(\&quot;First argument: \&quot; + arguments[0] + \&quot;\\rSecond argument: \&quot; + arguments[1]);&quot;</span>;</div>
<div class="line">    app.doScript(myJavaScript, ScriptLanguage.javascript, myParameters);</div>
<div class="line">    <span class="keywordflow">if</span>(File.fs == <span class="stringliteral">&quot;Windows&quot;</span>){</div>
<div class="line">        var myVBScript = <span class="stringliteral">&quot;msgbox arguments(1), vbOKOnly, \&quot;First argument: \&quot; &amp; arguments(0)&quot;</span>;</div>
<div class="line">        app.doScript(myVBScript, ScriptLanguage.visualBasic, myParameters);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span>{</div>
<div class="line">        var myAppleScript = <span class="stringliteral">&quot;tell application \&quot;Adobe InDesign CC 2018\\rdisplay dialog(\&quot;First argument\&quot; &amp; item 1 of arguments &amp; return &amp; \&quot;Second argument: \&quot; &amp; item 2 of arguments &amp; return &amp; end tell&quot;</span>;</div>
<div class="line">        app.doScript(myAppleScript, ScriptLanguage.applescriptLanguage, myParameters);</div>
<div class="line">    }</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_returning_values_from_doscript"></a>
Returning values from doScript</h3>
<p>The following script fragment shows how to return a value from a script executed by doScript. This example uses a JavaScript that is executed as a string, but the same method works for script files. This example returns a single value, but you can return multiple values by returning an array (for the complete script, refer to the DoScriptReturnValues script). </p>
<div class="fragment"><div class="line"><span class="comment">//To send parameters to a script run using app.doScript(), the doScript </span></div>
<div class="line"><span class="comment">//statement must not appear inside a function. If it does, the parameters </span></div>
<div class="line"><span class="comment">//will not be passed to the script (unless the function takes the same</span></div>
<div class="line"><span class="comment">//parameters as the doScript call).</span></div>
<div class="line">var myDocument = app.documents.add();</div>
<div class="line">var myPage = myDocument.pages.item(0);</div>
<div class="line">var myTextFrame = myPage.textFrames.add();</div>
<div class="line">myTextFrame.geometricBounds = [<span class="stringliteral">&quot;72pt&quot;</span>, <span class="stringliteral">&quot;72pt&quot;</span>, <span class="stringliteral">&quot;288pt&quot;</span>, <span class="stringliteral">&quot;288pt&quot;</span>];</div>
<div class="line">myTextFrame.contents = <span class="stringliteral">&quot;Example text frame.&quot;</span>;</div>
<div class="line">var myDestinationPage = myDocument.pages.add(LocationOptions.after, myPage);</div>
<div class="line">var myPageIndex = myDestinationPage.name;</div>
<div class="line">var myID = myTextFrame.id;</div>
<div class="line">var myJavaScript = <span class="stringliteral">&quot;var myDestinationPage = arguments[1];\r&quot;</span> ;</div>
<div class="line">myJavaScript += <span class="stringliteral">&quot;myID = arguments[0];\r&quot;</span>; </div>
<div class="line">myJavaScript += <span class="stringliteral">&quot;var myX = arguments[2];\r&quot;</span>;</div>
<div class="line">myJavaScript += <span class="stringliteral">&quot;var myY = arguments[3]\r;&quot;</span></div>
<div class="line">myJavaScript += <span class="stringliteral">&quot;var myPageItem = app.documents.item(0).pages.item(0).pageItems.itemByID(myID);\r&quot;</span>;</div>
<div class="line">myJavaScript += <span class="stringliteral">&quot;myPageItem.duplicate(app.documents.item(0).pages.item(myDestinationPage));\r&quot;</span></div>
<div class="line"><span class="comment">//Create an array for the parameters we want to pass to the JavaScript.</span></div>
<div class="line">var myArguments = [myID, myPageIndex, 0, 0];</div>
<div class="line">var myDuplicate = app.doScript(myJavaScript, ScriptLanguage.javascript, myArguments);</div>
<div class="line"><span class="comment">//myDuplicate now contains a reference to the duplicated text frame.</span></div>
<div class="line"><span class="comment">//Change the text in the duplicated text frame.</span></div>
<div class="line">myDuplicate.contents = <span class="stringliteral">&quot;Duplicated text frame.&quot;</span>;</div>
</div><!-- fragment --><p> Another way to get values from another script is to use the scriptArgs (short for "script arguments") object of the application. The following script fragment shows how to do this (for the complete script, see DoScriptScriptArgs): </p>
<div class="fragment"><div class="line">    var nameA = <span class="stringliteral">&quot;ScriptArgumentA&quot;</span>;</div>
<div class="line">    var nameB = <span class="stringliteral">&quot;ScriptArgumentB&quot;</span>;</div>
<div class="line">    var nAc = nameA + <span class="stringliteral">&quot;: &quot;</span>;</div>
<div class="line">    var nBc = nameB + <span class="stringliteral">&quot;: &quot;</span>;</div>
<div class="line">    <span class="comment">//Create a string to be run as a JavaScript.</span></div>
<div class="line">    var p1 = <span class="stringliteral">&quot;app.scriptArgs.setValue(\&quot;&quot;</span> + nameA + <span class="stringliteral">&quot;\&quot;, &quot;</span>;</div>
<div class="line">    var p2 = <span class="stringliteral">&quot;\&quot;This is the first script argument value.\&quot;);\r&quot;</span>;</div>
<div class="line">    var p3 = <span class="stringliteral">&quot;app.scriptArgs.setValue(\&quot;&quot;</span> + nameB + <span class="stringliteral">&quot;\&quot;, &quot;</span>;</div>
<div class="line">    var p4 = <span class="stringliteral">&quot;\&quot;This is the second script argument value.\&quot;)&quot;</span>;</div>
<div class="line">    var p5, p6; <span class="comment">//Used later.</span></div>
<div class="line">    var myJavaScript = p1 + p2 + p3 + p4;</div>
<div class="line">    var myScriptArgumentA = app.scriptArgs.getValue(nameA);</div>
<div class="line">    var myScriptArgumentB = app.scriptArgs.getValue(nameB);</div>
<div class="line">    alert(nameA + <span class="stringliteral">&quot;: &quot;</span> + myScriptArgumentA + <span class="stringliteral">&quot;\r&quot;</span> + nameB + <span class="stringliteral">&quot;: &quot;</span> + myScriptArgumentB);</div>
<div class="line">    <span class="keywordflow">if</span>(File.fs == <span class="stringliteral">&quot;Windows&quot;</span>) {</div>
<div class="line">        <span class="comment">//Create a string to be run as a VBScript.</span></div>
<div class="line">        p1 = <span class="stringliteral">&quot;Set myInDesign = CreateObject(\&quot;InDesign.Application.CC.2018\&quot;)\r&quot;</span>;</div>
<div class="line">        p2 = <span class="stringliteral">&quot;myInDesign.ScriptArgs.SetValue \&quot;&quot;</span> + nameA + <span class="stringliteral">&quot;\&quot;, &quot;</span>;</div>
<div class="line">        p3 = <span class="stringliteral">&quot;\&quot;This is the first script argument value.\&quot;\r&quot;</span>;</div>
<div class="line">        p4 = <span class="stringliteral">&quot;myInDesign.ScriptArgs.SetValue \&quot;&quot;</span> + nameB + <span class="stringliteral">&quot;\&quot;, &quot;</span>;</div>
<div class="line">        p5 = <span class="stringliteral">&quot;\&quot;This is the second script argument value.\&quot;&quot;</span>;</div>
<div class="line">        var myVBScript = p1 + p2 + p3 + p4 + p5; </div>
<div class="line">        app.doScript(myVBScript, ScriptLanguage.visualBasic);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="comment">//Create a string to be run as a AppleScript.</span></div>
<div class="line">        p1 = <span class="stringliteral">&quot;tell application \&quot;Adobe InDesign CC 2018\&quot;\r&quot;</span>;</div>
<div class="line">        p2 = <span class="stringliteral">&quot;tell script args&quot;</span> +<span class="stringliteral">&quot;\r&quot;</span>;</div>
<div class="line">        p3 = <span class="stringliteral">&quot;set value name\&quot;&quot;</span> + nameA +<span class="stringliteral">&quot;\&quot; value &quot;</span>;</div>
<div class="line">        p4 = <span class="stringliteral">&quot;\&quot;This is the firest AppleScript script argument value.\&quot;&quot;</span> +<span class="stringliteral">&quot;\r&quot;</span>;</div>
<div class="line">        p5 = <span class="stringliteral">&quot;set value name\&quot;&quot;</span> + nameB +<span class="stringliteral">&quot;\&quot; value &quot;</span>;</div>
<div class="line">        p6 = <span class="stringliteral">&quot;\&quot;This is the second AppleScript script argument value.\&quot;&quot;</span> +<span class="stringliteral">&quot;\r&quot;</span>;</div>
<div class="line">        p7 = <span class="stringliteral">&quot;end tell&quot;</span> + <span class="stringliteral">&quot;\r&quot;</span></div>
<div class="line">        p8 = <span class="stringliteral">&quot;end tell&quot;</span> + <span class="stringliteral">&quot;\r&quot;</span></div>
<div class="line">        var myAppleScript = p1 + p2 + p3 + p4 + p5 + p6 + p7 + p8;</div>
<div class="line">        app.doScript(myAppleScript, ScriptLanguage.applescriptLanguage);</div>
<div class="line">    }</div>
<div class="line">    var myScriptArgumentA = app.scriptArgs.getValue(nameA);</div>
<div class="line">    var myScriptArgumentB = app.scriptArgs.getValue(nameB);</div>
<div class="line">    alert(nAc + myScriptArgumentA + nBc + myScriptArgumentB);</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_controlling_undo_with_doscript"></a>
Controlling Undo with doScript</h2>
<p>InDesign gives you the ability to undo almost every action, but this comes at a price: for almost every action you make, InDesign writes to disk. For normal work you using the tools presented by the user interface, this does not present any problem. For scripts, which can perform thousands of actions in the time a human being can blink, the constant disk access can be a serious drag on performance.</p>
<p>The doScript method offers a way around this performance bottleneck by providing two parameters that control the way that scripts are executed relative to InDesign's Undo behavior. These parameters are shown in the following examples:</p>
<div class="fragment"><div class="line"><span class="comment">//Given a script &quot;myJavaScript&quot; and an array of parameters &quot;myParameters&quot;...</span></div>
<div class="line">app.doScript(myJavaScript, ScriptLanguage.javascript, myParameters, UndoModes.fastEntireScript, <span class="stringliteral">&quot;Script Action&quot;</span>);</div>
<div class="line"></div>
<div class="line"><span class="comment">//UndoModes can be:</span></div>
<div class="line"><span class="comment">//UndoModes.autoUnto: Add no events to the Undo queue.</span></div>
<div class="line"><span class="comment">//UndoModes.entireScript: Put a single event in the Undo queue.</span></div>
<div class="line"><span class="comment">//UndoModes.fastEntireScript: Put a single event in the Undo queue.</span></div>
<div class="line"><span class="comment">//UndoModes.scriptRequest: Undo each script action as a separate event.</span></div>
<div class="line"><span class="comment">//The last parameter is the text that appears in the Undo menu item.</span></div>
</div><!-- fragment --><h2><a class="anchor" id="id_js_working_with_script_labels"></a>
Working with Script Labels</h2>
<p>Many objects in InDesign scripting have a label property, including page items (rectangles, ovals, groups, polygons, text frames, and graphic lines), table cells, documents, stories, and pages. This property can store a very large amount of text.</p>
<p>The label of page items can be viewed, entered, or edited using the Script Label panel (choose Window &gt; Utilities &gt; Script Label to display this panel), shown below. You also can add a label to an object using scripting, and you can read the script label via scripting. For many objects, like stories, pages, and paragraph styles, you cannot set or view the label using the Script Label panel. </p>
<div class="image">
<img src="InDesign_ScriptingGuide-1.gif" alt="InDesign_ScriptingGuide-1.gif"/>
</div>
<p>The label property can contain any form of text data, such as tab- or comma-delimited text, HTML, or XML. Because scripts also are text, they can be stored in the label property.</p>
<p>Page items can be referred to by their label, just like named items (such as paragraph styles, colors, or layers) can be referred to by their name. The following script fragment demonstrates this special case of the label property (for the complete script, see ScriptLabel):</p>
<div class="fragment"><div class="line">    <span class="comment">//Access the active document and page.</span></div>
<div class="line">    var myDocument = app.documents.add();</div>
<div class="line">    var myPage = myDocument.pages.item(0);</div>
<div class="line">    var myX1, myX2, myY1, myY2, myRectangle;</div>
<div class="line">    var myPageWidth = myDocument.documentPreferences.pageWidth;</div>
<div class="line">    var myPageHeight = myDocument.documentPreferences.pageHeight;</div>
<div class="line">    <span class="comment">//Create 10 random page items.</span></div>
<div class="line">    <span class="keywordflow">for</span>(var i = 0; i &lt; 10; i++)</div>
<div class="line">    {</div>
<div class="line">        myX1 = myGetRandom(0, myPageWidth, <span class="keyword">false</span>);</div>
<div class="line">        myY1 = myGetRandom(0, myPageHeight, <span class="keyword">false</span>);</div>
<div class="line">        myX2 = myGetRandom(0, myPageWidth, <span class="keyword">false</span>);</div>
<div class="line">        myY2 = myGetRandom(0, myPageHeight, <span class="keyword">false</span>);</div>
<div class="line">        myRectangle = myPage.rectangles.add({geometricBounds:[myY1, myX1, myY2, myX2]});</div>
<div class="line">        <span class="keywordflow">if</span>(myGetRandom(0, 1, <span class="keyword">true</span>))</div>
<div class="line">        {</div>
<div class="line">            myRectangle.label = <span class="stringliteral">&quot;myScriptLabel&quot;</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    var count = 0;</div>
<div class="line">    <span class="keywordflow">for</span>(var i = 0; i &lt; myPage.pageItems.length; i++)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span>(myPage.pageItems.item(i).label == <span class="stringliteral">&quot;myScriptLabel&quot;</span>)</div>
<div class="line">        {</div>
<div class="line">            count++;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    alert(<span class="stringliteral">&quot;Found &quot;</span> + count + <span class="stringliteral">&quot; page items with the label.&quot;</span>);</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">//This function gets a random number in the range myStart to myEnd.</span></div>
<div class="line"><span class="keyword">function</span> myGetRandom(myStart, myEnd, myInteger)</div>
<div class="line">{</div>
<div class="line">    var myRandom;</div>
<div class="line">    var myRange = myEnd - myStart; </div>
<div class="line">    <span class="keywordflow">if</span>(myInteger == <span class="keyword">true</span>)</div>
<div class="line">    {</div>
<div class="line">        myRandom = myStart = Math.round(Math.random());</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        myRandom = myStart + Math.floor(Math.random()*myRange);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> myRandom;</div>
<div class="line">}</div>
</div><!-- fragment --><p> In addition, all objects that support the label property also support custom labels. A script can set a custom label using the insertLabel method, and extract the custom label using the extractLabel method, as shown in the following script fragment (from the CustomLabel tutorial script):</p>
<div class="fragment"><div class="line">    var myDocument = app.documents.add();</div>
<div class="line">    myDocument.viewPreferences.horizontalMeasurementUnits = MeasurementUnits.points;</div>
<div class="line">    myDocument.viewPreferences.verticalMeasurementUnits = MeasurementUnits.points;</div>
<div class="line">    var myPage = myDocument.pages.item(0);</div>
<div class="line">    var myRectangle = myPage.rectangles.add({geometricBounds:[72, 72, 144, 144]});</div>
<div class="line">    <span class="comment">//Insert a custom label using insertLabel. The first parameter is the</span></div>
<div class="line">    <span class="comment">//name of the label, the second is the text to add to the label.</span></div>
<div class="line">    myRectangle.insertLabel(<span class="stringliteral">&quot;CustomLabel&quot;</span>, <span class="stringliteral">&quot;This is some text stored in a custom label.&quot;</span>);</div>
<div class="line">    <span class="comment">//Extract the text from the label and display it in an alert.</span></div>
<div class="line">    var myString = myRectangle.extractLabel(<span class="stringliteral">&quot;CustomLabel&quot;</span>);</div>
<div class="line">    alert(<span class="stringliteral">&quot;Custom label contained: &quot;</span> + myString);</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_running_scripts_at_startup"></a>
Running Scripts at Startup</h2>
<p>To run a script when InDesign starts, put the script in the Startup Scripts folder in the Scripts folder (for more information, see <a class="el" href="id_scripting_tutorial.html#id_installing_scripts">Installing Scripts</a> in Adobe InDesign Scripting Tutorial).</p>
<dl class="section note"><dt>Note</dt><dd>Scripts run in the session ExtendScript engine when InDesign starts can create objects and functions that will be available to other scripts for the duration of the session. For more information, see <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_session_and_main_script_execution">Session and Main Script Execution</a>.</dd></dl>
<h2><a class="anchor" id="id_js_session_and_main_script_execution"></a>
Session and Main Script Execution</h2>
<p>InDesign has two ways to run a JavaScript, session and main. These names correspond to the ExtendScript "engine" used to run the script.</p>
<p>By default, when you run an InDesign JavaScript, the script is interpreted and executed by the "main" ExtendScript engine, which is destroyed when the script completes execution. Script objects created by the script do not persist.</p>
<p>Scripts run in the session engine can create objects that persist until you close InDesign. You can refer to these objects from other scripts run in the session engine. To set the session engine as the target of an InDesign JavaScript, add the following line to the start of your script.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#targetengine &quot;session&quot;</span></div>
</div><!-- fragment --><p>You can create your own persistent ExtendScript interpretation and execution environment. To do this, use the #targetengine statement and provide your own ExtendScript engine name, as shown in the following script fragment:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#targetengine &quot;adobe&quot; </span></div>
</div><!-- fragment --><h1><a class="anchor" id="id_js_documents"></a>
Documents</h1>
<p>The work you do in InDesign revolves around documents-creating them, saving them, printing or exporting them, and populating them with page items, colors, styles, and text. Almost every document-related task can be automated using InDesign scripting.</p>
<p>We assume that you have already read Adobe InDesign Scripting Tutorial and know how to create, install, and run a script.</p>
<h2><a class="anchor" id="id_js_basic_document_operations"></a>
Basic Document Operations</h2>
<p>Opening, closing, and saving documents are some of the most basic document tasks. This section shows how to do them using scripting.</p>
<h3><a class="anchor" id="id_js_creating_a_new_document"></a>
Creating a new document</h3>
<p>The following script shows how to make a new document using scripting. (For the complete script, see MakeDocument.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Creates a new document.</span></div>
<div class="line">    var myDocument = app.documents.add();</div>
</div><!-- fragment --><p> To create a document using a document preset, the add method includes an optional parameter you can use to specify a document preset, as shown in the following script. (For the complete script, see MakeDocumentWithPreset.)</p>
<div class="fragment"><div class="line">    <span class="comment">//Creates a new document using the specified document preset.</span></div>
<div class="line">    <span class="comment">//Replace &quot;myDocumentPreset&quot; in the following line with the name</span></div>
<div class="line">    <span class="comment">//of the document preset you want to use.</span></div>
<div class="line">    var myDocumentPreset = app.documentPresets.item(<span class="stringliteral">&quot;myDocumentPreset&quot;</span>);</div>
<div class="line">    var myDocument = app.documents.add(<span class="keyword">true</span>, myDocumentPreset);</div>
</div><!-- fragment --><p> You can create a document without displaying it in a window, as shown in the following script fragment (from the MakeDocumentWithParameters tutorial script):</p>
<div class="fragment"><div class="line">    <span class="comment">//Creates a new document without showing the document window.</span></div>
<div class="line">    <span class="comment">//The parameter (showingWindow) controls the visibility of the document.</span></div>
<div class="line">    <span class="comment">//Hidden documents are not minimized, and will not appear until you add</span></div>
<div class="line">    <span class="comment">//a new window to the document.</span></div>
<div class="line">    var myDocument = app.documents.add(<span class="keyword">false</span>);</div>
<div class="line">    <span class="comment">//To show the window:</span></div>
<div class="line">    <span class="comment">//var myLayoutWindow = myDocument.windows.add();</span></div>
</div><!-- fragment --><p> Some script operations are much faster when the document window is hidden.</p>
<h3><a class="anchor" id="id_js_opening_a_document"></a>
Opening a document</h3>
<p>The following script shows how to open an existing document. (For the complete script, see OpenDocument.)</p>
<div class="fragment"><div class="line">    <span class="comment">//Opens an existing document. You&#39;ll have to fill in your own file path.</span></div>
<div class="line">    var myDocument = app.open(File(Folder.desktop + <span class="stringliteral">&quot;/OpenDocument.indd&quot;</span>));</div>
</div><!-- fragment --><p> You can choose to prevent the document from displaying (that is, hide it) by setting the showing window parameter of the open method to false (the default is true). You might want to do this to improve performance of a script. To show a hidden document, create a new window, as shown in the following script fragment (from the OpenDocumentInBackground tutorial script):</p>
<div class="fragment"><div class="line">    <span class="comment">//Opens an existing document in the background, then shows the document.</span></div>
<div class="line">    <span class="comment">//You&#39;ll have to fill in your own file path.</span></div>
<div class="line">    var myDocument = app.open(File(Folder.desktop + <span class="stringliteral">&quot;/OpenDocInBackground.indd&quot;</span>), <span class="keyword">false</span>);</div>
<div class="line">    <span class="comment">//At this point, you could do things with the document without showing the</span></div>
<div class="line">    <span class="comment">//document window. This can speed up many scripting</span></div>
<div class="line">    <span class="comment">//operations, and makes it possible for a script to operate</span></div>
<div class="line">    <span class="comment">//on a file in the background.</span></div>
<div class="line">    myAlert (<span class="stringliteral">&quot;Document is open but not visible.&quot;</span>);</div>
<div class="line">    <span class="comment">//When you want to show the hidden document, create a new window.</span></div>
<div class="line">    var myLayoutWindow = myDocument.windows.add();</div>
<div class="line">    myAlert (<span class="stringliteral">&quot;Document is now visible.&quot;</span>);</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_saving_a_document"></a>
Saving a document</h3>
<p>In the InDesign user interface, you save a file by choosing File &gt; Save, and you save a file to another file name by choosing File &gt; Save As. In InDesign scripting, the save method can do either operation, as shown in the following script fragment (from the SaveDocument tutorial script):</p>
<div class="fragment"><div class="line">    <span class="comment">//If the document has been changed since it was last saved, save it.</span></div>
<div class="line">    <span class="comment">//If the file is untitled, InDesign will display the Save dialog box.</span></div>
<div class="line">    <span class="keywordflow">if</span>(myDocument.modified == <span class="keyword">true</span>){</div>
<div class="line">        myDocument.save();</div>
<div class="line">    }</div>
</div><!-- fragment --><p> The save method has two optional parameters: The first (to) specifies the file to save to; the second (stationery) can be set to true to save the document as a template, as shown in the following script fragment (from the SaveDocumentAs tutorial script):</p>
<div class="fragment"><div class="line">    <span class="comment">//If the document has been changed since it was last saved, </span></div>
<div class="line">    <span class="comment">//save to the desktop in a file named by the script.</span></div>
<div class="line">    <span class="keywordflow">if</span>(app.activeDocument.saved == <span class="keyword">false</span>){</div>
<div class="line">        <span class="comment">//If you do not provide a file name, InDesign </span></div>
<div class="line">        <span class="comment">//will display the Save dialog box.</span></div>
<div class="line">        app.activeDocument.save(File(Folder.desktop + <span class="stringliteral">&quot;/SaveDocumentAs.indd&quot;</span>));</div>
<div class="line">    }</div>
</div><!-- fragment --><p> You can save a document as a template, as shown in the following script fragment (from the SaveAsTemplate tutorial script): </p>
<div class="fragment"><div class="line">    <span class="comment">//Save the active document as a template.</span></div>
<div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    <span class="keywordflow">if</span> (myDocument.saved == <span class="keyword">true</span>){</div>
<div class="line">        <span class="comment">//Convert the file name to a string.</span></div>
<div class="line">        myFileName = myDocument.fullName + <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">        <span class="comment">//If the file name contains the extension &quot;.indd&quot;, change it to &quot;.indt&quot;.</span></div>
<div class="line">        <span class="keywordflow">if</span>(myFileName.indexOf(<span class="stringliteral">&quot;.indd&quot;</span>)!=-1){</div>
<div class="line">            var myRegularExpression = /.indd/gi</div>
<div class="line">            myFileName = myFileName.replace(myRegularExpression, <span class="stringliteral">&quot;.indt&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span>{</div>
<div class="line">        <span class="comment">//If the document has not been saved, then give it </span></div>
<div class="line">        <span class="comment">//a default file name.</span></div>
<div class="line">        myFileName = <span class="stringliteral">&quot;SaveAsTemplate.indt&quot;</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Save the file to the desktop.</span></div>
<div class="line">    myDocument.save(File(Folder.desktop + <span class="stringliteral">&quot;/&quot;</span> + myFileName), <span class="keyword">true</span>);</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_closing_a_document"></a>
Closing a document</h3>
<p>The close method closes a document, as shown in the following script fragment (from the CloseDocument tutorial script):</p>
<div class="fragment"><div class="line">    app.documents.item(0).close();</div>
<div class="line">    <span class="comment">//Note that:</span></div>
<div class="line">    <span class="comment">//1. documents.item(0) always refers to the front-most document.</span></div>
<div class="line">    <span class="comment">//2. You could also use:</span></div>
<div class="line">    <span class="comment">//      app.activeDocument.close();</span></div>
</div><!-- fragment --><p> The close method can take up to two optional parameters, as shown in the following script fragment (from the CloseWithParameters tutorial script):</p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    <span class="comment">//Close the active document with parameters:</span></div>
<div class="line">    <span class="comment">//   Use SaveOptions.yes to save the document</span></div>
<div class="line">    <span class="comment">//    or SaveOptions.no  to close the document without saving</span></div>
<div class="line">    <span class="comment">//    or SaveOptions.ask to display a prompt.</span></div>
<div class="line">    <span class="comment">//If you use SaveOptions.yes, you&#39;ll need to provide a reference to a file </span></div>
<div class="line">    <span class="comment">//to save to in the second parameter. Saving to a file name is the</span></div>
<div class="line">    <span class="comment">//same as doing a Save As from the user interface--the file name can be</span></div>
<div class="line">    <span class="comment">//a different file name or the same as the existing file name.</span></div>
<div class="line">    <span class="keywordflow">if</span>(myDocument.modified == <span class="keyword">true</span>){</div>
<div class="line">        <span class="comment">//(You&#39;ll have to fill in your own file path):</span></div>
<div class="line">        var myFile = File(Folder.desktop + <span class="stringliteral">&quot;/CloseWithParametersModified.indd&quot;</span>);</div>
<div class="line">        myDocument.close(SaveOptions.ask, myFile);</div>
<div class="line">        <span class="comment">//Or, to save to a user-specified file name:</span></div>
<div class="line">        <span class="comment">//myDocument.close(SaveOptions.ask);</span></div>
<div class="line">    }<span class="keywordflow">else</span>{</div>
<div class="line">        <span class="comment">//If the file has not been modified, simply close it.</span></div>
<div class="line">        myDocument.close(SaveOptions.no);</div>
<div class="line">    }</div>
</div><!-- fragment --><p> You can close all open documents without saving them, as shown in the following script fragment (from the CloseAll tutorial script):</p>
<div class="fragment"><div class="line">    <span class="keywordflow">for</span>(myCounter = app.documents.length; myCounter &gt; 0; myCounter--){</div>
<div class="line">        app.documents.item(myCounter-1).close(SaveOptions.no);</div>
<div class="line">    }</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_basic_page_layout"></a>
Basic Page Layout</h2>
<p>Each document has a default page size, assigned number of pages, bleed and slug working areas, and columns and margins to define the area into which material is placed. Again, all these parameters are accessible to scripting, as shown in the examples in this section.</p>
<h3><a class="anchor" id="id_js_defining_page_size_and_document_length"></a>
Defining page size and document length</h3>
<p>When you create a new document using the InDesign user interface, you can specify the default page size, number of pages, page orientation, and whether the document uses facing pages. To create a document using InDesign scripting, use the documents.add method, which does not specify these settings. After creating a document, you can use the documentPreferences object to control the settings, as shown in the following script fragment (from the DocumentPreferences tutorial script): </p>
<div class="fragment"><div class="line">    <span class="comment">//Use the documentPreferences object to change the page height, width,</span></div>
<div class="line">    <span class="comment">//orientation, and the number of pages of a new document.</span></div>
<div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    with(myDocument.documentPreferences){</div>
<div class="line">        pageHeight = <span class="stringliteral">&quot;800pt&quot;</span>;</div>
<div class="line">        pageWidth = <span class="stringliteral">&quot;600pt&quot;</span>;</div>
<div class="line">        pageOrientation = PageOrientation.landscape;</div>
<div class="line">        pagesPerDocument = 16;</div>
<div class="line">    }</div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>The app object also has a documentPreferences object. You can set the application defaults for page height, page width, and other properties by changing the properties of this object. You can also set individual page sizes; see <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_adjusting_page_sizes_and_layout">Adjusting Page Sizes and Layout</a>.</dd></dl>
<h3><a class="anchor" id="id_js_defining_bleed_and_slug_areas"></a>
Defining bleed and slug areas</h3>
<p>Within InDesign, a bleed or a slug is an area outside the page margins that can be printed or included in an exported PDF. Typically, these areas are used for objects that extend beyond the page edges (bleed) and job/document information (slug). The two areas can be printed and exported independently; for example, you might want to omit slug information for the final printing of a document. The following script shows how to set up the bleed and slug for a new document. (For the complete script, see BleedAndSlug.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Shows how to define the bleed and slug areas of a document.</span></div>
<div class="line">    var myDocument = app.documents.add();</div>
<div class="line">    <span class="comment">//The bleed and slug properties belong to the documentPreferences object.</span></div>
<div class="line">    with(myDocument.documentPreferences){</div>
<div class="line">        <span class="comment">//Bleed</span></div>
<div class="line">        documentBleedBottomOffset = <span class="stringliteral">&quot;3p&quot;</span>;</div>
<div class="line">        documentBleedTopOffset = <span class="stringliteral">&quot;3p&quot;</span>;</div>
<div class="line">        documentBleedInsideOrLeftOffset = <span class="stringliteral">&quot;3p&quot;</span>;</div>
<div class="line">        documentBleedOutsideOrRightOffset = <span class="stringliteral">&quot;3p&quot;</span>;</div>
<div class="line">        <span class="comment">//Slug</span></div>
<div class="line">        slugBottomOffset = <span class="stringliteral">&quot;18p&quot;</span>;</div>
<div class="line">        slugTopOffset = <span class="stringliteral">&quot;3p&quot;</span>;</div>
<div class="line">        slugInsideOrLeftOffset = <span class="stringliteral">&quot;3p&quot;</span>;</div>
<div class="line">        slugRightOrOutsideOffset = <span class="stringliteral">&quot;3p&quot;</span>;</div>
<div class="line">    }</div>
</div><!-- fragment --><p> Alternately, if all the bleed distances are equal, as in the preceding example, you can use the documentBleedUniformSize property, as shown in the following script fragment (from the UniformBleed tutorial script): </p>
<div class="fragment"><div class="line">    <span class="comment">//Shows how to use the uniform size property of the document bleed.</span></div>
<div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    <span class="comment">//The bleed properties belong to the documentPreferences object.</span></div>
<div class="line">    <span class="comment">//&lt;fragment&gt;</span></div>
<div class="line">    with(myDocument.documentPreferences){</div>
<div class="line">        <span class="comment">//Bleed</span></div>
<div class="line">        documentBleedUniformSize = <span class="keyword">true</span>;</div>
<div class="line">        documentBleedTopOffset = <span class="stringliteral">&quot;2p&quot;</span>;</div>
<div class="line">    }</div>
</div><!-- fragment --><p> If all the slug distances are equal, you can use the documentSlugUniformSize property, as shown in the following script fragment (from the UniformSlug tutorial script): </p>
<div class="fragment"><div class="line">    <span class="comment">//Shows how to use the uniform size property of the document slug.</span></div>
<div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    <span class="comment">//The slug properties belong to the documentPreferences object.</span></div>
<div class="line">    with(myDocument.documentPreferences){</div>
<div class="line">        <span class="comment">//Slug:</span></div>
<div class="line">        documentSlugUniformSize = <span class="keyword">true</span>;</div>
<div class="line">        slugTopOffset = <span class="stringliteral">&quot;4p&quot;</span>;</div>
<div class="line">    }</div>
</div><!-- fragment --><p> In addition to setting the bleed and slug widths and heights, you can control the color used to draw the guides defining the bleed and slug. This property is not in the documentPreferences object; instead, it is in the pasteboardPreferences object, as shown in the following script fragment (from the BleedSlugGuideColors tutorial script): </p>
<div class="fragment"><div class="line">    with(myDocument.pasteboardPreferences){</div>
<div class="line">        <span class="comment">//Any of InDesign&#39;s guides can use the UIColors constants...</span></div>
<div class="line">        bleedGuideColor = UIColors.cuteTeal;</div>
<div class="line">        slugGuideColor = UIColors.charcoal;</div>
<div class="line">        <span class="comment">//...or you can specify an array of RGB values (with values from 0 to 255)</span></div>
<div class="line">        bleedGuideColor = [0, 198, 192];</div>
<div class="line">        slugGuideColor = [192, 192, 192];</div>
<div class="line">    }</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_setting_page_margins_and_columns"></a>
Setting page margins and columns</h3>
<p>Each page in a document can have its own margin and column settings. With InDesign scripting, these properties are part of the marginPreferences object for each page. This following sample script creates a new document, then sets the margins and columns for all pages in the master spread. (For the complete script, see PageMargins.) </p>
<div class="fragment"><div class="line">    with (myDocument.marginPreferences) {</div>
<div class="line">        top = 56;</div>
<div class="line">        bottom = 24;</div>
<div class="line">        left = 48;</div>
<div class="line">        right = 10;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//The following assumes that your default document contains a single page.</span></div>
<div class="line">    with (myPage.marginPreferences) {</div>
<div class="line">        top = 56;</div>
<div class="line">        bottom = 24;</div>
<div class="line">        <span class="comment">//When document.documentPreferences.facingPages = true,</span></div>
<div class="line">        <span class="comment">//&quot;left&quot; means inside and &quot;right&quot; means outside.</span></div>
<div class="line">        left = 48;</div>
<div class="line">        right = 10;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//The following assumes that your default master spread contains two pages.</span></div>
<div class="line">    with (myDocument.masterSpreads.item(0).pages) {</div>
<div class="line">        with (item(0).marginPreferences) {</div>
<div class="line">            top = 56;</div>
<div class="line">            bottom = 24;</div>
<div class="line">            left = 48;</div>
<div class="line">            right = 10;</div>
<div class="line">        }</div>
<div class="line">        with (item(1).marginPreferences) {</div>
<div class="line">            top = 56;</div>
<div class="line">            bottom = 24;</div>
<div class="line">            left = 48;</div>
<div class="line">            right = 10;</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment --><p> To set the page margins for an individual page, use the margin preferences for that page, as shown in the following script fragment (from the PageMarginsForOnePage tutorial script): </p>
<div class="fragment"><div class="line">    with (myPage.marginPreferences){</div>
<div class="line">        columnCount = 3;</div>
<div class="line">        <span class="comment">//columnGutter can be a number or a measurement string.</span></div>
<div class="line">        columnGutter = <span class="stringliteral">&quot;1p&quot;</span>;</div>
<div class="line">        top = <span class="stringliteral">&quot;4p&quot;</span></div>
<div class="line">        bottom = <span class="stringliteral">&quot;6p&quot;</span></div>
<div class="line">        <span class="comment">//When document.documentPreferences.facingPages == true, </span></div>
<div class="line">        <span class="comment">//&quot;left&quot; means inside; &quot;right&quot; means outside.</span></div>
<div class="line">        left = <span class="stringliteral">&quot;6p&quot;</span></div>
<div class="line">        right = <span class="stringliteral">&quot;4p&quot;</span></div>
<div class="line">    }</div>
</div><!-- fragment --><p> InDesign does not allow you to create a page that is smaller than the sum of the relevant margins; that is, the width of the page must be greater than the sum of the left and right page margins, and the height of the page must be greater than the sum of the top and bottom margins. If you are creating very small pages (for example, for individual newspaper advertisements) using the InDesign user interface, you can easily set the correct margin sizes as you create the document, by entering new values in the document default page Margin fields in the New Document dialog box.</p>
<p>From scripting, however, the solution is not as clear: when you create a document, it uses the application's default-margin preferences. These margins are applied to all pages of the document, including master pages. Setting the document margin preferences affects only new pages and has no effect on existing pages. If you try to set the page height and page width to values smaller than the sum of the corresponding margins on any existing pages, InDesign does not change the page size.</p>
<p>There are two solutions. The first is to set the margins of the existing pages before you try to change the page size, as shown in the following script fragment (from the PageMarginsForSmallPages tutorial script): </p>
<div class="fragment"><div class="line">    <span class="comment">//The following assumes that your document contains a single page.</span></div>
<div class="line">    with (myPage.marginPreferences) {</div>
<div class="line">        top = 0;</div>
<div class="line">        left = 0;</div>
<div class="line">        bottom = 0;</div>
<div class="line">        right = 0;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//The following prevents errors when new pages are added.</span></div>
<div class="line">    with (myDocument.marginPreferences) {</div>
<div class="line">        top = 0;</div>
<div class="line">        left = 0;</div>
<div class="line">        bottom = 0;</div>
<div class="line">        right = 0;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//The following assumes that your default master spread contains two pages.</span></div>
<div class="line">    with (myDocument.masterSpreads.item(0)) {</div>
<div class="line">        with (pages.item(0).marginPreferences) {</div>
<div class="line">            top = 0;</div>
<div class="line">            left = 0;</div>
<div class="line">            bottom = 0;</div>
<div class="line">            right = 0;</div>
<div class="line">        }</div>
<div class="line">        with (pages.item(1).marginPreferences) {</div>
<div class="line">            top = 0;</div>
<div class="line">            left = 0;</div>
<div class="line">            bottom = 0;</div>
<div class="line">            right = 0;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//At this point, you can set your page size to a small width and height</span></div>
<div class="line">    <span class="comment">//(1x1 picas minimum).</span></div>
<div class="line">    myDocument.documentPreferences.pageHeight = <span class="stringliteral">&quot;1p&quot;</span>;</div>
<div class="line">    myDocument.documentPreferences.pageWidth = <span class="stringliteral">&quot;6p&quot;</span>;</div>
</div><!-- fragment --><p> Alternately, you can change the application's default-margin preferences before you create the document, as shown in the following script fragment (from the ApplicationPageMargins tutorial script): </p>
<div class="fragment"><div class="line">    with (app.marginPreferences){</div>
<div class="line">        <span class="comment">//Save the current application default margin preferences.</span></div>
<div class="line">        var myY1 = top;</div>
<div class="line">        var myX1 = left;</div>
<div class="line">        var myY2 = bottom;</div>
<div class="line">        var myX2 = right;</div>
<div class="line">        <span class="comment">//Set the application default margin preferences.</span></div>
<div class="line">        top = 0;</div>
<div class="line">        left = 0;</div>
<div class="line">        bottom = 0;</div>
<div class="line">        right = 0;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Create a new example document to demonstrate the change.</span></div>
<div class="line">    var myDocument = app.documents.add();</div>
<div class="line">    <span class="comment">//At this point, you can set your page size to a small width and</span></div>
<div class="line">    <span class="comment">//height (1x1 picas minimum).</span></div>
<div class="line">    myDocument.documentPreferences.pageHeight = <span class="stringliteral">&quot;1p&quot;</span>;</div>
<div class="line">    myDocument.documentPreferences.pageWidth = <span class="stringliteral">&quot;1p&quot;</span>;</div>
<div class="line">    <span class="comment">//Reset the application default margin preferences to their former state.</span></div>
<div class="line">    with (app.marginPreferences){</div>
<div class="line">        top = myY1;</div>
<div class="line">        left = myX1 ;</div>
<div class="line">        bottom = myY2;</div>
<div class="line">        right = myX2;</div>
<div class="line">    }</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_changing_the_appearance_of_the_pasteboard"></a>
Changing the appearance of the pasteboard</h3>
<p>The pasteboard is the area that surrounds InDesign pages and spreads. You can use it for temporary storage of page items or for job-tracking information. You can change the size of the pasteboard and its color using scripting. The previewBackgroundColor property sets the color of the pasteboard in Preview mode, as shown in the following script fragment (from the PasteboardPreferences tutorial script): </p>
<div class="fragment"><div class="line">    with(myDocument.pasteboardPreferences){</div>
<div class="line">        <span class="comment">//You can use either a number or a measurement string </span></div>
<div class="line">        <span class="comment">//to set the minimum horizontal and vertical pasteboard margins</span></div>
<div class="line">        pasteboardMargins = [<span class="stringliteral">&quot;12p&quot;</span>, <span class="stringliteral">&quot;15p&quot;</span>];</div>
<div class="line">        <span class="comment">//You can set the preview background color (which you&#39;ll only see</span></div>
<div class="line">        <span class="comment">//in Preview mode) to any of the predefined UIColor constants...</span></div>
<div class="line">        previewBackgroundColor = UIColors.gray;</div>
<div class="line">        <span class="comment">//...or you can specify an array of RGB values </span></div>
<div class="line">        <span class="comment">//   (with values from 0 to 255)</span></div>
<div class="line">        previewBackgroundColor = [192, 192, 192];   </div>
<div class="line">    }</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_guides_and_grids"></a>
Guides and grids</h3>
<p>Guides and grids make it easy to position objects on your document pages. These are very useful items to add when you are creating templates for others to use.</p>
<p><b>Defining guides</b></p>
<p>Guides in InDesign give you an easy way to position objects on the pages of your document. The following script fragment shows how to use guides. (For the complete script, see Guides.) </p>
<div class="fragment"><div class="line">    var myPageWidth = myDocument.documentPreferences.pageWidth;</div>
<div class="line">    var myPageHeight = myDocument.documentPreferences.pageHeight;</div>
<div class="line">    with(myDocument.pages.item(0)){</div>
<div class="line">        <span class="comment">//Place guides at the margins of the page.</span></div>
<div class="line">        guides.add(undefined, {orientation:HorizontalOrVertical.vertical,</div>
<div class="line">                               location:marginPreferences.left});</div>
<div class="line">        guides.add(undefined, {orientation:HorizontalOrVertical.vertical,</div>
<div class="line">                               location:(myPageWidth - marginPreferences.right)});</div>
<div class="line">        guides.add(undefined, {orientation:HorizontalOrVertical.horizontal,</div>
<div class="line">                               location:marginPreferences.top});</div>
<div class="line">        guides.add(undefined, {orientation:HorizontalOrVertical.horizontal,</div>
<div class="line">                               location:(myPageHeight - marginPreferences.bottom)});</div>
<div class="line">        <span class="comment">//Place a guide at the vertical center of the page.</span></div>
<div class="line">        guides.add(undefined, {orientation:HorizontalOrVertical.vertical,</div>
<div class="line">                               location:(myPageWidth/2)});</div>
<div class="line">        <span class="comment">//Place a guide at the horizontal center of the page.</span></div>
<div class="line">        guides.add(undefined, {orientation:HorizontalOrVertical.horizontal,</div>
<div class="line">                               location:(myPageHeight/2)});</div>
<div class="line">    }</div>
</div><!-- fragment --><p> Horizontal guides can be limited to a given page or extend across all pages in a spread. From InDesign scripting, you can control this using the fitToPage property. This property is ignored by vertical guides.</p>
<p>You can use scripting to change the layer, color, and visibility of guides, just as you can from the user interface, as shown in the following script fragment (from the GuideOptions tutorial script): </p>
<div class="fragment"><div class="line">    var myGuide;</div>
<div class="line">    <span class="comment">//Create a layer named &quot;guide layer&quot;.</span></div>
<div class="line">    var myLayer = myDocument.layers.add({name:<span class="stringliteral">&quot;guide layer&quot;</span>});</div>
<div class="line">    <span class="comment">//Add a series of guides to page 1.</span></div>
<div class="line">    with(myDocument.pages.item(0)){</div>
<div class="line">        <span class="comment">//Create a guide on the layer we created above.</span></div>
<div class="line">        myGuide = guides.add(myLayer,</div>
<div class="line">                             {orientation:HorizontalOrVertical.horizontal,</div>
<div class="line">                              location:<span class="stringliteral">&quot;12p&quot;</span>});</div>
<div class="line">        <span class="comment">//Another way to make a guide on a specific layer.</span></div>
<div class="line">        myGuide = guides.add(undefined,</div>
<div class="line">                             {itemLayer:myLayer,</div>
<div class="line">                              orientation:HorizontalOrVertical.horizontal,</div>
<div class="line">                              location:<span class="stringliteral">&quot;14p&quot;</span>});</div>
<div class="line">        <span class="comment">//Make a locked guide.</span></div>
<div class="line">        myGuide = guides.add(myLayer,{locked:<span class="keyword">true</span>,</div>
<div class="line">                                      orientation:HorizontalOrVertical.horizontal,</div>
<div class="line">                                      location:<span class="stringliteral">&quot;16p&quot;</span>});</div>
<div class="line">        <span class="comment">//Set the view threshold of a guide.</span></div>
<div class="line">        myGuide = guides.add(myLayer,{viewThreshold:100,</div>
<div class="line">                                      orientation:HorizontalOrVertical.horizontal,</div>
<div class="line">                                      location:<span class="stringliteral">&quot;18p&quot;</span>});</div>
<div class="line">        <span class="comment">//Set the guide color of a guide using a UIColors constant.</span></div>
<div class="line">        myGuide = guides.add(myLayer,{guideColor:UIColors.gray,</div>
<div class="line">                                      orientation:HorizontalOrVertical.horizontal,</div>
<div class="line">                                      location:<span class="stringliteral">&quot;20p&quot;</span>});</div>
<div class="line">        <span class="comment">//Set the guide color of a guide using an RGB array.</span></div>
<div class="line">        myGuide = guides.add(myLayer,{guideColor:[192, 192, 192],</div>
<div class="line">                                      orientation:HorizontalOrVertical.horizontal,</div>
<div class="line">                                      location:<span class="stringliteral">&quot;22p&quot;</span>});</div>
<div class="line">    }</div>
</div><!-- fragment --><p> You also can create guides using the createGuides method on spreads and master spreads, as shown in the following script fragment (from the CreateGuides tutorial script): </p>
<div class="fragment"><div class="line">    var myLayer = myDocument.layers.item(0);</div>
<div class="line">    with (myDocument.spreads.item(0)){</div>
<div class="line">        <span class="comment">//Parameters (all optional): row count, column count, row gutter, </span></div>
<div class="line">        <span class="comment">//column gutter,guide color, fit margins, remove existing, layer.</span></div>
<div class="line">        <span class="comment">//Note that the createGuides method does not take an RGB array </span></div>
<div class="line">        <span class="comment">//for the guide color parameter.</span></div>
<div class="line">        createGuides(4, 4, <span class="stringliteral">&quot;1p&quot;</span>, <span class="stringliteral">&quot;1p&quot;</span>, UIColors.gray, <span class="keyword">true</span>, <span class="keyword">true</span>, myLayer);</div>
<div class="line">    }</div>
</div><!-- fragment --><p> <b>Setting grid preferences</b></p>
<p>To control the properties of the document and baseline grid, you set the properties of the gridPreferences object, as shown in the following script fragment (from the DocumentAndBaselineGrid tutorial script): </p>
<div class="fragment"><div class="line">    <span class="comment">//Set the document measurement units to points.</span></div>
<div class="line">    myDocument.viewPreferences.horizontalMeasurementUnits = MeasurementUnits.points;</div>
<div class="line">    myDocument.viewPreferences.verticalMeasurementUnits = MeasurementUnits.points;</div>
<div class="line">    <span class="comment">//Set up grid preferences.</span></div>
<div class="line">    with(myDocument.gridPreferences){</div>
<div class="line">        baselineStart = 56;</div>
<div class="line">        baselineDivision = 14;</div>
<div class="line">        baselineShown = <span class="keyword">true</span>;</div>
<div class="line">        horizontalGridlineDivision = 14;</div>
<div class="line">        horizontalGridSubdivision = 5</div>
<div class="line">        verticalGridlineDivision = 14;</div>
<div class="line">        verticalGridSubdivision = 5</div>
<div class="line">        documentGridShown = <span class="keyword">true</span>;</div>
<div class="line">    }</div>
</div><!-- fragment --><p> <b>Snapping to guides and grids</b></p>
<p>All snap settings for a document's grids and guides are in the properties of the guidePreferences and gridPreferences objects. The following script fragment shows how to set guide and grid snap properties. (For the complete script, see GuideGridPreferences.) </p>
<div class="fragment"><div class="line">    with(myDocument.guidePreferences){</div>
<div class="line">        guidesInBack = <span class="keyword">true</span>;</div>
<div class="line">        guidesLocked = <span class="keyword">false</span>;</div>
<div class="line">        guidesShown = <span class="keyword">true</span>;</div>
<div class="line">        guidesSnapTo = <span class="keyword">true</span>;</div>
<div class="line">        rulerGuidesColor = UIColors.cuteTeal; <span class="comment">//By name ...</span></div>
<div class="line">        rulerGuidesColor = [0, 198, 192];     <span class="comment">//... or RGB values.</span></div>
<div class="line">        rulerGuidesViewThreashold = 50; <span class="comment">//Magnification (as a percentage) less</span></div>
<div class="line">                                        <span class="comment">//then which ruler guides do not appear</span></div>
<div class="line">                                        <span class="comment">//(Range: 5 to 4000)</span></div>
<div class="line">    }</div>
<div class="line">    var myBaselineStart;</div>
<div class="line">    with (BaselineGridRelativeOption) {</div>
<div class="line">        myBaselineStart = TOP_OF_PAGE_OF_BASELINE_GRID_RELATIVE_OPTION; <span class="comment">// or</span></div>
<div class="line">        myBaselineStart = TOP_OF_MARGIN_OF_BASELINE_GRID_RELATIVE_OPTION; </div>
<div class="line">        <span class="comment">// XXX Even with this set, JS puts first baseline 2 in. from top of page.</span></div>
<div class="line">    }</div>
<div class="line">    with(myDocument.gridPreferences){</div>
<div class="line">        <span class="comment">//Baseline Grid</span></div>
<div class="line">        baselineStart = <span class="stringliteral">&quot;2in&quot;</span>;</div>
<div class="line">        baselingeGridRelativeOption = myBaselineStart;</div>
<div class="line">        baselineColor = UIColors.lightBlue; <span class="comment">//By name ...</span></div>
<div class="line">        baselineColor = [79, 153, 255];     <span class="comment">//... or by RGB color.</span></div>
<div class="line">        baselineDivision = <span class="stringliteral">&quot;22pt&quot;</span>;</div>
<div class="line">        baselineGridShown = <span class="keyword">true</span>;  <span class="comment">//Objects will snap to the baseline grid only if</span></div>
<div class="line">                                   <span class="comment">//the grid is shown.</span></div>
<div class="line">        baselineViewThreashold = 75;</div>
<div class="line">        <span class="comment">//Document Grid</span></div>
<div class="line">        documentGridSnapTo = <span class="keyword">true</span>; <span class="comment">//If documentGridSnapTo is true, objects will</span></div>
<div class="line">                                   <span class="comment">//snap to the grid even if ...</span></div>
<div class="line">        documentGridShown = <span class="keyword">false</span>; <span class="comment">//... documentGridShown is false.</span></div>
<div class="line">        gridColor = UIColors.charcoal; <span class="comment">//By name ...</span></div>
<div class="line">        gridColor = [192, 192, 192];   <span class="comment">//... or RGB values.</span></div>
<div class="line">        gridInBack = <span class="keyword">true</span>;</div>
<div class="line">        <span class="comment">//Set spacing of document grid based on current measurement units (inches).</span></div>
<div class="line">        horizontalGridlineDivision = 1;</div>
<div class="line">        horizontalGridSubdivision = 4;</div>
<div class="line">        verticalGridlineDivision = 1;</div>
<div class="line">        verticalGridSubdivision = 4;</div>
<div class="line">    }</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_changing_measurement_units_and_ruler"></a>
Changing measurement units and ruler</h3>
<p>Thus far, the sample scripts used measurement strings, strings that force InDesign to use a specific measurement unit (for example, "8.5i" for 8.5 inches). They do this because you might be using a different measurement system when you run the script.</p>
<p>To specify the measurement system used in a script, use the document's viewPreferences object, as shown in the following script fragment (from the ViewPreferences tutorial script): </p>
<div class="fragment"><div class="line">    with(myDocument.viewPreferences){</div>
<div class="line">        <span class="comment">//Measurement unit choices are:</span></div>
<div class="line">        <span class="comment">//* MeasurementUnits.picas</span></div>
<div class="line">        <span class="comment">//* MeasurementUnits.points</span></div>
<div class="line">        <span class="comment">//* MeasurementUnits.inches</span></div>
<div class="line">        <span class="comment">//* MeasurementUnits.inchesDecimal</span></div>
<div class="line">        <span class="comment">//* MeasurementUnits.millimeters</span></div>
<div class="line">        <span class="comment">//* MeasurementUnits.centimeters</span></div>
<div class="line">        <span class="comment">//* MeasurementUnits.ciceros</span></div>
<div class="line">        <span class="comment">//* MeasurementUnits.agates</span></div>
<div class="line">        <span class="comment">//* MeasurementUnits.custom</span></div>
<div class="line">        <span class="comment">//Set horizontal and vertical measurement units to points.</span></div>
<div class="line">        horizontalMeasurementUnits = MeasurementUnits.points;</div>
<div class="line">        verticalMeasurementUnits = MeasurementUnits.points;</div>
<div class="line">    }</div>
</div><!-- fragment --><p> If you are writing a script that needs to use a specific measurement system, you can change the measurement units at the beginning of the script, then restore the original measurement units at the end of the script. This is shown in the following script fragment (from the ResetMeasurementUnits tutorial script): </p>
<div class="fragment"><div class="line">    with (myDocument.viewPreferences){</div>
<div class="line">        var myOldXUnits = horizontalMeasurementUnits;</div>
<div class="line">        var myOldYUnits = verticalMeasurementUnits;</div>
<div class="line">        horizontalMeasurementUnits = MeasurementUnits.points;</div>
<div class="line">        verticalMeasurementUnits = MeasurementUnits.points;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//At this point, you can perform any series of script actions </span></div>
<div class="line">    <span class="comment">//that depend on the measurement units you&#39;ve set. At the end of</span></div>
<div class="line">    <span class="comment">//the script, reset the measurement units to their original state.</span></div>
<div class="line">    with (myDocument.viewPreferences){</div>
<div class="line">        <span class="keywordflow">try</span>{</div>
<div class="line">            horizontalMeasurementUnits = myOldXUnits;</div>
<div class="line">            verticalMeasurementUnits = myOldYUnits;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span>(myError){</div>
<div class="line">            alert(<span class="stringliteral">&quot;Could not reset custom measurement units.&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_defining_and_applying_document_presets"></a>
Defining and applying document presets</h3>
<p>InDesign document presets enable you to store and apply common document set-up information (page size, page margins, columns, and bleed and slug areas). When you create a new document, you can base the document on a document preset.</p>
<p><b>Creating a preset by copying values</b></p>
<p>To create a document preset using an existing document's settings as an example, open a document that has the document set-up properties you want to use in the document preset, then run the following script (from the DocumentPresetByExample tutorial script): </p>
<div class="fragment"><div class="line">        <span class="comment">//If the document preset &quot;myDocumentPresetByExample&quot; does not already exist,</span></div>
<div class="line">        <span class="comment">//create it.    </span></div>
<div class="line">        var myDocumentPreset = app.documentPresets.item(<span class="stringliteral">&quot;myDocumentPresetByExample&quot;</span>);</div>
<div class="line">        <span class="keywordflow">try</span> {</div>
<div class="line">            var myPresetName = myDocumentPreset.name;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span> (myError){</div>
<div class="line">            myDocumentPreset</div>
<div class="line">                = app.documentPresets.add({name:<span class="stringliteral">&quot;myDocumentPresetByExample&quot;</span>});</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">//Set the application default measurement units to match the document</span></div>
<div class="line">        <span class="comment">//measurement units.</span></div>
<div class="line">        app.viewPreferences.horizontalMeasurementUnits</div>
<div class="line">            = myDocument.viewPreferences.horizontalMeasurementUnits;</div>
<div class="line">        app.viewPreferences.verticalMeasurementUnits</div>
<div class="line">            = myDocument.viewPreferences.verticalMeasurementUnits;</div>
<div class="line">        <span class="comment">//Fill in the properties of the document preset with the corresponding</span></div>
<div class="line">        <span class="comment">//properties of the active document.</span></div>
<div class="line">        with(myDocumentPreset){</div>
<div class="line">            <span class="comment">//Note that the following gets the page margins from the margin</span></div>
<div class="line">            <span class="comment">//preferences of the document; to get the margin preferences from the</span></div>
<div class="line">            <span class="comment">//active page, replace &quot;app.activeDocument&quot; with</span></div>
<div class="line">            <span class="comment">//&quot;app.activeWindow.activePage&quot; in the following line (assuming the</span></div>
<div class="line">            <span class="comment">//active window is a layout window).</span></div>
<div class="line">            var myMarginPreferences = app.activeDocument.marginPreferences;</div>
<div class="line">            left = myMarginPreferences.left;</div>
<div class="line">            right = myMarginPreferences.right;</div>
<div class="line">            top = myMarginPreferences.top;</div>
<div class="line">            bottom = myMarginPreferences.bottom;</div>
<div class="line">            columnCount = myMarginPreferences.columnCount;</div>
<div class="line">            columnGutter = myMarginPreferences.columnGutter;</div>
<div class="line">            documentBleedBottom</div>
<div class="line">                = myDocument.documentPreferences.documentBleedBottomOffset;</div>
<div class="line">            documentBleedTop</div>
<div class="line">                = myDocument.documentPreferences.documentBleedTopOffset;</div>
<div class="line">            documentBleedLeft</div>
<div class="line">                = myDocument.documentPreferences.documentBleedInsideOrLeftOffset;</div>
<div class="line">            documentBleedRight</div>
<div class="line">                = myDocument.documentPreferences.documentBleedOutsideOrRightOffset;</div>
<div class="line">            facingPages = myDocument.documentPreferences.facingPages;</div>
<div class="line">            pageHeight = myDocument.documentPreferences.pageHeight;</div>
<div class="line">            pageWidth = myDocument.documentPreferences.pageWidth;</div>
<div class="line">            pageOrientation = myDocument.documentPreferences.pageOrientation;</div>
<div class="line">            pagesPerDocument = myDocument.documentPreferences.pagesPerDocument;</div>
<div class="line">            slugBottomOffset = myDocument.documentPreferences.slugBottomOffset;</div>
<div class="line">            slugTopOffset = myDocument.documentPreferences.slugTopOffset;</div>
<div class="line">            slugInsideOrLeftOffset</div>
<div class="line">                = myDocument.documentPreferences.slugInsideOrLeftOffset;</div>
<div class="line">            slugRightOrOutsideOffset</div>
<div class="line">                = myDocument.documentPreferences.slugRightOrOutsideOffset;</div>
<div class="line">        }</div>
</div><!-- fragment --><p> <b>Creating a document preset</b></p>
<p>To create a document preset using explicit values, run the following script (from the DocumentPreset tutorial script): </p>
<div class="fragment"><div class="line">    var myDocumentPreset;</div>
<div class="line">    <span class="comment">//If the document preset &quot;myDocumentPreset&quot; does not already exist, create it.  </span></div>
<div class="line">    myDocumentPreset = app.documentPresets.item(<span class="stringliteral">&quot;myDocumentPreset&quot;</span>);</div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line">        var myPresetName = myDocumentPreset.name;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span> (myError){</div>
<div class="line">        myDocumentPreset = app.documentPresets.add({name:<span class="stringliteral">&quot;myDocumentPreset&quot;</span>});</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Fill in the properties of the document preset.</span></div>
<div class="line">    with(myDocumentPreset){</div>
<div class="line">        pageHeight = <span class="stringliteral">&quot;9i&quot;</span>;</div>
<div class="line">        pageWidth = <span class="stringliteral">&quot;7i&quot;</span>;</div>
<div class="line">        left = <span class="stringliteral">&quot;4p&quot;</span>;</div>
<div class="line">        right = <span class="stringliteral">&quot;6p&quot;</span>;</div>
<div class="line">        top = <span class="stringliteral">&quot;4p&quot;</span>;</div>
<div class="line">        bottom = <span class="stringliteral">&quot;9p&quot;</span>;</div>
<div class="line">        columnCount = 1;</div>
<div class="line">        documentBleedBottom = <span class="stringliteral">&quot;3p&quot;</span>;</div>
<div class="line">        documentBleedTop = <span class="stringliteral">&quot;3p&quot;</span>;</div>
<div class="line">        documentBleedLeft = <span class="stringliteral">&quot;3p&quot;</span>;</div>
<div class="line">        documentBleedRight = <span class="stringliteral">&quot;3p&quot;</span>;</div>
<div class="line">        facingPages = <span class="keyword">true</span>;</div>
<div class="line">        pageOrientation = PageOrientation.portrait;</div>
<div class="line">        pagesPerDocument = 1;</div>
<div class="line">        slugBottomOffset = <span class="stringliteral">&quot;18p&quot;</span>;</div>
<div class="line">        slugTopOffset = <span class="stringliteral">&quot;3p&quot;</span>;</div>
<div class="line">        slugInsideOrLeftOffset = <span class="stringliteral">&quot;3p&quot;</span>;</div>
<div class="line">        slugRightOrOutsideOffset = <span class="stringliteral">&quot;3p&quot;</span>;</div>
<div class="line">    }</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_setting_up_master_spreads"></a>
Setting up master spreads</h3>
<p>After setting up the basic document page size, slug, and bleed, you probably will want to define the document's master spreads. The following script shows how to do that. (For the complete script, see MasterSpread.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Set the document&#39;s ruler origin to page origin. This is very important!</span></div>
<div class="line">    <span class="comment">//If you don&#39;t do this, getting objects to the correct position on the</span></div>
<div class="line">    <span class="comment">//page is much more difficult.</span></div>
<div class="line">    myDocument.viewPreferences.rulerOrigin = RulerOrigin.pageOrigin;</div>
<div class="line">    with(myDocument.masterSpreads.item(0)){</div>
<div class="line">        <span class="comment">//Set up the left page (verso).</span></div>
<div class="line">        with(pages.item(0)){</div>
<div class="line">            with(marginPreferences){</div>
<div class="line">                columnCount = 3;</div>
<div class="line">                columnGutter = <span class="stringliteral">&quot;1p&quot;</span>;</div>
<div class="line">                bottom = <span class="stringliteral">&quot;6p&quot;</span></div>
<div class="line">                <span class="comment">//&quot;left&quot; means inside; &quot;right&quot; means outside.</span></div>
<div class="line">                left = <span class="stringliteral">&quot;6p&quot;</span></div>
<div class="line">                right = <span class="stringliteral">&quot;4p&quot;</span></div>
<div class="line">                top = <span class="stringliteral">&quot;4p&quot;</span></div>
<div class="line">            }</div>
<div class="line">            <span class="comment">//Add a simple footer with a section number and page number.</span></div>
<div class="line">            with(textFrames.add()){</div>
<div class="line">                geometricBounds = [<span class="stringliteral">&quot;61p&quot;</span>, <span class="stringliteral">&quot;4p&quot;</span>, <span class="stringliteral">&quot;62p&quot;</span>, <span class="stringliteral">&quot;45p&quot;</span>];</div>
<div class="line">                insertionPoints.item(0).contents = SpecialCharacters.sectionMarker;</div>
<div class="line">                insertionPoints.item(0).contents = SpecialCharacters.emSpace;</div>
<div class="line">                insertionPoints.item(0).contents = SpecialCharacters.autoPageNumber;</div>
<div class="line">                paragraphs.item(0).justification = Justification.leftAlign;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">//Set up the right page (recto).</span></div>
<div class="line">        with(pages.item(1)){</div>
<div class="line">            with(marginPreferences){</div>
<div class="line">                columnCount = 3;</div>
<div class="line">                columnGutter = <span class="stringliteral">&quot;1p&quot;</span>;</div>
<div class="line">                bottom = <span class="stringliteral">&quot;6p&quot;</span></div>
<div class="line">                <span class="comment">//&quot;left&quot; means inside; &quot;right&quot; means outside.</span></div>
<div class="line">                left = <span class="stringliteral">&quot;6p&quot;</span></div>
<div class="line">                right = <span class="stringliteral">&quot;4p&quot;</span></div>
<div class="line">                top = <span class="stringliteral">&quot;4p&quot;</span></div>
<div class="line">            }</div>
<div class="line">            <span class="comment">//Add a simple footer with a section number and page number.</span></div>
<div class="line">            with(textFrames.add()){</div>
<div class="line">                geometricBounds = [<span class="stringliteral">&quot;61p&quot;</span>, <span class="stringliteral">&quot;6p&quot;</span>, <span class="stringliteral">&quot;62p&quot;</span>, <span class="stringliteral">&quot;47p&quot;</span>];</div>
<div class="line">                insertionPoints.item(0).contents = SpecialCharacters.autoPageNumber;</div>
<div class="line">                insertionPoints.item(0).contents = SpecialCharacters.emSpace;</div>
<div class="line">                insertionPoints.item(0).contents = SpecialCharacters.sectionMarker;</div>
<div class="line">                paragraphs.item(0).justification = Justification.rightAlign;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment --><p> To apply a master spread to a document page, use the appliedMaster property of the document page, as shown in the following script fragment (from the ApplyMaster tutorial script): </p>
<div class="fragment"><div class="line">    <span class="comment">//Assumes that you have document open with a master page named &quot;B-Master&quot;</span></div>
<div class="line">    <span class="comment">//and at least three pages--page 3 is pages.item(2) because JavaScript arrays</span></div>
<div class="line">    <span class="comment">//are zero-based.</span></div>
<div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myPage = myDocument.pages.item(2);</div>
<div class="line">    myPage.appliedMaster = myDocument.masterSpreads.item(<span class="stringliteral">&quot;B-Master&quot;</span>);</div>
</div><!-- fragment --><p> Use the same property to apply a master spread to a master spread page, as shown in the following script fragment (from the ApplyMasterToMaster tutorial script): </p>
<div class="fragment"><div class="line">    <span class="comment">//Create a new master spread.</span></div>
<div class="line">    var myBMaster = myDocument.masterSpreads.add();</div>
<div class="line">    myBMaster.namePrefix = <span class="stringliteral">&quot;B&quot;</span>;</div>
<div class="line">    myBMaster.baseName = <span class="stringliteral">&quot;Master&quot;</span>;</div>
<div class="line">    <span class="comment">//Apply master spread &quot;A&quot; to the first page of the new master spread.</span></div>
<div class="line">    var myMasterPage = myDocument.masterSpreads.item(<span class="stringliteral">&quot;B-Master&quot;</span>).pages.item(0);</div>
<div class="line">    myMasterPage.appliedMaster = myDocument.masterSpreads.item(<span class="stringliteral">&quot;A-Master&quot;</span>);</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_adding_xmp_metadata"></a>
Adding XMP metadata</h3>
<p>Metadata is information that describes the content, origin, or other attributes of a file. In the InDesign user interface, you enter, edit, and view metadata using the File Info dialog (choose File &gt; File Info). This metadata includes the document's creation and modification dates, author, copyright status, and other information. All this information is stored using XMP (Adobe Extensible Metadata Platform), an open standard for embedding metadata in a document.</p>
<p>To learn more about XMP, see the XMP specification at <a href="http://partners.adobe.com/asn/developer/pdf/MetadataFramework.pdf">http://partners.adobe.com/asn/developer/pdf/MetadataFramework.pdf </a>.</p>
<p>You also can add XMP information to a document using InDesign scripting. All XMP properties for a document are in the document's metadataPreferences object. The example below fills in the standard XMP data for a document.</p>
<p>This example also shows that XMP information is extensible. If you need to attach metadata to a document and the data does not fall into a category provided by the metadata preferences object, you can create your own metadata container (email, in this example). (For the complete script, see MetadataExample.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Adds metadata to an example document.</span></div>
<div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    with (myDocument.metadataPreferences){</div>
<div class="line">        author = <span class="stringliteral">&quot;Adobe&quot;</span>;</div>
<div class="line">        copyrightInfoURL = <span class="stringliteral">&quot;http://www.adobe.com&quot;</span>;</div>
<div class="line">        copyrightNotice = <span class="stringliteral">&quot;This document is copyrighted.&quot;</span>;</div>
<div class="line">        copyrightStatus = CopyrightStatus.yes;</div>
<div class="line">        description = <span class="stringliteral">&quot;Example of xmp metadata scripting in Adobe InDesign CC&quot;</span>;</div>
<div class="line">        documentTitle = <span class="stringliteral">&quot;XMP Example&quot;</span>;</div>
<div class="line">        jobName = <span class="stringliteral">&quot;XMP_Example_2008&quot;</span>;</div>
<div class="line">        keywords = [<span class="stringliteral">&quot;animal&quot;</span>, <span class="stringliteral">&quot;mineral&quot;</span>, <span class="stringliteral">&quot;vegetable&quot;</span>];</div>
<div class="line">        <span class="comment">//The metadata preferences object also includes the read-only</span></div>
<div class="line">        <span class="comment">//creator, format, creationDate, modificationDate, and serverURL </span></div>
<div class="line">        <span class="comment">//properties that are automatically entered and maintained by InDesign.</span></div>
<div class="line">        <span class="comment">//Create a custom XMP container, &quot;email&quot;</span></div>
<div class="line">        var myString = <span class="stringliteral">&quot;http://ns.adobe.com/xap/1.0/&quot;</span>;</div>
<div class="line">        var myNewContainer = createContainerItem(myString, <span class="stringliteral">&quot;email&quot;</span>);</div>
<div class="line">        setProperty(myString, <span class="stringliteral">&quot;email/*[1]&quot;</span>, <span class="stringliteral">&quot;someone@adobe.com&quot;</span>);</div>
<div class="line">    }</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_creating_a_document_template"></a>
Creating a document template</h3>
<p>This example creates a new document, defines slug and bleed areas, adds information to the document's XMP metadata, sets up master pages, adds page footers, and adds job information to a table in the slug area. (For the complete script, see DocumentTemplate.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Set the application default margin preferences.</span></div>
<div class="line">    with (app.marginPreferences){</div>
<div class="line">        <span class="comment">//Save the current application default margin preferences.</span></div>
<div class="line">        var myY1 = top;</div>
<div class="line">        var myX1 = left;</div>
<div class="line">        var myY2 = bottom;</div>
<div class="line">        var myX2 = right;</div>
<div class="line">        <span class="comment">//Set the application default margin preferences.</span></div>
<div class="line">        <span class="comment">//Document baseline grid will be based on 14 points, and</span></div>
<div class="line">        <span class="comment">//all margins are set in increments of 14 points.</span></div>
<div class="line">        top = 14 * 4 + <span class="stringliteral">&quot;pt&quot;</span>;</div>
<div class="line">        left = 14 * 4 + <span class="stringliteral">&quot;pt&quot;</span>;</div>
<div class="line">        bottom = <span class="stringliteral">&quot;74pt&quot;</span>;</div>
<div class="line">        right = 14 * 5 + <span class="stringliteral">&quot;pt&quot;</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Make a new document.</span></div>
<div class="line">    var myDocument = app.documents.add();</div>
<div class="line">    myDocument.documentPreferences.pageWidth = <span class="stringliteral">&quot;7i&quot;</span>;</div>
<div class="line">    myDocument.documentPreferences.pageHeight = <span class="stringliteral">&quot;9i&quot;</span>;</div>
<div class="line">    myDocument.documentPreferences.pageOrientation = PageOrientation.portrait;</div>
<div class="line">    <span class="comment">//At this point, we can reset the application </span></div>
<div class="line">    <span class="comment">//default margins to their original state.</span></div>
<div class="line">    with (app.marginPreferences){</div>
<div class="line">        top = myY1;</div>
<div class="line">        left = myX1;</div>
<div class="line">        bottom = myY2;</div>
<div class="line">        right = myX2;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Set up the bleed and slug areas.</span></div>
<div class="line">    with(myDocument.documentPreferences){</div>
<div class="line">        <span class="comment">//Bleed</span></div>
<div class="line">        documentBleedBottomOffset = <span class="stringliteral">&quot;3p&quot;</span>;</div>
<div class="line">        documentBleedTopOffset = <span class="stringliteral">&quot;3p&quot;</span>;</div>
<div class="line">        documentBleedInsideOrLeftOffset = <span class="stringliteral">&quot;3p&quot;</span>;</div>
<div class="line">        documentBleedOutsideOrRightOffset = <span class="stringliteral">&quot;3p&quot;</span>;</div>
<div class="line">        <span class="comment">//Slug</span></div>
<div class="line">        slugBottomOffset = <span class="stringliteral">&quot;18p&quot;</span>;</div>
<div class="line">        slugTopOffset = <span class="stringliteral">&quot;3p&quot;</span>;</div>
<div class="line">        slugInsideOrLeftOffset = <span class="stringliteral">&quot;3p&quot;</span>;</div>
<div class="line">        slugRightOrOutsideOffset = <span class="stringliteral">&quot;3p&quot;</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Create a color.</span></div>
<div class="line">    <span class="keywordflow">try</span>{</div>
<div class="line">        myDocument.colors.item(<span class="stringliteral">&quot;PageNumberRed&quot;</span>).name;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span> (myError){</div>
<div class="line">        myDocument.colors.add({name:<span class="stringliteral">&quot;PageNumberRed&quot;</span>, model:ColorModel.process,colorValue:[20, 100, 80, 10]});</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Next, set up some default styles.</span></div>
<div class="line">    <span class="comment">//Create up a character style for the page numbers.</span></div>
<div class="line">    <span class="keywordflow">try</span>{</div>
<div class="line">        myDocument.characterStyles.item(<span class="stringliteral">&quot;page_number&quot;</span>).name;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span> (myError){</div>
<div class="line">        myDocument.characterStyles.add({name:<span class="stringliteral">&quot;page_number&quot;</span>});</div>
<div class="line">    }</div>
<div class="line">    myDocument.characterStyles.item(<span class="stringliteral">&quot;page_number&quot;</span>).fillColor</div>
<div class="line">        = myDocument.colors.item(<span class="stringliteral">&quot;PageNumberRed&quot;</span>);</div>
<div class="line">    <span class="comment">//Create a pair of paragraph styles for the page footer text.</span></div>
<div class="line">    <span class="comment">//These styles have only basic formatting.</span></div>
<div class="line">    <span class="keywordflow">try</span>{</div>
<div class="line">        myDocument.paragraphStyles.item(<span class="stringliteral">&quot;footer_left&quot;</span>).name;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span> (myError){</div>
<div class="line">        myDocument.paragraphStyles.add({name:<span class="stringliteral">&quot;footer_left&quot;</span>, pointSize:11,leading:14});</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Create a paragraph style for the page footer text.</span></div>
<div class="line">    <span class="keywordflow">try</span>{</div>
<div class="line">        myDocument.paragraphStyles.item(<span class="stringliteral">&quot;footer_right&quot;</span>).name;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span> (myError){</div>
<div class="line">        myDocument.paragraphStyles.add({name:<span class="stringliteral">&quot;footer_right&quot;</span>,basedOn:myDocument.paragraphStyles.item(<span class="stringliteral">&quot;footer_left&quot;</span>),justification:Justification.rightAlign, pointSize:11, leading:14});</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Create a layer for guides.</span></div>
<div class="line">    <span class="keywordflow">try</span>{</div>
<div class="line">        myDocument.layers.item(<span class="stringliteral">&quot;GuideLayer&quot;</span>).name;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span> (myError){</div>
<div class="line">        myDocument.layers.add({name:<span class="stringliteral">&quot;GuideLayer&quot;</span>});</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Create a layer for the footer items.</span></div>
<div class="line">    <span class="keywordflow">try</span>{</div>
<div class="line">        myDocument.layers.item(<span class="stringliteral">&quot;Footer&quot;</span>).name;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span> (myError){</div>
<div class="line">        myDocument.layers.add({name:<span class="stringliteral">&quot;Footer&quot;</span>});</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Create a layer for the slug items.</span></div>
<div class="line">    <span class="keywordflow">try</span>{</div>
<div class="line">        myDocument.layers.item(<span class="stringliteral">&quot;Slug&quot;</span>).name;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span> (myError){</div>
<div class="line">        myDocument.layers.add({name:<span class="stringliteral">&quot;Slug&quot;</span>});</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Create a layer for the body text.</span></div>
<div class="line">    <span class="keywordflow">try</span>{</div>
<div class="line">        myDocument.layers.item(<span class="stringliteral">&quot;BodyText&quot;</span>).name;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span> (myError){</div>
<div class="line">        myDocument.layers.add({name:<span class="stringliteral">&quot;BodyText&quot;</span>});</div>
<div class="line">    }</div>
<div class="line">    with(myDocument.viewPreferences){</div>
<div class="line">        rulerOrigin = RulerOrigin.pageOrigin;</div>
<div class="line">        horizontalMeasurementUnits = MeasurementUnits.points;</div>
<div class="line">        verticalMeasurementUnits = MeasurementUnits.points;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Document baseline grid and document grid</span></div>
<div class="line">    with(myDocument.gridPreferences){</div>
<div class="line">        baselineStart = 56;</div>
<div class="line">        baselineDivision = 14;</div>
<div class="line">        baselineShown = <span class="keyword">false</span>;</div>
<div class="line">        horizontalGridlineDivision = 14;</div>
<div class="line">        horizontalGridSubdivision = 5</div>
<div class="line">        verticalGridlineDivision = 14;</div>
<div class="line">        verticalGridSubdivision = 5</div>
<div class="line">        documentGridShown = <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Document XMP information.</span></div>
<div class="line">    with (myDocument.metadataPreferences){</div>
<div class="line">        author = <span class="stringliteral">&quot;Adobe Systems&quot;</span>;</div>
<div class="line">        copyrightInfoURL = <span class="stringliteral">&quot;http://www.adobe.com&quot;</span>;</div>
<div class="line">        copyrightNotice = <span class="stringliteral">&quot;This document is not copyrighted.&quot;</span>;</div>
<div class="line">        copyrightStatus = CopyrightStatus.no;</div>
<div class="line">        description = <span class="stringliteral">&quot;Example 7 x 9 book layout&quot;</span>;</div>
<div class="line">        documentTitle = <span class="stringliteral">&quot;Example&quot;</span>;</div>
<div class="line">        jobName = <span class="stringliteral">&quot;7 x 9 book layout template&quot;</span>;</div>
<div class="line">        keywords = [<span class="stringliteral">&quot;7 x 9&quot;</span>, <span class="stringliteral">&quot;book&quot;</span>, <span class="stringliteral">&quot;template&quot;</span>];</div>
<div class="line">        var myURL = <span class="stringliteral">&quot;http://ns.adobe.com/xap/1.0/&quot;</span>;</div>
<div class="line">        var myNewContainer = createContainerItem(myURL, <span class="stringliteral">&quot;email&quot;</span>);</div>
<div class="line">        setProperty(myURL, <span class="stringliteral">&quot;email/*[1]&quot;</span>, <span class="stringliteral">&quot;someone@adobe.com&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Set up the master spread.</span></div>
<div class="line">    with(myDocument.masterSpreads.item(0)){</div>
<div class="line">        with(pages.item(0)){</div>
<div class="line">            <span class="comment">//Left and right are reversed for left-hand pages (becoming &quot;inside&quot;</span></div>
<div class="line">            <span class="comment">//and &quot;outside&quot;--this is also true in the InDesign user interface).</span></div>
<div class="line">            var myBottomMargin = myDocument.documentPreferences.pageHeight - marginPreferences.bottom;</div>
<div class="line">            var myRightMargin = myDocument.documentPreferences.pageWidth - marginPreferences.left;</div>
<div class="line">            guides.add(myDocument.layers.item(<span class="stringliteral">&quot;GuideLayer&quot;</span>), {orientation:HorizontalOrVertical.vertical,location:marginPreferences.right});</div>
<div class="line">            guides.add(myDocument.layers.item(<span class="stringliteral">&quot;GuideLayer&quot;</span>), {orientation:HorizontalOrVertical.vertical,location:myRightMargin});</div>
<div class="line">            guides.add(myDocument.layers.item(<span class="stringliteral">&quot;GuideLayer&quot;</span>), {orientation:HorizontalOrVertical.horizontal,location:marginPreferences.top, fitToPage:<span class="keyword">false</span>});</div>
<div class="line">            guides.add(myDocument.layers.item(<span class="stringliteral">&quot;GuideLayer&quot;</span>), {orientation:HorizontalOrVertical.horizontal,location:myBottomMargin, fitToPage:<span class="keyword">false</span>});</div>
<div class="line">            guides.add(myDocument.layers.item(<span class="stringliteral">&quot;GuideLayer&quot;</span>), {orientation:HorizontalOrVertical.horizontal,location:myBottomMargin + 14, fitToPage:<span class="keyword">false</span>});</div>
<div class="line">            guides.add(myDocument.layers.item(<span class="stringliteral">&quot;GuideLayer&quot;</span>), {orientation:HorizontalOrVertical.horizontal,location:myBottomMargin + 28, fitToPage:<span class="keyword">false</span>});</div>
<div class="line">            var myLeftFooter = textFrames.add(myDocument.layers.item(<span class="stringliteral">&quot;Footer&quot;</span>),undefined, undefined,{geometricBounds:[myBottomMargin+14,marginPreferences.right,myBottomMargin+28,myRightMargin]})</div>
<div class="line">            with (myLeftFooter.parentStory.insertionPoints.item(0)) {</div>
<div class="line">                contents = SpecialCharacters.sectionMarker;</div>
<div class="line">                contents = SpecialCharacters.emSpace;</div>
<div class="line">                contents = SpecialCharacters.autoPageNumber;</div>
<div class="line">            }</div>
<div class="line">            with (myLeftFooter.parentStory.characters.item(0)){</div>
<div class="line">                appliedCharacterStyle= myDocument.characterStyles.item(<span class="stringliteral">&quot;page_number&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">            with (myLeftFooter.parentStory.paragraphs.item(0)){</div>
<div class="line">                applyParagraphStyle(myDocument.paragraphStyles.item(<span class="stringliteral">&quot;footer_left&quot;</span>,<span class="keyword">false</span>));</div>
<div class="line">            }</div>
<div class="line">            <span class="comment">//Slug information.</span></div>
<div class="line">            with(myDocument.metadataPreferences){</div>
<div class="line">                var myString = <span class="stringliteral">&quot;Author:\t&quot;</span> + author + <span class="stringliteral">&quot;\tDescription:\t&quot;</span> + description + <span class="stringliteral">&quot;\rCreation Date:\t&quot;</span>+ <span class="keyword">new</span> Date + <span class="stringliteral">&quot;\tEmail Contact\t&quot;</span>+ getProperty(<span class="stringliteral">&quot;http://ns.adobe.com/xap/1.0/&quot;</span>,<span class="stringliteral">&quot;email/*[1]&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">            var myLeftSlug = textFrames.add(myDocument.layers.item(<span class="stringliteral">&quot;Slug&quot;</span>),undefined, undefined,{geometricBounds:[myDocument.documentPreferences.pageHeight+36,marginPreferences.right,myDocument.documentPreferences.pageHeight + 144,myRightMargin], contents:myString});</div>
<div class="line">            myLeftSlug.parentStory.texts.item(0).convertToTable();</div>
<div class="line">            <span class="comment">//Body text master text frame.</span></div>
<div class="line">            var myLeftFrame = textFrames.add(myDocument.layers.item(<span class="stringliteral">&quot;BodyText&quot;</span>),undefined, undefined,{geometricBounds:[marginPreferences.top,marginPreferences.right,myBottomMargin, myRightMargin]});</div>
<div class="line">        }</div>
<div class="line">        with(pages.item(1)){</div>
<div class="line">            var myBottomMargin = myDocument.documentPreferences.pageHeight - marginPreferences.bottom;</div>
<div class="line">            var myRightMargin = myDocument.documentPreferences.pageWidth - marginPreferences.right;</div>
<div class="line">            guides.add(myDocument.layers.item(<span class="stringliteral">&quot;GuideLayer&quot;</span>),{orientation:HorizontalOrVertical.vertical,location:marginPreferences.left}         );</div>
<div class="line">            guides.add(myDocument.layers.item(<span class="stringliteral">&quot;GuideLayer&quot;</span>),{orientation:HorizontalOrVertical.vertical,location:myRightMargin});</div>
<div class="line">            var myRightFooter = textFrames.add(myDocument.layers.item(<span class="stringliteral">&quot;Footer&quot;</span>),undefined, undefined,{geometricBounds:[myBottomMargin+14, marginPreferences.left,myBottomMargin+28, myRightMargin]})</div>
<div class="line">            with (myRightFooter.parentStory.insertionPoints.item(0)) {</div>
<div class="line">                contents = SpecialCharacters.autoPageNumber;</div>
<div class="line">                contents = SpecialCharacters.emSpace;</div>
<div class="line">                contents = SpecialCharacters.sectionMarker;</div>
<div class="line">            }</div>
<div class="line">            with (myRightFooter.parentStory.characters.item(-1)) {</div>
<div class="line">                appliedCharacterStyle = myDocument.characterStyles.item(<span class="stringliteral">&quot;page_number&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">            with (myRightFooter.parentStory.paragraphs.item(0)) {</div>
<div class="line">                applyParagraphStyle(myDocument.paragraphStyles.item(<span class="stringliteral">&quot;footer_right&quot;</span>),<span class="keyword">false</span>);</div>
<div class="line">            }</div>
<div class="line">            <span class="comment">//Slug information.</span></div>
<div class="line">            var myRightSlug = textFrames.add(myDocument.layers.item(<span class="stringliteral">&quot;Slug&quot;</span>),undefined, undefined,{geometricBounds:[myDocument.documentPreferences.pageHeight+36,marginPreferences.left,myDocument.documentPreferences.pageHeight + 144,myRightMargin], contents:myString});</div>
<div class="line">            myRightSlug.parentStory.texts.item(0).convertToTable();</div>
<div class="line">            <span class="comment">//Body text master text frame.</span></div>
<div class="line">            var myRightFrame = textFrames.add(myDocument.layers.item(<span class="stringliteral">&quot;BodyText&quot;</span>),undefined, undefined,{geometricBounds:[marginPreferences.top, marginPreferences.left,myBottomMargin, myRightMargin],previousTextFrame:myLeftFrame});</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Add section marker text--this text will appear in the footer.</span></div>
<div class="line">    myDocument.sections.item(0).marker = <span class="stringliteral">&quot;Section 1&quot;</span>;</div>
<div class="line">    <span class="comment">//When you link the master page text frames, one of the frames sometimes becomes</span></div>
<div class="line">    <span class="comment">//selected. Deselect it.</span></div>
<div class="line">    app.select(NothingEnum.nothing, undefined);</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_creating_watermarks"></a>
Creating watermarks</h3>
<p>You can apply watermarks to documents in InDesign or InDesign Server using scripting. Currently, no user interface component exists in InDesign for managing watermarks.</p>
<p>A document's watermark preferences can be set in two ways using scripting:</p>
<ul>
<li>Application-level watermark preferences, if any are set, are applied to the document watermark preferences for each new document created by InDesign. This setting has no effect on existing documents.</li>
<li>Document-level watermark preferences apply only to that document. Setting or changing a document's watermark preferences replaces any previous watermark settings for the document.</li>
</ul>
<p>Both the document and application watermark preference settings persist after the document or application is closed until a script changes them.</p>
<p>The same group of watermark preferences exist for both the document and the application objects.</p>
<p><b>Setting watermark preferences</b></p>
<p>The following script fragment shows how to set watermarks at the application level. A watermark will be applied to all documents created after this code finishes. (For the complete script for setting application preferences, see ApplicationWatermark.) </p>
<div class="fragment"><div class="line">    app.watermarkPreferences.watermarkVisibility = <span class="keyword">true</span>;</div>
<div class="line">    app.watermarkPreferences.watermarkDoPrint = <span class="keyword">true</span>;</div>
<div class="line">    app.watermarkPreferences.watermarkDrawInBack = <span class="keyword">true</span>;</div>
<div class="line">    app.watermarkPreferences.watermarkText = <span class="stringliteral">&quot;Confidential&quot;</span>;</div>
<div class="line">    app.watermarkPreferences.watermarkFontFamily = <span class="stringliteral">&quot;Arial&quot;</span>;</div>
<div class="line">    app.watermarkPreferences.watermarkFontStyle = <span class="stringliteral">&quot;Bold&quot;</span>;</div>
<div class="line">    app.watermarkPreferences.watermarkFontPointSize = 72;</div>
<div class="line">    app.watermarkPreferences.watermarkFontColor = UIColors.red; </div>
<div class="line">    app.watermarkPreferences.watermarkOpacity = 60;</div>
<div class="line">    app.watermarkPreferences.watermarkRotation = -45;</div>
<div class="line">    app.watermarkPreferences.watermarkHorizontalPosition = WatermarkHorizontalPositionEnum.watermarkHCenter;</div>
<div class="line">    app.watermarkPreferences.watermarkHorizontalOffset = 0;</div>
<div class="line">    app.watermarkPreferences.watermarkVerticalPosition = WatermarkVerticalPositionEnum.watermarkVCenter;</div>
<div class="line">    app.watermarkPreferences.watermarkVerticalOffset = 0;</div>
</div><!-- fragment --><p> The same preferences can be applied to a document object by referring to a document, rather than to the application. (For the complete script for setting document preferences, see DocumentWatermark.) </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    myDocument.watermarkPreferences.watermarkVisibility = <span class="keyword">true</span>;</div>
<div class="line">    myDocument.watermarkPreferences.watermarkDoPrint = <span class="keyword">true</span>;</div>
<div class="line">    myDocument.watermarkPreferences.watermarkDrawInBack = <span class="keyword">true</span>;</div>
<div class="line">    myDocument.watermarkPreferences.watermarkText = <span class="stringliteral">&quot;Confidential&quot;</span>;</div>
<div class="line">    myDocument.watermarkPreferences.watermarkFontFamily = <span class="stringliteral">&quot;Arial&quot;</span>;</div>
<div class="line">    myDocument.watermarkPreferences.watermarkFontStyle = <span class="stringliteral">&quot;Bold&quot;</span>;</div>
<div class="line">    myDocument.watermarkPreferences.watermarkFontPointSize = 72;</div>
<div class="line">    myDocument.watermarkPreferences.watermarkFontColor = UIColors.blue; </div>
<div class="line">    myDocument.watermarkPreferences.watermarkOpacity = 60;</div>
<div class="line">    myDocument.watermarkPreferences.watermarkRotation = -45;</div>
<div class="line">    myDocument.watermarkPreferences.watermarkHorizontalPosition = WatermarkHorizontalPositionEnum.watermarkHCenter;</div>
<div class="line">    myDocument.watermarkPreferences.watermarkHorizontalOffset = 0;</div>
<div class="line">    myDocument.watermarkPreferences.watermarkVerticalPosition = WatermarkVerticalPositionEnum.watermarkVCenter;</div>
<div class="line">    myDocument.watermarkPreferences.watermarkVerticalOffset = 0;</div>
</div><!-- fragment --><p> <b>Disabling watermarks</b></p>
<p>After turning off the application setting for watermarks, InDesign no longer turns on the watermark settings for new documents by default. However, you can still set watermarks for individual documents. The following script fragment shows how to turn off application-level watermarks. </p>
<div class="fragment"><div class="line">app.watermarkPreferences.watermarkVisibility = <span class="keyword">false</span>;</div>
</div><!-- fragment --><p>You can turn off watermarks in an individual document at any time, as shown in the following script fragment. </p>
<div class="fragment"><div class="line">app.documents.item(0).watermarkPreferences.watermarkVisibility = <span class="keyword">false</span>;</div>
</div><!-- fragment --><h2><a class="anchor" id="id_js_adjusting_page_sizes_and_layout"></a>
Adjusting Page Sizes and Layout</h2>
<p>InDesign allows different page sizes within a single InDesign document. For information on setting the default page size, see <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_defining_page_size_and_document_length">Defining page size and document length</a>.</p>
<p>You can also apply geometric transformations to individual pages.</p>
<h3><a class="anchor" id="id_js_selecting_pages"></a>
Selecting pages</h3>
<p>Before changing a page's size or applying a transformation to the page, you must select the page. In the InDesign user interface, you do this using the Page Tool on the Tools Panel. You can also select a page using scripting. The following script shows how. (For the complete script, see PageSelect.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a document with four pages (0, 1, 2, 3)...</span></div>
<div class="line">    var myDocument = app.activeDocument;</div>
<div class="line">    var myPages = myDocument.pages;</div>
<div class="line">    <span class="comment">//Select page 1 and 2.</span></div>
<div class="line">    myPages.item(1).select();</div>
<div class="line">    myPages.item(2).select(SelectionOptions.ADD_TO);</div>
<div class="line">    <span class="comment">//Select last page.</span></div>
<div class="line">    myDocument.select(myPages.item(-1), SelectionOptions.ADD_TO);</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_resizing_and_reframing_pages"></a>
Resizing and reframing pages</h3>
<p>You can resize or reframe page items on a page by scripting. You can also apply the resize and reframe operations to pages to change their sizes. </p>
<dl class="section note"><dt>Note</dt><dd>Your minimum page size is determined by the page's margins. See <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_setting_page_margins_and_columns">Setting page margins and columns</a> for more information.</dd></dl>
<p>The following script shows how to change a page's size using the resize method. (For the complete script, see PageResize.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a document with four pages (0, 1, 2, 3)...</span></div>
<div class="line">    var myDocument = app.activeDocument;</div>
<div class="line">    var myPages = myDocument.pages;</div>
<div class="line">    <span class="comment">//Resize page to two times bigger</span></div>
<div class="line">    myPages.item(1).resize(CoordinateSpaces.INNER_COORDINATES,</div>
<div class="line">                                    AnchorPoint.CENTER_ANCHOR,</div>
<div class="line">                                    ResizeMethods.MULTIPLYING_CURRENT_DIMENSIONS_BY,</div>
<div class="line">                                    [2, 2]);</div>
<div class="line">    <span class="comment">//Resize page to 400 points width and 600 points height.</span></div>
<div class="line">    myPages.item(2).resize(CoordinateSpaces.INNER_COORDINATES,</div>
<div class="line">                                    AnchorPoint.CENTER_ANCHOR,</div>
<div class="line">                                    ResizeMethods.REPLACING_CURRENT_DIMENSIONS_WITH,</div>
<div class="line">                                    [400, 600]);</div>
</div><!-- fragment --><p> Reframing changes the bounding box of a page, so reframing can be used to change a page's size by making the bounding box larger or smaller. The following script shows how to change a page's size using the reframe method. (For the complete script, see PageReframe.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a document with four pages (0, 1, 2, 3)...</span></div>
<div class="line">    var myDocument = app.activeDocument;</div>
<div class="line">    var myPages = myDocument.pages;</div>
<div class="line">    <span class="comment">//Make the page one inch wider and one inch higher.</span></div>
<div class="line">    var myPage = myPages.item(1);</div>
<div class="line">    var myBounds = myPage.bounds;</div>
<div class="line">    var myY1 = myBounds[0];</div>
<div class="line">    var myX1 = myBounds[1];</div>
<div class="line">    var myY2 = myBounds[2]+72;</div>
<div class="line">    var myX2 = myBounds[3]+72;</div>
<div class="line">    myPage.reframe(CoordinateSpaces.INNER_COORDINATES, [[myX1, myY1], [myX2, myY2]]);</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_transforming_pages"></a>
Transforming pages</h3>
<p>Operations that change the geometry of objects are called transformations. The transform method can rotate, scale, shear, and move (translate) page items on a page and can also be used on pages. For technical details about transformation architecture, refer to <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_transforming_page_items">Transforming Page Items</a>.</p>
<p>To transform a page:</p>
<ol type="1">
<li>Create a transformation matrix.</li>
<li>Apply the transformation matrix to the page using the transform method.</li>
</ol>
<p>The following script shows how to transform a page with scripting. (For the complete script, see PageTransform.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a document with four pages (0, 1, 2, 3)...</span></div>
<div class="line">    var myDocument = app.activeDocument;</div>
<div class="line">    var myPages = myDocument.pages;</div>
<div class="line"></div>
<div class="line">    <span class="comment">//Rotate a page around its center point.</span></div>
<div class="line">    var myRotateMatrix = app.transformationMatrices.add({counterclockwiseRotationAngle:27});</div>
<div class="line">    myTransform(myPages.item(0), myRotateMatrix);</div>
<div class="line"></div>
<div class="line">    <span class="comment">//Scale a page around its center point.</span></div>
<div class="line">    var myScaleMatrix = app.transformationMatrices.add({horizontalScaleFactor:0.8, verticalScaleFactor:0.8});</div>
<div class="line">    myTransform(myPages.item(1), myScaleMatrix);</div>
<div class="line"></div>
<div class="line">    <span class="comment">//Shear a page around its center point.</span></div>
<div class="line">    var myShearMatrix = app.transformationMatrices.add({clockwiseShearAngle:30});</div>
<div class="line">    myTransform(myPages.item(2), myShearMatrix);</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">function</span> myTransform(myPage, myTransformationMatrix)</div>
<div class="line">{</div>
<div class="line">    myPage.transform(CoordinateSpaces.PASTEBOARD_COORDINATES,</div>
<div class="line">                    AnchorPoint.CENTER_ANCHOR,</div>
<div class="line">                    myTransformationMatrix);</div>
<div class="line">}</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_master_page_overlay"></a>
Master page overlay</h3>
<p>Because pages can have multiple sizes, it is possible for a page and its master page to be different sizes. In addition to tracking which master is applied, pages also maintain a matrix that determines how the master page draws on the page. This is called the Master Page Overlay. When you select a page using the Page Tool on the Tools Panel, you can see how the master page is positioned by checking the Show Master Page Overlay checkbox on the control panel. You can move the overlay around with the mouse. InDesign achieves this by applying a transform to the master overlay matrix. Although the user interface allows only translation (moving x and y), you can do more by scripting. The following script shows how to transform a master page overlay. (For the complete script, see MasterPageTransform.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a document with four pages (0, 1, 2, 3)...</span></div>
<div class="line">    var myDocument = app.activeDocument;</div>
<div class="line">    var myPages = myDocument.pages;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">//Rotate master page overlay around its top-left corner.</span></div>
<div class="line">    var myRotateMatrix = app.transformationMatrices.add({counterclockwiseRotationAngle:27});</div>
<div class="line">    myPages.item(0).masterPageTransform = myRotateMatrix;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">//Scale master page overlay around its top-left corner.</span></div>
<div class="line">    var myScaleMatrix = app.transformationMatrices.add({horizontalScaleFactor:0.5, verticalScaleFactor:0.5});</div>
<div class="line">    myPages.item(1).masterPageTransform = myScaleMatrix;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">//Shear master page overlay around its top-left corner.</span></div>
<div class="line">    var myShearMatrix =app.transformationMatrices.add({clockwiseShearAngle:30});</div>
<div class="line">    myPages.item(2).masterPageTransform = myShearMatrix;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">//Translate master page overlay 1 inch right and 2 inches down.</span></div>
<div class="line">    var myTranslateMatrix = app.transformationMatrices.add({horizontalTranslation:72, verticalTranslation:144});</div>
<div class="line">    myPages.item(3).masterPageTransform = myTranslateMatrix;</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_making_an_adaptive_layout"></a>
Making an Adaptive Layout</h2>
<p>Using InDesign's layout adaptation workflow, you create your primary layout the same way that you would create it for a document that will be printed, but then you can quickly adapt that layout to another orientation, to another dimension or aspect ratio, or to a completely different device class. This workflow mainly involves two features: Liquid Layout makes the layout flexible, and Create Alternate Layout creates alternative layouts for different orientations and device classes.</p>
<h3><a class="anchor" id="id_js_making_a_flexible_layout"></a>
Making a flexible layout</h3>
<p>Using layout rules, a designer can create one InDesign file with one set of physical pages that can display their content suitably on different devices with different sizes and orientations. You can optionally control the pages' appearance for each size and orientation. The following example script shows how to do this. (For the complete script, see LiquidLayout.) </p>
<div class="fragment"><div class="line">    var doc = app.documents.add();</div>
<div class="line">    var myPage = doc.pages.item(0);</div>
<div class="line">    <span class="comment">//Set layout policy to LayoutPolicyOptions.OBJECT_BASED</span></div>
<div class="line">    <span class="comment">//Reposition and resize objects on the page as it resizes.</span></div>
<div class="line">    myPage.layoutRule = LayoutRuleOptions.OBJECT_BASED ;</div>
<div class="line">      <span class="comment">//Create a text frame on the first page.</span></div>
<div class="line">    var myTextFrame = myPage.textFrames.add({</div>
<div class="line">                geometricBounds:myGetBounds(doc, myPage), </div>
<div class="line">                contents:<span class="stringliteral">&quot;This is object-based layoutpolicy sample doc.&quot;</span></div>
<div class="line">              });</div>
<div class="line">    <span class="comment">//Create a rectangle</span></div>
<div class="line">    var myItem = myPage.rectangles.add({geometricBounds:[20,20,70,70]});</div>
<div class="line">    myItem.verticalLayoutConstraints = </div>
<div class="line">            [DimensionsConstraints.flexibleDimension, </div>
<div class="line">             DimensionsConstraints.flexibleDimension, </div>
<div class="line">             DimensionsConstraints.flexibleDimension];</div>
<div class="line">    myItem.horizontalLayoutConstraints = </div>
<div class="line">            [DimensionsConstraints.fixedDimension, </div>
<div class="line">             DimensionsConstraints.flexibleDimension, </div>
<div class="line">             DimensionsConstraints.flexibleDimension];</div>
<div class="line"></div>
<div class="line">    var doc2 = app.documents.add();</div>
<div class="line">    var myPage2 = doc2.pages.item(0);</div>
<div class="line">    <span class="comment">//Set layout policy to LayoutPolicyOptions.SCALE</span></div>
<div class="line">    <span class="comment">//Scale objects on the page as it resizes. </span></div>
<div class="line">    myPage2.layoutRule = LayoutRuleOptions.SCALE;  </div>
<div class="line">      <span class="comment">//Create a text frame on the first page.</span></div>
<div class="line">    var myTextFrame2 = myPage2.textFrames.add({</div>
<div class="line">              geometricBounds:myGetBounds(doc2, myPage2), </div>
<div class="line">              contents:<span class="stringliteral">&quot;This is scale layoutpolicy sample doc.&quot;</span></div>
<div class="line">            });</div>
<div class="line">    var myItem2 = myPage2.rectangles.add({geometricBounds:[20,20,70,70]});</div>
<div class="line">    </div>
<div class="line">    var doc3 = app.documents.add();</div>
<div class="line">    var myPage3 = doc3.pages.item(0);</div>
<div class="line">    <span class="comment">//Set layout policy to LayoutPolicyOptions.RECENTER</span></div>
<div class="line">    <span class="comment">//Recenter objects on the page as it resizes.</span></div>
<div class="line">    myPage3.layoutRule = LayoutRuleOptions.RECENTER; </div>
<div class="line">      <span class="comment">//Create a text frame on the first page.</span></div>
<div class="line">    var myTextFrame = myPage3.textFrames.add({</div>
<div class="line">              geometricBounds:myGetBounds(doc3, myPage3), </div>
<div class="line">              contents:<span class="stringliteral">&quot;This is recenter layoutpolicy sample doc.&quot;</span></div>
<div class="line">            });</div>
<div class="line">    var myItem = myPage3.rectangles.add({geometricBounds:[20,20,70,70]});</div>
<div class="line">     </div>
<div class="line">    var doc4 = app.documents.add();</div>
<div class="line">    var myPage4 = doc4.pages.item(0);</div>
<div class="line">    <span class="comment">//Set layout policy to LayoutPolicyOptions.GUIDE_BASED</span></div>
<div class="line">    <span class="comment">//Use guide slicing to resize objects on the page as it resizes.</span></div>
<div class="line">    myPage4.layoutRule = LayoutRuleOptions.GUIDE_BASED; </div>
<div class="line">    <span class="comment">//Create a text frame on the first page.</span></div>
<div class="line">    var myTextFrame4 = myPage4.textFrames.add({</div>
<div class="line">             geometricBounds:myGetBounds(doc4, myPage4), </div>
<div class="line">             contents:<span class="stringliteral">&quot;This is guide-based layoutpolicy sample doc.&quot;</span></div>
<div class="line">           });</div>
<div class="line">    var myItem4 = myPage4.rectangles.add({geometricBounds:[20,20,70,70]});</div>
<div class="line">    with(doc4)</div>
<div class="line">    {</div>
<div class="line">        guides.add({</div>
<div class="line">            guideType:GuideTypeOptions.LIQUID,</div>
<div class="line">            location:40, </div>
<div class="line">            orientation:HorizontalOrVertical.horizontal});</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    var doc5 = app.documents.add();</div>
<div class="line">    var myPage5 = doc5.pages.item(0);</div>
<div class="line">    <span class="comment">//Set layout policy to LayoutPolicyOptions.USE_MASTER</span></div>
<div class="line">    <span class="comment">//Use layout policy from the page&#39;s applied master page.</span></div>
<div class="line">    myPage5.layoutRule = LayoutRuleOptions.USE_MASTER; </div>
<div class="line">    <span class="comment">//Create a text frame on the first page.</span></div>
<div class="line">    var myTextFrame5 = myPage5.textFrames.add(</div>
<div class="line">            {geometricBounds:myGetBounds(doc5, myPage5), </div>
<div class="line">            contents:<span class="stringliteral">&quot;This is master page layoutpolicy sample doc.&quot;</span></div>
<div class="line">          });</div>
<div class="line">    var myItem5 = myPage5.rectangles.add({geometricBounds:[20,20,70,70]});</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_adding_guides_for_a_guide-based_layout"></a>
Adding guides for a guide-based layout</h3>
<p>The following example script shows how to add guide slices for guide-based layout rules. (For the complete script, see AddGuides.) </p>
<div class="fragment"><div class="line">    var doc = app.documents.add();</div>
<div class="line">    var myPage = doc.pages.item(0);</div>
<div class="line">    <span class="comment">//Use guide slicing to resize objects on the page as it resizes.</span></div>
<div class="line">    myPage.layoutRule = LayoutRuleOptions.GUIDE_BASED; </div>
<div class="line">      <span class="comment">//Create a text frame on the first page.</span></div>
<div class="line">    var myTextFrame = myPage.textFrames.add({</div>
<div class="line">            geometricBounds:myGetBounds(doc, myPage), </div>
<div class="line">            contents:<span class="stringliteral">&quot;This is guide-based LayoutRule sample doc.&quot;</span></div>
<div class="line">            });</div>
<div class="line">    var myItem = myPage.rectangles.add({geometricBounds:[20,20,70,70]});</div>
<div class="line">    </div>
<div class="line">    with(doc)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">//add guide slice</span></div>
<div class="line">        guides.add({</div>
<div class="line">              guideType:GuideTypeOptions.LIQUID, </div>
<div class="line">              location:20, </div>
<div class="line">              orientation:HorizontalOrVertical.horizontal</div>
<div class="line">            });</div>
<div class="line">    }</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_setting_constraints_for_an_object-based_layout"></a>
Setting constraints for an object-based layout</h3>
<p>The following example script shows how to set constraints for object-based layout rules. (For the complete script, see SetConstraints.) </p>
<div class="fragment"><div class="line">    var doc = app.documents.add();</div>
<div class="line">    var myPage = doc.pages.item(0);</div>
<div class="line">    <span class="comment">//Reposition and resize objects on the page as it resizes.</span></div>
<div class="line">    myPage.layoutRule = LayoutRuleOptions.OBJECT_BASED ;</div>
<div class="line">    <span class="comment">//Create a text frame on the first page.</span></div>
<div class="line">    var myTextFrame = myPage.textFrames.add({</div>
<div class="line">                    geometricBounds:myGetBounds(doc, myPage), </div>
<div class="line">                    contents:<span class="stringliteral">&quot;This is object-based layoutRule sample doc.&quot;</span></div>
<div class="line">                  });</div>
<div class="line">    <span class="comment">//Create a rectangle</span></div>
<div class="line">    var myItem = myPage.rectangles.add({geometricBounds:[20,20,70,70]});</div>
<div class="line">    <span class="comment">//set constrains</span></div>
<div class="line">    myItem.verticalLayoutConstraints = </div>
<div class="line">            [DimensionsConstraints.flexibleDimension, </div>
<div class="line">             DimensionsConstraints.flexibleDimension, </div>
<div class="line">             DimensionsConstraints.flexibleDimension];</div>
<div class="line">    myItem.horizontalLayoutConstraints = </div>
<div class="line">            [DimensionsConstraints.fixedDimension, </div>
<div class="line">             DimensionsConstraints.flexibleDimension, </div>
<div class="line">             DimensionsConstraints.flexibleDimension];</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_creating_alternative_layouts"></a>
Creating alternative layouts</h3>
<p>Create Alternate Layout takes a range of existing pages with content and automatically creates linked copies of the content on a set of new pages within the same document. Use this when you need to create unique layouts for different orientations and device classes. (For the complete script, see CreateAlternateLayout.) </p>
<div class="fragment"><div class="line">myDoc = app.documents.add({</div>
<div class="line">                                documentPreferences: </div>
<div class="line">                                {</div>
<div class="line">                                    facingPages:<span class="keyword">false</span>, </div>
<div class="line">                                    pagesPerDocument:1, </div>
<div class="line">                                    pageWidth:1024, </div>
<div class="line">                                    pageHeight:768</div>
<div class="line">                                 }</div>
<div class="line">                        });</div>
<div class="line"><span class="comment">//Reposition and resize objects on the page as it resizes.</span></div>
<div class="line">myDoc.pages[0].layoutRule = LayoutRuleOptions.OBJECT_BASED ;</div>
<div class="line"></div>
<div class="line"> with (myDoc)</div>
<div class="line"> {</div>
<div class="line">    var myItem = pages[0].rectangles.add({geometricBounds:[50,50,100,100]});  </div>
<div class="line">    <span class="comment">//create alternate layout </span></div>
<div class="line">    myDoc.createAlternateLayout(myDoc.spreads, </div>
<div class="line">                                <span class="stringliteral">&quot;new layout&quot;</span>, </div>
<div class="line">                                myDoc.documentPreferences.pageHeight, </div>
<div class="line">                                myDoc.documentPreferences.pageWidth, </div>
<div class="line">                                <span class="keyword">true</span>, </div>
<div class="line">                                <span class="keyword">true</span>, </div>
<div class="line">                                LayoutRuleOptions.PRESERVE_EXISTING);</div>
<div class="line">  }</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_collecting_and_dropping_content"></a>
Collecting and Dropping Content</h2>
<p>With Content Dropper, you can copy the content from a file designed for printing and paste it into another document.</p>
<p>The following script shows how to collect content in a document using scripting. (For the complete script, see ContentCollectorAndPlacer.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Invoke Page.contentPlace with default parameters</span></div>
<div class="line">    myPage1.contentPlace(myPage.textFrames);  </div>
</div><!-- fragment --><p> The following script shows how to place collected content into another document. (For the complete script, see ContentCollectorAndPlacer.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Invoke Page.contentPlace with full parameters</span></div>
<div class="line">    myPage1.contentPlace(myPage.checkBoxes,          <span class="comment">//One or more page items to place or load</span></div>
<div class="line">                           <span class="keyword">true</span>,                     <span class="comment">//Whether to link pageItems in content placer (Optional)</span></div>
<div class="line">                           <span class="keyword">true</span>,                     <span class="comment">//Whether to link stories in content placer (Optional)</span></div>
<div class="line">                           <span class="keyword">true</span>,                     <span class="comment">//Whether to map styles in content placer (Optional)</span></div>
<div class="line">                           [0, 0, 40, 40],           <span class="comment">//The point at which to place (Optional)</span></div>
<div class="line">                           myDocument1.activeLayer,  <span class="comment">//The layer on which to place (Optional)</span></div>
<div class="line">                           <span class="keyword">true</span>);                    <span class="comment">//Whether to display the link options dialog (Optional)</span></div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_printing_a_document"></a>
Printing a Document</h2>
<p>The following script prints the active document using the current print preferences. (For the complete script, see PrintDocument.) </p>
<div class="fragment"><div class="line">    <span class="comment">//The print() method has two optional parameters:</span></div>
<div class="line">    <span class="comment">//printDialog -- if false, do not display the Print dialog box.</span></div>
<div class="line">    <span class="comment">//using -- if specified, use a named printer preset.</span></div>
<div class="line">    <span class="comment">//The following line prints the document using the default</span></div>
<div class="line">    <span class="comment">//settings without displaying the Print dialog box.</span></div>
<div class="line">    myDocument.print(<span class="keyword">false</span>);</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_printing_using_page_ranges"></a>
Printing using page ranges</h3>
<p>To specify a page range to print, set the pageRange property of the document's print preferences object before printing, as shown in the following script fragment (from the PrintPageRange tutorial script): </p>
<div class="fragment"><div class="line">    <span class="comment">//The page range can be either PageRange.ALL_PAGES or a page range string.</span></div>
<div class="line">    <span class="comment">//A page number entered in the page range must correspond to a page</span></div>
<div class="line">    <span class="comment">//name in the document (i.e., not the page index). If the page name is</span></div>
<div class="line">    <span class="comment">//not found, InDesign will display an error message.</span></div>
<div class="line">    myDocument.printPreferences.pageRange = <span class="stringliteral">&quot;1-3,10&quot;</span>;</div>
<div class="line">    myDocument.print(<span class="keyword">false</span>);</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_setting_print_preferences"></a>
Setting print preferences</h3>
<p>The print preferences object contains properties corresponding to the options in the panels of the Print dialog. The following script shows how to set print preferences using scripting. (For the complete script, see PrintPreferences.) </p>
<div class="fragment"><div class="line">    with(myDocument.printPreferences){</div>
<div class="line">        <span class="comment">//Properties corresponding to the controls in the General panel </span></div>
<div class="line">        <span class="comment">//of the Print dialog box. activePrinterPreset is ignored in this </span></div>
<div class="line">        <span class="comment">//example--we&#39;ll set our own print preferences. printer can be </span></div>
<div class="line">        <span class="comment">//either a string (the name of the printer) or Printer.postscriptFile.</span></div>
<div class="line">        printer = Printer.postscriptFile;</div>
<div class="line">        <span class="comment">//Here&#39;s an example of setting the printer to a specific printer.</span></div>
<div class="line">        <span class="comment">//printer = &quot;AGFA-SelectSet 5000SF v2013.108&quot;;</span></div>
<div class="line">        <span class="comment">//If the printer property is the name of a printer, then the ppd property</span></div>
<div class="line">        <span class="comment">//is locked (and will return an error if you try to set it).</span></div>
<div class="line">        <span class="comment">//ppd = &quot;AGFA-SelectSet5000SF&quot;;</span></div>
<div class="line">        <span class="comment">//If the printer property is set to Printer.postscript file, the copies</span></div>
<div class="line">        <span class="comment">//property is unavailable. Attempting to set it will generate an error.</span></div>
<div class="line">        <span class="comment">//copies = 1;</span></div>
<div class="line">        <span class="comment">//If the printer property is set to Printer.postscript file, or if the</span></div>
<div class="line">        <span class="comment">//selected printer does not support collation, then the collating </span></div>
<div class="line">        <span class="comment">//property is unavailable. Attempting to set it will generate an error.</span></div>
<div class="line">        <span class="comment">//collating = false;</span></div>
<div class="line">        reverseOrder = <span class="keyword">false</span>;</div>
<div class="line">        <span class="comment">//pageRange can be either PageRange.allPages or a page range string.</span></div>
<div class="line">        pageRange = PageRange.allPages;</div>
<div class="line">        printSpreads = <span class="keyword">false</span>;</div>
<div class="line">        printMasterPages = <span class="keyword">false</span>;</div>
<div class="line">        <span class="comment">//If the printer property is set to Printer.postScript file, then</span></div>
<div class="line">        <span class="comment">//the printFile property contains the file path to the output file.</span></div>
<div class="line">        <span class="comment">//printFile = &quot;/c/test.ps&quot;;</span></div>
<div class="line">        sequence = Sequences.all;</div>
<div class="line">        <span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line">        <span class="comment">//Properties corresponding to the controls in the Output panel of the Print</span></div>
<div class="line">        <span class="comment">//dialog box.</span></div>
<div class="line">        <span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line">        <span class="comment">//negative = true;                                      </span></div>
<div class="line">        <span class="comment">//If a device independent PPD is specified, trying to set the colorOutput</span></div>
<div class="line">        <span class="comment">//parameter will result in an error.</span></div>
<div class="line">        <span class="keywordflow">try</span>{</div>
<div class="line">            colorOutput = ColorOutputModes.separations;</div>
<div class="line">            <span class="comment">//Note the lowercase &quot;i&quot; in &quot;Builtin&quot;</span></div>
<div class="line">            trapping = Trapping.applicationBuiltin;</div>
<div class="line">            flip = Flip.none;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span>(myError){}</div>
<div class="line">        <span class="comment">//If trapping is on, attempting to set the following properties will generate</span></div>
<div class="line">        <span class="comment">//an error. If trapping is not available for the selected output method/device,</span></div>
<div class="line">        <span class="comment">//attempting to get/set trapping properties will fail.</span></div>
<div class="line">        <span class="keywordflow">try</span>{</div>
<div class="line">            <span class="keywordflow">if</span>(trapping == Trapping.off){</div>
<div class="line">                printBlack = <span class="keyword">true</span>;</div>
<div class="line">                printCyan = <span class="keyword">true</span>;</div>
<div class="line">                printMagenta = <span class="keyword">true</span>;</div>
<div class="line">                printYellow = <span class="keyword">true</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span> (myError){}</div>
<div class="line">        <span class="comment">//Only change the ink angle and frequency when you want to override the</span></div>
<div class="line">        <span class="comment">//screening set by the screening specified by the screening property.</span></div>
<div class="line">        <span class="comment">//blackAngle = 45;</span></div>
<div class="line">        <span class="comment">//blackFrequency = 175;</span></div>
<div class="line">        <span class="comment">//cyanAngle = 15;</span></div>
<div class="line">        <span class="comment">//cyanFrequency = 175;</span></div>
<div class="line">        <span class="comment">//magentaAngle = 75;</span></div>
<div class="line">        <span class="comment">//magentaFreqency = 175;</span></div>
<div class="line">        <span class="comment">//yellowAngle = 0;</span></div>
<div class="line">        <span class="comment">//yellowFrequency = 175;</span></div>
<div class="line">        <span class="comment">//The following properties are not needed (because colorOutput is set to</span></div>
<div class="line">        <span class="comment">//separations).</span></div>
<div class="line">        <span class="comment">//compositeAngle = 45;</span></div>
<div class="line">        <span class="comment">//compositeFrequency = 175;</span></div>
<div class="line">        <span class="comment">//simulateOverprint = false;</span></div>
<div class="line">        <span class="comment">//If trapping is on, setting the following properties will produce an error.</span></div>
<div class="line">        <span class="keywordflow">try</span>{</div>
<div class="line">            <span class="keywordflow">if</span>(trapping == Trapping.off){</div>
<div class="line">                printBlankPages = <span class="keyword">false</span>;</div>
<div class="line">                printGuidesGrids = <span class="keyword">false</span>;</div>
<div class="line">                printNonprinting = <span class="keyword">false</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span>(myError){}</div>
<div class="line">        <span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line">        <span class="comment">//Properties corresponding to the controls in the Setup panel of the Print</span></div>
<div class="line">        <span class="comment">//dialog box.</span></div>
<div class="line">        <span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line">        <span class="keywordflow">try</span>{</div>
<div class="line">            paperSize = PaperSizes.custom;</div>
<div class="line">            <span class="comment">//Page width and height are ignored if paperSize is not PaperSizes.custom.</span></div>
<div class="line">            paperHeight = 1200;</div>
<div class="line">            paperWidth = 1200;</div>
<div class="line">            printPageOrientation = PrintPageOrientation.portrait;</div>
<div class="line">            pagePosition = PagePositions.centered;</div>
<div class="line">            paperGap = 0;</div>
<div class="line">            paperOffset = 0;</div>
<div class="line">            paperTransverse = <span class="keyword">false</span>;</div>
<div class="line">            scaleHeight = 100;</div>
<div class="line">            scaleWidth = 100;</div>
<div class="line">            scaleMode = ScaleModes.scaleWidthHeight;</div>
<div class="line">            scaleProportional = <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span>(myError){}</div>
<div class="line">        <span class="comment">//If trapping is on, attempting to set the following properties will produce</span></div>
<div class="line">        <span class="comment">//an error.</span></div>
<div class="line">        <span class="keywordflow">try</span>{</div>
<div class="line">            <span class="keywordflow">if</span>(trapping == Trapping.off){</div>
<div class="line">                textAsBlack = <span class="keyword">false</span>;</div>
<div class="line">                thumbnails = <span class="keyword">false</span>;</div>
<div class="line">                <span class="comment">//The following properties is not needed because thumbnails is set to</span></div>
<div class="line">                <span class="comment">//false.</span></div>
<div class="line">                <span class="comment">//thumbnailsPerPage = 4;</span></div>
<div class="line">                tile = <span class="keyword">false</span>;</div>
<div class="line">                <span class="comment">//The following properties are not needed because tile is set to false.</span></div>
<div class="line">                <span class="comment">//tilingOverlap = 12;</span></div>
<div class="line">                <span class="comment">//tilingType = TilingTypes.auto;</span></div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span>(myError){}</div>
<div class="line">    </div>
<div class="line">        <span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line">        <span class="comment">//Properties corresponding to the controls in the Marks and Bleed panel of</span></div>
<div class="line">        <span class="comment">//the Print dialog box.</span></div>
<div class="line">        <span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line">        <span class="comment">//Set the following property to true to print all printer&#39;s marks.</span></div>
<div class="line">        <span class="comment">//allPrinterMarks = true;</span></div>
<div class="line">        useDocumentBleedToPrint = <span class="keyword">false</span>;</div>
<div class="line">        <span class="comment">//If useDocumentBleedToPrint = false then setting any of the  bleed</span></div>
<div class="line">        <span class="comment">//properties will result in an error.</span></div>
<div class="line">        <span class="comment">//Get the bleed amounts from the document&#39;s bleed and add a bit.</span></div>
<div class="line">        var myDocumentPreferences = myDocument.documentPreferences;</div>
<div class="line">        bleedBottom = myDocumentPreferences.documentBleedBottomOffset+3;</div>
<div class="line">        bleedTop = myDocumentPreferences.documentBleedTopOffset+3;</div>
<div class="line">        bleedInside = myDocumentPreferences.documentBleedInsideOrLeftOffset+3;</div>
<div class="line">        bleedOutside = myDocumentPreferences.documentBleedOutsideOrRightOffset+3;</div>
<div class="line">        <span class="comment">//If any bleed area is greater than zero, then export the bleed marks.</span></div>
<div class="line">        <span class="keywordflow">if</span>(bleedBottom &amp;&amp; bleedTop &amp;&amp; bleedInside &amp;&amp; bleedOutside){</div>
<div class="line">            bleedMarks = <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span>{</div>
<div class="line">            bleedMarks = <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">        colorBars = <span class="keyword">true</span>;</div>
<div class="line">        cropMarks = <span class="keyword">true</span>;</div>
<div class="line">        includeSlugToPrint = <span class="keyword">false</span>;</div>
<div class="line">        markLineWeight = MarkLineWeight.p125pt</div>
<div class="line">        markOffset = 6;</div>
<div class="line">        <span class="comment">//markType = MarkTypes.default;</span></div>
<div class="line">        pageInformationMarks = <span class="keyword">true</span>;</div>
<div class="line">        registrationMarks = <span class="keyword">true</span>;</div>
<div class="line">    </div>
<div class="line">    </div>
<div class="line">        <span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line">        <span class="comment">//Properties corresponding to the controls in the Graphics panel of the</span></div>
<div class="line">        <span class="comment">//Print dialog box.</span></div>
<div class="line">        <span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line">        <span class="comment">//if a device independent PPD is specified, trying to set the graphics</span></div>
<div class="line">        <span class="comment">//send data will result in an error</span></div>
<div class="line">        <span class="keywordflow">try</span>{</div>
<div class="line">            sendImageData = ImageDataTypes.allImageData;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span>(myError){}</div>
<div class="line">        fontDownloading = FontDownloading.complete;</div>
<div class="line">        downloadPPDFOnts = <span class="keyword">true</span>;</div>
<div class="line">        <span class="keywordflow">try</span>{</div>
<div class="line">            dataFormat = DataFormat.binary;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span>(e){}</div>
<div class="line">        <span class="keywordflow">try</span>{</div>
<div class="line">            postScriptLevel = PostScriptLevels.level3;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span>(e){}</div>
<div class="line">    </div>
<div class="line">        <span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line">        <span class="comment">//Properties corresponding to the controls in the Color Management panel of</span></div>
<div class="line">        <span class="comment">//the Print dialog box.</span></div>
<div class="line">        <span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line">        <span class="comment">//If the useColorManagement property of app.colorSettings is false,</span></div>
<div class="line">        <span class="comment">//attempting to set the following properties will return an error.</span></div>
<div class="line">        <span class="keywordflow">try</span>{</div>
<div class="line">            sourceSpace = SourceSpaces.useDocument;</div>
<div class="line">            intent = RenderingIntent.useColorSettings;</div>
<div class="line">            crd = ColorRenderingDictionary.useDocument;</div>
<div class="line">            profile = Profile.postscriptCMS;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span>(e){}</div>
<div class="line">    </div>
<div class="line">        <span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line">        <span class="comment">//Properties corresponding to the controls in the Advanced panel of the</span></div>
<div class="line">        <span class="comment">//Print dialog box.</span></div>
<div class="line">        <span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line">        opiImageReplacement = <span class="keyword">false</span>;</div>
<div class="line">        omitBitmaps = <span class="keyword">false</span>;</div>
<div class="line">        omitEPS = <span class="keyword">false</span>;</div>
<div class="line">        omitPDF = <span class="keyword">false</span>;</div>
<div class="line">        <span class="comment">//The following line assumes that you have a flattener preset named</span></div>
<div class="line">        <span class="comment">//&quot;high quality flattener&quot;.</span></div>
<div class="line">        <span class="keywordflow">try</span>{</div>
<div class="line">            flattenerPresetName = <span class="stringliteral">&quot;high quality flattener&quot;</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span>(e){}</div>
<div class="line">        ignoreSpreadOverrides = <span class="keyword">false</span>;</div>
<div class="line">    }</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_printing_with_printer_presets"></a>
Printing with printer presets</h3>
<p>To print a document using a printer preset, include the printer preset in the print command. </p>
<div class="fragment"><div class="line">    <span class="comment">//Prints the active document using the specified printer preset.</span></div>
<div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    myDocument.print(<span class="keyword">false</span>, app.printerPresets.item(<span class="stringliteral">&quot;myPrinterPreset&quot;</span>));</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_exporting_a_document_as_pdf"></a>
Exporting a Document as PDF</h2>
<p>InDesign scripting offers full control over the creation of PDF files from your page-layout documents.</p>
<h3><a class="anchor" id="id_js_exporting_to_pdf"></a>
Exporting to PDF</h3>
<p>The following script exports the current document as PDF, using the current PDF export options. (For the complete script, see ExportPDF.) </p>
<div class="fragment"><div class="line">    myDocument.exportFile(</div>
<div class="line">        ExportFormat.pdfType,</div>
<div class="line">        File(Folder.desktop + <span class="stringliteral">&quot;/ExportPDF.pdf&quot;</span>), </div>
<div class="line">        <span class="keyword">false</span></div>
<div class="line">    );</div>
</div><!-- fragment --><p> The following script fragment shows how to export to PDF using a PDF export preset. (For the complete script, see ExportPDFWithPreset.) </p>
<div class="fragment"><div class="line">    var myPDFExportPreset = app.pdfExportPresets.item(<span class="stringliteral">&quot;[Press Quality]&quot;</span>);</div>
<div class="line">    myDocument.exportFile(</div>
<div class="line">        ExportFormat.pdfType,</div>
<div class="line">        File(Folder.desktop + <span class="stringliteral">&quot;/ExportPDFWithPreset.pdf&quot;</span>),</div>
<div class="line">        <span class="keyword">false</span>, </div>
<div class="line">        myPDFExportPreset</div>
<div class="line">    );</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_setting_pdf_export_options"></a>
Setting PDF export options</h3>
<p>The following script sets the PDF export options before exporting. (For the complete script, see ExportPDFWithOptions.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Sets PDF export options, then exports the active document as PDF.</span></div>
<div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    with(app.pdfExportPreferences){</div>
<div class="line">        <span class="comment">//Basic PDF output options.</span></div>
<div class="line">        pageRange = PageRange.allPages;</div>
<div class="line">        acrobatCompatibility = AcrobatCompatibility.acrobat6;</div>
<div class="line">        exportGuidesAndGrids = <span class="keyword">false</span>;</div>
<div class="line">        exportLayers = <span class="keyword">false</span>;</div>
<div class="line">        exportNonPrintingObjects = <span class="keyword">false</span>;</div>
<div class="line">        exportReaderSpreads = <span class="keyword">false</span>;</div>
<div class="line">        generateThumbnails = <span class="keyword">false</span>;</div>
<div class="line">        <span class="keywordflow">try</span>{</div>
<div class="line">            ignoreSpreadOverrides = <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span>(e){}</div>
<div class="line">        includeBookmarks = <span class="keyword">true</span>;</div>
<div class="line">        includeHyperlinks = <span class="keyword">true</span>;</div>
<div class="line">        includeICCProfiles = <span class="keyword">true</span>;</div>
<div class="line">        includeSlugWithPDF = <span class="keyword">false</span>;</div>
<div class="line">        includeStructure = <span class="keyword">false</span>;</div>
<div class="line">        interactiveElementsOption = InteractiveElementsOptions.doNotInclude;</div>
<div class="line">        <span class="comment">//Setting subsetFontsBelow to zero disallows font subsetting;</span></div>
<div class="line">        <span class="comment">//set subsetFontsBelow to some other value to use font subsetting.</span></div>
<div class="line">        subsetFontsBelow = 0;</div>
<div class="line">        <span class="comment">//Bitmap compression/sampling/quality options.</span></div>
<div class="line">        colorBitmapCompression = BitmapCompression.zip;</div>
<div class="line">        colorBitmapQuality = CompressionQuality.eightBit;</div>
<div class="line">        colorBitmapSampling = Sampling.none;</div>
<div class="line">        <span class="comment">//thresholdToCompressColor is not needed in this example.</span></div>
<div class="line">        <span class="comment">//colorBitmapSamplingDPI is not needed when colorBitmapSampling is set to</span></div>
<div class="line">        <span class="comment">//none.</span></div>
<div class="line">        grayscaleBitmapCompression = BitmapCompression.zip;</div>
<div class="line">        grayscaleBitmapQuality = CompressionQuality.eightBit;</div>
<div class="line">        grayscaleBitmapSampling = Sampling.none;</div>
<div class="line">        <span class="comment">//thresholdToCompressGray is not needed in this example.</span></div>
<div class="line">        <span class="comment">//grayscaleBitmapSamplingDPI is not needed when grayscaleBitmapSampling is</span></div>
<div class="line">        <span class="comment">//set to none.</span></div>
<div class="line">        monochromeBitmapCompression = BitmapCompression.zip;</div>
<div class="line">        monochromeBitmapSampling = Sampling.none;</div>
<div class="line">        <span class="comment">//thresholdToCompressMonochrome is not needed in this example.</span></div>
<div class="line">        <span class="comment">//monochromeBitmapSamplingDPI is not needed when monochromeBitmapSampling</span></div>
<div class="line">        <span class="comment">//is set to none.</span></div>
<div class="line">        <span class="comment">//Other compression options.</span></div>
<div class="line">        compressionType = PDFCompressionType.compressNone;</div>
<div class="line">        compressTextAndLineArt = <span class="keyword">true</span>;</div>
<div class="line">        cropImagesToFrames = <span class="keyword">true</span>;</div>
<div class="line">        optimizePDF = <span class="keyword">true</span>;</div>
<div class="line">        <span class="comment">//Printers marks and prepress options.</span></div>
<div class="line">        <span class="comment">//Get the bleed amounts from the document&#39;s bleed.</span></div>
<div class="line">        var myDocumentPreferences = myDocument.documentPreferences;</div>
<div class="line">        bleedBottom = myDocumentPreferences.documentBleedBottomOffset;</div>
<div class="line">        bleedTop = myDocumentPreferences.documentBleedTopOffset;</div>
<div class="line">        bleedInside = myDocumentPreferences.documentBleedInsideOrLeftOffset;</div>
<div class="line">        bleedOutside = myDocumentPreferences.documentBleedOutsideOrRightOffset;</div>
<div class="line">        <span class="comment">//If any bleed area is greater than zero, then include bleed marks.</span></div>
<div class="line">        <span class="keywordflow">if</span>(bleedBottom &amp;&amp; bleedTop &amp;&amp; bleedInside &amp;&amp; bleedInside){</div>
<div class="line">            bleedMarks = <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span>{</div>
<div class="line">            bleedMarks = <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">        colorBars = <span class="keyword">true</span>;</div>
<div class="line">        colorTileSize = 128;</div>
<div class="line">        grayTileSize = 128;</div>
<div class="line">        cropMarks = <span class="keyword">true</span>;</div>
<div class="line">        omitBitmaps = <span class="keyword">false</span>;</div>
<div class="line">        omitEPS = <span class="keyword">false</span>;</div>
<div class="line">        omitPDF = <span class="keyword">false</span>;</div>
<div class="line">        pageInformationMarks = <span class="keyword">true</span>;</div>
<div class="line">        pageMarksOffset = <span class="stringliteral">&quot;12 pt&quot;</span>;</div>
<div class="line">        pdfColorSpace = PDFColorSpace.unchangedColorSpace;</div>
<div class="line">        <span class="comment">//Default mark type.</span></div>
<div class="line">        pdfMarkType = 1147563124;</div>
<div class="line">        printerMarkWeight = PDFMarkWeight.p125pt;</div>
<div class="line">        registrationMarks = <span class="keyword">true</span>;</div>
<div class="line">        <span class="keywordflow">try</span>{</div>
<div class="line">            simulateOverprint = <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span>(e){}</div>
<div class="line">        useDocumentBleedWithPDF = <span class="keyword">true</span>;</div>
<div class="line">        <span class="comment">//Set viewPDF to true to open the PDF in Acrobat or Adobe Reader.</span></div>
<div class="line">        viewPDF = <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Now export the document. You&#39;ll have to fill in your own file path.</span></div>
<div class="line">    myDocument.exportFile(</div>
<div class="line">        ExportFormat.pdfType,</div>
<div class="line">        File(Folder.desktop + <span class="stringliteral">&quot;/ExportPDFWithOptions.pdf&quot;</span>), </div>
<div class="line">        <span class="keyword">false</span></div>
<div class="line">    );</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_exporting_to_grayscale_pdf"></a>
Exporting to grayscale PDF</h3>
<p>An InDesign document that contains colors can be exported to a color PDF or to a grayscale PDF. You can modify the script in the preceding <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_setting_pdf_export_options">Setting PDF export options</a> section to export in grayscale by changing the PDFColorSpace option from unchangedColorSpace to gray. For example: </p>
<div class="fragment"><div class="line">with(app.pdfExportPreferences){</div>
<div class="line">    pdfColorSpace = PDFColorSpace.GRAY;</div>
<div class="line">}</div>
</div><!-- fragment --><p>(For a different script that creates a small document containing color and exports it to PDF in grayscale, see GreyscalePDFforIDS.)</p>
<h3><a class="anchor" id="id_js_exporting_a_range_of_pages_to_pdf"></a>
Exporting a range of pages to PDF</h3>
<p>The following script shows how to export a specified page range as PDF. (For the complete script, see ExportPageRangeAsPDF.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Exports specified pages of An InDesign document to a PDF</span></div>
<div class="line">    <span class="comment">//using the current PDF export settings.</span></div>
<div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    with(app.pdfExportPreferences){</div>
<div class="line">    <span class="comment">//Enter the names of the pages you want to export in the following line.</span></div>
<div class="line">    <span class="comment">//Note that the page name is not necessarily the index of the page in the</span></div>
<div class="line">    <span class="comment">//document (e.g., the first page of a document whose page numbering starts</span></div>
<div class="line">    <span class="comment">//with page 21 will be &quot;21&quot;, not 1).</span></div>
<div class="line">        pageRange = <span class="stringliteral">&quot;1, 3-6, 7, 9-11, 12&quot;</span>;</div>
<div class="line">    }</div>
<div class="line">    myDocument.exportFile(</div>
<div class="line">        ExportFormat.pdfType,</div>
<div class="line">        File(Folder.desktop + <span class="stringliteral">&quot;/ExportPageRangeAsPDF.pdf&quot;</span>),</div>
<div class="line">        <span class="keyword">false</span></div>
<div class="line">    );</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_exporting_individual_pages_to_pdf"></a>
Exporting individual pages to PDF</h3>
<p>The following script exports each page from a document as an individual PDF file. (For the complete script, see ExportEachPageAsPDF.) </p>
<div class="fragment"><div class="line">    var myPageName, myFilePath, myFile;</div>
<div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myBaseName = myDocument.name;</div>
<div class="line">    <span class="keywordflow">for</span>(var myCounter = 0; myCounter &lt; myDocument.pages.length; myCounter++){</div>
<div class="line">        myPageName = myDocument.pages.item(myCounter).name;</div>
<div class="line">        app.pdfExportPreferences.pageRange = myPageName;</div>
<div class="line">        <span class="comment">//The name of the exported files will be the base name + the </span></div>
<div class="line">        <span class="comment">//page name + &quot;.pdf&quot;. If the page name contains a colon (as it will </span></div>
<div class="line">        <span class="comment">//if the document contains sections), then remove the colon.</span></div>
<div class="line">        var myRegExp = /:/gi;</div>
<div class="line">        myPageName = myPageName.replace(myRegExp, <span class="stringliteral">&quot;_&quot;</span>);</div>
<div class="line">        myFilePath = Folder.desktop + <span class="stringliteral">&quot;/&quot;</span> + myBaseName + <span class="stringliteral">&quot;_&quot;</span> + myPageName + <span class="stringliteral">&quot;.pdf&quot;</span>;</div>
<div class="line">        myFile = <span class="keyword">new</span> File(myFilePath);</div>
<div class="line">        myDocument.exportFile(ExportFormat.pdfType, myFile, <span class="keyword">false</span>);</div>
<div class="line">    }</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_exporting_pdf_with_interactive_features"></a>
Exporting PDF with interactive features</h3>
<p>The following script exports a document with interactive features as a PDF. (For the complete script, see ExportInteractivePDF.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a document &quot;myDocument,&quot; add page transitions...</span></div>
<div class="line">    <span class="keywordflow">for</span>(var myCounter = 0; myCounter &lt; myDocument.spreads.length; myCounter++){</div>
<div class="line">        myDocument.spreads.item(myCounter).pageTransitionType = PageTransitionTypeOptions.wipeTransition;</div>
<div class="line">        myDocument.spreads.item(myCounter).pageTransitionDirection = PageTransitionDirectionOptions.down;</div>
<div class="line">        myDocument.spreads.item(myCounter).pageTransitionDuration = PageTransitionDurationOptions.medium;</div>
<div class="line">    }</div>
<div class="line">    app.interactivePDFExportPreferences.flipPages = <span class="keyword">true</span>;</div>
<div class="line">    app.interactivePDFExportPreferences.flipPagesSpeed = 5;</div>
<div class="line">    app.interactivePDFExportPreferences.openInFullScreen = <span class="keyword">true</span>;</div>
<div class="line">    app.interactivePDFExportPreferences.interactivePDFInteractiveElementsOption = InteractivePDFInteractiveElementsOptions.includeAllMedia;</div>
<div class="line">    <span class="comment">//Export the document to PDF.</span></div>
<div class="line">    myDocument.exportFile(ExportFormat.interactivePDF,File(Folder.desktop + <span class="stringliteral">&quot;/InteractivePDF.pdf&quot;</span>), <span class="keyword">false</span>);</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_exporting_as_a_pdf_form"></a>
Exporting as a PDF form.</h3>
<p>To create a PDF that contains form fields, you can either save the InDesign document as PDF, then open it in Acrobat and apply form fields, or apply text fields, radio buttons, signature fields, and so on directly in InDesign and export the document to PDF as a form with no additional Acrobat editing required.</p>
<p>The following script applies form elements to an InDesign document and exports the document as a PDF form. (For the complete script, see ExportInteractivePDFForm.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Create a textframe as firstname label</span></div>
<div class="line">    var myTextFrame = myDocument.pages.item(0).textFrames.add</div>
<div class="line">    (</div>
<div class="line">        {geometricBounds:[15, 15, 20, 35], contents:<span class="stringliteral">&quot;FirstName: &quot;</span>}</div>
<div class="line">    );    </div>
<div class="line">    <span class="comment">//Create a textbox as firstname input box</span></div>
<div class="line">    var myTextBox = myDocument.pages.item(0).textBoxes.add</div>
<div class="line">    (</div>
<div class="line">        {geometricBounds:[15, 40, 20, 75], contents:SpecialCharacters.autoPageNumber}</div>
<div class="line">    );</div>
<div class="line">    <span class="comment">//Create another textframe as lastname label</span></div>
<div class="line">    var myTextFrame1 = myDocument.pages.item(0).textFrames.add</div>
<div class="line">    (</div>
<div class="line">        {geometricBounds:[30, 15, 25, 35], contents:<span class="stringliteral">&quot;LastName: &quot;</span>}</div>
<div class="line">    );    </div>
<div class="line">    <span class="comment">//Create another textbox as lastname input box</span></div>
<div class="line">    var myTextBox = myDocument.pages.item(0).textBoxes.add</div>
<div class="line">    (</div>
<div class="line">        {geometricBounds:[30, 40, 25, 75], contents:SpecialCharacters.autoPageNumber}</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">     <span class="comment">//Create a TextFrame to introduce the following checkbox</span></div>
<div class="line">     var myTextFrame2 = myDocument.pages.item(0).textFrames.add</div>
<div class="line">     (</div>
<div class="line">        {geometricBounds:[15, 80, 20, 95], contents:<span class="stringliteral">&quot;Hobby: &quot;</span>}</div>
<div class="line">     );</div>
<div class="line">     <span class="comment">//Create some CheckBoxes</span></div>
<div class="line">     var myCheckBox = myDocument.pages.item(0).checkBoxes.add</div>
<div class="line">     (</div>
<div class="line">        {geometricBounds:[15, 100, 20, 105], name:<span class="stringliteral">&quot;Football &quot;</span>}</div>
<div class="line">     );</div>
<div class="line">     var myTextFrame3 = myDocument.pages.item(0).textFrames.add</div>
<div class="line">     (</div>
<div class="line">        {geometricBounds:[15, 107, 20, 125], contents:<span class="stringliteral">&quot;Football &quot;</span>}</div>
<div class="line">     );</div>
<div class="line">     var myCheckBox1 = myDocument.pages.item(0).checkBoxes.add</div>
<div class="line">     (</div>
<div class="line">        {geometricBounds:[15, 130, 20, 135], name:<span class="stringliteral">&quot;Basketball &quot;</span>}</div>
<div class="line">     );</div>
<div class="line">     var myTextFrame4 = myDocument.pages.item(0).textFrames.add</div>
<div class="line">     (</div>
<div class="line">        {geometricBounds:[15, 137, 20, 160], contents:<span class="stringliteral">&quot;Basketball &quot;</span>}</div>
<div class="line">     );</div>
<div class="line">     var myCheckBox2 = myDocument.pages.item(0).checkBoxes.add</div>
<div class="line">     (</div>
<div class="line">        {geometricBounds:[15, 165, 20, 170], name:<span class="stringliteral">&quot;Pingpong &quot;</span>}</div>
<div class="line">     );</div>
<div class="line">     var myTextFrame5 = myDocument.pages.item(0).textFrames.add</div>
<div class="line">     (</div>
<div class="line">        {geometricBounds:[15, 172, 20, 193], contents:<span class="stringliteral">&quot;Pingpong &quot;</span>}</div>
<div class="line">     );</div>
<div class="line">    </div>
<div class="line">    <span class="comment">//Create a button for submit</span></div>
<div class="line">    var submitButton = myDocument.pages.item(0).buttons.add</div>
<div class="line">    (</div>
<div class="line">        {geometricBounds:[45, 15, 35, 35], name:<span class="stringliteral">&quot;Submit&quot;</span>}</div>
<div class="line">    );</div>
<div class="line">    <span class="comment">//Fill contents to the button</span></div>
<div class="line">    var myRightArrow1 = submitButton.states.item(0).polygons.add</div>
<div class="line">    (</div>
<div class="line">        {fillColor:myDocument.colors.item(<span class="stringliteral">&quot;Green&quot;</span>)}</div>
<div class="line">    );</div>
<div class="line">    myRightArrow1.paths.item(0).entirePath = [[15, 35],[35,40],[15, 45]];</div>
<div class="line">    <span class="comment">//Add the Rollover state.</span></div>
<div class="line">    var myRolloverState1 = submitButton.states.add();</div>
<div class="line">    <span class="comment">//Add a shadow to the polygon in the Rollover state.</span></div>
<div class="line">    var myRolloverArrow1 = myRolloverState1.polygons.add</div>
<div class="line">    (</div>
<div class="line">        {fillColor:myDocument.colors.item(<span class="stringliteral">&quot;Green&quot;</span>)}</div>
<div class="line">    );</div>
<div class="line">    myRolloverArrow1.paths.item(0).entirePath = [[15, 35],[35,40],[15, 45]];</div>
<div class="line">    var myFillTransparencySettings1 = myRolloverArrow1.fillTransparencySettings;</div>
<div class="line">    myFillTransparencySettings1.dropShadowSettings.mode = ShadowMode.drop;</div>
<div class="line">    myFillTransparencySettings1.dropShadowSettings.angle = 90;</div>
<div class="line">    myFillTransparencySettings1.dropShadowSettings.xOffset = 0;</div>
<div class="line">    myFillTransparencySettings1.dropShadowSettings.yOffset = 0;</div>
<div class="line">    myFillTransparencySettings1.dropShadowSettings.size = 6;</div>
<div class="line">    <span class="comment">//Add a shadow to the polygon in the Click state.</span></div>
<div class="line">    var myClickState1 = submitButton.states.add();</div>
<div class="line">    var myClickArrow1 = myClickState1.polygons.add</div>
<div class="line">    (</div>
<div class="line">        {fillColor:myDocument.colors.item(<span class="stringliteral">&quot;Blue&quot;</span>)}</div>
<div class="line">    );</div>
<div class="line">    myClickArrow1.paths.item(0).entirePath = [[15, 35],[35,40],[15,45]];</div>
<div class="line">    <span class="comment">//Set the behavior for the button.</span></div>
<div class="line">    var SubmitForm = submitButton.submitFormBehaviors.add</div>
<div class="line">    (</div>
<div class="line">        {behaviorEvent:BehaviorEvents.mouseUp}</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">     <span class="comment">//Create a button for print</span></div>
<div class="line">    var printButton = myDocument.pages.item(0).buttons.add</div>
<div class="line">    (</div>
<div class="line">        {geometricBounds:[45, 40, 35, 60], content:<span class="stringliteral">&quot;Print&quot;</span>}</div>
<div class="line">    );</div>
<div class="line">    <span class="comment">//Fill contents to the button</span></div>
<div class="line">    var myRightArrow2 = printButton.states.item(0).polygons.add</div>
<div class="line">    (</div>
<div class="line">        {fillColor:myDocument.colors.item(<span class="stringliteral">&quot;Red&quot;</span>)}</div>
<div class="line">    );</div>
<div class="line">    myRightArrow2.paths.item(0).entirePath = [[40, 35],[60,40],[40, 45]];</div>
<div class="line">    <span class="comment">//Add the Rollover state.</span></div>
<div class="line">    var myRolloverState2 = printButton.states.add();</div>
<div class="line">    <span class="comment">//Add a shadow to the polygon in the Rollover state.</span></div>
<div class="line">    var myRolloverArrow2 = myRolloverState2.polygons.add</div>
<div class="line">    (</div>
<div class="line">        {fillColor:myDocument.colors.item(<span class="stringliteral">&quot;Red&quot;</span>)}</div>
<div class="line">    );</div>
<div class="line">    myRolloverArrow2.paths.item(0).entirePath = [[40, 35],[60,40],[40, 45]];</div>
<div class="line">    var myFillTransparencySettings2 = myRolloverArrow2.fillTransparencySettings;</div>
<div class="line">    myFillTransparencySettings2.dropShadowSettings.mode = ShadowMode.drop;</div>
<div class="line">    myFillTransparencySettings2.dropShadowSettings.angle = 90;</div>
<div class="line">    myFillTransparencySettings2.dropShadowSettings.xOffset = 0;</div>
<div class="line">    myFillTransparencySettings2.dropShadowSettings.yOffset = 0;</div>
<div class="line">    myFillTransparencySettings2.dropShadowSettings.size = 6;</div>
<div class="line">    <span class="comment">//Add a shadow to the polygon in the Click state.</span></div>
<div class="line">    var myClickState2 = printButton.states.add();</div>
<div class="line">    var myClickArrow2 = myClickState2.polygons.add</div>
<div class="line">    (</div>
<div class="line">        {fillColor:myDocument.colors.item(<span class="stringliteral">&quot;Blue&quot;</span>)}</div>
<div class="line">    );</div>
<div class="line">    myClickArrow2.paths.item(0).entirePath = [[40, 35],[60,40],[40,45]];</div>
<div class="line">    <span class="comment">//Set the behavior for the button.</span></div>
<div class="line">    var PrintForm = printButton.printFormBehaviors.add</div>
<div class="line">    (</div>
<div class="line">        {behaviorEvent:BehaviorEvents.mouseUp}</div>
<div class="line">    );</div>
<div class="line">    </div>
<div class="line">    <span class="comment">//Export the document to interactive PDF.</span></div>
<div class="line">    myDocument.exportFile(ExportFormat.interactivePDF,File(Folder.desktop + <span class="stringliteral">&quot;/SubmitForm.pdf&quot;</span>), <span class="keyword">false</span>);</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_exporting_pages_as_eps"></a>
Exporting Pages as EPS</h2>
<p>When you export a document as EPS, InDesign saves each page of the file as a separate EPS graphic (an EPS, by definition, can contain only a single page). If you export more than a single page, InDesign appends the index of the page to the filename. The index of the page in the document is not necessarily the name of the page (as defined by the section options for the section containing the page).</p>
<h3><a class="anchor" id="id_js_exporting_all_pages_to_eps"></a>
Exporting all pages to EPS</h3>
<p>The following script exports the pages of the active document to one or more EPS files. (For the complete script, see ExportAsEPS.) </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myFile = File(Folder.desktop + <span class="stringliteral">&quot;/ExportAsEPS.eps&quot;</span>);</div>
<div class="line">    myDocument.exportFile(ExportFormat.epsType, myFile, <span class="keyword">false</span>);</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_exporting_a_range_of_pages_to_eps"></a>
Exporting a range of pages to EPS</h3>
<p>To control which pages are exported as EPS, set the page range property of the EPS export preferences to a page-range string containing the page or pages you want to export, before exporting. (For the complete script, see ExportPageRangeAsEPS.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Enter the names of the pages you want to export in the following line.</span></div>
<div class="line">    <span class="comment">//Note that the page name is not necessarily the index of the page in the</span></div>
<div class="line">    <span class="comment">//document (e.g., the first page of a document whose page numbering starts</span></div>
<div class="line">    <span class="comment">//with page 21 will be &quot;21&quot;, not 1).</span></div>
<div class="line">    app.epsExportPreferences.pageRange = <span class="stringliteral">&quot;1, 3-6, 7, 9-11, 12&quot;</span>;</div>
<div class="line">    var myFile = File(Folder.desktop + <span class="stringliteral">&quot;/ExportPageRangeAsEPS.eps&quot;</span>);</div>
<div class="line">    myDocument.exportFile(ExportFormat.epsType, myFile, <span class="keyword">false</span>);</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_exporting_as_eps_with_file_naming"></a>
Exporting as EPS with file naming</h3>
<p>The following script exports each page as an EPS, but it offers more control over file naming than the earlier example. (For the complete script, see ExportEachPageAsEPS.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Ordinarily, exporting a document to EPS would create a single EPS file</span></div>
<div class="line">    <span class="comment">//for every page in the document (as EPS is a single-page format). We&#39;ll </span></div>
<div class="line">    <span class="comment">//export each page separately, because we want to control the file name.</span></div>
<div class="line">    var myPageName, myFilePath, myFile;</div>
<div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myBaseName = myDocument.name;</div>
<div class="line">    <span class="keywordflow">for</span>(var myCounter = 0; myCounter &lt; myDocument.pages.length; myCounter++){</div>
<div class="line">        myPageName = myDocument.pages.item(myCounter).name;</div>
<div class="line">        app.epsExportPreferences.pageRange = myPageName;</div>
<div class="line">        <span class="comment">//The name of the exported files will be the base name + the </span></div>
<div class="line">        <span class="comment">//page name + &quot;.pdf&quot;. If the page name contains a colon (as it will </span></div>
<div class="line">        <span class="comment">//if the document contains sections), then remove the colon.</span></div>
<div class="line">        var myRegExp = /:/gi;</div>
<div class="line">        myPageName = myPageName.replace(myRegExp, <span class="stringliteral">&quot;_&quot;</span>);</div>
<div class="line">        myFilePath = Folder.desktop + <span class="stringliteral">&quot;/&quot;</span> + myBaseName + <span class="stringliteral">&quot;_&quot;</span> + myPageName + <span class="stringliteral">&quot;.eps&quot;</span>;</div>
<div class="line">        myDocument.exportFile(ExportFormat.epsType, File(myFilePath), <span class="keyword">false</span>);</div>
<div class="line">    }</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_exporting_to_epub"></a>
Exporting to EPub</h2>
<p>InDesign scripting offers full control over the creation of EPub files from your page-layout documents.</p>
<h3><a class="anchor" id="id_js_exporting_the_current_document"></a>
Exporting the current document</h3>
<p>The following script exports the current document as EPub, using default options. (For the complete script, see ExportEPub.) </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);    </div>
<div class="line">    <span class="comment">//The document export parameters are:</span></div>
<div class="line">    <span class="comment">//Format as (use ExportFormat.EPUB)</span></div>
<div class="line">    <span class="comment">//To as File</span></div>
<div class="line">    <span class="comment">//ShowingOptions as boolean (setting this option to true displays the EPub Export dialog box)    </span></div>
<div class="line">    myDocument.exportFile(ExportFormat.EPUB, File(<span class="stringliteral">&quot;C:/test/ExportEPub.epub&quot;</span>), <span class="keyword">false</span>);</div>
</div><!-- fragment --><p> To give the user more control over the creation of EPub files, specify true for the third parameter. This opens the EPub export options dialog.</p>
<h3><a class="anchor" id="id_js_setting_epub_export_options"></a>
Setting EPub export options</h3>
<p>The following script sets the EPub export options before exporting. (For the complete script, see ExportEPubWithOptions.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Sets EPub export options, then exports the active document as EPub.</span></div>
<div class="line">    with (myDocument.epubExportPreferences)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">//Apply image alignment to anchored object settings.</span></div>
<div class="line">        applyImageAlignmentToAnchoredObjectSettings = <span class="keyword">false</span>;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">//Bottom margin of the epub.</span></div>
<div class="line">        bottomMargin = 5;</div>
<div class="line">        <span class="comment">//Left margin of the epub.</span></div>
<div class="line">        leftMargin = 5;</div>
<div class="line">        <span class="comment">//Right margin of the epub.</span></div>
<div class="line">        rightMargin = 5;</div>
<div class="line">        <span class="comment">//Top margin of the epub.</span></div>
<div class="line">        topMargin = 5;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">//If true, break InDesign document into smaller pieces when generating epub.</span></div>
<div class="line">        breakDocument = <span class="keyword">false</span>;</div>
<div class="line">        <span class="comment">//The name of paragraph style to break InDesign document.</span></div>
<div class="line">        <span class="comment">//paragraphStyleName = &quot;&quot;;</span></div>
<div class="line">        </div>
<div class="line">        <span class="comment">//The bullet export option.</span></div>
<div class="line">        bulletExportOption = BulletListExportOption.AS_TEXT;        </div>
<div class="line">        </div>
<div class="line">        customImageSizeOption = ImageSizeOption.SIZE_RELATIVE_TO_PAGE_WIDTH;</div>
<div class="line">               </div>
<div class="line">        embedFont = <span class="keyword">true</span>;</div>
<div class="line">        epubCover = EpubCover.FIRST_PAGE;</div>
<div class="line">        <span class="comment">//This will take effect only when epubCover is set to EXTERNAL_IMAGE.</span></div>
<div class="line">        <span class="comment">//coverImageFile = &quot;/c/cover.jpg&quot;;</span></div>
<div class="line">        </div>
<div class="line">        epubPublisher = <span class="stringliteral">&quot;Adobe Devtech&quot;</span>;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">//The export order.</span></div>
<div class="line">        exportorder = ExportOrder.LAYOUT_ORDER;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">//If true, output footnote immediately after its paragraph.</span></div>
<div class="line">        footnoteFollowParagraph = <span class="keyword">false</span>;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">//If true, export epub in XHTML format. Otherwise, in DTBook format.</span></div>
<div class="line">        format = <span class="keyword">true</span>;</div>
<div class="line">        </div>
<div class="line">        gifOptionsInterlaced = <span class="keyword">true</span>;</div>
<div class="line">        gifOptionsPalette = GIFOptionsPalette.WINDOWS_PALETTE;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">//The epub unique identifier, like ISBN.</span></div>
<div class="line">        <span class="keywordtype">id</span> = <span class="stringliteral">&quot;123&quot;</span>;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">//Ignore object level image conversion settings.</span></div>
<div class="line">        ignoreObjectConversionSettings = <span class="keyword">true</span>;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">//Alignment applied to images.</span></div>
<div class="line">        imageAlignment = ImageAlignmentType.ALIGN_CENTER;</div>
<div class="line">        <span class="comment">//The file format to use for converted images.</span></div>
<div class="line">        <span class="comment">//Valid only when copy optimized images and/or copy formatted images is true.</span></div>
<div class="line">        imageConversion = ImageConversion.AUTOMATIC;</div>
<div class="line">        imageExportResolution = ImageResolution.PPI_150;</div>
<div class="line">        <span class="comment">//Image page break settings to be used with objects.</span></div>
<div class="line">        imagePageBreak = ImagePageBreakType.PAGE_BREAK_AFTER;</div>
<div class="line">        <span class="comment">//Space After applied to images.</span></div>
<div class="line">        imageSpaceAfter = 2;</div>
<div class="line">        <span class="comment">//Space Before applied to images.</span></div>
<div class="line">        imageSpaceBefore = 2;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">//If true, output document metadata into epub.</span></div>
<div class="line">        includeDocumentMetadata = <span class="keyword">true</span>;</div>
<div class="line">        </div>
<div class="line">        jpegOptionsFormat = JPEGOptionsFormat.BASELINE_ENCODING;</div>
<div class="line">        jpegOptionsQuality = JPEGOptionsQuality.HIGH;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">//The PNG compression level.</span></div>
<div class="line">        level = 5;</div>
<div class="line">        </div>
<div class="line">        numberedListExportOption = NumberedListExportOption.AS_TEXT;    </div>
<div class="line">        </div>
<div class="line">        <span class="comment">//If true, format image based on layout appearence.</span></div>
<div class="line">        preserveLayoutAppearence = <span class="keyword">true</span>;</div>
<div class="line">        <span class="comment">//If true, output local style override.</span></div>
<div class="line">        preserveLocalOverride = <span class="keyword">true</span>;</div>
<div class="line">        </div>
<div class="line">        stripSoftReturn = <span class="keyword">true</span>; </div>
<div class="line">        <span class="comment">//If true, image page break settings will be used in objects.</span></div>
<div class="line">        useImagePageBreak = <span class="keyword">true</span>;</div>
<div class="line">        <span class="comment">//Use a defined TOC style to generate epub TOC.</span></div>
<div class="line">        <span class="comment">//tocStyleName = &quot;MyTOCStyle&quot;;</span></div>
<div class="line">        </div>
<div class="line">        viewDocumentAfterExport = <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">    myDocument.exportFile(ExportFormat.EPUB, File(<span class="stringliteral">&quot;C:/test/ExportEPubWithOptions.epub&quot;</span>), <span class="keyword">false</span>);</div>
</div><!-- fragment --> <h1><a class="anchor" id="id_js_working_with_layers"></a>
Working with Layers</h1>
<p>InDesign's layers are the key to controlling the stacking order of objects in your layout. You can think of layers as transparent planes stacked on top of each other. You also can use layers as an organizational tool, putting one type of content on a given layer or set of layers.</p>
<p>A document can contain one or more layers, and each document includes at least one layer. Layers are document wide, not bound to specific pages or spreads.</p>
<p>This section covers scripting techniques related to layers in an InDesign layout and discusses common operations involving layers.</p>
<h2><a class="anchor" id="id_js_understanding_the_layer_object_model"></a>
Understanding the Layer Object Model</h2>
<p>The following figure shows the layer object model. Note the following about the diagram:</p>
<ul>
<li>It focuses on the location of a layer and its contents in the context of the object hierarchy of a document; it does not attempt to show all the other ways a script might work with the content of a layer (e.g., you can get a reference to a text-frame object from a story, text object, page, or spread, in addition to finding it inside a layer object).</li>
<li>It uses the JavaScript form of the object names; however, the object hierarchy is the same in all scripting languages.</li>
<li>The basic properties of a layer are shown in the column at the left of the figure; the objects that may be contained by the layer object, at the right.</li>
</ul>
<p>It is important to note the distinction between the page-items collection and the allPageItems collection. The former is a collection containing only the top-level page items in a layer. If a page item is inside a group, for example, it will not appear in the pageItems collection. In contrast, the allPageItems collection is a flattened collection of all page items assigned to the layer, regardless of their location in the object hierarchy. A page item inside a group on the layer would appear in the allPageItems collection.</p>
<p>Similarly, the allGraphics property contains all graphics stored in page items assigned to the layer, regardless of their location in the object hierarchy.</p>
<div class="image">
<img src="InDesign_ScriptingGuide-2.gif" alt="InDesign_ScriptingGuide-2.gif"/>
</div>
<h2><a class="anchor" id="id_js_scripting_layers"></a>
Scripting Layers</h2>
<p>In InDesign's user interface, you add, delete, rearrange, duplicate, and merge layers using the Layers panel. You also can change the layer to which a selected page item is assigned by dragging and dropping the layer proxy in the Layers panel. (For more on assigning objects to a layer, see the InDesign online help.) This section shows how to accomplish these tasks using InDesign scripting.</p>
<h3><a class="anchor" id="id_js_creating_layers"></a>
Creating layers</h3>
<div class="fragment"><div class="line">    <span class="comment">//Given a document &quot;myDocument&quot;...</span></div>
<div class="line">    var myLayer = myDocument.layers.add();</div>
</div><!-- fragment --><p> When you create a new layer, the layer appears above all other layers in the document.</p>
<h3><a class="anchor" id="id_js_referring_to_layers"></a>
Referring to layers</h3>
<p>InDesign scripting offers several ways to refer to a layer object. This section describes the most common ways to refer to layers.</p>
<p><b>Getting the active layer</b> </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a document &quot;myDocument&quot;...</span></div>
<div class="line">    var myLayer = myDocument.activeLayer;</div>
</div><!-- fragment --><p> <b>Referring to layers by layer index</b></p>
<p>You can get a reference to a layer using the index of the layer in the layers collection of a document. The script fragment below uses the layer index to iterate through layers. (For the complete script, see HideOtherLayers.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a document &quot;myDocument&quot;...</span></div>
<div class="line">    var myTargetLayer = myDocument.activeLayer;</div>
<div class="line">    <span class="keywordflow">for</span>(var myCounter = 0; myCounter &lt; myDocument.layers.length; myCounter++){</div>
<div class="line">        <span class="comment">//If the layer is not the target layer, hide it.</span></div>
<div class="line">        <span class="keywordflow">if</span>(myDocument.layers.item(myCounter).name != myTargetLayer.name){</div>
<div class="line">            myDocument.layers.item(myCounter).visible = <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment --><p> Note that you can use negative numbers to refer to the layers in the layers collection of a document. Layer -1 refers to the last (bottom) layer in the collection.</p>
<p><b>Referring to layers by layer name</b></p>
<p>You also can get a reference to a layer using the name of the layer, as shown in the following script fragment. (For the complete script, see LayerName.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a document &quot;myDocument&quot;...</span></div>
<div class="line">    var myLayer = myDocument.layers.item(<span class="stringliteral">&quot;Text Layer&quot;</span>);</div>
</div><!-- fragment --><p> <b>Using relative references</b></p>
<p>Given a layer, you can refer to the layer above using the previousItem method, or refer to the layer below using the nextItem method, as shown in the following script fragment. (For the complete script, see RelativeLayerReferences.) Both methods take a reference layer as a parameter. </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a document &quot;myDocument&quot;...</span></div>
<div class="line">    var myLayer = myDocument.layers.item(4);</div>
<div class="line">    myDocument.activeLayer = myLayer;</div>
<div class="line">    var myNextLayer = myDocument.layers.nextItem(myLayer);</div>
<div class="line">    var myPreviousLayer = myDocument.layers.previousItem(myLayer);</div>
<div class="line">    var myString = <span class="stringliteral">&quot;The layer below the target layer is &quot;</span> + myNextLayer.name + <span class="stringliteral">&quot;\r&quot;</span>;</div>
<div class="line">    myString += <span class="stringliteral">&quot;The layer above the target layer is &quot;</span> + myPreviousLayer.name;</div>
<div class="line">    alert(myString);</div>
</div><!-- fragment --><p> The previousItem and nextItem methods return an invalid layer reference if the specified (next or previous) layer does not exist, rather than generating an error.</p>
<p><b>Referring to ranges of layers</b></p>
<p>To refer to a series of layers, you can use the itemByRange method. The following script fragment shows how to get a reference to a range of layers, then set a property on all layers in the range. (For the complete script, see HideLayersAbove.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a document &quot;myDocument&quot;...</span></div>
<div class="line">    var myLayer = myDocument.layers.item(4);</div>
<div class="line">    myDocument.activeLayer = myLayer;</div>
<div class="line">    <span class="comment">//Now hide all of the layers above the current layer.</span></div>
<div class="line">    var myLayers = myDocument.layers.itemByRange(0, myLayer.index -1);</div>
<div class="line">    <span class="comment">//Even though the result contains multiple layers, you can</span></div>
<div class="line">    <span class="comment">//set a property on all of the layers without iterating.</span></div>
<div class="line">    myLayers.visible = <span class="keyword">false</span>;</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_deleting_layers"></a>
Deleting layers</h3>
<p>Use the remove method to delete a layer from a specific document, as shown in the following script fragment. (For the complete script, see DeleteLayer.) You cannot delete the last remaining layer in a document. </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a document &quot;myDocument&quot; containing a layer named &quot;Delete This Layer&quot;...</span></div>
<div class="line">    var myLayer = myDocument.layers.item(<span class="stringliteral">&quot;Delete This Layer&quot;</span>);</div>
<div class="line">    myLayer.remove();</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_moving_layers"></a>
Moving layers</h3>
<p>Use the move method to change the stacking order of layers in a document, as shown in the following script fragment. (For the complete script, see MoveLayer.) </p>
<div class="fragment"><div class="line">    <span class="comment">// Given a layer &quot;myLayer&quot;, move the layer behind</span></div>
<div class="line">    <span class="comment">// the default layer (the lowest layer in the document </span></div>
<div class="line">    <span class="comment">// is Layers.Item(-1).</span></div>
<div class="line">    myLayer.move(LocationOptions.after, app.documents.item(0).layers.item(-1));</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_duplicating_layers"></a>
Duplicating layers</h3>
<p>Use the duplicate method to create a copy of a layer, as shown in the following script fragment. (For the complete script, see DuplicateLayer.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a document &quot;myDocument&quot;...</span></div>
<div class="line">    var myLayer = myDocument.layers.item(0);</div>
<div class="line">    var myNewLayer = myLayer.duplicate();</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_merging_layers"></a>
Merging layers</h3>
<p>The following script fragment shows how to merge two or more layers, including the page items assigned to them, into a single layer. (For the complete script, see MergeLayers.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a document &quot;myDocument&quot; containing at least two layers...</span></div>
<div class="line">    var myLayerA = myDocument.layers.item(0);</div>
<div class="line">    var myLayerB = myDocument.layers.item(1);</div>
<div class="line">    myLayerA.merge(myLayerB);</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_assigning_page_items_to_layers"></a>
Assigning page items to layers</h3>
<p>You can assign a page item to a layer by either referring to the layer when you create the page item (the add method of all page items can take a layer as a parameter) or setting the itemLayer property of an existing page item. The following script fragment shows how to assign a page item to a layer using both techniques. (For the complete script, see AssignPageItemsToLayers.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a reference to a page &quot;myPage,&quot; and a document &quot;myDocument,&quot;</span></div>
<div class="line">    <span class="comment">//create a text frame on a layer named &quot;TextFrames&quot;</span></div>
<div class="line">    var myTextFrame = myPage.textFrames.add(myDocument.layers.item(<span class="stringliteral">&quot;TextFrames&quot;</span>));</div>
<div class="line">    myTextFrame.geometricBounds = [72, 72, 144, 144];</div>
<div class="line">    <span class="comment">//Create a rectangle on the current target layer.</span></div>
<div class="line">    var myRectangle = myPage.rectangles.add({geometricBounds:[72, 144, 144, 216]});</div>
<div class="line">    <span class="comment">//Move the rectangle to a specific layer.</span></div>
<div class="line">    myRectangle.itemLayer = myDocument.layers.item(<span class="stringliteral">&quot;Rectangles&quot;</span>);</div>
<div class="line">    <span class="comment">//Create a series of ovals.</span></div>
<div class="line">    <span class="keywordflow">for</span>(var myCounter = 72; myCounter &lt; 172; myCounter+=10){</div>
<div class="line">        myPage.ovals.add({geometricBounds:[216, myCounter, 226, myCounter+10]});</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Move all of the ovals on the page to a specific layer.</span></div>
<div class="line">    myPage.ovals.everyItem().itemLayer = myDocument.layers.item(<span class="stringliteral">&quot;Ovals&quot;</span>);</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_setting_layer_properties"></a>
Setting layer properties</h3>
<p>Layer properties control the layer name, color, visibility, and other attributes of a layer. This section shows how to work with layer properties.</p>
<p><b>Setting basic layer properties</b></p>
<p>Basic layer properties include the name of the layer, the highlight color of the layer, the visibility of the layer, and whether text objects on the layer ignore text-wrap settings. The following script fragment shows how to set these basic properties of a layer. (For the complete script, see BasicLayerProperties.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a document &quot;myDocument&quot;...</span></div>
<div class="line">    var myLayer = myDocument.layers.add();</div>
<div class="line">    myLayer.name = <span class="stringliteral">&quot;myLayer&quot;</span>;</div>
<div class="line">    myLayer.layerColor = UIColors.CHARCOAL;</div>
<div class="line">    myLayer.ignoreWrap = <span class="keyword">false</span>;</div>
<div class="line">    myLayer.visible = <span class="keyword">true</span>;</div>
</div><!-- fragment --><p> <b>Working with layer guides</b></p>
<p>Guides can be assigned to a specific layer, just like page items. You can choose to show or hide the guides for a layer, and you can lock or unlock the guides on a layer. The following script fragment shows how to work with the guides on a layer. (For the complete script, see LayerGuides.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a document &quot;myDocument&quot; and a page &quot;myPage&quot; containing at least one guide...</span></div>
<div class="line">    <span class="comment">//Create a new layer.</span></div>
<div class="line">    var myLayer = myDocument.layers.add();</div>
<div class="line">    <span class="comment">//Move all of the guides on the page to the new layer.</span></div>
<div class="line">    myPage.guides.everyItem().itemLayer = myLayer;</div>
<div class="line">    myLayer.lockGuides = <span class="keyword">true</span>;</div>
<div class="line">    myLayer.showGuides = <span class="keyword">true</span>;</div>
</div><!-- fragment --><p> <b>Controlling layer printing and visibility</b></p>
<p>You can control the printing and visibility of objects on a layer, as shown in the following script fragment. (For the complete script, see LayerControl.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a document &quot;myDocument&quot; containing layers named &quot;Background,&quot;</span></div>
<div class="line">    <span class="comment">//&quot;Language A,&quot;, &quot;Language B,&quot; and &quot;Language C,&quot; export the &quot;Background&quot;</span></div>
<div class="line">    <span class="comment">//layer and each &quot;Language&quot; layer to PDF as separate PDF files...</span></div>
<div class="line">    var myVersion, myLanguageCounter, myFileName;</div>
<div class="line">    var myFolder = Folder.desktop;</div>
<div class="line">    <span class="keywordflow">for</span>(var myCounter = 0; myCounter &lt; 3; myCounter ++){</div>
<div class="line">        <span class="keywordflow">switch</span>(myCounter){</div>
<div class="line">            <span class="keywordflow">case</span> 0:</div>
<div class="line">                myVersion = <span class="stringliteral">&quot;Language A&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> 1:</div>
<div class="line">                myVersion = <span class="stringliteral">&quot;Language B&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> 2:</div>
<div class="line">                myVersion = <span class="stringliteral">&quot;Language C&quot;</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">for</span>(myLanguageCounter = 0; myLanguageCounter &lt; myDocument.layers.length; myLanguageCounter ++){</div>
<div class="line">            <span class="keywordflow">if</span>((myDocument.layers.item(myLanguageCounter).name == myVersion)||</div>
<div class="line">            (myDocument.layers.item(myLanguageCounter).name == <span class="stringliteral">&quot;Background&quot;</span>)){</div>
<div class="line">                myDocument.layers.item(myLanguageCounter).visible = <span class="keyword">true</span>;</div>
<div class="line">                myDocument.layers.item(myLanguageCounter).printable = <span class="keyword">true</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span>{</div>
<div class="line">                myDocument.layers.item(myLanguageCounter).visible = <span class="keyword">false</span>;</div>
<div class="line">                myDocument.layers.item(myLanguageCounter).printable = <span class="keyword">false</span>;</div>
<div class="line">            }               </div>
<div class="line">        }</div>
<div class="line">        myFileName = myFolder + <span class="stringliteral">&quot;/&quot;</span> + myVersion + <span class="stringliteral">&quot;.pdf&quot;</span>;</div>
<div class="line">        myDocument.exportFile(ExportFormat.pdfType, File(myFileName));  </div>
<div class="line">    }</div>
</div><!-- fragment --><p> <b>Locking layers</b></p>
<p>Layers can be locked, which means the page items on the layers cannot be edited. The following script fragment shows how to lock and unlock layers. (For the complete script, see LockLayersBelow.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a document &quot;myDocument&quot;...</span></div>
<div class="line">    var myTargetLayer = myDocument.activeLayer;</div>
<div class="line">    var myLayers = myDocument.layers.itemByRange(myDocument.layers.length-1, myTargetLayer.index +1);</div>
<div class="line">    myLayers.locked = <span class="keyword">true</span>;</div>
</div><!-- fragment --> <h1><a class="anchor" id="id_js_text_and_type"></a>
Text and Type</h1>
<p>Entering, editing, and formatting text are the tasks that make up the bulk of the time spent working on most InDesign documents. Because of this, automating text and type operations can result in large productivity gains.</p>
<p>This section shows how to script the most common operations involving text and type. The sample scripts in this section are presented in order of complexity, starting with very simple scripts and building toward more complex operations.</p>
<p>We assume that you have already read Adobe InDesign Scripting Tutorial and know how to create, install, and run a script. We also assume that you have some knowledge of working with text in InDesign and understand basic typesetting terms.</p>
<h2><a class="anchor" id="id_js_entering_and_importing_text"></a>
Entering and Importing Text</h2>
<p>This section covers the process of getting text into your InDesign documents. Just as you can type text into text frames and place text files using the InDesign user interface, you can create text frames, insert text into a story, or place text files on pages using scripting.</p>
<h3><a class="anchor" id="id_js_creating_a_text_frame"></a>
Creating a text frame</h3>
<p>The following script creates a text frame, sets the bounds (size) of the frame, then enters text in the frame (for the complete script, see the MakeTextFrame tutorial script): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myPage = myDocument.pages.item(0);</div>
<div class="line">    var myTextFrame = myPage.textFrames.add();</div>
<div class="line">    <span class="comment">//Set the bounds of the text frame.</span></div>
<div class="line">    myTextFrame.geometricBounds = [72, 72, 288, 288];</div>
<div class="line">    <span class="comment">//Enter text in the text frame.</span></div>
<div class="line">    myTextFrame.contents = <span class="stringliteral">&quot;This is some example text.&quot;</span></div>
<div class="line">    <span class="comment">//Note that you could also use a properties record to</span></div>
<div class="line">    <span class="comment">//create the frame and set its bounds and contents in one line:</span></div>
<div class="line">    <span class="comment">//var myTextFrame = myDocument.pages.item(0).textFrames.add({geometricBounds:[72, 72, 288, 288], contents:&quot;This is some example text.&quot;});</span></div>
</div><!-- fragment --><p> The following script shows how to create a text frame that is the size of the area defined by the page margins. myGetBounds is a useful function that you can add to your own scripts, and it appears in many other examples in this section. (For the complete script, see MakeTextFrameWithinMargins.) </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myPage = myDocument.pages.item(0);</div>
<div class="line">    <span class="comment">//Create a text frame on the current page.</span></div>
<div class="line">    var myTextFrame = myPage.textFrames.add();</div>
<div class="line">    <span class="comment">//Set the bounds of the text frame.</span></div>
<div class="line">    myTextFrame.geometricBounds = myGetBounds(myDocument, myPage);</div>
<div class="line">    <span class="comment">//Enter text in the text frame.</span></div>
<div class="line">    myTextFrame.contents = <span class="stringliteral">&quot;This is some example text.&quot;</span></div>
</div><!-- fragment --><p> The following script fragment shows the myGetBounds function. </p>
<div class="fragment"><div class="line"><span class="keyword">function</span> myGetBounds(myDocument, myPage){</div>
<div class="line">    var myPageWidth = myDocument.documentPreferences.pageWidth;</div>
<div class="line">    var myPageHeight = myDocument.documentPreferences.pageHeight</div>
<div class="line">    <span class="keywordflow">if</span>(myPage.side == PageSideOptions.leftHand){</div>
<div class="line">        var myX2 = myPage.marginPreferences.left;</div>
<div class="line">        var myX1 = myPage.marginPreferences.right;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span>{</div>
<div class="line">        var myX1 = myPage.marginPreferences.left;</div>
<div class="line">        var myX2 = myPage.marginPreferences.right;</div>
<div class="line">    }</div>
<div class="line">    var myY1 = myPage.marginPreferences.top;</div>
<div class="line">    var myX2 = myPageWidth - myX2;</div>
<div class="line">    var myY2 = myPageHeight - myPage.marginPreferences.bottom;</div>
<div class="line">    <span class="keywordflow">return</span> [myY1, myX1, myY2, myX2];</div>
<div class="line">}</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_adding_text"></a>
Adding text</h3>
<p>To add text to a story, use the contents property of the insertion point at the location where you want to insert the text. The following sample script uses this technique to add text at the end of a story (for the complete script, see AddText): </p>
<div class="fragment"><div class="line">    <span class="comment">//Add text at the end of the text in the text frame.</span></div>
<div class="line">    <span class="comment">//To do this, we&#39;ll use the last insertion point in the story.</span></div>
<div class="line">    <span class="comment">//(&quot;\r&quot; is a return character.)</span></div>
<div class="line">    var myNewText = <span class="stringliteral">&quot;\rThis is a new paragraph of example text.&quot;</span>;</div>
<div class="line">    myTextFrame.parentStory.insertionPoints.item(-1).contents = myNewText;</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_stories_and_text_frames"></a>
Stories and text frames</h3>
<p>All text in an InDesign layout is part of a story, and every story can contain one or more text frames. Creating a text frame creates a story, and stories can contain multiple text frames.</p>
<p>In the preceding script, we added text at the end of the parent story rather than at the end of the text frame. This is because the end of the text frame might not be the end of the story; that depends on the length and formatting of the text. By adding the text to the end of the parent story, we can guarantee that the text is added, regardless of the composition of the text in the text frame.</p>
<p>You always can get a reference to the story using the parentTextFrame property of a text frame. It can be useful to work with the text of a story instead of the text of a text frame; the following script demonstrates the difference. The alerts shows that the text frame does not contain the overset text, but the story does (for the complete script, see StoryAndTextFrame). </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myTextFrame = myDocument.pages.item(0).textFrames.item(0);</div>
<div class="line">    <span class="comment">//Now add text beyond the end of the text frame.</span></div>
<div class="line">    myTextFrame.insertionPoints.item(-1).contents = <span class="stringliteral">&quot;\rThis is some overset text&quot;</span>;</div>
<div class="line">    alert(<span class="stringliteral">&quot;The last paragraph in this alert should be \&quot;This is some overset text\&quot;. Is it?\r&quot;</span> + myTextFrame.contents);</div>
<div class="line">    alert(<span class="stringliteral">&quot;The last paragraph in this alert should be \&quot;This is some overset text\&quot;. Is it?\r&quot;</span> + myTextFrame.parentStory.contents);</div>
</div><!-- fragment --><p> For more on understanding the relationships between text objects in an InDesign document, see <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_understanding_text_objects">Understanding Text Objects</a>.</p>
<h3><a class="anchor" id="id_js_replacing_text"></a>
Replacing text</h3>
<p>The following script replaces a word with a phrase by changing the contents of the appropriate object (for the complete script, see ReplaceWord): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myTextFrame = myDocument.pages.item(0).textFrames.item(0);</div>
<div class="line">    <span class="comment">//Replace the third word with the phrase &quot;a little bit of&quot;.</span></div>
<div class="line">    myTextFrame.parentStory.words.item(2).contents = <span class="stringliteral">&quot;a little bit of&quot;</span>;</div>
</div><!-- fragment --><p> The following script replaces the text in a paragraph (for the complete script, see ReplaceText): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myPage = myDocument.pages.item(0);</div>
<div class="line">    var myTextFrame = myPage.textFrames.item(0);</div>
<div class="line">    <span class="comment">//Replace the text in the second paragraph without replacing</span></div>
<div class="line">    <span class="comment">//the return character at the end of the paragraph. To do this,</span></div>
<div class="line">    <span class="comment">//we&#39;ll use the ItemByRange method.</span></div>
<div class="line">    var myStartCharacter = myTextFrame.parentStory.paragraphs.item(1).characters.item(0);</div>
<div class="line">    var myEndCharacter = myTextFrame.parentStory.paragraphs.item(1).characters.item(-2);</div>
<div class="line">    myTextFrame.texts.itemByRange(myStartCharacter, myEndCharacter).contents = <span class="stringliteral">&quot;This text replaces the text in paragraph 2.&quot;</span></div>
</div><!-- fragment --><p> In the preceding script above, we excluded the return character because deleting the return might change the paragraph style applied to the paragraph. To do this, we used ItemByRange method, and we supplied two characters-the starting and ending characters of the paragraph-as parameters.</p>
<h3><a class="anchor" id="id_js_inserting_special_characters"></a>
Inserting special characters</h3>
<p>Because the ExtendScript Toolkit supports Unicode, you can simply enter Unicode characters in text strings that you send to InDesign. Alternately, you can use the JavaScript method of explicitly entering Unicode characters by their glyph ID number: \unnnn (where nnnn is the Unicode code for the character). The following script shows several ways to enter special characters. (We omitted the myGetBounds function from this listing; you can find it in <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_creating_a_text_frame">Creating a text frame</a>" or in the SpecialCharacters tutorial script.) </p>
<div class="fragment"><div class="line">var myDocument = app.documents.item(0);</div>
<div class="line"></div>
<div class="line"><span class="comment">//Create a text frame on the current page.</span></div>
<div class="line">var myTextFrame = myDocument.pages.item(0).textFrames.add();</div>
<div class="line"></div>
<div class="line"><span class="comment">//Set the bounds of the text frame.</span></div>
<div class="line">myTextFrame.geometricBounds = myGetBounds(myDocument, myDocument.pages.item(0));</div>
<div class="line"></div>
<div class="line"><span class="comment">//Entering special characters directly.</span></div>
<div class="line">myTextFrame.contents = <span class="stringliteral">&quot;Registered trademark: \rCopyright: &amp;copy;\rTrademark: ?\r&quot;</span>;</div>
<div class="line"></div>
<div class="line"><span class="comment">//Entering special characters by their Unicode glyph ID value:</span></div>
<div class="line">myTextFrame.parentStory.insertionPoints.item(-1).contents = <span class="stringliteral">&quot;Not equal to: \u2260\rSquare root: \u221A\rParagraph: \u00B6\r&quot;</span>;</div>
<div class="line"></div>
<div class="line"><span class="comment">//Entering InDesign special characters by their enumerations:</span></div>
<div class="line">myTextFrame.parentStory.insertionPoints.item(-1).contents = <span class="stringliteral">&quot;Automatic page number marker:&quot;</span>;</div>
<div class="line">myTextFrame.parentStory.insertionPoints.item(-1).contents = SpecialCharacters.autoPageNumber;</div>
<div class="line">myTextFrame.parentStory.insertionPoints.item(-1).contents = <span class="stringliteral">&quot;\r&quot;</span>;</div>
<div class="line">myTextFrame.parentStory.insertionPoints.item(-1).contents = <span class="stringliteral">&quot;Section symbol:&quot;</span>;</div>
<div class="line">myTextFrame.parentStory.insertionPoints.item(-1).contents = SpecialCharacters.sectionSymbol;</div>
<div class="line">myTextFrame.parentStory.insertionPoints.item(-1).contents = <span class="stringliteral">&quot;\r&quot;</span>;</div>
<div class="line">myTextFrame.parentStory.insertionPoints.item(-1).contents = <span class="stringliteral">&quot;En dash:&quot;</span>;</div>
<div class="line">myTextFrame.parentStory.insertionPoints.item(-1).contents = SpecialCharacters.enDash;</div>
<div class="line">myTextFrame.parentStory.insertionPoints.item(-1).contents = <span class="stringliteral">&quot;\r&quot;</span>;</div>
</div><!-- fragment --><p>The easiest way to find the Unicode ID for a character is to use InDesign's Glyphs palette: move the cursor over a character in the palette, and InDesign displays its Unicode value. To learn more about Unicode, visit <a href="http://www.unicode.org">http://www.unicode.org </a>.</p>
<h2><a class="anchor" id="id_js_placing_text_and_setting_text-import_preferences"></a>
Placing Text and Setting Text-Import Preferences</h2>
<p>In addition to entering text strings, you can place text files created using word processors and text editors. The following script shows how to place a text file on a document page (for the complete script, see PlaceTextFile): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myPage = myDocument.pages.item(0);</div>
<div class="line">    <span class="comment">//Get the top and left margins to use as a place point.</span></div>
<div class="line">    var myX = myPage.marginPreferences.left;</div>
<div class="line">    var myY = myPage.marginPreferences.top;</div>
<div class="line">    <span class="comment">//Autoflow a text file on the current page.</span></div>
<div class="line">    <span class="comment">//Parameters for Page.place():</span></div>
<div class="line">    <span class="comment">//File as File object, </span></div>
<div class="line">    <span class="comment">//[PlacePoint as Array [x, y]]</span></div>
<div class="line">    <span class="comment">//[DestinationLayer as Layer object]</span></div>
<div class="line">    <span class="comment">//[ShowingOptions as Boolean = False]</span></div>
<div class="line">    <span class="comment">//[Autoflowing as Boolean = False]</span></div>
<div class="line">    <span class="comment">//You&#39;ll have to fill in your own file path.</span></div>
<div class="line">    var myStory = myPage.place(File(<span class="stringliteral">&quot;/c/test.txt&quot;</span>), [myX, myY], undefined, <span class="keyword">false</span>, <span class="keyword">true</span>)[0];</div>
<div class="line">    <span class="comment">//Note that if the PlacePoint parameter is inside a column, only the vertical (y)</span></div>
<div class="line">    <span class="comment">//coordinate will be honored--the text frame will expand horizontally to fit the column.</span></div>
</div><!-- fragment --><p> The following script shows how to place a text file in an existing text frame. (We omitted the myGetBounds function from this listing; you can find it in <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_creating_a_text_frame">Creating a text frame</a>, or see the PlaceTextFileInFrame tutorial script.) </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myPage = myDocument.pages.item(0);</div>
<div class="line">    var myTextFrame = myPage.textFrames.item(0);</div>
<div class="line">    <span class="comment">//Place a text file in the text frame.</span></div>
<div class="line">    <span class="comment">//Parameters for TextFrame.place():</span></div>
<div class="line">    <span class="comment">//File as File object, </span></div>
<div class="line">    <span class="comment">//[ShowingOptions as Boolean = False]</span></div>
<div class="line">    <span class="comment">//You&#39;ll have to fill in your own file path.</span></div>
<div class="line">    myTextFrame.place(File(<span class="stringliteral">&quot;/c/test.txt&quot;</span>));</div>
</div><!-- fragment --><p> The following script shows how to insert a text file at a specific location in text. (We omitted the myGetBounds function from this listing; you can find it in <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_creating_a_text_frame">Creating a text frame</a>, or see the InsertTextFile tutorial script.) </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myPage = myDocument.pages.item(0);</div>
<div class="line">    var myTextFrame = myPage.textFrames.item(0);</div>
<div class="line">    <span class="comment">//Place a text file at the end of the text.</span></div>
<div class="line">    <span class="comment">//Parameters for InsertionPoint.place():</span></div>
<div class="line">    <span class="comment">//File as File object, </span></div>
<div class="line">    <span class="comment">//[ShowingOptions as Boolean = False]</span></div>
<div class="line">    <span class="comment">//You&#39;ll have to fill in your own file path.</span></div>
<div class="line">    myTextFrame.parentStory.insertionPoints.item(-1).place(File(<span class="stringliteral">&quot;/c/test.txt&quot;</span>));</div>
</div><!-- fragment --><p> To specify the import options for the specific type of text file you are placing, use the corresponding import-preferences object. The following script shows how to set text-import preferences (for the complete script, see TextImportPreferences). The comments in the script show the possible values for each property. </p>
<div class="fragment"><div class="line">    with(app.textImportPreferences){</div>
<div class="line">        <span class="comment">//Options for characterSet: TextImportCharacterSet.</span></div>
<div class="line">        characterSet = TextImportCharacterSet.UTF8;</div>
<div class="line">        convertSpacesIntoTabs = <span class="keyword">true</span>;</div>
<div class="line">        spacesIntoTabsCount = 3;</div>
<div class="line">        <span class="comment">//The dictionary property can take many values, such as French, Italian.</span></div>
<div class="line">        dictionary = <span class="stringliteral">&quot;English: USA&quot;</span>;</div>
<div class="line">        <span class="comment">//platform options: ImportPlatform</span></div>
<div class="line">        platform = ImportPlatform.macintosh;</div>
<div class="line">        stripReturnsBetweenLines = <span class="keyword">true</span>;</div>
<div class="line">        stripReturnsBetweenParagraphs = <span class="keyword">true</span>;</div>
<div class="line">        useTypographersQuotes = <span class="keyword">true</span>;</div>
<div class="line">    }</div>
</div><!-- fragment --><p> The following script shows how to set tagged text import preferences (for the complete script, see TaggedTextImportPreferences): </p>
<div class="fragment"><div class="line">    with(app.taggedTextImportPreferences){</div>
<div class="line">        removeTextFormatting = <span class="keyword">false</span>;</div>
<div class="line">        <span class="comment">//styleConflict property can be:</span></div>
<div class="line">        <span class="comment">//StyleConflict.publicationDefinition</span></div>
<div class="line">        <span class="comment">//StyleConflict.tagFileDefinition</span></div>
<div class="line">        styleConflict = StyleConflict.publicationDefinition;</div>
<div class="line">        useTypographersQuotes = <span class="keyword">true</span>;</div>
<div class="line">    }</div>
</div><!-- fragment --><p> The following script shows how to set Word and RTF import preferences (for the complete script, see WordRTFImportPreferences): </p>
<div class="fragment"><div class="line">    with(app.wordRTFImportPreferences){</div>
<div class="line">        <span class="comment">//convertPageBreaks property can be:</span></div>
<div class="line">        <span class="comment">//ConvertPageBreaks.columnBreak</span></div>
<div class="line">        <span class="comment">//ConvertPageBreaks.none</span></div>
<div class="line">        <span class="comment">//ConvertPageBreaks.pageBreak</span></div>
<div class="line">        convertPageBreaks = ConvertPageBreaks.none;</div>
<div class="line">        <span class="comment">//convertTablesTo property can be:</span></div>
<div class="line">        <span class="comment">//ConvertTablesOptions.unformattedTabbedText</span></div>
<div class="line">        <span class="comment">//ConvertTablesOptions.unformattedTable</span></div>
<div class="line">        convertTablesTo = ConvertTablesOptions.unformattedTable;</div>
<div class="line">        importEndnotes = <span class="keyword">true</span>;</div>
<div class="line">        importFootnotes = <span class="keyword">true</span>;</div>
<div class="line">        importIndex = <span class="keyword">true</span>;</div>
<div class="line">        importTOC = <span class="keyword">true</span>;</div>
<div class="line">        importUnusedStyles = <span class="keyword">false</span>;</div>
<div class="line">        preserveGraphics = <span class="keyword">false</span>;</div>
<div class="line">        preserveLocalOverrides = <span class="keyword">false</span>;</div>
<div class="line">        preserveTrackChanges = <span class="keyword">false</span>;</div>
<div class="line">        removeFormatting = <span class="keyword">false</span>;</div>
<div class="line">        <span class="comment">//resolveCharacterSytleClash and resolveParagraphStyleClash properties can be:</span></div>
<div class="line">        <span class="comment">//ResolveStyleClash.resolveClashAutoRename</span></div>
<div class="line">        <span class="comment">//ResolveStyleClash.resolveClashUseExisting</span></div>
<div class="line">        <span class="comment">//ResolveStyleClash.resolveClashUseNew</span></div>
<div class="line">        resolveCharacterStyleClash = ResolveStyleClash.resolveClashUseExisting;</div>
<div class="line">        resolveParagraphStyleClash = ResolveStyleClash.resolveClashUseExisting;</div>
<div class="line">        useTypographersQuotes = <span class="keyword">true</span>;</div>
<div class="line">    }</div>
</div><!-- fragment --><p> The following script shows how to set Excel import preferences (for the complete script, see ExcelImportPreferences): </p>
<div class="fragment"><div class="line">    with(app.excelImportPreferences){</div>
<div class="line">        <span class="comment">//alignmentStyle property can be:</span></div>
<div class="line">        <span class="comment">//AlignmentStyleOptions.centerAlign</span></div>
<div class="line">        <span class="comment">//AlignmentStyleOptions.leftAlign</span></div>
<div class="line">        <span class="comment">//AlignmentStyleOptions.rightAlign</span></div>
<div class="line">        <span class="comment">//AlignmentStyleOptions.spreadsheet</span></div>
<div class="line">        alignmentStyle = AlignmentStyleOptions.spreadsheet;</div>
<div class="line">        decimalPlaces = 4;</div>
<div class="line">        preserveGraphics = <span class="keyword">false</span>;</div>
<div class="line">        <span class="comment">//Enter the range you want to import as &quot;start cell:end cell&quot;.</span></div>
<div class="line">        rangeName = <span class="stringliteral">&quot;A1:B16&quot;</span>;</div>
<div class="line">        sheetIndex = 1;</div>
<div class="line">        sheetName = <span class="stringliteral">&quot;pathpoints&quot;</span>;</div>
<div class="line">        showHiddenCells = <span class="keyword">false</span>;</div>
<div class="line">        <span class="comment">//tableFormatting property can be:</span></div>
<div class="line">        <span class="comment">//TableFormattingOptions.excelFormattedTable</span></div>
<div class="line">        <span class="comment">//TableFormattingOptions.excelUnformattedTabbedText</span></div>
<div class="line">        <span class="comment">//TableFormattingOptions.excelUnformattedTable</span></div>
<div class="line">        tableFormatting = TableFormattingOptions.excelFormattedTable;</div>
<div class="line">        useTypographersQuotes = <span class="keyword">true</span>;</div>
<div class="line">        viewName = <span class="stringliteral">&quot;&quot;</span>;  </div>
<div class="line">    }</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_exporting_text_and_setting_text-export_preferences"></a>
Exporting Text and Setting Text-Export Preferences</h2>
<p>The following script shows how to export text from an InDesign document. Note that you must use text or story objects to export into text file formats; you cannot export all text in a document in one operation. (We omitted the myGetBounds function from this listing; you can find it in <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_creating_a_text_frame">Creating a text frame</a>, or see the ExportTextFile tutorial script.) </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myPage = myDocument.pages.item(0);</div>
<div class="line">    var myTextFrame = myPage.textFrames.item(0);</div>
<div class="line">    <span class="comment">//Text exportFile method parameters:</span></div>
<div class="line">    <span class="comment">//Format as ExportFormat</span></div>
<div class="line">    <span class="comment">//To As File</span></div>
<div class="line">    <span class="comment">//[ShowingOptions As Boolean = False]</span></div>
<div class="line">    <span class="comment">//Format parameter can be:</span></div>
<div class="line">    <span class="comment">//ExportFormat.incopyMarkup</span></div>
<div class="line">    <span class="comment">//ExportFormat.html</span></div>
<div class="line">    <span class="comment">//ExportFormat.epub</span></div>
<div class="line">    <span class="comment">//ExportFormat.rtf</span></div>
<div class="line">    <span class="comment">//ExportFormat.taggedText</span></div>
<div class="line">    <span class="comment">//ExportFormat.textType</span></div>
<div class="line">    <span class="comment">//Export the story as text. You&#39;ll have to fill in a valid file path on your system.</span></div>
<div class="line">    myTextFrame.parentStory.exportFile(ExportFormat.textType, File(<span class="stringliteral">&quot;/c/test.txt&quot;</span>));</div>
</div><!-- fragment --><p> The following example shows how to export a specific range of text. (We omitted the myGetBounds function from this listing; you can find it in <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_creating_a_text_frame">Creating a text frame</a>, or see the ExportTextRange tutorial script.) </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myStory = myDocument.stories.item(0);</div>
<div class="line">    var myStart = myStory.characters.item(0);</div>
<div class="line">    var myEnd = myStory.paragraphs.item(0).characters.item(-1);</div>
<div class="line">    myText = myStory.texts.itemByRange(myStart, myEnd);</div>
<div class="line">    <span class="comment">//Text exportFile method parameters:</span></div>
<div class="line">    <span class="comment">//Format as ExportFormat</span></div>
<div class="line">    <span class="comment">//To As File</span></div>
<div class="line">    <span class="comment">//[ShowingOptions As Boolean = False]</span></div>
<div class="line">    <span class="comment">//Format parameter can be:</span></div>
<div class="line">    <span class="comment">//ExportFormat.inCopy</span></div>
<div class="line">    <span class="comment">//ExportFormat.inCopyCS2Story</span></div>
<div class="line">    <span class="comment">//ExportFormat.rtf</span></div>
<div class="line">    <span class="comment">//ExportFormat.taggedText</span></div>
<div class="line">    <span class="comment">//ExportFormat.textType</span></div>
<div class="line">    <span class="comment">//Export the text range. You&#39;ll have to fill in a valid file path on your system.</span></div>
<div class="line">    myText.exportFile(ExportFormat.textType, File(<span class="stringliteral">&quot;/c/test.txt&quot;</span>));</div>
</div><!-- fragment --><p> To specify the export options for the specific type of text file you're exporting, use the corresponding export preferences object. The following script sets text-export preferences (for the complete script, see TextExportPreferences): </p>
<div class="fragment"><div class="line">    with(app.textExportPreferences){</div>
<div class="line">        <span class="comment">//Options for characterSet: TextExportCharacterSet</span></div>
<div class="line">        characterSet = TextExportCharacterSet.UTF8;</div>
<div class="line">        <span class="comment">//platform options: ImportPlatform</span></div>
<div class="line">        platform = ImportPlatform.macintosh;</div>
<div class="line">    }</div>
</div><!-- fragment --><p> The following script sets tagged text export preferences (for the complete script, see TaggedTextExportPreferences): </p>
<div class="fragment"><div class="line">    with(app.taggedTextExportPreferences){</div>
<div class="line">        <span class="comment">//Options for characterSet:</span></div>
<div class="line">        <span class="comment">//TagTextExportCharacterSet.ansi</span></div>
<div class="line">        <span class="comment">//TagTextExportCharacterSet.ascii</span></div>
<div class="line">        <span class="comment">//TagTextExportCharacterSet.gb18030</span></div>
<div class="line">        <span class="comment">//TagTextExportCharacterSet.ksc5601</span></div>
<div class="line">        <span class="comment">//TagTextExportCharacterSet.shiftJIS</span></div>
<div class="line">        <span class="comment">//TagTextExportCharacterSet.unicode</span></div>
<div class="line">        characterSet = TagTextExportCharacterSet.unicode;</div>
<div class="line">        <span class="comment">//tagForm options:</span></div>
<div class="line">        <span class="comment">//TagTextForm.abbreviated</span></div>
<div class="line">        <span class="comment">//TagTextForm.verbose</span></div>
<div class="line">        tagForm = TagTextForm.verbose;</div>
<div class="line">    }</div>
</div><!-- fragment --><p> You cannot export all text in a document in one step. Instead, you need to either combine the text in the document into a single story and then export that story, or combine the text files by reading and writing files via scripting. The following script demonstrates the former approach. (We omitted the myGetBounds function from this listing; you can find it in <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_creating_a_text_frame">Creating a text frame</a>, or see the ExportAllText tutorial script.) For any format other than text only, the latter method can become quite complex. </p>
<div class="fragment"><div class="line">    <span class="keywordflow">if</span>(app.documents.length != 0){</div>
<div class="line">        <span class="keywordflow">if</span>(app.documents.item(0).stories.length != 0){</div>
<div class="line">            myExportAllText(app.documents.item(0).name);</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment --><p> Here is the ExportAllText function referred to in the preceding fragment: </p>
<div class="fragment"><div class="line"><span class="keyword">function</span> myExportAllText(myDocumentName){</div>
<div class="line">    var myStory;</div>
<div class="line">    <span class="comment">//File name for the exported text. Fill in a valid file path on your system.</span></div>
<div class="line">    var myFileName = <span class="stringliteral">&quot;/c/test.txt&quot;</span>;</div>
<div class="line">    <span class="comment">//If you want to add a separator line between stories, set myAddSeparator to true.</span></div>
<div class="line">    var myAddSeparator = <span class="keyword">true</span>;</div>
<div class="line">    var myNewDocument = app.documents.add();</div>
<div class="line">    var myDocument = app.documents.item(myDocumentName);</div>
<div class="line">    var myTextFrame = myNewDocument.pages.item(0).textFrames.add({geometricBounds:myGetBounds(myNewDocument, myNewDocument.pages.item(0))});</div>
<div class="line">    var myNewStory = myTextFrame.parentStory;</div>
<div class="line">    <span class="keywordflow">for</span>(myCounter = 0; myCounter &lt; myDocument.stories.length; myCounter++){</div>
<div class="line">        myStory = myDocument.stories.item(myCounter);</div>
<div class="line">        <span class="comment">//Export the story as tagged text.</span></div>
<div class="line">        myStory.exportFile(ExportFormat.taggedText, File(myFileName));</div>
<div class="line">        <span class="comment">//Import (place) the file at the end of the temporary story.</span></div>
<div class="line">        myNewStory.insertionPoints.item(-1).place(File(myFileName));</div>
<div class="line">        <span class="comment">//If the imported text did not end with a return, enter a return</span></div>
<div class="line">        <span class="comment">//to keep the stories from running together.</span></div>
<div class="line">        <span class="keywordflow">if</span>(myCounter != myDocument.stories.length -1){</div>
<div class="line">            <span class="keywordflow">if</span>(myNewStory.characters.item(-1).contents != <span class="stringliteral">&quot;\r&quot;</span>){</div>
<div class="line">                myNewStory.insertionPoints.item(-1).contents = <span class="stringliteral">&quot;\r&quot;</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span>(myAddSeparator == <span class="keyword">true</span>){</div>
<div class="line">                myNewStory.insertionPoints.item(-1).contents = <span class="stringliteral">&quot;----------------------------------------\r&quot;</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    myNewStory.exportFile(ExportFormat.taggedText, File(<span class="stringliteral">&quot;/c/test.txt&quot;</span>));</div>
<div class="line">    myNewDocument.close(SaveOptions.no);</div>
<div class="line">}</div>
</div><!-- fragment --><p> Do not assume that you are limited to exporting text using existing export filters. Because JavaScript can write text files to disk, you can have your script traverse the text in a document and export it in any order you like, using whatever text mark-up scheme you prefer. Here is a very simple example that shows how to export InDesign text as HTML. (We omitted the myGetBounds function from this listing; you can find it in <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_creating_a_text_frame">Creating a text frame</a>, or see the ExportHTML tutorial script.) </p>
<div class="fragment"><div class="line">    var myStory, myParagraph, myString, myTag, myStartTag, myEndTag, myTextStyleRange, myTable;</div>
<div class="line">    <span class="comment">//Use the myStyleToTagMapping array to set up your paragraph style to tag mapping.</span></div>
<div class="line">    var myStyleToTagMapping = <span class="keyword">new</span> Array;</div>
<div class="line">    <span class="comment">//For each style to tag mapping, add a new item to the array.</span></div>
<div class="line">    myStyleToTagMapping.push([<span class="stringliteral">&quot;body_text&quot;</span>, <span class="stringliteral">&quot;p&quot;</span>]);</div>
<div class="line">    myStyleToTagMapping.push([<span class="stringliteral">&quot;heading1&quot;</span>, <span class="stringliteral">&quot;h1&quot;</span>]);</div>
<div class="line">    myStyleToTagMapping.push([<span class="stringliteral">&quot;heading2&quot;</span>, <span class="stringliteral">&quot;h2&quot;</span>]);</div>
<div class="line">    myStyleToTagMapping.push([<span class="stringliteral">&quot;heading3&quot;</span>, <span class="stringliteral">&quot;h3&quot;</span>]);</div>
<div class="line">    <span class="comment">//End of style to tag mapping.</span></div>
<div class="line">    <span class="keywordflow">if</span>(app.documents.length !=0){</div>
<div class="line">        <span class="keywordflow">if</span>(app.documents.item(0).stories.length != 0){</div>
<div class="line">            <span class="comment">//Open a new text file.</span></div>
<div class="line">            var myTextFile = File.saveDialog(<span class="stringliteral">&quot;Save HTML As&quot;</span>, undefined);</div>
<div class="line">            <span class="comment">//If the user clicked the Cancel button, the result is null.</span></div>
<div class="line">            <span class="keywordflow">if</span>(myTextFile != null){</div>
<div class="line">                <span class="comment">//Open the file with write access.</span></div>
<div class="line">                myTextFile.open(<span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line">                <span class="comment">//Iterate through the stories.</span></div>
<div class="line">                <span class="keywordflow">for</span>(var myCounter = 0; myCounter &lt; app.documents.item(0).stories.length; myCounter ++){</div>
<div class="line">                    myStory = app.documents.item(0).stories.item(myCounter);</div>
<div class="line">                    <span class="keywordflow">for</span>(var myParagraphCounter = 0; myParagraphCounter &lt; myStory.paragraphs.length; myParagraphCounter ++){</div>
<div class="line">                        myParagraph = myStory.paragraphs.item(myParagraphCounter);</div>
<div class="line">                        <span class="keywordflow">if</span>(myParagraph.tables.length == 0){</div>
<div class="line">                            <span class="keywordflow">if</span>(myParagraph.textStyleRanges.length == 1){</div>
<div class="line">                                <span class="comment">//If the paragraph is a simple paragraph--no tables, no local formatting--then</span></div>
<div class="line">                                <span class="comment">//simply export the text of the pararaph with the appropriate tag.</span></div>
<div class="line">                                myTag = myFindTag(myParagraph.appliedParagraphStyle.name, myStyleToTagMapping);</div>
<div class="line">                                <span class="comment">//If the tag comes back empty, map it to the basic paragraph tag.</span></div>
<div class="line">                                <span class="keywordflow">if</span>(myTag == <span class="stringliteral">&quot;&quot;</span>){</div>
<div class="line">                                    myTag = <span class="stringliteral">&quot;p&quot;</span>;</div>
<div class="line">                                }</div>
<div class="line">                                myStartTag = <span class="stringliteral">&quot;&lt;&quot;</span> + myTag + <span class="stringliteral">&quot;&gt;&quot;</span>;</div>
<div class="line">                                myEndTag = <span class="stringliteral">&quot;&lt;/&quot;</span> + myTag + <span class="stringliteral">&quot;&gt;&quot;</span>;</div>
<div class="line">                                <span class="comment">//If the paragraph is not the last paragraph in the story,</span></div>
<div class="line">                                <span class="comment">//omit the return character.</span></div>
<div class="line">                                <span class="keywordflow">if</span>(myParagraph.characters.item(-1).contents == <span class="stringliteral">&quot;\r&quot;</span>){</div>
<div class="line">                                    myString = myParagraph.texts.itemByRange(myParagraph.characters.item(0), myParagraph.characters.item(-2)).contents;</div>
<div class="line">                                }</div>
<div class="line">                                <span class="keywordflow">else</span>{</div>
<div class="line">                                    myString = myParagraph.contents;                        </div>
<div class="line">                                }</div>
<div class="line">                                <span class="comment">//Write the paragraphs&#39; text to the text file.</span></div>
<div class="line">                                myTextFile.writeln(myStartTag + myString + myEndTag);</div>
<div class="line">                            }</div>
<div class="line">                            <span class="keywordflow">else</span>{</div>
<div class="line">                                <span class="comment">//Handle text style range export by iterating through the text style ranges in the paragraph..</span></div>
<div class="line">                                <span class="keywordflow">for</span>(var myRangeCounter = 0; myRangeCounter &lt; myParagraph.textStyleRanges.length; myRangeCounter ++){</div>
<div class="line">                                    myTextStyleRange = myParagraph.textStyleRanges.item(myRangeCounter);</div>
<div class="line">                                    <span class="keywordflow">if</span>(myTextStyleRange.characters.item(-1)==<span class="stringliteral">&quot;\r&quot;</span>){</div>
<div class="line">                                        myString = myTextStyleRange.texts.itemByRange(myTextStyleRange.characters.item(1), myTextStyleRange.characters.item(-2)).contents;</div>
<div class="line">                                    }</div>
<div class="line">                                    <span class="keywordflow">else</span>{</div>
<div class="line">                                        myString = myTextStyleRange.contents;</div>
<div class="line">                                    }</div>
<div class="line">                                    <span class="keywordflow">switch</span>(myTextStyleRange.fontStyle){</div>
<div class="line">                                        <span class="keywordflow">case</span> <span class="stringliteral">&quot;Bold&quot;</span>:</div>
<div class="line">                                            myString = <span class="stringliteral">&quot;&lt;b&gt;&quot;</span> + myString + <span class="stringliteral">&quot;&lt;/b&gt;&quot;</span></div>
<div class="line">                                            <span class="keywordflow">break</span>;</div>
<div class="line">                                        <span class="keywordflow">case</span> <span class="stringliteral">&quot;Italic&quot;</span>:</div>
<div class="line">                                            myString = <span class="stringliteral">&quot;&lt;i&gt;&quot;</span> + myString + <span class="stringliteral">&quot;&lt;/i&gt;&quot;</span></div>
<div class="line">                                            <span class="keywordflow">break</span>;</div>
<div class="line">                                    }</div>
<div class="line">                                    myTextFile.write(myString);</div>
<div class="line">                                }</div>
<div class="line">                                myTextFile.write(<span class="stringliteral">&quot;\r&quot;</span>);</div>
<div class="line">                            }</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">else</span>{</div>
<div class="line">                            <span class="comment">//Handle table export (assumes that there is only one table per paragraph,</span></div>
<div class="line">                            <span class="comment">//and that the table is in the paragraph by itself).</span></div>
<div class="line">                            myTable = myParagraph.tables.item(0);</div>
<div class="line">                            myTextFile.writeln(<span class="stringliteral">&quot;&lt;table border = 1&gt;&quot;</span>);</div>
<div class="line">                            <span class="keywordflow">for</span>(var myRowCounter = 0; myRowCounter &lt; myTable.rows.length; myRowCounter ++){</div>
<div class="line">                                myTextFile.writeln(<span class="stringliteral">&quot;&lt;tr&gt;&quot;</span>);</div>
<div class="line">                                <span class="keywordflow">for</span>(var myColumnCounter = 0; myColumnCounter &lt; myTable.columns.length; myColumnCounter++){</div>
<div class="line">                                    <span class="keywordflow">if</span>(myRowCounter == 0){</div>
<div class="line">                                        myString = <span class="stringliteral">&quot;&lt;th&gt;&quot;</span> + myTable.rows.item(myRowCounter).cells.item(myColumnCounter).texts.item(0).contents + <span class="stringliteral">&quot;&lt;/th&gt;&quot;</span>;</div>
<div class="line">                                    }</div>
<div class="line">                                    <span class="keywordflow">else</span>{</div>
<div class="line">                                        myString = <span class="stringliteral">&quot;&lt;td&gt;&quot;</span> + myTable.rows.item(myRowCounter).cells.item(myColumnCounter).texts.item(0).contents + <span class="stringliteral">&quot;&lt;/td&gt;&quot;</span>;</div>
<div class="line">                                    }</div>
<div class="line">                                    myTextFile.writeln(myString);</div>
<div class="line">                                }</div>
<div class="line">                                myTextFile.writeln(<span class="stringliteral">&quot;&lt;/tr&gt;&quot;</span>);</div>
<div class="line">                            }</div>
<div class="line">                            myTextFile.writeln(<span class="stringliteral">&quot;&lt;/table&gt;&quot;</span>);</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">                <span class="comment">//Close the text file.</span></div>
<div class="line">                myTextFile.close();</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment --><p> Here is the myFindTag function referred to in the above script: </p>
<div class="fragment"><div class="line"><span class="keyword">function</span> myFindTag (myStyleName, myStyleToTagMapping){</div>
<div class="line">    var myTag = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">    var myDone = <span class="keyword">false</span>;</div>
<div class="line">    var myCounter = 0;</div>
<div class="line">    <span class="keywordflow">do</span>{</div>
<div class="line">        <span class="keywordflow">if</span>(myStyleToTagMapping[myCounter][0] == myStyleName){</div>
<div class="line">            myTag = myStyleToTagMapping[myCounter][1];</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        myCounter ++;</div>
<div class="line">    } <span class="keywordflow">while</span>((myDone == <span class="keyword">false</span>)||(myCounter &lt; myStyleToTagMapping.length))</div>
<div class="line">    <span class="keywordflow">return</span> myTag;</div>
<div class="line">}</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_understanding_text_objects"></a>
Understanding Text Objects</h2>
<p>The following diagram shows a view of InDesign's text object model. As you can see, there are two main types of text object: layout objects (text frames) and text-stream objects (for example, stories, insertion points, characters, and words):</p>
<div class="image">
<img src="InDesign_ScriptingGuide-3.gif" alt="InDesign_ScriptingGuide-3.gif"/>
</div>
<p>There are many ways to get a reference to a given text object. The following diagram shows a few ways to refer to the first character in the first text frame of the first page of a new document:</p>
<div class="image">
<img src="InDesign_ScriptingGuide-4.gif" alt="InDesign_ScriptingGuide-4.gif"/>
</div>
<p>For any text stream object, the parent of the object is the story containing the object. To get a reference to the text frame (or text frames) containing the text object, use the parentTextFrames property.</p>
<p>For a text frame, the parent of the text frame usually is the page or spread containing the text frame. If the text frame is inside a group or was pasted inside another page item, the parent of the text frame is the containing page item. If the text frame was converted to an anchored frame, the parent of the text frame is the character containing the anchored frame.</p>
<h3><a class="anchor" id="id_js_working_with_text_selections"></a>
Working with text selections</h3>
<p>Text-related scripts often act on a text selection. The following script demonstrates a way to determine whether the current selection is a text selection. Unlike many of the other sample scripts, this script does not actually do anything; it simply presents a selection-filtering routine that you can use in your own scripts (for the complete script, see TextSelection). </p>
<div class="fragment"><div class="line">    <span class="keywordflow">if</span> (app.documents.length != 0){</div>
<div class="line">        <span class="comment">//If the selection contains more than one item, the selection</span></div>
<div class="line">        <span class="comment">//is not text selected with the Type tool.</span></div>
<div class="line">        <span class="keywordflow">if</span> (app.selection.length == 1){</div>
<div class="line">            <span class="comment">//Evaluate the selection based on its type.</span></div>
<div class="line">            <span class="keywordflow">switch</span> (app.selection[0].constructor.name){</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;InsertionPoint&quot;</span>:</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Character&quot;</span>:</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Word&quot;</span>:</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;TextStyleRange&quot;</span>:</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Line&quot;</span>:</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Paragraph&quot;</span>:</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;TextColumn&quot;</span>:</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Text&quot;</span>:</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Story&quot;</span>:</div>
<div class="line">                    <span class="comment">//The object is a text object; pass it on to a function.</span></div>
<div class="line">                    myProcessText(app.selection[0]);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="comment">//In addition to checking for the above text objects, we can</span></div>
<div class="line">                <span class="comment">//also continue if the selection is a text frame selected with</span></div>
<div class="line">                <span class="comment">//the Selection tool or the Direct Selection tool.</span></div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;TextFrame&quot;</span>:</div>
<div class="line">                    <span class="comment">//If the selection is a text frame, get a reference to the</span></div>
<div class="line">                    <span class="comment">//text in the text frame.</span></div>
<div class="line">                    myProcessText(app.selection[0].texts.item(0));</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                    alert(<span class="stringliteral">&quot;The selected object is not a text object. Select some text and try again.&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span>{</div>
<div class="line">            alert(<span class="stringliteral">&quot;Please select some text and try again.&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_moving_and_copying_text"></a>
Moving and copying text</h3>
<p>You can move a text object to another location in text using the move method. To copy the text, use the duplicate method (whose arguments are identical to the move method). The following script fragment shows how it works (for the complete script, see MoveText): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myPage = myDocument.pages.item(0);</div>
<div class="line">    var myTextFrameA = myPage.textFrames.item(3);</div>
<div class="line">    var myTextFrameB = myPage.textFrames.item(2);</div>
<div class="line">    var myTextFrameC = myPage.textFrames.item(1);</div>
<div class="line">    var myTextFrameD = myPage.textFrames.item(0);</div>
<div class="line">    <span class="comment">//Move WordC between the words in TextFrameC.</span></div>
<div class="line">    myTextFrameD.parentStory.paragraphs.item(-1).words.item(0).move(LocationOptions.before, myTextFrameC.parentStory.paragraphs.item(0).words.item(1))</div>
<div class="line">    <span class="comment">//Move WordB after the word in TextFrameB.</span></div>
<div class="line">    myTextFrameD.parentStory.paragraphs.item(-2).words.item(0).move(LocationOptions.after, myTextFrameB.parentStory.paragraphs.item(0).words.item(0))</div>
<div class="line">    <span class="comment">//Move WordA to before the word in TextFrameA.</span></div>
<div class="line">    myTextFrameD.parentStory.paragraphs.item(-3).words.item(0).move(LocationOptions.before, myTextFrameA.parentStory.paragraphs.item(0).words.item(0))</div>
<div class="line">    <span class="comment">//Note that moving text removes it from its original location.</span></div>
</div><!-- fragment --><p> When you want to transfer formatted text from one document to another, you also can use the move method. Using the move or duplicate method is better than using copy and paste; to use copy and paste, you must make the document visible and select the text you want to copy. Using move or duplicate is much faster and more robust. The following script shows how to move text from one document to another using move and duplicate. (We omitted the myGetBounds function from this listing; you can find it in <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_creating_a_text_frame">Creating a text frame</a>, or see the MoveTextBetweenDocuments tutorial script.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Create the source document.</span></div>
<div class="line">    var mySourceDocument = app.documents.add();</div>
<div class="line">    var mySourcePage = mySourceDocument.pages.item(0);</div>
<div class="line">    var mySourceTextFrame = mySourcePage.textFrames.add({geometricBounds:myGetBounds(mySourceDocument, mySourcePage), contents:<span class="stringliteral">&quot;This is the source text.\rThis text is not the source text.&quot;</span>});</div>
<div class="line">    var mySoureParagraph = mySourceTextFrame.parentStory.paragraphs.item(0);</div>
<div class="line">    mySoureParagraph.pointSize = 24;</div>
<div class="line">    <span class="comment">//Create the target document.</span></div>
<div class="line">    var myTargetDocument = app.documents.add();</div>
<div class="line">    var myTargetPage = myTargetDocument.pages.item(0);</div>
<div class="line">    var myTargetTextFrame = myTargetPage.textFrames.add({geometricBounds:myGetBounds(myTargetDocument, myTargetDocument.pages.item(0)), contents:<span class="stringliteral">&quot;This is the target text. Insert the source text before this paragraph.\r&quot;</span>});</div>
<div class="line">    <span class="comment">//Move the text from the source document to the target document.</span></div>
<div class="line">    <span class="comment">//This deletes the text from the source document.</span></div>
<div class="line">    mySoureParagraph.move(LocationOptions.AT_BEGINNING, myTargetTextFrame.insertionPoints.item(0));</div>
<div class="line">    <span class="comment">//To duplicate (rather than move) the text, use the following:</span></div>
<div class="line">    <span class="comment">//mySoureParagraph.duplicate(LocationOptions.AT_BEGINNING, myTargetTextFrame.insertionPoints.item(0));</span></div>
</div><!-- fragment --><p> When you need to copy and paste text, you can use the copy method of the application. You will need to select the text before you copy. Again, you should use copy and paste only as a last resort; other approaches are faster, less fragile, and do not depend on the document being visible. (We omitted the myGetBounds function from this listing; you can find it in <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_creating_a_text_frame">Creating a text frame</a>, or see the CopyPasteText tutorial script.) </p>
<div class="fragment"><div class="line">    var myDocumentA = app.documents.add();</div>
<div class="line">    var myPageA = myDocumentA.pages.item(0);</div>
<div class="line">    var myString = <span class="stringliteral">&quot;Example text.\r&quot;</span>;</div>
<div class="line">    var myTextFrameA = myPageA.textFrames.add({geometricBounds:myGetBounds(myDocumentA, myPageA), contents:myString});</div>
<div class="line">    var myDocumentB = app.documents.add();</div>
<div class="line">    var myPageB = myDocumentB.pages.item(0);</div>
<div class="line">    var myTextFrameB = myPageB.textFrames.add({geometricBounds:myGetBounds(myDocumentB, myPageB)});</div>
<div class="line">    <span class="comment">//Make document A the active document.</span></div>
<div class="line">    app.activeDocument = myDocumentA;</div>
<div class="line">    <span class="comment">//Select the text.</span></div>
<div class="line">    app.select(myTextFrameA.parentStory.texts.item(0));</div>
<div class="line">    app.copy();</div>
<div class="line">    <span class="comment">//Make document B the active document.</span></div>
<div class="line">    app.activeDocument = myDocumentB;</div>
<div class="line">    <span class="comment">//Select the insertion point at which you want to paste the text.</span></div>
<div class="line">    app.select(myTextFrameB.parentStory.insertionPoints.item(0));</div>
<div class="line">    app.paste();</div>
</div><!-- fragment --><p> One way to copy unformatted text from one text object to another is to get the contents property of a text object, then use that string to set the contents property of another text object. The following script shows how to do this (for the complete script, see CopyUnformattedText): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myPage = myDocument.pages.item(0);</div>
<div class="line">    <span class="comment">//Create a text frame on the active page.</span></div>
<div class="line">    var myTextFrameA = myPage.textFrames.add({geometricBounds:[72, 72, 144, 288]});</div>
<div class="line">    myTextFrameA.contents = <span class="stringliteral">&quot;This is a formatted string.&quot;</span>;</div>
<div class="line">    myTextFrameA.parentStory.texts.item(0).fontStyle = <span class="stringliteral">&quot;Bold&quot;</span>;</div>
<div class="line">    <span class="comment">//Create another text frame on the active page.</span></div>
<div class="line">    var myTextFrameB = myPage.textFrames.add({geometricBounds:[228, 72, 300, 288]});</div>
<div class="line">    myTextFrameB.contents = <span class="stringliteral">&quot;This is the destination text frame. Text pasted here will retain its formatting.&quot;</span>;</div>
<div class="line">    myTextFrameB.parentStory.texts.item(0).fontStyle = <span class="stringliteral">&quot;Italic&quot;</span>;</div>
<div class="line">    <span class="comment">//Copy from one frame to another using a simple copy.</span></div>
<div class="line">    app.select(myTextFrameA.texts.item(0));</div>
<div class="line">    app.copy();</div>
<div class="line">    app.select(myTextFrameB.parentStory.insertionPoints.item(-1));</div>
<div class="line">    app.paste();</div>
<div class="line">    <span class="comment">//Create another text frame on the active page.</span></div>
<div class="line">    var myTextFrameC = myPage.textFrames.add({geometricBounds:[312, 72, 444, 288]});</div>
<div class="line">    myTextFrameC.contents = <span class="stringliteral">&quot;Text copied here will take on the formatting of the existing text.&quot;</span>;</div>
<div class="line">    myTextFrameC.parentStory.texts.item(0).fontStyle = <span class="stringliteral">&quot;Italic&quot;</span>;</div>
<div class="line">    <span class="comment">//Copy the unformatted string from text frame A to the end of text frame C (note</span></div>
<div class="line">    <span class="comment">//that this doesn&#39;t really copy the text; it replicates the text string from one</span></div>
<div class="line">    <span class="comment">//text frame in another text frame):</span></div>
<div class="line">    myTextFrameC.parentStory.insertionPoints.item(-1).contents = myTextFrameA.parentStory.texts.item(0).contents;</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_text_objects_and_iteration"></a>
Text objects and iteration</h3>
<p>When your script moves, deletes, or adds text while iterating through a series of text objects, you can easily end up with invalid text references. The following script demonstrates this problem. (We omitted the myGetBounds function from this listing; you can find it in <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_creating_a_text_frame">Creating a text frame</a>, or see the TextIterationWrong tutorial script.) </p>
<div class="fragment"><div class="line">    var myDocument = app.activeDocument;</div>
<div class="line">    var myStory = myDocument.stories.item(0);</div>
<div class="line">    <span class="comment">//The following for loop will fail to format all of the paragraphs.</span></div>
<div class="line">    <span class="keywordflow">for</span>(var myParagraphCounter = 0; myParagraphCounter &lt; myStory.paragraphs.length; myParagraphCounter ++){</div>
<div class="line">        <span class="keywordflow">if</span>(myStory.paragraphs.item(myParagraphCounter).words.item(0).contents == <span class="stringliteral">&quot;Delete&quot;</span>){</div>
<div class="line">            myStory.paragraphs.item(myParagraphCounter).remove();</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span>{</div>
<div class="line">            myStory.paragraphs.item(myParagraphCounter).pointSize = 24;</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment --><p> In the preceding example, some of the paragraphs are left unformatted. How does this happen? The loop in the script iterates through the paragraphs from the first paragraph in the story to the last. As it does so, it deletes paragraphs that begin with the word "Delete." When the script deletes the second paragraph, the third paragraph moves up to take its place. When the loop counter reaches 2, the script processes the paragraph that had been the fourth paragraph in the story; the original third paragraph is now the second paragraph and is skipped.</p>
<p>To avoid this problem, iterate backward through the text objects, as shown in the following script. (We omitted the myGetBounds function from this listing; you can find it in <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_creating_a_text_frame">Creating a text frame</a>, " or see the TextIterationRight tutorial script.) </p>
<div class="fragment"><div class="line">    var myDocument = app.activeDocument;</div>
<div class="line">    var myStory = myDocument.stories.item(0);</div>
<div class="line">    <span class="comment">//The following for loop will format all of the paragraphs by iterating </span></div>
<div class="line">    <span class="comment">//backwards through the paragraphs in the story.</span></div>
<div class="line">    <span class="keywordflow">for</span>(var myParagraphCounter = myStory.paragraphs.length-1; myParagraphCounter &gt;= 0; myParagraphCounter --){</div>
<div class="line">        <span class="keywordflow">if</span>(myStory.paragraphs.item(myParagraphCounter).words.item(0).contents == <span class="stringliteral">&quot;Delete&quot;</span>){</div>
<div class="line">            myStory.paragraphs.item(myParagraphCounter).remove();</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span>{</div>
<div class="line">            myStory.paragraphs.item(myParagraphCounter).pointSize = 24;</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_working_with_text_frames"></a>
Working with Text Frames</h2>
<p>In the previous sections of this chapter, we concentrated on working with text stream objects; in this section, we focus on text frames, the page-layout items that contain text in an InDesign document.</p>
<h3><a class="anchor" id="id_js_linking_text_frames"></a>
Linking text frames</h3>
<p>The nextTextFrame and previousTextFrame properties of a text frame are the keys to linking (or "threading") text frames in InDesign scripting. These properties correspond to the in port and out port on InDesign text frames, as shown in the following script fragment (for the complete script, see LinkTextFrames): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myPage = myDocument.pages.item(0);</div>
<div class="line">    var myTextFrameA = myPage.textFrames.item(1);</div>
<div class="line">    var myTextFrameB = myPage.textFrames.item(0);</div>
<div class="line">    <span class="comment">//Add a page.</span></div>
<div class="line">    var myNewPage = myDocument.pages.add();</div>
<div class="line">    <span class="comment">//Create another text frame on the new page.</span></div>
<div class="line">    var myTextFrameC = myNewPage.textFrames.add({geometricBounds:[72, 72, 144, 144]})</div>
<div class="line">    <span class="comment">//Link TextFrameA to TextFrameB using the nextTextFrame property.</span></div>
<div class="line">    myTextFrameA.nextTextFrame = myTextFrameB;</div>
<div class="line">    <span class="comment">//Link TextFrameC to TextFrameB using the previousTextFrame property.</span></div>
<div class="line">    myTextFrameC.previousTextFrame = myTextFrameB;</div>
<div class="line">    <span class="comment">//Fill the text frames with placeholder text.</span></div>
<div class="line">    myTextFrameA.contents = TextFrameContents.placeholderText;</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_unlinking_text_frames"></a>
Unlinking text frames</h3>
<p>The following example script shows how to unlink text frames (for the complete script, see UnlinkTextFrames): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myPage = myDocument.pages.item(0);</div>
<div class="line">    var myTextFrameA =  myPage.textFrames.item(1);</div>
<div class="line">    <span class="comment">//Given a text frame &quot;myTextFrameA&quot; that is linked to another text frame...</span></div>
<div class="line">    <span class="comment">//Unlink the two text frames.</span></div>
<div class="line">    myTextFrameA.nextTextFrame = NothingEnum.nothing;</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_removing_a_frame_from_a_story"></a>
Removing a frame from a story</h3>
<p>In InDesign, deleting a frame from a story does not delete the text in the frame, unless the frame is the only frame in the story. The following script fragment shows how to delete a frame and the text it contains from a story without disturbing the other frames in the story (for the complete script, see BreakFrame): </p>
<div class="fragment"><div class="line">    var myObjectList = <span class="keyword">new</span> Array;</div>
<div class="line">    <span class="comment">//Script does nothing if no documents are open or if no objects are selected.</span></div>
<div class="line">    <span class="keywordflow">if</span>(app.documents.length != 0){</div>
<div class="line">        <span class="keywordflow">if</span>(app.selection.length != 0){</div>
<div class="line">            <span class="comment">//Process the objects in the selection to create a list of</span></div>
<div class="line">            <span class="comment">//qualifying objects (text frames).</span></div>
<div class="line">            <span class="keywordflow">for</span>(myCounter = 0; myCounter &lt; app.selection.length; myCounter ++){</div>
<div class="line">                <span class="keywordflow">switch</span>(app.selection[myCounter].constructor.name){</div>
<div class="line">                    <span class="keywordflow">case</span> <span class="stringliteral">&quot;TextFrame&quot;</span>:</div>
<div class="line">                        myObjectList.push(app.selection[myCounter]);</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">default</span>:</div>
<div class="line">                        <span class="keywordflow">if</span>(app.selection.length == 1){</div>
<div class="line">                            <span class="comment">//If text is selected, then get the parent text frame.</span></div>
<div class="line">                            <span class="keywordflow">switch</span>(app.selection[myCounter].constructor.name){</div>
<div class="line">                                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Text&quot;</span>:</div>
<div class="line">                                <span class="keywordflow">case</span> <span class="stringliteral">&quot;InsertionPoint&quot;</span>:</div>
<div class="line">                                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Character&quot;</span>:</div>
<div class="line">                                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Word&quot;</span>:</div>
<div class="line">                                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Line&quot;</span>:</div>
<div class="line">                                <span class="keywordflow">case</span> <span class="stringliteral">&quot;TextStyleRange&quot;</span>:</div>
<div class="line">                                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Paragraph&quot;</span>:</div>
<div class="line">                                <span class="keywordflow">case</span> <span class="stringliteral">&quot;TextColumn&quot;</span>:</div>
<div class="line">                                    myObjectList.push(app.selection[myCounter].parentTextFrames[0]);</div>
<div class="line">                                    <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="comment">//If the object list is not empty, pass it on to the function</span></div>
<div class="line">            <span class="comment">//that does the real work.</span></div>
<div class="line">            <span class="keywordflow">if</span>(myObjectList.length != 0){</div>
<div class="line">                myBreakFrames(myObjectList);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment --><p> Here is the myBreakFrames function referred to in the preceding script. </p>
<div class="fragment"><div class="line"><span class="keyword">function</span> myBreakFrames(myObjectList){</div>
<div class="line">    myObjectList.sort(myReverseSortByTextFrameIndex);</div>
<div class="line">    <span class="keywordflow">for</span>(var myCounter = 0; myCounter &lt; myObjectList.length; myCounter ++){</div>
<div class="line">        myBreakFrame(myObjectList[myCounter]);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="keyword">function</span> myBreakFrame(myTextFrame){</div>
<div class="line">    <span class="keywordflow">if</span>((myTextFrame.nextTextFrame != null)&amp;&amp;(myTextFrame.previousTextFrame != null)){</div>
<div class="line">        var myNewFrame = myTextFrame.duplicate();</div>
<div class="line">        <span class="keywordflow">if</span>(myTextFrame.contents != <span class="stringliteral">&quot;&quot;</span>){</div>
<div class="line">            myTextFrame.texts.item(0).remove();</div>
<div class="line">        }</div>
<div class="line">        myTextFrame.remove();</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="keyword">function</span> myReverseSortByTextFrameIndex(a,b){</div>
<div class="line">    <span class="comment">//By combining the story id with the text frame index, we can sort the text frames</span></div>
<div class="line">    <span class="comment">//into the right (reverse) order in a single pass.</span></div>
<div class="line">    $.write(<span class="stringliteral">&quot;padded a: &quot;</span> + myPadString(a.id, 8)+myPadString(a.textFrameIndex, 8));</div>
<div class="line">    $.write(<span class="stringliteral">&quot;padded b: &quot;</span> + myPadString(b.id, 8)+myPadString(b.textFrameIndex, 8));</div>
<div class="line">    <span class="keywordflow">if</span>((myPadString(a.id, 8)+myPadString(a.textFrameIndex, 8)) &gt; (myPadString(b.id, 8)+myPadString(b.textFrameIndex, 8))){</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span>((myPadString(a.id,8)+myPadString(a.textFrameIndex,8)) &lt; (myPadString(b.id,8)+myPadString(b.textFrameIndex,8))){</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"><span class="keyword">function</span> myPadString(myString, myLength) {</div>
<div class="line">  var myTempString = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  var myNewLength = myLength-String(myString).length;</div>
<div class="line">  <span class="keywordflow">for</span> (var myCounter = 0; myCounter&lt;myNewLength; myCounter++) {</div>
<div class="line">    myTempString += <span class="stringliteral">&quot;0&quot;</span>;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">return</span> myTempString + myString;</div>
<div class="line">}</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_splitting_all_frames_in_a_story"></a>
Splitting all frames in a story</h3>
<p>The following script fragment shows how to split all frames in a story into separate, independent stories, each containing one unlinked text frame (for the complete script, see SplitStory): </p>
<div class="fragment"><div class="line">    <span class="keywordflow">if</span>(app.documents.length != 0){</div>
<div class="line">        <span class="keywordflow">if</span>(app.selection.length != 0){</div>
<div class="line">            <span class="comment">//Get the first item in the selection.</span></div>
<div class="line">            var mySelection = app.selection[0];</div>
<div class="line">            <span class="comment">//Process the selection. If text or a text frame is </span></div>
<div class="line">            <span class="comment">//selected, do something; otherwise, do nothing.</span></div>
<div class="line">            <span class="keywordflow">switch</span>(mySelection.constructor.name){</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Text&quot;</span>:</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;InsertionPoint&quot;</span>:</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Character&quot;</span>:</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Word&quot;</span>:</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Line&quot;</span>:</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;TextStyleRange&quot;</span>:</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Paragraph&quot;</span>:</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;TextColumn&quot;</span>:</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;TextFrame&quot;</span>:</div>
<div class="line">                    <span class="comment">//If the text frame is the only text frame in the story, do nothing.</span></div>
<div class="line">                    <span class="keywordflow">if</span>(mySelection.parentStory.textContainers.length != 1){</div>
<div class="line">                        <span class="comment">//Splitting the story is a two-step process: first, duplicate</span></div>
<div class="line">                        <span class="comment">//the text frames, second, delete the original text frames.</span></div>
<div class="line">                        mySplitStory(mySelection.parentStory);</div>
<div class="line">                        myRemoveFrames(mySelection.parentStory);</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment --><p> Here is the mySplitStory function referred to in the preceding script: </p>
<div class="fragment"><div class="line"><span class="keyword">function</span> mySplitStory(myStory){</div>
<div class="line">    var myTextFrame;</div>
<div class="line">    <span class="comment">//Duplicate each text frame in the story.</span></div>
<div class="line">    <span class="keywordflow">for</span>(var myCounter = myStory.textContainers.length-1; myCounter &gt;= 0; myCounter --){</div>
<div class="line">        myTextFrame = myStory.textContainers[myCounter];</div>
<div class="line">        myTextFrame.duplicate();</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="keyword">function</span> myRemoveFrames(myStory){</div>
<div class="line">    <span class="comment">//Remove each text frame in the story. Iterate backwards to avoid invalid references.</span></div>
<div class="line">    <span class="keywordflow">for</span>(var myCounter = myStory.textContainers.length-1; myCounter &gt;= 0; myCounter --){</div>
<div class="line">        myStory.textContainers[myCounter].remove();</div>
<div class="line">    }   </div>
<div class="line">}</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_creating_an_anchored_frame"></a>
Creating an anchored frame</h3>
<p>To create an anchored frame (also known as an inline frame), you can create a text frame (or rectangle, oval, polygon, or graphic line) at a specific location in text (usually an insertion point). The following script fragment shows an example (for the complete script, see AnchoredFrame): </p>
<div class="fragment"><div class="line">    var myInsertionPoint = myTextFrame.paragraphs.item(0).insertionPoints.item(0);</div>
<div class="line">    var myInlineFrame = myInsertionPoint.textFrames.add();</div>
<div class="line">    <span class="comment">//Recompose the text to make sure that getting the </span></div>
<div class="line">    <span class="comment">//geometric bounds of the inline graphic will work.</span></div>
<div class="line">    myTextFrame.texts.item(0).recompose;</div>
<div class="line">    <span class="comment">//Get the geometric bounds of the inline frame.</span></div>
<div class="line">    var myBounds = myInlineFrame.geometricBounds;</div>
<div class="line">    <span class="comment">//Set the width and height of the inline frame. In this example, we&#39;ll</span></div>
<div class="line">    <span class="comment">//make the frame 24 points tall by 72 points wide.</span></div>
<div class="line">    var myArray = [myBounds[0], myBounds[1], myBounds[0]+24, myBounds[1]+72];</div>
<div class="line">    myInlineFrame.geometricBounds = myArray;</div>
<div class="line">    myInlineFrame.contents = <span class="stringliteral">&quot;This is an inline frame.&quot;</span>;</div>
<div class="line">    myInsertionPoint = myTextFrame.paragraphs.item(1).insertionPoints.item(0);</div>
<div class="line">    var myAnchoredFrame = myInsertionPoint.textFrames.add();</div>
<div class="line">    <span class="comment">//Recompose the text to make sure that getting the </span></div>
<div class="line">    <span class="comment">//geometric bounds of the inline graphic will work.</span></div>
<div class="line">    myTextFrame.texts.item(0).recompose;</div>
<div class="line">    <span class="comment">//Get the geometric bounds of the inline frame.</span></div>
<div class="line">    var myBounds = myAnchoredFrame.geometricBounds;</div>
<div class="line">    <span class="comment">//Set the width and height of the inline frame. In this example, we&#39;ll</span></div>
<div class="line">    <span class="comment">//make the frame 24 points tall by 72 points wide.</span></div>
<div class="line">    myArray = [myBounds[0], myBounds[1], myBounds[0]+24, myBounds[1]+72];</div>
<div class="line">    myAnchoredFrame.geometricBounds = myArray;</div>
<div class="line">    myAnchoredFrame.contents = <span class="stringliteral">&quot;This is an anchored frame.&quot;</span>;</div>
<div class="line">    with(myAnchoredFrame.anchoredObjectSettings){</div>
<div class="line">        anchoredPosition = AnchorPosition.anchored;</div>
<div class="line">        anchorPoint = AnchorPoint.topLeftAnchor;</div>
<div class="line">        horizontalReferencePoint = AnchoredRelativeTo.anchorLocation;</div>
<div class="line">        horizontalAlignment = HorizontalAlignment.leftAlign;</div>
<div class="line">        anchorXoffset = 72;</div>
<div class="line">        verticalReferencePoint = VerticallyRelativeTo.lineBaseline;</div>
<div class="line">        anchorYoffset = 24;</div>
<div class="line">        anchorSpaceAbove = 24;</div>
<div class="line">    }</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_fitting_text_frames_to_content"></a>
Fitting text frames to content</h3>
<p>The following example script shows how to set rules on a text frame to determine how it grows when the user inputs text (for the complete script, see PersistedTextFrameFill): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myTextFrame = myDocument.pages.item(0).textFrames.item(3);</div>
<div class="line">    <span class="comment">//Now add text at the end of the text frame.</span></div>
<div class="line">    myTextFrame.insertionPoints.item(-1).contents = <span class="stringliteral">&quot;\rThis is some overset text&quot;</span>;</div>
<div class="line">    alert(<span class="stringliteral">&quot;The last paragraph in this alert should be \&quot;This is some overset text\&quot;. Is it?\r&quot;</span> </div>
<div class="line">            + myTextFrame.contents);</div>
<div class="line">    alert(<span class="stringliteral">&quot;The last paragraph in this alert should be \&quot;This is some overset text\&quot;. Is it?\r&quot;</span> </div>
<div class="line">            + myTextFrame.parentStory.contents);   </div>
<div class="line">    var myTextFrame2 = myDocument.pages.item(0).textFrames.item(2);</div>
<div class="line">    <span class="comment">//Set auto size type of the text frame</span></div>
<div class="line">    with(myTextFrame2.textFramePreferences)</div>
<div class="line">    {</div>
<div class="line">        autoSizingType=AutoSizingType.HEIGHT_AND_WIDTH_PROPORTIONALLY;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Now add text at the end of the text frame.</span></div>
<div class="line">    myTextFrame2.insertionPoints.item(-1).contents = <span class="stringliteral">&quot;\rThis is some overset text&quot;</span>;   </div>
<div class="line">    var myTextFrame3 = myDocument.pages.item(0).textFrames.item(1);</div>
<div class="line">    <span class="comment">//Set  auto size type of the text frame </span></div>
<div class="line">    <span class="comment">//useMinimumHeightForAutoSizing and useNoLineBreaksForAutoSizing</span></div>
<div class="line">    with(myTextFrame3.textFramePreferences)</div>
<div class="line">    {</div>
<div class="line">        autoSizingType=AutoSizingType.HEIGHT_ONLY;</div>
<div class="line">        useMinimumHeightForAutoSizing=<span class="keyword">true</span></div>
<div class="line">        useNoLineBreaksForAutoSizing=<span class="keyword">true</span></div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Now add text at the end of the text frame.</span></div>
<div class="line">    myTextFrame3.insertionPoints.item(-1).contents = <span class="stringliteral">&quot;\rThis is some overset text&quot;</span>;   </div>
<div class="line">    var myTextFrame4 = myDocument.pages.item(0).textFrames.item(0);</div>
<div class="line">    <span class="comment">//Set  auto size type of the text frame and autoSizingReferencePoint</span></div>
<div class="line">    with(myTextFrame4.textFramePreferences)</div>
<div class="line">    {</div>
<div class="line">        autoSizingType=AutoSizingType.WIDTH_ONLY;</div>
<div class="line">        autoSizingReferencePoint=AutoSizingReferencePoint.TOP_LEFT_POSITION;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Now add text at the end of the text frame.</span></div>
<div class="line">    myTextFrame4.insertionPoints.item(-1).contents = <span class="stringliteral">&quot;\rThis is some overset text&quot;</span>;</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_formatting_text"></a>
Formatting Text</h2>
<p>In the previous sections of this chapter, we added text to a document, linked text frames, and worked with stories and text objects. In this section, we apply formatting to text. All the typesetting capabilities of InDesign are available to scripting.</p>
<h3><a class="anchor" id="id_js_setting_text_defaults"></a>
Setting text defaults</h3>
<p>You can set text defaults for both the application and each document. Text defaults for the application determine the text defaults in all new documents; text defaults for a document set the formatting of all new text objects in that document. (For the complete script, see TextDefaults.) </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    <span class="comment">//To set the application text formatting defaults, replace the variable &quot;myDocument&quot;</span></div>
<div class="line">    <span class="comment">//with &quot;app&quot; in the following lines.</span></div>
<div class="line">    with(myDocument.textDefaults){</div>
<div class="line">        alignToBaseline = <span class="keyword">true</span>;</div>
<div class="line">        <span class="comment">//Because the font might not be available, it&#39;s usually best</span></div>
<div class="line">        <span class="comment">//to apply the font within a try...catch structure. Fill in the</span></div>
<div class="line">        <span class="comment">//name of a font on your system.</span></div>
<div class="line">        <span class="keywordflow">try</span>{</div>
<div class="line">            appliedFont = app.fonts.item(<span class="stringliteral">&quot;Minion Pro&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span>(e){}</div>
<div class="line">        <span class="comment">//Because the font style might not be available, it&#39;s usually best</span></div>
<div class="line">        <span class="comment">//to apply the font style within a try...catch structure.</span></div>
<div class="line">        <span class="keywordflow">try</span>{</div>
<div class="line">            fontStyle = <span class="stringliteral">&quot;Regular&quot;</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span>(e){}</div>
<div class="line">        <span class="comment">//Because the language might not be available, it&#39;s usually best</span></div>
<div class="line">        <span class="comment">//to apply the language within a try...catch structure.</span></div>
<div class="line">        <span class="keywordflow">try</span>{</div>
<div class="line">            appliedLanguage = <span class="stringliteral">&quot;English: USA&quot;</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span>(e){}</div>
<div class="line">        autoLeading = 100;</div>
<div class="line">        balanceRaggedLines = <span class="keyword">false</span>;</div>
<div class="line">        baselineShift = 0;</div>
<div class="line">        capitalization = Capitalization.normal;</div>
<div class="line">        composer = <span class="stringliteral">&quot;Adobe Paragraph Composer&quot;</span>;</div>
<div class="line">        desiredGlyphScaling = 100;</div>
<div class="line">        desiredLetterSpacing = 0;</div>
<div class="line">        desiredWordSpacing = 100;</div>
<div class="line">        dropCapCharacters = 0;</div>
<div class="line">        <span class="keywordflow">if</span>(dropCapCharacters != 0){</div>
<div class="line">            dropCapLines = 3;</div>
<div class="line">            <span class="comment">//Assumes that the application has a default character style named &quot;myDropCap&quot;</span></div>
<div class="line">            dropCapStyle = myDocument.characterStyles.item(<span class="stringliteral">&quot;myDropCap&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">        fillColor = myDocument.colors.item(<span class="stringliteral">&quot;Black&quot;</span>);</div>
<div class="line">        fillTint = 100;</div>
<div class="line">        firstLineIndent = 14;</div>
<div class="line">        gridAlignFirstLineOnly = <span class="keyword">false</span>;</div>
<div class="line">        horizontalScale = 100;</div>
<div class="line">        hyphenateAfterFirst = 3;</div>
<div class="line">        hyphenateBeforeLast = 4;</div>
<div class="line">        hyphenateCapitalizedWords = <span class="keyword">false</span>;</div>
<div class="line">        hyphenateLadderLimit = 1;</div>
<div class="line">        hyphenateWordsLongerThan = 5;</div>
<div class="line">        hyphenation = <span class="keyword">true</span>;</div>
<div class="line">        hyphenationZone = 36;</div>
<div class="line">        hyphenWeight = 9;</div>
<div class="line">        justification = Justification.leftAlign;</div>
<div class="line">        keepAllLinesTogether = <span class="keyword">false</span>;</div>
<div class="line">        keepLinesTogether = <span class="keyword">true</span>;</div>
<div class="line">        keepFirstLines = 2;</div>
<div class="line">        keepLastLines = 2;</div>
<div class="line">        keepWithNext = 0;</div>
<div class="line">        kerningMethod = <span class="stringliteral">&quot;Optical&quot;</span>;</div>
<div class="line">        kerningValue = 0;</div>
<div class="line">        leading = 14;</div>
<div class="line">        leftIndent = 0;</div>
<div class="line">        ligatures = <span class="keyword">true</span>;</div>
<div class="line">        maximumGlyphScaling = 100;</div>
<div class="line">        maximumLetterSpacing = 0;</div>
<div class="line">        maximumWordSpacing = 160;</div>
<div class="line">        minimumGlyphScaling = 100;</div>
<div class="line">        minimumLetterSpacing = 0;</div>
<div class="line">        minimumWordSpacing = 80;</div>
<div class="line">        noBreak = <span class="keyword">false</span>;</div>
<div class="line">        otfContextualAlternate = <span class="keyword">true</span>;</div>
<div class="line">        otfDiscretionaryLigature = <span class="keyword">false</span>;</div>
<div class="line">        otfFigureStyle = OTFFigureStyle.proportionalOldstyle;</div>
<div class="line">        otfFraction = <span class="keyword">true</span>;</div>
<div class="line">        otfHistorical = <span class="keyword">false</span>;</div>
<div class="line">        otfOrdinal = <span class="keyword">false</span>;</div>
<div class="line">        otfSlashedZero = <span class="keyword">false</span>;</div>
<div class="line">        otfSwash = <span class="keyword">false</span>;</div>
<div class="line">        otfTitling = <span class="keyword">false</span>;</div>
<div class="line">        overprintFill = <span class="keyword">false</span>;</div>
<div class="line">        overprintStroke = <span class="keyword">false</span>;</div>
<div class="line">        pointSize = 11;</div>
<div class="line">        position = Position.normal;</div>
<div class="line">        rightIndent = 0;</div>
<div class="line">        ruleAbove = <span class="keyword">false</span>;</div>
<div class="line">        <span class="keywordflow">if</span>(ruleAbove == <span class="keyword">true</span>){</div>
<div class="line">            ruleAboveColor = myDocument.colors.item(<span class="stringliteral">&quot;Black&quot;</span>);</div>
<div class="line">            ruleAboveGapColor = myDocument.swatches.item(<span class="stringliteral">&quot;None&quot;</span>);</div>
<div class="line">            ruleAboveGapOverprint = <span class="keyword">false</span>;</div>
<div class="line">            ruleAboveGapTint = 100;</div>
<div class="line">            ruleAboveLeftIndent = 0;</div>
<div class="line">            ruleAboveLineWeight = .25;</div>
<div class="line">            ruleAboveOffset = 14;</div>
<div class="line">            ruleAboveOverprint = <span class="keyword">false</span>;</div>
<div class="line">            ruleAboveRightIndent = 0;</div>
<div class="line">            ruleAboveTint = 100;</div>
<div class="line">            ruleAboveType = myDocument.strokeStyles.item(<span class="stringliteral">&quot;Solid&quot;</span>);</div>
<div class="line">            ruleAboveWidth = RuleWidth.columnWidth;</div>
<div class="line">        }</div>
<div class="line">        ruleBelow = <span class="keyword">false</span>;</div>
<div class="line">        <span class="keywordflow">if</span>(ruleBelow == <span class="keyword">true</span>){</div>
<div class="line">            ruleBelowColor = myDocument.colors.item(<span class="stringliteral">&quot;Black&quot;</span>);</div>
<div class="line">            ruleBelowGapColor = myDocument.swatches.item(<span class="stringliteral">&quot;None&quot;</span>);</div>
<div class="line">            ruleBelowGapOverprint = <span class="keyword">false</span>;</div>
<div class="line">            ruleBelowGapTint = 100;</div>
<div class="line">            ruleBelowLeftIndent = 0;</div>
<div class="line">            ruleBelowLineWeight = .25;</div>
<div class="line">            ruleBelowOffset = 0;</div>
<div class="line">            ruleBelowOverprint = <span class="keyword">false</span>;</div>
<div class="line">            ruleBelowRightIndent = 0;</div>
<div class="line">            ruleBelowTint = 100;</div>
<div class="line">            ruleBelowType = app.strokeStyles.item(<span class="stringliteral">&quot;Solid&quot;</span>);</div>
<div class="line">            ruleBelowWidth = RuleWidth.columnWidth;</div>
<div class="line">        }</div>
<div class="line">        singleWordJustification = SingleWordJustification.leftAlign;</div>
<div class="line">        skew = 0;</div>
<div class="line">        spaceAfter = 0;</div>
<div class="line">        spaceBefore = 0;</div>
<div class="line">        startParagraph = StartParagraph.anywhere;</div>
<div class="line">        strikeThru = <span class="keyword">false</span>;</div>
<div class="line">        <span class="keywordflow">if</span>(strikeThru == <span class="keyword">true</span>){</div>
<div class="line">            strikeThroughColor = myDocument.colors.item(<span class="stringliteral">&quot;Black&quot;</span>);</div>
<div class="line">            strikeThroughGapColor = myDocument.swatches.item(<span class="stringliteral">&quot;None&quot;</span>);</div>
<div class="line">            strikeThroughGapOverprint = <span class="keyword">false</span>;</div>
<div class="line">            strikeThroughGapTint = 100;</div>
<div class="line">            strikeThroughOffset = 3;</div>
<div class="line">            strikeThroughOverprint = <span class="keyword">false</span>;</div>
<div class="line">            strikeThroughTint = 100;</div>
<div class="line">            strikeThroughType = myDocument.strokeStyles.item(<span class="stringliteral">&quot;Solid&quot;</span>);</div>
<div class="line">            strikeThroughWeight = .25;</div>
<div class="line">        }</div>
<div class="line">        strokeColor = myDocument.swatches.item(<span class="stringliteral">&quot;None&quot;</span>);</div>
<div class="line">        strokeTint = 100;</div>
<div class="line">        strokeWeight = 0;</div>
<div class="line">        tracking = 0;</div>
<div class="line">        underline = <span class="keyword">false</span>;</div>
<div class="line">        <span class="keywordflow">if</span>(underline == <span class="keyword">true</span>){</div>
<div class="line">            underlineColor = myDocument.colors.item(<span class="stringliteral">&quot;Black&quot;</span>);</div>
<div class="line">            underlineGapColor = myDocument.swatches.item(<span class="stringliteral">&quot;None&quot;</span>);</div>
<div class="line">            underlineGapOverprint = <span class="keyword">false</span>;</div>
<div class="line">            underlineGapTint = 100;</div>
<div class="line">            underlineOffset = 3;</div>
<div class="line">            underlineOverprint = <span class="keyword">false</span>;</div>
<div class="line">            underlineTint = 100;</div>
<div class="line">            underlineType = myDocument.strokeStyles.item(<span class="stringliteral">&quot;Solid&quot;</span>);</div>
<div class="line">            underlineWeight = .25</div>
<div class="line">        }</div>
<div class="line">        verticalScale = 100;</div>
<div class="line">    }</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_working_with_fonts"></a>
Working with fonts</h3>
<p>The fonts collection of the InDesign application object contains all fonts accessible to InDesign. The fonts collection of a document, by contrast, contains only those fonts used in the document. The fonts collection of a document also contains any missing fonts-fonts used in the document that are not accessible to InDesign. The following script shows the difference between application fonts and document fonts. (We omitted the myGetBounds function here; for the complete script, see FontCollections.) </p>
<div class="fragment"><div class="line">    var myApplicationFonts = app.fonts;</div>
<div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myStory = myDocument.stories.item(0);</div>
<div class="line">    var myDocumentFonts = myDocument.fonts;</div>
<div class="line">    var myFontNames = myApplicationFonts.everyItem().name;</div>
<div class="line">    var myDocumentFontNames = myDocument.fonts.everyItem().name;</div>
<div class="line">    var myString = <span class="stringliteral">&quot;Document Fonts:\r&quot;</span>;</div>
<div class="line">    <span class="keywordflow">for</span>(var myCounter = 0;myCounter&lt;myDocumentFontNames.length; myCounter++){</div>
<div class="line">        myString += myDocumentFontNames[myCounter] + <span class="stringliteral">&quot;\r&quot;</span>;</div>
<div class="line">    }</div>
<div class="line">    myString += <span class="stringliteral">&quot;\rApplication Fonts:\r&quot;</span>;</div>
<div class="line">    <span class="keywordflow">for</span>(var myCounter = 0;myCounter&lt;myFontNames.length; myCounter++){</div>
<div class="line">        myString += myFontNames[myCounter] + <span class="stringliteral">&quot;\r&quot;</span>;</div>
<div class="line">    }</div>
<div class="line">    myStory.contents = myString;</div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>Font names typically are of the form familyName &lt;tab&gt; fontStyle, where familyName is the name of the font family, &lt;tab&gt; is a tab character, and fontStyle is the name of the font style. For example:"Adobe Caslon Pro \&lt;tab\&gt; Semibold Italic"</dd></dl>
<h3><a class="anchor" id="id_js_applying_a_font"></a>
Applying a font</h3>
<p>To apply a local font change to a range of text, use the appliedFont property, as shown in the following script fragment (from the ApplyFont tutorial script): </p>
<div class="fragment"><div class="line"><span class="comment">//Given a font name &quot;myFontName&quot; and a text object &quot;myText&quot;...</span></div>
<div class="line">myText.appliedFont = app.fonts.item(myFontName);</div>
</div><!-- fragment --><p>You also can apply a font by specifying the font family name and font style, as shown in the following script fragment: </p>
<div class="fragment"><div class="line">myText.appliedFont = app.fonts.item(<span class="stringliteral">&quot;Adobe Caslon Pro&quot;</span>);</div>
<div class="line">myText.fontStyle = <span class="stringliteral">&quot;Semibold Italic&quot;</span>;</div>
</div><!-- fragment --><h3><a class="anchor" id="id_js_changing_text_properties"></a>
Changing text properties</h3>
<p>Text objects in InDesign have literally dozens of properties corresponding to their formatting attributes. Even one insertion point features properties that affect the formatting of text-up to and including properties of the paragraph containing the insertion point. The SetTextProperties tutorial script shows how to set every property of a text object. A fragment of the script is shown below: </p>
<div class="fragment"><div class="line">    <span class="comment">//Access the active document and page.</span></div>
<div class="line">    var myDocument = app.activeDocument;</div>
<div class="line">    var myPage = app.activeWindow.activePage;</div>
<div class="line">    var myTextFrame = myPage.textFrames.add();</div>
<div class="line">    myTextFrame.contents = <span class="stringliteral">&quot;x&quot;</span>;</div>
<div class="line">    var myTextObject = myTextFrame.parentStory.characters.item(0);</div>
<div class="line">    myTextObject.alignToBaseline = <span class="keyword">false</span>;</div>
<div class="line">    myTextObject.appliedCharacterStyle = myDocument.characterStyles.item(<span class="stringliteral">&quot;[None]&quot;</span>);</div>
<div class="line">    myTextObject.appliedFont = app.fonts.item(<span class="stringliteral">&quot;Minion Pro   Regular&quot;</span>);</div>
<div class="line">    myTextObject.appliedLanguage = app.languagesWithVendors.item(<span class="stringliteral">&quot;English: USA&quot;</span>);</div>
<div class="line">    myTextObject.appliedNumberingList = myDocument.numberingLists.item(<span class="stringliteral">&quot;[Default]&quot;</span>);</div>
<div class="line">    myTextObject.appliedParagraphStyle = myDocument.paragraphStyles.item(<span class="stringliteral">&quot;[No Paragraph Style]&quot;</span>);</div>
<div class="line">    myTextObject.autoLeading = 120;</div>
<div class="line">    myTextObject.balanceRaggedLines = BalanceLinesStyle.noBalancing;</div>
<div class="line">    myTextObject.baselineShift = 0;</div>
<div class="line">    myTextObject.bulletsAlignment = ListAlignment.leftAlign;</div>
<div class="line">    myTextObject.bulletsAndNumberingListType = ListType.noList;</div>
<div class="line">    myTextObject.bulletsCharacterStyle = myDocument.characterStyles.item(<span class="stringliteral">&quot;[None]&quot;</span>);</div>
<div class="line">    myTextObject.bulletsTextAfter = <span class="stringliteral">&quot;^t&quot;</span>;</div>
<div class="line">    myTextObject.capitalization = Capitalization.normal;</div>
<div class="line">    myTextObject.composer = <span class="stringliteral">&quot;Adobe Paragraph Composer&quot;</span>;</div>
<div class="line">    myTextObject.desiredGlyphScaling = 100;</div>
<div class="line">    myTextObject.desiredLetterSpacing = 0;</div>
<div class="line">    myTextObject.desiredWordSpacing = 100;</div>
<div class="line">    myTextObject.dropCapCharacters = 0;</div>
<div class="line">    myTextObject.dropCapLines = 0;</div>
<div class="line">    myTextObject.dropCapStyle = myDocument.characterStyles.item(<span class="stringliteral">&quot;[None]&quot;</span>);</div>
<div class="line">    myTextObject.dropcapDetail = 0;</div>
<div class="line">    myTextObject.fillColor = myDocument.colors.item(<span class="stringliteral">&quot;Black&quot;</span>);</div>
<div class="line">    myTextObject.fillTint = -1;</div>
<div class="line">    myTextObject.firstLineIndent = 0;</div>
<div class="line">    myTextObject.fontStyle = <span class="stringliteral">&quot;Regular&quot;</span>;</div>
<div class="line">    myTextObject.gradientFillAngle = 0;</div>
<div class="line">    myTextObject.gradientFillLength = -1;</div>
<div class="line">    myTextObject.gradientFillStart = [0,0];</div>
<div class="line">    myTextObject.gradientStrokeAngle = 0;</div>
<div class="line">    myTextObject.gradientStrokeLength = -1;</div>
<div class="line">    myTextObject.gradientStrokeStart = [0,0];</div>
<div class="line">    myTextObject.gridAlignFirstLineOnly = <span class="keyword">false</span>;</div>
<div class="line">    myTextObject.horizontalScale = 100;</div>
<div class="line">    myTextObject.hyphenWeight = 5;</div>
<div class="line">    myTextObject.hyphenateAcrossColumns = <span class="keyword">true</span>;</div>
<div class="line">    myTextObject.hyphenateAfterFirst = 2;</div>
<div class="line">    myTextObject.hyphenateBeforeLast = 2;</div>
<div class="line">    myTextObject.hyphenateCapitalizedWords = <span class="keyword">true</span>;</div>
<div class="line">    myTextObject.hyphenateLadderLimit = 3;</div>
<div class="line">    myTextObject.hyphenateLastWord = <span class="keyword">true</span>;</div>
<div class="line">    myTextObject.hyphenateWordsLongerThan = 5;</div>
<div class="line">    myTextObject.hyphenation = <span class="keyword">true</span>;</div>
<div class="line">    myTextObject.hyphenationZone = 3;</div>
<div class="line">    myTextObject.ignoreEdgeAlignment = <span class="keyword">false</span>;</div>
<div class="line">    myTextObject.justification = Justification.leftAlign;</div>
<div class="line">    myTextObject.keepAllLinesTogether = <span class="keyword">false</span>;</div>
<div class="line">    myTextObject.keepFirstLines = 2;</div>
<div class="line">    myTextObject.keepLastLines = 2;</div>
<div class="line">    myTextObject.keepLinesTogether = <span class="keyword">false</span>;</div>
<div class="line">    myTextObject.keepRuleAboveInFrame = <span class="keyword">false</span>;</div>
<div class="line">    myTextObject.keepWithNext = 0;</div>
<div class="line">    myTextObject.kerningMethod = <span class="stringliteral">&quot;Optical&quot;</span>;</div>
<div class="line">    <span class="comment">//myTextObject.kerningValue = error;</span></div>
<div class="line">    myTextObject.lastLineIndent = 0;</div>
<div class="line">    myTextObject.leading = 12;</div>
<div class="line">    myTextObject.leftIndent = 0;</div>
<div class="line">    myTextObject.ligatures = <span class="keyword">true</span>;</div>
<div class="line">    myTextObject.maximumGlyphScaling = 100;</div>
<div class="line">    myTextObject.maximumLetterSpacing = 0;</div>
<div class="line">    myTextObject.maximumWordSpacing = 133;</div>
<div class="line">    myTextObject.minimumGlyphScaling = 100;</div>
<div class="line">    myTextObject.minimumLetterSpacing = 0;</div>
<div class="line">    myTextObject.minimumWordSpacing = 80;</div>
<div class="line">    myTextObject.noBreak = <span class="keyword">false</span>;</div>
<div class="line">    myTextObject.numberingAlignment = ListAlignment.leftAlign;</div>
<div class="line">    myTextObject.numberingApplyRestartPolicy = <span class="keyword">true</span>;</div>
<div class="line">    myTextObject.numberingCharacterStyle = myDocument.characterStyles.item(<span class="stringliteral">&quot;[None]&quot;</span>);</div>
<div class="line">    myTextObject.numberingContinue = <span class="keyword">true</span>;</div>
<div class="line">    myTextObject.numberingExpression = <span class="stringliteral">&quot;^#.^t&quot;</span>;</div>
<div class="line">    myTextObject.numberingFormat = <span class="stringliteral">&quot;1, 2, 3, 4...&quot;</span>;</div>
<div class="line">    myTextObject.numberingLevel = 1;</div>
<div class="line">    myTextObject.numberingStartAt = 1;</div>
<div class="line">    myTextObject.otfContextualAlternate = <span class="keyword">true</span>;</div>
<div class="line">    myTextObject.otfDiscretionaryLigature = <span class="keyword">false</span>;</div>
<div class="line">    myTextObject.otfFigureStyle = OTFFigureStyle.proportionalLining;</div>
<div class="line">    myTextObject.otfFraction = <span class="keyword">false</span>;</div>
<div class="line">    myTextObject.otfHistorical = <span class="keyword">false</span>;</div>
<div class="line">    myTextObject.otfLocale = <span class="keyword">true</span>;</div>
<div class="line">    myTextObject.otfMark = <span class="keyword">true</span>;</div>
<div class="line">    myTextObject.otfOrdinal = <span class="keyword">false</span>;</div>
<div class="line">    myTextObject.otfSlashedZero = <span class="keyword">false</span>;</div>
<div class="line">    myTextObject.otfStylisticSets = 0;</div>
<div class="line">    myTextObject.otfSwash = <span class="keyword">false</span>;</div>
<div class="line">    myTextObject.otfTitling = <span class="keyword">false</span>;</div>
<div class="line">    myTextObject.overprintFill = <span class="keyword">false</span>;</div>
<div class="line">    myTextObject.overprintStroke = <span class="keyword">false</span>;</div>
<div class="line">    myTextObject.pointSize = 12;</div>
<div class="line">    myTextObject.position = Position.normal;</div>
<div class="line">    myTextObject.positionalForm = PositionalForms.none;</div>
<div class="line">    myTextObject.rightIndent = 0;</div>
<div class="line">    myTextObject.ruleAbove = <span class="keyword">false</span>;</div>
<div class="line">    myTextObject.ruleAboveColor = <span class="stringliteral">&quot;Text Color&quot;</span>;</div>
<div class="line">    myTextObject.ruleAboveGapColor = myDocument.swatches.item(<span class="stringliteral">&quot;None&quot;</span>);</div>
<div class="line">    myTextObject.ruleAboveGapOverprint = <span class="keyword">false</span>;</div>
<div class="line">    myTextObject.ruleAboveGapTint = -1;</div>
<div class="line">    myTextObject.ruleAboveLeftIndent = 0;</div>
<div class="line">    myTextObject.ruleAboveLineWeight = 1;</div>
<div class="line">    myTextObject.ruleAboveOffset = 0;</div>
<div class="line">    myTextObject.ruleAboveOverprint = <span class="keyword">false</span>;</div>
<div class="line">    myTextObject.ruleAboveRightIndent = 0;</div>
<div class="line">    myTextObject.ruleAboveTint = -1;</div>
<div class="line">    myTextObject.ruleAboveType = myDocument.strokeStyles.item(<span class="stringliteral">&quot;Solid&quot;</span>);</div>
<div class="line">    myTextObject.ruleAboveWidth = RuleWidth.columnWidth;</div>
<div class="line">    myTextObject.ruleBelow = <span class="keyword">false</span>;</div>
<div class="line">    myTextObject.ruleBelowColor = <span class="stringliteral">&quot;Text Color&quot;</span>;</div>
<div class="line">    myTextObject.ruleBelowGapColor = myDocument.swatches.item(<span class="stringliteral">&quot;None&quot;</span>);</div>
<div class="line">    myTextObject.ruleBelowGapOverprint = <span class="keyword">false</span>;</div>
<div class="line">    myTextObject.ruleBelowGapTint = -1;</div>
<div class="line">    myTextObject.ruleBelowLeftIndent = 0;</div>
<div class="line">    myTextObject.ruleBelowLineWeight = 1;</div>
<div class="line">    myTextObject.ruleBelowOffset = 0;</div>
<div class="line">    myTextObject.ruleBelowOverprint = <span class="keyword">false</span>;</div>
<div class="line">    myTextObject.ruleBelowRightIndent = 0;</div>
<div class="line">    myTextObject.ruleBelowTint = -1;</div>
<div class="line">    myTextObject.ruleBelowType = myDocument.strokeStyles.item(<span class="stringliteral">&quot;Solid&quot;</span>);</div>
<div class="line">    myTextObject.ruleBelowWidth = RuleWidth.columnWidth;</div>
<div class="line">    myTextObject.singleWordJustification = 1718971500;</div>
<div class="line">    myTextObject.skew = 0;</div>
<div class="line">    myTextObject.spaceAfter = 0;</div>
<div class="line">    myTextObject.spaceBefore = 0;</div>
<div class="line">    myTextObject.startParagraph = 1851945579;</div>
<div class="line">    myTextObject.strikeThroughColor = <span class="stringliteral">&quot;Text Color&quot;</span>;</div>
<div class="line">    myTextObject.strikeThroughGapColor = myDocument.swatches.item(<span class="stringliteral">&quot;None&quot;</span>);</div>
<div class="line">    myTextObject.strikeThroughGapOverprint = <span class="keyword">false</span>;</div>
<div class="line">    myTextObject.strikeThroughGapTint = -1;</div>
<div class="line">    myTextObject.strikeThroughOffset = -9999;</div>
<div class="line">    myTextObject.strikeThroughOverprint = <span class="keyword">false</span>;</div>
<div class="line">    myTextObject.strikeThroughTint = -1;</div>
<div class="line">    myTextObject.strikeThroughType = myDocument.strokeStyles.item(<span class="stringliteral">&quot;Solid&quot;</span>);</div>
<div class="line">    myTextObject.strikeThroughWeight = -9999;</div>
<div class="line">    myTextObject.strikeThru = <span class="keyword">false</span>;</div>
<div class="line">    myTextObject.strokeColor = myDocument.swatches.item(<span class="stringliteral">&quot;None&quot;</span>);</div>
<div class="line">    myTextObject.strokeTint = -1;</div>
<div class="line">    myTextObject.strokeWeight = 1;</div>
<div class="line">    myTextObject.tracking = 0;</div>
<div class="line">    myTextObject.underline = <span class="keyword">false</span>;</div>
<div class="line">    myTextObject.underlineColor = <span class="stringliteral">&quot;Text Color&quot;</span>;</div>
<div class="line">    myTextObject.underlineGapColor = myDocument.swatches.item(<span class="stringliteral">&quot;None&quot;</span>);</div>
<div class="line">    myTextObject.underlineGapOverprint = <span class="keyword">false</span>;</div>
<div class="line">    myTextObject.underlineGapTint = -1;</div>
<div class="line">    myTextObject.underlineOffset = -9999;</div>
<div class="line">    myTextObject.underlineOverprint = <span class="keyword">false</span>;</div>
<div class="line">    myTextObject.underlineTint = -1;</div>
<div class="line">    myTextObject.underlineType = myDocument.strokeStyles.item(<span class="stringliteral">&quot;Solid&quot;</span>);</div>
<div class="line">    myTextObject.underlineWeight = -9999;</div>
<div class="line">    myTextObject.verticalScale = 100;</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_changing_text_color"></a>
Changing text color</h3>
<p>You can apply colors to the fill and stroke of text characters, as shown in the following script fragment (from the TextColors tutorial script): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.add();</div>
<div class="line">    var myPage = myDocument.pages.item(0);</div>
<div class="line">    <span class="comment">//Create a color.</span></div>
<div class="line">    <span class="keywordflow">try</span>{</div>
<div class="line">        myColorA = myDocument.colors.item(<span class="stringliteral">&quot;DGC1_664a&quot;</span>);</div>
<div class="line">        <span class="comment">//If the color does not exist, trying to get its name will generate an error.</span></div>
<div class="line">        myName = myColorA.name;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span> (myError){</div>
<div class="line">        <span class="comment">//The color style did not exist, so create it.</span></div>
<div class="line">        myColorA = myDocument.colors.add({name:<span class="stringliteral">&quot;DGC1_664a&quot;</span>, model:ColorModel.process, colorValue:[90, 100, 70, 0]});</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Create another color.</span></div>
<div class="line">    <span class="keywordflow">try</span>{</div>
<div class="line">        myColorB = myDocument.colors.item(<span class="stringliteral">&quot;DGC1_664b&quot;</span>);</div>
<div class="line">        <span class="comment">//If the color does not exist, trying to get its name will generate an error.</span></div>
<div class="line">        myName = myColorB.name;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span> (myError){</div>
<div class="line">        <span class="comment">//The color style did not exist, so create it.</span></div>
<div class="line">        myColorB = myDocument.colors.add({name:<span class="stringliteral">&quot;DGC1_664b&quot;</span>, model:ColorModel.process, colorValue:[70, 0, 30, 50]});</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Create a text frame on the active page.</span></div>
<div class="line">    var myTextFrame = myPage.textFrames.add();</div>
<div class="line">    <span class="comment">//Set the bounds of the text frame.</span></div>
<div class="line">    myTextFrame.geometricBounds = myGetBounds(myDocument, myPage);</div>
<div class="line">    <span class="comment">//Enter text in the text frame.</span></div>
<div class="line">    myTextFrame.contents = <span class="stringliteral">&quot;Text\rColor&quot;</span></div>
</div><!-- fragment --><div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myStory = myDocument.stories.item(0);</div>
<div class="line">    var myText = myStory.paragraphs.item(0);</div>
<div class="line">    myText.pointSize = 72;</div>
<div class="line">    myText.justification = Justification.centerAlign;</div>
<div class="line">    <span class="comment">//Apply a color to the fill of the text.</span></div>
<div class="line">    myText.fillColor = myColorA;</div>
<div class="line">    <span class="comment">//Use the itemByRange method to apply the color to the stroke of the text.</span></div>
<div class="line">    myText.strokeColor = myColorB;</div>
<div class="line">    myText = myStory.paragraphs.item(1)</div>
<div class="line">    myText.strokeWeight = 3;</div>
<div class="line">    myText.pointSize = 144;</div>
<div class="line">    myText.justification = Justification.centerAlign;</div>
<div class="line">    myText.fillColor = myColorB;</div>
<div class="line">    myText.strokeColor = myColorA;</div>
<div class="line">    myText.strokeWeight = 3;</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_creating_and_applying_styles"></a>
Creating and applying styles</h3>
<p>While you can use scripting to apply local formatting-as in some of the examples earlier in this chapter-you probably will want to use character and paragraph styles to format your text. Using styles creates a link between the formatted text and the style, which makes it easier to redefine the style, collect the text formatted with a given style, or find and/or change the text. Paragraph and character styles are the keys to text formatting productivity and should be a central part of any script that applies text formatting.</p>
<p>The following example script fragment shows how to create and apply paragraph and character styles (for the complete script, see CreateStyles): </p>
<div class="fragment"><div class="line">    var myParagraphStyle, myCharacterStyle, myColor, myName;</div>
<div class="line">    <span class="comment">//Access the active document and page.</span></div>
<div class="line">    var myDocument = app.activeDocument;</div>
<div class="line">    var myPage = app.activeWindow.activePage;</div>
<div class="line">    <span class="comment">//Create a color for use by one of the paragraph styles we&#39;ll create.</span></div>
<div class="line">    <span class="keywordflow">try</span>{</div>
<div class="line">        myColor = myDocument.colors.item(<span class="stringliteral">&quot;Red&quot;</span>);</div>
<div class="line">        <span class="comment">//If the color does not exist, trying to get its name will generate an error.</span></div>
<div class="line">        myName = myColor.name;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span> (myError){</div>
<div class="line">        <span class="comment">//The color style did not exist, so create it.</span></div>
<div class="line">        myColor = myDocument.colors.add({name:<span class="stringliteral">&quot;Red&quot;</span>, model:ColorModel.process, colorValue:[0, 100, 100, 0]});</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Create a text frame on the active page.</span></div>
<div class="line">    var myTextFrame = myPage.textFrames.add();</div>
<div class="line">    <span class="comment">//Set the bounds of the text frame.</span></div>
<div class="line">    myTextFrame.geometricBounds = myGetBounds(myDocument, myPage);</div>
<div class="line">    <span class="comment">//Fill the text frame with placeholder text.</span></div>
<div class="line">    myTextFrame.contents = <span class="stringliteral">&quot;Normal text. Text with a character style applied to it. More normal text.&quot;</span>;</div>
<div class="line">    <span class="comment">//Create a character style named &quot;myCharacterStyle&quot; if </span></div>
<div class="line">    <span class="comment">//no style by that name already exists.</span></div>
<div class="line">    <span class="keywordflow">try</span>{</div>
<div class="line">        myCharacterStyle = myDocument.characterStyles.item(<span class="stringliteral">&quot;myCharacterStyle&quot;</span>);</div>
<div class="line">        <span class="comment">//If the style does not exist, trying to get its name will generate an error.</span></div>
<div class="line">        myName = myCharacterStyle.name;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span> (myError){</div>
<div class="line">        <span class="comment">//The style did not exist, so create it.</span></div>
<div class="line">        myCharacterStyle = myDocument.characterStyles.add({name:<span class="stringliteral">&quot;myCharacterStyle&quot;</span>});</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//At this point, the variable myCharacterStyle contains a reference to a character </span></div>
<div class="line">    <span class="comment">//style object, which you can now use to specify formatting.</span></div>
<div class="line">    myCharacterStyle.fillColor = myColor;</div>
<div class="line">    <span class="comment">//Create a paragraph style named &quot;myParagraphStyle&quot; if </span></div>
<div class="line">    <span class="comment">//no style by that name already exists.</span></div>
<div class="line">    <span class="keywordflow">try</span>{</div>
<div class="line">        myParagraphStyle = myDocument.paragraphStyles.item(<span class="stringliteral">&quot;myParagraphStyle&quot;</span>);</div>
<div class="line">        <span class="comment">//If the paragraph style does not exist, trying to get its name will generate an error.</span></div>
<div class="line">        myName = myParagraphStyle.name;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span> (myError){</div>
<div class="line">        <span class="comment">//The paragraph style did not exist, so create it.</span></div>
<div class="line">        myParagraphStyle = myDocument.paragraphStyles.add({name:<span class="stringliteral">&quot;myParagraphStyle&quot;</span>});</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//At this point, the variable myParagraphStyle contains a reference to a paragraph </span></div>
<div class="line">    <span class="comment">//style object, which you can now use to specify formatting.</span></div>
<div class="line">    myTextFrame.parentStory.texts.item(0).applyParagraphStyle(myParagraphStyle, <span class="keyword">true</span>);</div>
<div class="line">    var myStartCharacter = myTextFrame.parentStory.characters.item(13);</div>
<div class="line">    var myEndCharacter = myTextFrame.parentStory.characters.item(54);</div>
<div class="line">    myTextFrame.parentStory.texts.itemByRange(myStartCharacter, myEndCharacter).applyParagraphStyle(myParagraphStyle, <span class="keyword">true</span>);</div>
</div><!-- fragment --><p> Why use the applyParagraphStyle method instead of setting the appliedParagraphStyle property of the text object? The applyParagraphStyle method gives the ability to override existing formatting; setting the property to a style retains local formatting.</p>
<p>Why check for the existence of a style when creating a new document? It always is possible that the style exists as an application default style. If it does, trying to create a new style with the same name results in an error.</p>
<p>Nested styles apply character-style formatting to a paragraph according to a pattern. The following script fragment shows how to create a paragraph style containing nested styles (for the complete script, see NestedStyles): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myPage = myDocument.pages.item(0);</div>
<div class="line">    var myTextFrame = myPage.textFrames.item(0);</div>
<div class="line">    var myParagraphStyle = myDocument.paragraphStyles.item(<span class="stringliteral">&quot;myParagraphStyle&quot;</span>);</div>
<div class="line">    var myNestedStyle = myParagraphStyle.nestedStyles.add({appliedCharacterStyle:myCharacterStyle, delimiter:<span class="stringliteral">&quot;.&quot;</span>, inclusive:<span class="keyword">true</span>, repetition:1});</div>
<div class="line">    var myStartCharacter = myTextFrame.parentStory.characters.item(0);</div>
<div class="line">    var myEndCharacter = myTextFrame.parentStory.characters.item(-1);</div>
<div class="line">    <span class="comment">//Use the itemByRange method to apply the paragraph to all of the text in the story.</span></div>
<div class="line">    <span class="comment">//(Note that the story object does not have the applyParagraphStyle method.)</span></div>
<div class="line">    myTextFrame.parentStory.texts.itemByRange(myStartCharacter, myEndCharacter).applyParagraphStyle(myParagraphStyle, <span class="keyword">true</span>);</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_deleting_a_style"></a>
Deleting a style</h3>
<p>When you delete a style using the user interface, you can choose the way you want to format any text tagged with that style. InDesign scripting works the same way, as shown in the following script fragment (from the RemoveStyle tutorial script): </p>
<div class="fragment"><div class="line">    var myDocument = app.activeDocument;</div>
<div class="line">    var myParagraphStyleA = myDocument.paragraphStyles.item(<span class="stringliteral">&quot;myParagraphStyleA&quot;</span>);</div>
<div class="line">    <span class="comment">//Remove the paragraph style myParagraphStyleA and replace with myParagraphStyleB.</span></div>
<div class="line">    myParagraphStyleA.remove(myDocument.paragraphStyles.item(<span class="stringliteral">&quot;myParagraphStyleB&quot;</span>));</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_importing_paragraph_and_character_styles"></a>
Importing paragraph and character styles</h3>
<p>You can import character and paragraph styles from other InDesign documents, as shown in the following script fragment (from the ImportTextStyles tutorial script): </p>
<div class="fragment"><div class="line">    <span class="comment">//Create a new document.</span></div>
<div class="line">    myDocument = app.documents.add();</div>
<div class="line">    <span class="comment">//Import the styles from the saved document.</span></div>
<div class="line">    <span class="comment">//importStyles parameters:</span></div>
<div class="line">    <span class="comment">// Format as ImportFormat enumeration. Options for text styles are:</span></div>
<div class="line">    <span class="comment">// ImportFormat.paragraphStylesFormat</span></div>
<div class="line">    <span class="comment">// ImportFormat.characterStylesFormat</span></div>
<div class="line">    <span class="comment">// ImportFormat.textStylesFormat</span></div>
<div class="line">    <span class="comment">// From as File</span></div>
<div class="line">    <span class="comment">// GlobalStrategy as GlobalClashResolutionStrategy enumeration. Options are:</span></div>
<div class="line">    <span class="comment">// GlobalClashResolutionStrategy.doNotLoadTheStyle</span></div>
<div class="line">    <span class="comment">// GlobalClashResolutionStrategy.loadAllWithOverwrite</span></div>
<div class="line">    <span class="comment">// GlobalClashResolutionStrategy.loadAllWithRename</span></div>
<div class="line">    myDocument.importStyles(ImportFormat.textStylesFormat, File(<span class="stringliteral">&quot;/c/styles.indd&quot;</span>), GlobalClashResolutionStrategy.loadAllWithOverwrite);</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_finding_and_changing_text"></a>
Finding and changing text</h2>
<p>The find/change feature is one of the most powerful InDesign tools for working with text. It is fully supported by scripting, and scripts can use find/change to go far beyond what can be done using the InDesign user interface. InDesign has three ways of searching for text:</p>
<ul>
<li>You can find text and/or text formatting and change it to other text and/or text formatting. This type of find/change operation uses the findTextPreferences and changeTextPreferences objects to specify parameters for the findText and changeText methods.</li>
<li>You can find text using regular expressions, or "grep." This type of find/change operation uses the findGrepPreferences and changeGrepPreferences objects to specify parameters for the findGrep and changeGrep methods.</li>
<li>You can find specific glyphs (and their formatting) and replace them with other glyphs and formatting. This type of find/change operation uses the findGlyphPreferences and changeGlyphPreferences objects to specify parameters for the findGlyph and changeGlyph methods.</li>
</ul>
<p>All the find/change methods take one optional parameter, ReverseOrder, which specifies the order in which the results of the search are returned. If you are processing the results of a find or change operation in a way that adds or removes text from a story, you might face the problem of invalid text references, as discussed earlier in this section. In this case, you can either construct your loops to iterate backward through the collection of returned text objects, or you can have the search operation return the results in reverse order and then iterate through the collection normally.</p>
<h3><a class="anchor" id=""></a>
</h3>
<p>Before you search for text, you probably will want to clear find and change preferences, to make sure the settings from previous searches have no effect on your search. You also need to set some find/change preferences to specify the text, formatting, regular expression, or glyph you want to find and/or change. A typical find/change operation involves the following steps:</p>
<ol type="1">
<li>Clear the find/change preferences. Depending on the type of find/change operation, this can take one of the following three forms:<ul>
<li><div class="fragment"><div class="line"><span class="comment">//find/change text preferences</span></div>
<div class="line">app.findTextPreferences = NothingEnum.nothing;</div>
<div class="line">app.changeTextPreferences = NothingEnum.nothing;</div>
</div><!-- fragment --></li>
<li><div class="fragment"><div class="line"> <span class="comment">//find/change grep preferences</span></div>
<div class="line">app.findGrepPreferences = NothingEnum.nothing;</div>
<div class="line">app.changeGrepPreferences = NothingEnum.nothing;</div>
</div><!-- fragment --></li>
<li><div class="fragment"><div class="line"> <span class="comment">//find/change glyph preferences</span></div>
<div class="line">app.findGlyphPreferences = NothingEnum.nothing;</div>
<div class="line">app.changeGlyphPreferences = NothingEnum.nothing;</div>
</div><!-- fragment --></li>
</ul>
</li>
<li>Set up search parameters.</li>
<li>Execute the find/change operation.</li>
<li>Clear find/change preferences again.</li>
</ol>
<h3><a class="anchor" id="id_js_finding_and_changing_text"></a>
Finding and changing text</h3>
<p>The following script fragment shows how to find a specified string of text. While the following script fragment searches the entire document, you also can search stories, text frames, paragraphs, text columns, or any other text object. The findText method and its parameters are the same for all text objects. (For the complete script, see FindText.) </p>
<div class="fragment"><div class="line">    var myDocument = app.activeDocument;</div>
<div class="line">    <span class="comment">//Clear the find/change text preferences.</span></div>
<div class="line">    app.findTextPreferences = NothingEnum.nothing;</div>
<div class="line">    app.changeTextPreferences = NothingEnum.nothing;</div>
<div class="line">    <span class="comment">//Search the document for the string &quot;Text&quot;.</span></div>
<div class="line">    app.findTextPreferences.findWhat = <span class="stringliteral">&quot;text&quot;</span>;</div>
<div class="line">    <span class="comment">//Set the find options.</span></div>
<div class="line">    app.findChangeTextOptions.caseSensitive = <span class="keyword">false</span>;</div>
<div class="line">    app.findChangeTextOptions.includeFootnotes = <span class="keyword">false</span>;</div>
<div class="line">    app.findChangeTextOptions.includeHiddenLayers = <span class="keyword">false</span>;</div>
<div class="line">    app.findChangeTextOptions.includeLockedLayersForFind = <span class="keyword">false</span>;</div>
<div class="line">    app.findChangeTextOptions.includeLockedStoriesForFind = <span class="keyword">false</span>;</div>
<div class="line">    app.findChangeTextOptions.includeMasterPages = <span class="keyword">false</span>;</div>
<div class="line">    app.findChangeTextOptions.wholeWord = <span class="keyword">false</span>;</div>
<div class="line">    var myFoundItems = myDocument.findText();</div>
<div class="line">    alert(<span class="stringliteral">&quot;Found &quot;</span> + myFoundItems.length + <span class="stringliteral">&quot; instances of the search string.&quot;</span>);</div>
<div class="line">    app.findTextPreferences = NothingEnum.nothing;</div>
<div class="line">    app.changeTextPreferences = NothingEnum.nothing;</div>
</div><!-- fragment --><p> The following script fragment shows how to find a specified string of text and replace it with a different string (for the complete script, see ChangeText): </p>
<div class="fragment"><div class="line">    var myDocument = app.activeDocument;</div>
<div class="line">    <span class="comment">//Clear the find/change text preferences.</span></div>
<div class="line">    app.findTextPreferences = NothingEnum.nothing;</div>
<div class="line">    app.changeTextPreferences = NothingEnum.nothing;</div>
<div class="line">    <span class="comment">//Set the find options.</span></div>
<div class="line">    app.findChangeTextOptions.caseSensitive = <span class="keyword">false</span>;</div>
<div class="line">    app.findChangeTextOptions.includeFootnotes = <span class="keyword">false</span>;</div>
<div class="line">    app.findChangeTextOptions.includeHiddenLayers = <span class="keyword">false</span>;</div>
<div class="line">    app.findChangeTextOptions.includeLockedLayersForFind = <span class="keyword">false</span>;</div>
<div class="line">    app.findChangeTextOptions.includeLockedStoriesForFind = <span class="keyword">false</span>;</div>
<div class="line">    app.findChangeTextOptions.includeMasterPages = <span class="keyword">false</span>;</div>
<div class="line">    app.findChangeTextOptions.wholeWord = <span class="keyword">false</span>;</div>
<div class="line">    <span class="comment">//Search the document for the string &quot;copy&quot; and change it to &quot;text&quot;.</span></div>
<div class="line">    app.findTextPreferences.findWhat = <span class="stringliteral">&quot;copy&quot;</span>;</div>
<div class="line">    app.changeTextPreferences.changeTo = <span class="stringliteral">&quot;text&quot;</span>;</div>
<div class="line">    myDocument.changeText();</div>
<div class="line">    <span class="comment">//Clear the find/change text preferences after the search.</span></div>
<div class="line">    app.findTextPreferences = NothingEnum.nothing;</div>
<div class="line">    app.changeTextPreferences = NothingEnum.nothing;</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_finding_and_changing_text_formatting"></a>
Finding and changing text formatting</h3>
<p>To find and change text formatting, you set other properties of the findTextPreferences and changeTextPreferences objects, as shown in the script fragment below (from the FindChangeFormatting tutorial script): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    <span class="comment">//Clear the find/change preferences.</span></div>
<div class="line">    app.findTextPreferences = NothingEnum.nothing;</div>
<div class="line">    app.changeTextPreferences = NothingEnum.nothing;</div>
<div class="line">    <span class="comment">//Set the find options.</span></div>
<div class="line">    app.findChangeTextOptions.caseSensitive = <span class="keyword">false</span>;</div>
<div class="line">    app.findChangeTextOptions.includeFootnotes = <span class="keyword">false</span>;</div>
<div class="line">    app.findChangeTextOptions.includeHiddenLayers = <span class="keyword">false</span>;</div>
<div class="line">    app.findChangeTextOptions.includeLockedLayersForFind = <span class="keyword">false</span>;</div>
<div class="line">    app.findChangeTextOptions.includeLockedStoriesForFind = <span class="keyword">false</span>;</div>
<div class="line">    app.findChangeTextOptions.includeMasterPages = <span class="keyword">false</span>;</div>
<div class="line">    app.findChangeTextOptions.wholeWord = <span class="keyword">false</span>;</div>
<div class="line">    <span class="comment">//Search the document for the 24 point text and change it to 10 point text.</span></div>
<div class="line">    app.findTextPreferences.pointSize = 24;</div>
<div class="line">    app.changeTextPreferences.pointSize = 10;</div>
<div class="line">    myDocument.changeText();</div>
<div class="line">    <span class="comment">//Clear the find/change preferences after the search.</span></div>
<div class="line">    app.findTextPreferences = NothingEnum.nothing;</div>
<div class="line">    app.changeTextPreferences = NothingEnum.nothing;</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_using_grep"></a>
Using grep</h3>
<p>InDesign supports regular expression find/change through the findGrep and changeGrep methods. Regular-expression find/change also can find text with a specified format or replace the formatting of the text with formatting specified in the properties of the changeGrepPreferences object. The following script fragment shows how to use these methods and the related preferences objects (for the complete script, see FindGrep): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    <span class="comment">//Clear the find/change grep preferences.</span></div>
<div class="line">    app.findGrepPreferences = NothingEnum.nothing;</div>
<div class="line">    app.changeGrepPreferences = NothingEnum.nothing;</div>
<div class="line">    <span class="comment">//Set the find options.</span></div>
<div class="line">    app.findChangeGrepOptions.includeFootnotes = <span class="keyword">false</span>;</div>
<div class="line">    app.findChangeGrepOptions.includeHiddenLayers = <span class="keyword">false</span>;</div>
<div class="line">    app.findChangeGrepOptions.includeLockedLayersForFind = <span class="keyword">false</span>;</div>
<div class="line">    app.findChangeGrepOptions.includeLockedStoriesForFind = <span class="keyword">false</span>;</div>
<div class="line">    app.findChangeGrepOptions.includeMasterPages = <span class="keyword">false</span>;</div>
<div class="line">    <span class="comment">//Regular expression for finding an email address.</span></div>
<div class="line">    app.findGrepPreferences.findWhat = <span class="stringliteral">&quot;(?i)[A-Z]*?@[A-Z]*?[.]...&quot;</span>;</div>
<div class="line">    <span class="comment">//Apply the change to 24-point text only.</span></div>
<div class="line">    app.findGrepPreferences.pointSize = 24;</div>
<div class="line">    app.changeGrepPreferences.underline = <span class="keyword">true</span>;</div>
<div class="line">    myDocument.changeGrep();</div>
<div class="line">    <span class="comment">//Clear the find/change preferences after the search.</span></div>
<div class="line">    app.findGrepPreferences = NothingEnum.nothing;</div>
<div class="line">    app.changeGrepPreferences = NothingEnum.nothing;</div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>The findChangeGrepOptions object lacks two properties of the findChangeTextOptions object: wholeWord and caseSensitive. This is because you can set these options using the regular expression string itself. Use (?i) to turn case sensitivity on and (?-i) to turn case sensitivity off. Use &gt; to match the beginning of a word and \&lt; to match the end of a word, or use \b to match a word boundary.</dd></dl>
<p>One handy use for grep find/change is to convert text mark-up (i.e., some form of tagging plain text with formatting instructions) into InDesign formatted text. PageMaker paragraph tags (which are not the same as PageMaker tagged-text format files) are an example of a simplified text mark-up scheme. In a text file marked up using this scheme, paragraph style names appear at the start of a paragraph, as shown below: </p>
<div class="fragment"><div class="line">&lt;heading1&gt;This is a heading.</div>
<div class="line">&lt;body_text&gt;This is body text.</div>
</div><!-- fragment --><p>We can create a script that uses grep find in conjunction with text find/change operations to apply formatting to the text and remove the mark-up tags, as shown in the following script fragment (from the ReadPMTags tutorial script): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myStory = myDocument.stories.item(0);</div>
<div class="line">    myReadPMTags(myStory);</div>
</div><!-- fragment --><p> Here is the myReadPMTags function referred to in the above script. </p>
<div class="fragment"><div class="line"><span class="keyword">function</span> myReadPMTags(myStory){</div>
<div class="line">    var myName, myString, myStyle, myStyleName;</div>
<div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    <span class="comment">//Reset the findGrepPreferences to ensure that previous settings</span></div>
<div class="line">    <span class="comment">//do not affect the search.</span></div>
<div class="line">    app.findGrepPreferences = NothingEnum.nothing;</div>
<div class="line">    app.changeGrepPreferences = NothingEnum.nothing;</div>
<div class="line">    <span class="comment">//Find the tags (since this is a JavaScript string, the backslashes must be escaped).</span></div>
<div class="line">    app.findGrepPreferences.findWhat = <span class="stringliteral">&quot;(?i)^&lt;\\s*\\w+\\s*&gt;&quot;</span>;</div>
<div class="line">    var myFoundItems = myStory.findGrep();</div>
<div class="line">    <span class="keywordflow">if</span>(myFoundItems.length != 0){</div>
<div class="line">        var myFoundTags = <span class="keyword">new</span> Array;</div>
<div class="line">        <span class="keywordflow">for</span>(var myCounter = 0; myCounter&lt;myFoundItems.length; myCounter++){</div>
<div class="line">            myFoundTags.push(myFoundItems[myCounter].contents);</div>
<div class="line">        }</div>
<div class="line">        myFoundTags = myRemoveDuplicates(myFoundTags);</div>
<div class="line">        <span class="comment">//At this point, we have a list of tags to search for.</span></div>
<div class="line">        <span class="keywordflow">for</span>(myCounter = 0; myCounter &lt; myFoundTags.length; myCounter++){</div>
<div class="line">            myString = myFoundTags[myCounter];</div>
<div class="line">            <span class="comment">//Find the tag using findWhat.</span></div>
<div class="line">            app.findTextPreferences.findWhat = myString;</div>
<div class="line">            <span class="comment">//Extract the style name from the tag.</span></div>
<div class="line">            myStyleName = myString.substring(1, myString.length-1);</div>
<div class="line">            <span class="comment">//Create the style if it does not already exist.</span></div>
<div class="line">            <span class="keywordflow">try</span>{</div>
<div class="line">                myStyle = myDocument.paragraphStyles.item(myStyleName);</div>
<div class="line">                myName = myStyle.name;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">catch</span> (myError){</div>
<div class="line">                myStyle = myDocument.paragraphStyles.add({name:myStyleName});</div>
<div class="line">            }</div>
<div class="line">            <span class="comment">//Apply the style to each instance of the tag.</span></div>
<div class="line">            app.changeTextPreferences.appliedParagraphStyle = myStyle;</div>
<div class="line">            myStory.changeText();</div>
<div class="line">            <span class="comment">//Reset the changeTextPreferences.</span></div>
<div class="line">            app.changeTextPreferences = NothingEnum.nothing;</div>
<div class="line">            <span class="comment">//Set the changeTo to an empty string.</span></div>
<div class="line">            app.changeTextPreferences.changeTo = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">            <span class="comment">//Search to remove the tags.</span></div>
<div class="line">            myStory.changeText();</div>
<div class="line">            <span class="comment">//Reset the find/change preferences again.</span></div>
<div class="line">            app.changeTextPreferences = NothingEnum.nothing;            </div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Reset the findGrepPreferences.</span></div>
<div class="line">    app.findGrepPreferences  = NothingEnum.nothing;</div>
<div class="line">}</div>
<div class="line"><span class="keyword">function</span> myRemoveDuplicates(myArray){ </div>
<div class="line">    <span class="comment">//Semi-clever method of removing duplicate array items; much faster </span></div>
<div class="line">    <span class="comment">//than comparing every item to every other item! </span></div>
<div class="line">    var myNewArray = <span class="keyword">new</span> Array; </div>
<div class="line">    myArray = myArray.sort(); </div>
<div class="line">    myNewArray.push(myArray[0]); </div>
<div class="line">    <span class="keywordflow">if</span>(myArray.length &gt; 1){ </div>
<div class="line">        <span class="keywordflow">for</span>(var myCounter = 1; myCounter &lt; myArray.length; myCounter ++){ </div>
<div class="line">            <span class="keywordflow">if</span>(myArray[myCounter] != myNewArray[myNewArray.length -1]){ </div>
<div class="line">                myNewArray.push(myArray[myCounter]); </div>
<div class="line">            } </div>
<div class="line">        } </div>
<div class="line">    } </div>
<div class="line">    <span class="keywordflow">return</span> myNewArray; </div>
<div class="line">} </div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_using_glyph_search"></a>
Using glyph search</h3>
<p>You can find and change individual characters in a specific font using the findGlyph and changeGlyph methods and the associated findGlyphPreferences and changeGlyphPreferences objects. The following scripts fragment shows how to find and change a glyph in an example document (for the complete script, see FindChangeGlyph): </p>
<div class="fragment"><div class="line">    <span class="comment">//Clear glyph search preferences.</span></div>
<div class="line">    app.findGlyphPreferences = NothingEnum.nothing;</div>
<div class="line">    app.changeGlyphPreferences = NothingEnum.nothing;</div>
<div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    <span class="comment">//You must provide a font that is used in the document for the</span></div>
<div class="line">    <span class="comment">//appliedFont property of the findGlyphPreferences object.</span></div>
<div class="line">    app.findGlyphPreferences.appliedFont = app.fonts.itemByName(<span class="stringliteral">&quot;Minion Pro Regular&quot;</span>);</div>
<div class="line">    <span class="comment">//Provide the glyph ID, not the glyph Unicode value.</span></div>
<div class="line">    app.findGlyphPreferences.glyphID = 374;</div>
<div class="line">    <span class="comment">//The appliedFont of the changeGlyphPreferences object can be</span></div>
<div class="line">    <span class="comment">//any font available to the application.</span></div>
<div class="line">    app.changeGlyphPreferences.appliedFont = app.fonts.itemByName(<span class="stringliteral">&quot;Times New Roman  Bold&quot;</span>);</div>
<div class="line">    app.changeGlyphPreferences.glyphID = 85;</div>
<div class="line">    myDocument.changeGlyph(<span class="keyword">false</span>);</div>
<div class="line">    <span class="comment">//Clear glyph search preferences.</span></div>
<div class="line">    app.findGlyphPreferences = NothingEnum.nothing;</div>
<div class="line">    app.changeGlyphPreferences = NothingEnum.nothing;</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_working_with_tables"></a>
Working with Tables</h2>
<p>Tables can be created from existing text using the convertTextToTable method, or an empty table can be created at any insertion point in a story. The following script fragment shows three different ways to create a table (for the complete script, see MakeTable): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myStory = myDocument.stories.item(0);</div>
<div class="line">    var myStartCharacter = myStory.paragraphs.item(6).characters.item(0);</div>
<div class="line">    var myEndCharacter = myStory.paragraphs.item(6).characters.item(-2);</div>
<div class="line">    var myText = myStory.texts.itemByRange(myStartCharacter, myEndCharacter);</div>
<div class="line">    <span class="comment">//The convertToTable method takes three parameters:</span></div>
<div class="line">    <span class="comment">//[ColumnSeparator as string]</span></div>
<div class="line">    <span class="comment">//[RowSeparator as string]</span></div>
<div class="line">    <span class="comment">//[NumberOfColumns as integer] (only used if the ColumnSeparator</span></div>
<div class="line">    <span class="comment">//and RowSeparator values are the same)</span></div>
<div class="line">    <span class="comment">//In the last paragraph in the story, columns are separated by commas</span></div>
<div class="line">    <span class="comment">//and rows are separated by semicolons, so we provide those characters</span></div>
<div class="line">    <span class="comment">//to the method as parameters.</span></div>
<div class="line">    var myTable = myText.convertToTable(<span class="stringliteral">&quot;,&quot;</span>,<span class="stringliteral">&quot;;&quot;</span>);</div>
<div class="line">    var myStartCharacter = myStory.paragraphs.item(1).characters.item(0);</div>
<div class="line">    var myEndCharacter = myStory.paragraphs.item(4).characters.item(-2);</div>
<div class="line">    var myText = myStory.texts.itemByRange(myStartCharacter, myEndCharacter);</div>
<div class="line">    <span class="comment">//In the second through the fifth paragraphs, colums are separated by</span></div>
<div class="line">    <span class="comment">//tabs and rows are separated by returns. These are the default delimiter</span></div>
<div class="line">    <span class="comment">//parameters, so we don&#39;t need to provide them to the method.</span></div>
<div class="line">    var myTable = myText.convertToTable();</div>
<div class="line">    <span class="comment">//You can also explicitly add a table--you don&#39;t have to convert text to a table.</span></div>
<div class="line">    var myTable = myStory.insertionPoints.item(-1).tables.add();</div>
<div class="line">    myTable.columnCount = 3;</div>
<div class="line">    myTable.bodyRowCount = 3;</div>
</div><!-- fragment --><p> The following script fragment shows how to merge table cells. (For the complete script, see MergeTableCells.) </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myStory = myDocument.stories.item(0);</div>
<div class="line">    var myTable = myStory.insertionPoints.item(-1).tables.add();</div>
<div class="line">    myTable.columnCount = 4;</div>
<div class="line">    myTable.bodyRowCount = 4;</div>
<div class="line">    <span class="comment">//Merge all of the cells in the first column.</span></div>
<div class="line">    myTable.cells.item(0).merge(myTable.columns.item(0).cells.item(-1));</div>
<div class="line">    <span class="comment">//Convert column 2 into 2 cells (rather than 4).</span></div>
<div class="line">    myTable.columns.item(1).cells.item(-1).merge(myTable.columns.item(1).cells.item(-2));</div>
<div class="line">    myTable.columns.item(1).cells.item(0).merge(myTable.columns.item(1).cells.item(1));</div>
<div class="line">    <span class="comment">//Merge the last two cells in row 1.</span></div>
<div class="line">    myTable.rows.item(0).cells.item(-2).merge(myTable.rows.item(0).cells.item(-1));</div>
<div class="line">    <span class="comment">//Merge the last two cells in row 3.</span></div>
<div class="line">    myTable.rows.item(2).cells.item(-2).merge(myTable.rows.item(2).cells.item(-1));</div>
</div><!-- fragment --><p> The following script fragment shows how to split table cells. (For the complete script, see SplitTableCells.) </p>
<div class="fragment"><div class="line">    var myRowCounter, myRow, myCellCounter;</div>
<div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myStory = myDocument.stories.item(0);</div>
<div class="line">    var myTable = myStory.insertionPoints.item(-1).tables.add();</div>
<div class="line">    myTable.columnCount = 1;</div>
<div class="line">    myTable.bodyRowCount = 1;</div>
<div class="line">    var myArray = myGetBounds(myDocument, myDocument.pages.item(0))</div>
<div class="line">    var myWidth = myArray[3]-myArray[1];</div>
<div class="line">    myTable.columns.item(0).width = myWidth;    </div>
<div class="line">    myTable.cells.item(0).split(HorizontalOrVertical.horizontal);</div>
<div class="line">    myTable.columns.item(0).split(HorizontalOrVertical.vertical);</div>
<div class="line">    myTable.cells.item(0).split(HorizontalOrVertical.vertical);</div>
<div class="line">    myTable.rows.item(-1).split(HorizontalOrVertical.horizontal);</div>
<div class="line">    myTable.cells.item(-1).split(HorizontalOrVertical.vertical);</div>
<div class="line">    <span class="keywordflow">for</span>(myRowCounter = 0; myRowCounter &lt; myTable.rows.length; myRowCounter ++){</div>
<div class="line">        myRow = myTable.rows.item(myRowCounter);</div>
<div class="line">        <span class="keywordflow">for</span>(myCellCounter = 0; myCellCounter &lt; myRow.cells.length; myCellCounter ++){</div>
<div class="line">            myString = <span class="stringliteral">&quot;Row: &quot;</span> + myRowCounter + <span class="stringliteral">&quot; Cell: &quot;</span> + myCellCounter;</div>
<div class="line">            myRow.cells.item(myCellCounter).contents = myString;</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment --><p> The following script fragment shows how to create header and footer rows in a table (for the complete script, see HeaderAndFooterRows): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myTable = myDocument.stories.item(0).tables.item(0);</div>
<div class="line">    <span class="comment">//Convert the first row to a header row.</span></div>
<div class="line">    myTable.rows.item(0).rowType = RowTypes.headerRow;</div>
<div class="line">    <span class="comment">//Convert the last row to a footer row.</span></div>
<div class="line">    myTable.rows.item(-1).rowType = RowTypes.footerRow;</div>
</div><!-- fragment --><p> The following script fragment shows how to apply formatting to a table (for the complete script, see TableFormatting): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myTable = myDocument.stories.item(0).tables.item(0);</div>
<div class="line">    <span class="comment">//Convert the first row to a header row.</span></div>
<div class="line">    myTable.rows.item(0).rowType = RowTypes.headerRow;</div>
<div class="line">    <span class="comment">//Use a reference to a swatch, rather than to a color.</span></div>
<div class="line">    myTable.rows.item(0).fillColor = myDocument.swatches.item(<span class="stringliteral">&quot;DGC1_446b&quot;</span>);</div>
<div class="line">    myTable.rows.item(0).fillTint = 40;</div>
<div class="line">    myTable.rows.item(1).fillColor = myDocument.swatches.item(<span class="stringliteral">&quot;DGC1_446a&quot;</span>);</div>
<div class="line">    myTable.rows.item(1).fillTint = 40;</div>
<div class="line">    myTable.rows.item(2).fillColor = myDocument.swatches.item(<span class="stringliteral">&quot;DGC1_446a&quot;</span>);</div>
<div class="line">    myTable.rows.item(2).fillTint = 20;</div>
<div class="line">    myTable.rows.item(3).fillColor = myDocument.swatches.item(<span class="stringliteral">&quot;DGC1_446a&quot;</span>);</div>
<div class="line">    myTable.rows.item(3).fillTint = 40;</div>
<div class="line">    <span class="comment">//Use everyItem to set the formatting of multiple cells at once.</span></div>
<div class="line">    myTable.cells.everyItem().topEdgeStrokeColor = myDocument.swatches.item(<span class="stringliteral">&quot;DGC1_446b&quot;</span>);</div>
<div class="line">    myTable.cells.everyItem().topEdgeStrokeWeight = 1;</div>
<div class="line">    myTable.cells.everyItem().bottomEdgeStrokeColor = myDocument.swatches.item(<span class="stringliteral">&quot;DGC1_446b&quot;</span>);</div>
<div class="line">    myTable.cells.everyItem().bottomEdgeStrokeWeight = 1;</div>
<div class="line">    <span class="comment">//When you set a cell stroke to a swatch, make certain </span></div>
<div class="line">    <span class="comment">//that you also set the stroke weight.</span></div>
<div class="line">    myTable.cells.everyItem().leftEdgeStrokeColor = myDocument.swatches.item(<span class="stringliteral">&quot;None&quot;</span>);</div>
<div class="line">    myTable.cells.everyItem().leftEdgeStrokeWeight = 0;</div>
<div class="line">    myTable.cells.everyItem().rightEdgeStrokeColor = myDocument.swatches.item(<span class="stringliteral">&quot;None&quot;</span>);</div>
<div class="line">    myTable.cells.everyItem().rightEdgeStrokeWeight = 0;</div>
</div><!-- fragment --><p> The following script fragment shows how to add alternating row formatting to a table (for the complete script, see AlternatingRows): </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a table &quot;myTable,&quot; apply alternating fills to the table.</span></div>
<div class="line">    myTable.alternatingFills = AlternatingFillsTypes.alternatingRows;</div>
<div class="line">    myTable.startRowFillColor = myDocument.swatches.item(<span class="stringliteral">&quot;DGC1_446a&quot;</span>);</div>
<div class="line">    myTable.startRowFillTint = 60;</div>
<div class="line">    myTable.endRowFillColor = myDocument.swatches.item(<span class="stringliteral">&quot;DGC1_446b&quot;</span>);</div>
<div class="line">    myTable.endRowFillTint = 50;</div>
</div><!-- fragment --><p> The following script fragment shows how to process the selection when text or table cells are selected. In this example, the script displays an alert for each selection condition, but a real production script would then do something with the selected item(s). (For the complete script, see TableSelection.) </p>
<div class="fragment"><div class="line">    <span class="keywordflow">if</span>(app.documents.length != 0){</div>
<div class="line">        <span class="keywordflow">if</span>(app.selection.length != 0){</div>
<div class="line">            <span class="keywordflow">switch</span>(app.selection[0].constructor.name){</div>
<div class="line">                <span class="comment">//When a row, a column, or a range of cells is </span></div>
<div class="line">                <span class="comment">//selected, the type returned is &quot;Cell&quot;</span></div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Cell&quot;</span>:</div>
<div class="line">                    alert(<span class="stringliteral">&quot;A cell is selected.&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Table&quot;</span>:</div>
<div class="line">                    alert(<span class="stringliteral">&quot;A table is selected.&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;InsertionPoint&quot;</span>:</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Character&quot;</span>:</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Word&quot;</span>:</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;TextStyleRange&quot;</span>:</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Line&quot;</span>:</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Paragraph&quot;</span>:</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;TextColumn&quot;</span>:</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Text&quot;</span>:</div>
<div class="line">                    <span class="keywordflow">if</span>(app.selection[0].parent.constructor.name == <span class="stringliteral">&quot;Cell&quot;</span>){</div>
<div class="line">                        alert(<span class="stringliteral">&quot;The selection is inside a table cell.&quot;</span>);</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Rectangle&quot;</span>:</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Oval&quot;</span>:</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Polygon&quot;</span>:</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;GraphicLine&quot;</span>:</div>
<div class="line">                    <span class="keywordflow">if</span>(app.selection[0].parent.parent.constructor.name == <span class="stringliteral">&quot;Cell&quot;</span>){</div>
<div class="line">                        alert(<span class="stringliteral">&quot;The selection is inside a table cell.&quot;</span>);</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Image&quot;</span>:</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;PDF&quot;</span>:</div>
<div class="line">                <span class="keywordflow">case</span> <span class="stringliteral">&quot;EPS&quot;</span>:</div>
<div class="line">                    <span class="keywordflow">if</span>(app.selection[0].parent.parent.parent.constructor.name == <span class="stringliteral">&quot;Cell&quot;</span>){</div>
<div class="line">                        alert(<span class="stringliteral">&quot;The selection is inside a table cell.&quot;</span>);</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                    alert(<span class="stringliteral">&quot;The selection is not inside a table.&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_adding_path_text"></a>
Adding Path Text</h2>
<p>You can add path text to any rectangle, oval, polygon, graphic line, or text frame. The following script fragment shows how to add path text to a page item (for the complete script, see PathText): </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a document &quot;myDocument&quot; with a rectangle on page 1...</span></div>
<div class="line">    var myPage = myDocument.pages.item(0);</div>
<div class="line">    var myRectangle = myPage.rectangles.item(0);</div>
<div class="line">    var myTextPath = myRectangle.textPaths.add({contents:<span class="stringliteral">&quot;This is path text.&quot;</span>});</div>
</div><!-- fragment --><p> To link text paths to another text path or text frame, use the nextTextFrame and previousTextFrame properties, just as you would for a text frame (see <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_working_with_text_frames">Working with Text Frames</a>).</p>
<h2><a class="anchor" id="id_js_using_autocorrect"></a>
Using Autocorrect</h2>
<p>The autocorrect feature can correct text as you type. The following script shows how to use it (for the complete script, see Autocorrect): </p>
<div class="fragment"><div class="line">    <span class="comment">//The autocorrect preferences object turns the </span></div>
<div class="line">    <span class="comment">//autocorrect feature on or off.</span></div>
<div class="line">    app.autoCorrectPreferences.autoCorrect = <span class="keyword">true</span>;</div>
<div class="line">    app.autoCorrectPreferences.autoCorrectCapitalizationErrors = <span class="keyword">true</span>;</div>
<div class="line">    <span class="comment">//Add a word pair to the autocorrect list. Each AutoCorrectTable is linked</span></div>
<div class="line">    <span class="comment">//to a specific language. </span></div>
<div class="line">    var myAutoCorrectTable = app.autoCorrectTables.item(<span class="stringliteral">&quot;English: USA&quot;</span>);</div>
<div class="line">    <span class="comment">//To safely add a word pair to the auto correct table, get the current</span></div>
<div class="line">    <span class="comment">//word pair list, then add the new word pair to that array, and then</span></div>
<div class="line">    <span class="comment">//set the autocorrect word pair list to the array.</span></div>
<div class="line">    var myWordPairList = myAutoCorrectTable.autoCorrectWordPairList;</div>
<div class="line">    <span class="comment">//Add a new word pair to the array.</span></div>
<div class="line">    myWordPairList.push([<span class="stringliteral">&quot;paragarph&quot;</span>, <span class="stringliteral">&quot;paragraph&quot;</span>]);</div>
<div class="line">    <span class="comment">//Update the word pair list.</span></div>
<div class="line">    myAutoCorrectTable.autoCorrectWordPairList = myWordPairList;</div>
<div class="line">    <span class="comment">//To clear all autocorrect word pairs in the current dictionary:</span></div>
<div class="line">    <span class="comment">//myAutoCorrectTable.autoCorrectWordPairList = [[]];</span></div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_adding_footnotes"></a>
Adding Footnotes</h2>
<p>The following script fragment shows how to add footnotes to a story (for the complete script, including the myGetRandom function, see Footnotes): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myPage = myDocument.pages.item(0);</div>
<div class="line">    var myTextFrame = myPage.textFrames.item(0);</div>
<div class="line">    <span class="comment">//Add four footnotes at random locations in the story.</span></div>
<div class="line">    <span class="keywordflow">for</span>(myCounter = 0; myCounter &lt; 4; myCounter ++){</div>
<div class="line">        myWord = myTextFrame.parentStory.words.item(myGetRandom(0, myTextFrame.parentStory.words.length));</div>
<div class="line">        var myFootnote = myWord.insertionPoints.item(-1).footnotes.add();</div>
<div class="line">        <span class="comment">//Note: when you create a footnote, it contains text--the footnote marker</span></div>
<div class="line">        <span class="comment">//and the separator text (if any). If you try to set the text of the footnote</span></div>
<div class="line">        <span class="comment">//by setting the footnote contents, you will delete the marker. Instead, append</span></div>
<div class="line">        <span class="comment">//the footnote text, as shown below.</span></div>
<div class="line">        myFootnote.insertionPoints.item(-1).contents = <span class="stringliteral">&quot;This is a footnote.&quot;</span>;</div>
<div class="line">    }</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_spanning_columns"></a>
Spanning Columns</h2>
<p>A paragraph layout can span multiple columns or split into subcolumns with the Span Columns attribute or Split Column attribute applied. The following script fragment shows how to set the Span Columns and Split Column style for a paragraph (for the complete script, see SpanColumns): </p>
<div class="fragment"><div class="line">    var myDocument = app.activeDocument;</div>
<div class="line">    var myPage = myDocument.pages.item(0);</div>
<div class="line">    var myStory = myPage.textFrames.item(0).parentStory;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">//Split Column</span></div>
<div class="line">    with(myStory.paragraphs[0]) {   </div>
<div class="line">        spanColumnType = SpanColumnTypeOptions.splitColumns;</div>
<div class="line">        spanSplitColumnCount = 2;</div>
<div class="line">        splitColumnOutsideGutter = 0; </div>
<div class="line">        splitColumnInsideGutter = 1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">//Span Columns</span></div>
<div class="line">    var mySpanIndex = Math.floor(myStory.paragraphs.length / 2);</div>
<div class="line">    with(myStory.paragraphs[mySpanIndex]) { </div>
<div class="line">        spanColumnType = SpanColumnTypeOptions.spanColumns;</div>
<div class="line">        spanSplitColumnCount = SpanColumnCountOptions.all;</div>
<div class="line">    }</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_setting_text_preferences"></a>
Setting Text Preferences</h2>
<p>The following script shows how to set general text preferences (for the complete script, see TextPreferences): </p>
<div class="fragment"><div class="line">    <span class="comment">//The following sets the text preferences for the application; to set the</span></div>
<div class="line">    <span class="comment">//text preferences for the front-most document, replace &quot;app.textPreferences&quot; with</span></div>
<div class="line">    <span class="comment">//&quot;app.documents.item(0).textPreferences&quot;</span></div>
<div class="line">    with(app.textPreferences){</div>
<div class="line">        abutTextToTextWrap = <span class="keyword">true</span>;</div>
<div class="line">        <span class="comment">//baseline shift key increment can range from .001 to 200 points.</span></div>
<div class="line">        baselineShiftKeyIncrement = 1;</div>
<div class="line">        highlightCustomSpacing = <span class="keyword">false</span>;</div>
<div class="line">        highlightHjViolations = <span class="keyword">true</span>;</div>
<div class="line">        highlightKeeps = <span class="keyword">true</span>;</div>
<div class="line">        highlightSubstitutedFonts = <span class="keyword">true</span>;</div>
<div class="line">        highlightSubstitutedGlyphs = <span class="keyword">true</span>;</div>
<div class="line">        justifyTextWraps = <span class="keyword">true</span>;</div>
<div class="line">        <span class="comment">//kerning key increment value is 1/1000 of an em.</span></div>
<div class="line">        kerningKeyIncrement = 10;</div>
<div class="line">        <span class="comment">//leading key increment value can range from .001 to 200 points.</span></div>
<div class="line">        leadingKeyIncrement = 1;</div>
<div class="line">        linkTextFilesWhenImporting = <span class="keyword">false</span>;</div>
<div class="line">        scalingAdjustsText = <span class="keyword">false</span>;</div>
<div class="line">        showInvisibles = <span class="keyword">true</span>;</div>
<div class="line">        smallCap = 60;</div>
<div class="line">        subscriptPosition = 30;</div>
<div class="line">        subscriptSize = 60;</div>
<div class="line">        superscriptPosition = 30;</div>
<div class="line">        superscriptSize = 60;</div>
<div class="line">        typographersQuotes = <span class="keyword">false</span>;</div>
<div class="line">        useOpticalSize = <span class="keyword">false</span>;</div>
<div class="line">        useParagraphLeading = <span class="keyword">false</span>;</div>
<div class="line">        zOrderTextWrap = <span class="keyword">false</span>; </div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Text editing preferences are application-wide.</span></div>
<div class="line">    with(app.textEditingPreferences){</div>
<div class="line">        allowDragAndDropTextInStory = <span class="keyword">true</span>;</div>
<div class="line">        dragAndDropTextInLayout = <span class="keyword">true</span>;</div>
<div class="line">        smartCutAndPaste = <span class="keyword">true</span>;</div>
<div class="line">        tripleClickSelectsLine = <span class="keyword">false</span>;</div>
<div class="line">    }</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_working_with_linked_stories"></a>
Working with Linked Stories</h2>
<p>Linked stories make it easier to manager multiple versions of the same story or text content in the same document; it makes it easier to support emerging digital publishing workflows, where, for example, you need to design for vertical and horizontal layouts. Linked stories behave similarly to traditional links. You can designate a story as a parent, and then place the same story at other places in the document as child stories. Whenever the parent story is updated, the child stories are flagged in the Links panel and can be updated to synchronize with the parent story.</p>
<h3><a class="anchor" id="id_js_creating_linked_stories"></a>
Creating linked stories</h3>
<p>There are several ways to create a linked story. It can be created by linking existing text frames with the parent story, or by telling the Page, Spread, Master or Document object to create the text frame at the specified location and link it with the parent story.</p>
<p>To link an existing text frame with the parent story, use the following script (for the complete script, see CreateLinkedStories). </p>
<div class="fragment"><div class="line">    childTextFrame1.placeAndLink(myTextFrame.parentStory, <span class="keyword">false</span>);</div>
</div><!-- fragment --><p> If you specify true for the second parameter, which is optional, the linked story options dialog opens; otherwise, the default options are used.</p>
<p>To tell the Page object to create a linked story for the parent story, the placeAndLink method includes two additional parameters that you can use to specify the layer and point at which to place the linked story, as shown in the following script fragment (for the complete script, see CreateLinkedStories). </p>
<div class="fragment"><div class="line">    var newPage = myDocument.pages.add();</div>
<div class="line">    newPage.placeAndLink(myTextFrame.parentStory, [originY, originX], myDocument.activeLayer, <span class="keyword">false</span>);</div>
</div><!-- fragment --><p> To tell the Spread object to create linked story for the parent story, the placeAndLink method takes the same parameters as the placeAndLink method for Page object, as shown in the following script fragment (for the complete script, see CreateLinkedStories). </p>
<div class="fragment"><div class="line">    var newSpread = myDocument.spreads.add();</div>
<div class="line">    newSpread.placeAndLink(myTextFrame.parentStory, [originY, originX], myDocument.activeLayer, <span class="keyword">false</span>);        </div>
</div><!-- fragment --><p> You can also call the placeAndLink method for the Document object. The method takes the parent story as the only parameter. This method does not create the linked story; instead, it loads the place gun and lets the user decide where to place the linked story.</p>
<h3><a class="anchor" id="id_js_changing_linked_story_options"></a>
Changing linked story options</h3>
<p>To change the linked story options, use the following script fragment (for the complete script, see CreateLinkedStories). </p>
<div class="fragment"><div class="line">    with (myDocument.linkedStoryOptions)</div>
<div class="line">    {</div>
<div class="line">        removeForcedLineBreaks = <span class="keyword">true</span>;</div>
<div class="line">        updateWhileSaving = <span class="keyword">true</span>;</div>
<div class="line">        warnOnUpdateOfEditedStory = <span class="keyword">true</span>;</div>
<div class="line">    }</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_frequently_asked_questions"></a>
Frequently asked questions</h3>
<p><b>How can I tell whether a given link is a link for a linked story?</b></p>
<p>Use Link.filePath. If it is empty, then it is a link for a linked story.</p>
<p><b>Given a link for linked story, how can I get its link source?</b></p>
<p>Use this to select the link source: </p>
<div class="fragment"><div class="line">Link.editoriginal();</div>
</div><!-- fragment --><p>Then use this to find the active selection, which is the link source: </p>
<div class="fragment"><div class="line">Application.selection();</div>
</div><!-- fragment --><h1><a class="anchor" id="id_js_working_with_page_items"></a>
Working with Page Items</h1>
<p>This section covers scripting techniques related to the page items (rectangles, ellipses, graphic lines, polygons, text frames, buttons, and groups) that can appear in an InDesign layout.</p>
<h2><a class="anchor" id="id_js_creating_page_items"></a>
Creating Page Items</h2>
<p>Page items in an InDesign layout are arranged in a hierarchy, and appear within a container object of some sort. Spreads, pages, other page items, groups, and text characters are all examples of objects that can contain page items. This hierarchy of containers in the InDesign scripting object model is the same as in the InDesign user interface&ndash;when you create a rectangle by dragging the Rectangle tool on a page, you are specifying that the page is the container, or parent, of the rectangle. When you paste an ellipse into a polygon, you are specifying that the polygon is the parent of the ellipse, which, in turn, is a child object of its parent, a page.</p>
<p>In general, creating a new page item is as simple as telling the object you want to contain the page item to create the page item, as shown in the MakeRectangle script. </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a page &quot;myPage&quot;, create a new rectangle at the default size and location...</span></div>
<div class="line">    var myRectangle = myPage.rectangles.add();</div>
</div><!-- fragment --><p> In the above script, a new rectangle is created on the first page of a new document. The rectangle appears at the default location (near the upper left corner of the page) and has a default size (around ten points square). Moving the rectangle and changing its dimensions are both accomplished by filling its geometric bounds property with new values, as shown in the MakeRectangleWithProperties script. </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a page &quot;myPage&quot;, create a new rectangle and specify its size and location...</span></div>
<div class="line">    var myRectangle = myPage.rectangles.add({geometricBounds:[72, 72, 144, 144]});</div>
</div><!-- fragment --><p> <b>Page item types</b></p>
<p>It is important to note that you cannot create a "generic" page item&ndash;you have to create a page item of a specific type (a rectangle, oval, graphic line, polygon, text frame, or button). You will also notice that InDesign changes the type of a page item as the geometry of the page item changes. A rectangle, for example, is always made up of a single, closed path containing four path points and having 90 degree interior angles. Change the location of a single point, however, or add another path, and the type of the page item changes to a polygon. Open the path and remove two of the four points, and InDesign will change the type to a graphic line. The only things that define the type of a rectangle, ellipse, graphic line, or polygon are:</p>
<ul>
<li>The number of paths in the object. Any page item with more than one path is a polygon.</li>
<li>The number and location of points on the first path in the object.</li>
</ul>
<p>To determine the type of a page item, use this example: </p>
<div class="fragment"><div class="line">var myPageItemType = myPageItem.constructor.name;</div>
</div><!-- fragment --><p>The result of the above will be a string containing the type of the page item.</p>
<p><b>Getting the type of a page item</b></p>
<p>When you have a reference to a generic page item, and want to find out what type of a page item it is, use constructor.name to get the specific type. </p>
<div class="fragment"><div class="line"><span class="comment">//Given a generic page item &quot;myPageItem&quot;...</span></div>
<div class="line">var myType = myPageItem.constructor.name;</div>
<div class="line">alert(myType);</div>
</div><!-- fragment --><p> <b>Referring to page items</b></p>
<p>When you refer to page items inside a given container (a document, layer, page, spread, group, text frame, or page item), you use the pageItems collection of the container object. This gives you a collection of the top level page items inside the object. For example: </p>
<div class="fragment"><div class="line">var myPageItems = app.documents.item(0).pages.item(0).pageItems;</div>
</div><!-- fragment --><p>The resulting collection (myPageItems) does not include objects inside groups (though it does include the group), objects inside other page items (thought it does contain the parent page item), or page items in text frames. To get a reference to all of the items in a given container, including items nested inside other page items, use the allPageItems property. </p>
<div class="fragment"><div class="line">var myAllPageItems = app.documents.item(0).pages.item(0).pageItems;</div>
</div><!-- fragment --><p>The resulting collection (myAllPageItems) includes all objects on the page, regardless of their position in the hierarchy.</p>
<p>Another way to refer to page items is to use their label property, much as you can use the name property of other objects (such as paragraph styles or layers). In the following examples, we will get an array of page items whose label has been set to myLabel. </p>
<div class="fragment"><div class="line">var myPageItems = app.documents.item(0).pages.item(0).pageItems(<span class="stringliteral">&quot;myLabel&quot;</span>);</div>
</div><!-- fragment --><p> If no page items on the page have the specified label, InDesign returns an empty array.</p>
<h3><a class="anchor" id="id_js_page-item_geometry"></a>
Page-item geometry</h3>
<p>If you are working with page items, it is almost impossible to do anything without understanding the way that rulers and measurements work together to specify the location and shape of an InDesign page item. If you use the Control panel in InDesign's user interface, you probably are already familiar with InDesign's geometry, but here is a quick summary:</p>
<ul>
<li>Objects are constructed relative to the coordinates shown on the rulers.</li>
<li>Changing the zero point location by either dragging the zero point or by changing the ruler origin changes the coordinates on the rulers.</li>
<li>Page items are made up of one or more paths, which, in turn, are made up of two or more path points. Paths can be open or closed.</li>
<li>Path points contain an anchor point (the location of the point itself) and two control handles (left direction, which controls the curve of the line segment preceding the point on the path; and right direction, which controls the curve of the segment following the point). Each of these properties contains an array in the form (x, y) (where x is the horizontal location of the point, and y is the vertical location). This array holds the location, in current ruler coordinates, of the point or control handle.</li>
</ul>
<p>All of the above means that if your scripts need to construct page items, you also need to control the location of the zero point, and you may want to set the measurement units in use.</p>
<p><b>Working with paths and path points</b></p>
<p>For most simple page items, you do not need to worry about the paths and path points that define the shape of the object. Rectangles, ellipses, and text frames can be created by specifying their geometric bounds, as we did in the earlier example in this section.</p>
<p>In some cases, however, you may want to construct or change the shape of a path by specifying path point locations, you can either set the anchor point, left direction, and right direction of each path point on the path individually (as shown in the DrawRegularPolygon_Slow script), or you can use the entirePath property of the path to set all of the path point locations at once (as shown in the DrawRegularPolygon_Fast script). The latter approach is much faster.</p>
<p>The items in the array you use for the entirePath property can contain anchor points only, or a anchor points and control handles. Here is an example array containing only anchor point locations: </p>
<div class="fragment"><div class="line">[[x1, y1], [x2, y2], ...]</div>
</div><!-- fragment --><p>Where x and yspecify the location of the anchor.</p>
<p>Here is an example containing fully-specified path points (i.e., arrays containing the left direction, anchor, and right direction, in that order): </p>
<div class="fragment"><div class="line">[[xL1, YL1], [x1, y1], [xR1, yR1]], [[xL2, YL2], [x2, y2], [xR2, yR2]], ...]</div>
</div><!-- fragment --><p>Where xL and yL specify the left direction, x and y specify the anchor point, and xR and yR specify the right direction.</p>
<p>You can also mix the two approaches, as shown in the following example: </p>
<div class="fragment"><div class="line">[[[xL1, YL1], [x1, y1], [xR1, yR1]], [x2, y2], ...]</div>
</div><!-- fragment --><p>Note that the original path does not have to have the same number of points as you specify in the array-InDesign will add or subtract points from the path as it applies the array to the entirePath property.</p>
<p>The AddPathPoint script shows how to add path points to a path without using the entirePath property. </p>
<div class="fragment"><div class="line">    <span class="comment">// Given a graphic line &quot;myGraphicLine&quot;...</span></div>
<div class="line">    var myPathPoint = myGraphicLine.paths.item(0).pathPoints.add();</div>
<div class="line">    <span class="comment">// Move the path point to a specific location.</span></div>
<div class="line">    myPathPoint.anchor = [144, 144];</div>
</div><!-- fragment --><p> The DeletePathPoint script shows how to delete a path point from a path. </p>
<div class="fragment"><div class="line"><span class="comment">//Given a polygon &quot;myPolygon&quot;, remove the </span></div>
<div class="line"><span class="comment">//last path point in the first path.</span></div>
<div class="line">myPolygon.paths.item(0).pathPoints.item(-1).remove();</div>
</div><!-- fragment --><h2><a class="anchor" id="id_js_grouping_page_items"></a>
Grouping Page Items</h2>
<p>In the InDesign user interface, you create groups of page items by selecting them and then choosing Group from the Object menu (or by pressing the corresponding keyboard shortcut). In InDesign scripting, you tell the object containing the page items you want to group (usually a page or spread) to group the page items, as shown in the Group script. </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a page &quot;myPage&quot; containing at least two ovals and two rectangles...</span></div>
<div class="line">    var myArray = <span class="keyword">new</span> Array;</div>
<div class="line">    <span class="comment">//Add the items to the array.</span></div>
<div class="line">    myArray.push(myPage.rectangles.item(0));</div>
<div class="line">    myArray.push(myPage.ovals.item(0));</div>
<div class="line">    myArray.push(myPage.rectangles.item(1));</div>
<div class="line">    myArray.push(myPage.ovals.item(1));</div>
<div class="line">    <span class="comment">//Group the items.</span></div>
<div class="line">    myPage.groups.add(myArray);</div>
</div><!-- fragment --><p> To ungroup, you tell the group itself to ungroup, as shown in the Ungroup script. </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a group &quot;myGroup&quot;...</span></div>
<div class="line">    myPageItems = myGroup.ungroup();</div>
</div><!-- fragment --><p> There is no need to ungroup a group to change the shape, formatting, or content of the page items in the group. Instead, simply get a reference to the page item you want to change, just as you would with any other page item.</p>
<h2><a class="anchor" id="id_js_duplicating_and_moving_page_items"></a>
Duplicating and Moving Page Items</h2>
<p>In the InDesign user interface, you can move page items by selecting them and dragging them to a new location. You can also create copies of page items by copying and pasting, by holding down Option/Alt as you drag an object, or by choosing Duplicate, Paste In Place, or Step and Repeat from the Edit menu. In InDesign scripting, you can use the move method to change the location of page items, and the duplicate method to create a copy of a page item (and, optionally, move it to another location).</p>
<p>The move method can take one of two optional parameters: moveTo and moveBy. Both parameters consist of an array of two measurement units, consisting of a horizontal value and a vertical value. moveTo specifies an absolute move to the location specified by the array, relative to the current location of the zero point. moveBy specifies how far to move the page item relative to the current location of the page item itself. The Move script shows the difference between these two approaches. </p>
<div class="fragment"><div class="line">    <span class="comment">// Given a reference to a rectangle &quot;myRectangle&quot;...</span></div>
<div class="line">    <span class="comment">// Move the rectangle to the location (12, 12).</span></div>
<div class="line">    <span class="comment">// Absolute move:</span></div>
<div class="line">    myRectangle.move([12, 12]);</div>
<div class="line">    <span class="comment">// Move the rectangle *by* 12 points horizontally, 12 points vertically.</span></div>
<div class="line">    <span class="comment">// Relative move (note the use of &quot;undefined&quot; in the first parameter):</span></div>
<div class="line">    myRectangle.move(undefined, [12, 12]);</div>
<div class="line">    <span class="comment">// Move the rectangle to another page (rectangle appears at (0,0).</span></div>
<div class="line">    var myPage = app.documents.item(0).pages.add();</div>
<div class="line">    myRectangle.move(myPage);</div>
<div class="line">    <span class="comment">// To move a page item to another document, use the Duplicate method.</span></div>
</div><!-- fragment --><p> Note that the move method truly moves the object-when you move a page item to another document, it is deleted from the original document. To move the object to another while retaining the original, use the duplicate method (see below).</p>
<p>Use the duplicate method to create a copy of a page item. By default, the duplicate method creates a "clone" of an object in the same location as the original object. Optional parameters can be used with the duplicate method to move the duplicated object to a new location (including other pages in the same document, or to another document entirely). </p>
<div class="fragment"><div class="line">    <span class="comment">// Given a reference to a rectangle &quot;myRectangle&quot;...</span></div>
<div class="line">    <span class="comment">// Duplicate the rectangle and move the </span></div>
<div class="line">    <span class="comment">// duplicate to the location (12, 12).</span></div>
<div class="line">    <span class="comment">// Absolute move:</span></div>
<div class="line">    var myDuplicate = myRectangle.duplicate([12, 12]);</div>
<div class="line">    <span class="comment">// Duplicate the rectangle and move the duplicate *by* 12</span></div>
<div class="line">    <span class="comment">// points horizontally, 12 points vertically.</span></div>
<div class="line">    <span class="comment">// Relative move (note use of &quot;undefined&quot; in the first parameter):</span></div>
<div class="line">    var myDuplicate = myRectangle.duplicate(undefined, [12, 12]);</div>
<div class="line">    <span class="comment">// Duplicate the rectangle to another page (rectangle appears at (0,0).</span></div>
<div class="line">    var myPage = app.documents.item(0).pages.add();</div>
<div class="line">    var myDuplicate = myRectangle.duplicate(myPage);</div>
<div class="line">    <span class="comment">// Duplicate the rectangle to another document.</span></div>
<div class="line">    var myDocument = app.documents.add();</div>
<div class="line">    var myDuplicate = myRectangle.duplicate(myDocument.pages.item(0));</div>
</div><!-- fragment --><p> You can also use copy and paste in InDesign scripting, but scripts using on these methods require that you select objects (to copy) and rely on the current view to set the location of the pasted elements (when you paste). This means that scripts that use copy and paste tend to be more fragile (i.e., more likely to fail) than scripts that use duplicate and move. Whenever possible, try to write scripts that do not depend on the current view or selection state.</p>
<h3><a class="anchor" id="id_js_creating_compound_paths"></a>
Creating compound paths</h3>
<p>InDesign can combine the paths of two or more page items into a single page item containing multiple paths using the Object &gt; Paths &gt; Make Compound Path menu option. You can do this in InDesign scripting using the makeCompoundPath method of a page item, as shown in the following script fragment (for the complete script, refer to the MakeCompoundPath script). </p>
<div class="fragment"><div class="line">    <span class="comment">// Given a rectangle &quot;myRectangle&quot; and an Oval &quot;myOval&quot;...</span></div>
<div class="line">    myRectangle.makeCompoundPath(myOval);</div>
</div><!-- fragment --><p> When you create a compound path, regardless of the types of the objects used to create the compound path, the type of the resulting object is polygon.</p>
<p>To release a compound path and convert each path in the compound path into a separate page item, use the releaseCompoundPath method of a page item, as shown in the following script fragment (for the complete script, refer to the ReleaseCompoundPath script). </p>
<div class="fragment"><div class="line">    <span class="comment">// Given a path &quot;myCompoundPath&quot; (all compound paths are type Rectangle)...</span></div>
<div class="line">    var myPageItems = myCompoundPath.releaseCompoundPath();</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_using_pathfinder_operations"></a>
Using Pathfinder operations</h3>
<p>The InDesign Pathfinder features offer ways to work with relationships between page items on an InDesign page. You can merge the paths of page items, or subtract the area of one page item from another page item, or create a new page item from the area of intersection of two or more page items. Every page item supports the following methods related to the Pathfinder features: AddPath, ExcludeOverlapPath, IntersectPath, MinusBack, and SubtractPath.</p>
<p>All of the Pathfinder methods work the same way&ndash;you provide an array of page items to use as the basis for the operation (just as you select a series of page items before choosing the Pathfinder operation in the user interface).</p>
<p>Note that it is very likely that the type of the object will change after you apply one of the Pathfinder operations. Which object type it will change to depends on the number and location of the points in the path or paths resulting from the operation.</p>
<p>To merge two page items into a single page item, for example, you would use something like the approach shown in the following fragment (for the complete script, refer to AddPath). </p>
<div class="fragment"><div class="line">    <span class="comment">// Given a rectangle &quot;myRectangle&quot; and an Oval &quot;myOval&quot;...</span></div>
<div class="line">    myRectangle.addPath(myOval);</div>
</div><!-- fragment --><p> The excludeOverlapPath method creates a new path based on the non-intersecting areas of two or more overlapping page items, as shown in the following script fragment (for the complete script, refer to ExcludeOverlapPath). </p>
<div class="fragment"><div class="line">    <span class="comment">// Given a rectangle &quot;myRectangle&quot; and an Oval &quot;myOval&quot;...</span></div>
<div class="line">    myRectangle.excludeOverlapPath(myOval);</div>
</div><!-- fragment --><p> The intersectPath method creates a new page item from the area of intersection of two or more page items, as shown in the following script fragment (for the complete script, refer to IntersectPath). </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a rectangle &quot;myRectangle&quot; and an Oval &quot;myOval&quot;...</span></div>
<div class="line">    myRectangle.intersectPath(myOval);</div>
</div><!-- fragment --><p> The minusBack method removes the area of intersection of the back-most object from the page item or page items in front of it, as shown in the following script fragment (for the complete script, refer to MinusBack). </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a rectangle &quot;myRectangle&quot; and an Oval &quot;myOval&quot;...</span></div>
<div class="line">    myRectangle.minusBack(myOval);</div>
</div><!-- fragment --><p> The subtractPath method removes the area of intersection of the frontmost object from the page item or page items behind it, as shown in the following script fragment (for the complete script, refer to SubtractPath). </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a rectangle &quot;myRectangle&quot; and an Oval &quot;myOval&quot;...</span></div>
<div class="line">    myOval.subtractPath(myRectangle);</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_converting_page-item_shapes"></a>
Converting page-item shapes</h3>
<p>InDesign page items can be converted to other shapes using the options in the Object &gt; Convert Shape menu or the Pathfinder panel (Window &gt; Object and Layout &gt; Pathfinder). In InDesign scripting, page items support the convertShape method, as demonstrated in the following script fragment (for the complete script, refer to ConvertShape). </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a rectangle &quot;myRectangle&quot;...</span></div>
<div class="line">    myRectangle.convertShape(ConvertShapeOptions.convertToRoundedRectangle);</div>
</div><!-- fragment --><p> The convertShape method also provides a way to open or close reverse paths, as shown in the following script fragment (for the complete script, refer to OpenPath). </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a rectangle &quot;myRectangle&quot;...</span></div>
<div class="line">    myRectangle.convertShape(ConvertShapeOptions.convertToOpenPath);</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_arranging_page_items"></a>
Arranging page items</h3>
<p>Page items in an InDesign layout can be arranged in front of or behind each other by adjusting their stacking order within a layer, or can be placed on different layers. The following script fragment shows how to bring objects to the front or back of their layer, and how to control the stacking order of objects relative to each other (for the complete script, refer to StackingOrder). </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a rectangle &quot;myRectangle&quot; and an oval &quot;myOval&quot;,</span></div>
<div class="line">    <span class="comment">//where &quot;myOval&quot; is in front of &quot;myRectangle&quot;, bring</span></div>
<div class="line">    <span class="comment">//the rectangle to the front...</span></div>
<div class="line">    myRectangle.bringToFront();</div>
</div><!-- fragment --><p> When you create a page item, you can specify its layer, but you can also move a page item from one layer to another. The itemLayer property of the page item is the key to doing this, as shown in the following script fragment (for the complete script, refer to ItemLayer). </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a rectangle &quot;myRectangle&quot; and a layer &quot;myLayer&quot;,</span></div>
<div class="line">    <span class="comment">//send the rectangle to the layer...</span></div>
<div class="line">    myRectangle.itemLayer = app.documents.item(0).layers.item(<span class="stringliteral">&quot;myLayer&quot;</span>);</div>
</div><!-- fragment --><p> The stacking order of layers in a document can also be changed using the move method of the layer itself, as shown in the following script fragment (for the complete script, refer to MoveLayer). </p>
<div class="fragment"><div class="line">    <span class="comment">// Given a layer &quot;myLayer&quot;, move the layer behind</span></div>
<div class="line">    <span class="comment">// the default layer (the lowest layer in the document </span></div>
<div class="line">    <span class="comment">// is Layers.Item(-1).</span></div>
<div class="line">    myLayer.move(LocationOptions.after, app.documents.item(0).layers.item(-1));</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_transforming_page_items"></a>
Transforming Page Items</h2>
<p>Transformations include scaling, rotation, shearing (skewing), and movement (or translation). In scripting, you apply transformations using the transform method. This one method replaces the resize, rotate, and shear methods used in versions of InDesign prior to InDesign CS3 (5.0).</p>
<h3><a class="anchor" id="id_js_using_the_transform_method"></a>
Using the transform method</h3>
<p>The transform method requires a transformation matrix (transformationMatrix) object that defines the transformation or series of transformations to apply to the object. A transformation matrix can contain any combination of scale, rotate, shear, or translate operations.</p>
<p>The order in which transformations are applied to an object is important. Applying transformations in differing orders can produce very different results.</p>
<p>To transform an object, you follow two steps:</p>
<ol type="1">
<li>Create a transformation matrix.</li>
<li>Apply the transformation matrix to the object using the transform method. When you do this, you also specify the coordinate system in which the transformation is to take place. For more on coordinate systems, see <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_coordinate_spaces">Coordinate spaces</a>. In addition, you specify the center of transformation, or transformation origin. For more on specifying the transformation origin, see <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_transformation_origin">Transformation origin</a>.</li>
</ol>
<p>The following scripting example demonstrates the basic process of transforming a page item. (For the complete script, see TransformExamples.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Rotate a the rectangle around its center point.</span></div>
<div class="line">    var myRotateMatrix = app.transformationMatrices.add({counterclockwiseRotationAngle:27});</div>
<div class="line">    myRectangle.transform(CoordinateSpaces.pasteboardCoordinates, AnchorPoint.centerAnchor, myRotateMatrix);</div>
<div class="line">    alert(<span class="stringliteral">&quot;Rotated around center anchor.&quot;</span>);</div>
<div class="line">    myDocument.undo();</div>
<div class="line">    <span class="comment">//Scale a rectangle &quot;myRectangle&quot; around its center point.</span></div>
<div class="line">    var myScaleMatrix = app.transformationMatrices.add({horizontalScaleFactor:.5, verticalScaleFactor:.5});</div>
<div class="line">    myRectangle.transform(CoordinateSpaces.pasteboardCoordinates, AnchorPoint.centerAnchor, myScaleMatrix);</div>
<div class="line">    alert(<span class="stringliteral">&quot;Scaled around center anchor.&quot;</span>);</div>
<div class="line">    myDocument.undo();</div>
<div class="line">    <span class="comment">//Shear a rectangle &quot;myRectangle&quot; around its center point.</span></div>
<div class="line">    var myShearMatrix =app.transformationMatrices.add({clockwiseShearAngle:30});</div>
<div class="line">    myRectangle.transform(CoordinateSpaces.pasteboardCoordinates, AnchorPoint.centerAnchor, myShearMatrix);</div>
<div class="line">    alert(<span class="stringliteral">&quot;Sheared around center anchor.&quot;</span>);</div>
<div class="line">    myDocument.undo();</div>
<div class="line">    <span class="comment">//Rotate a rectangle &quot;myRectangle&quot; around a specified ruler point ([72, 72]).</span></div>
<div class="line">    var myRotateMatrix = app.transformationMatrices.add({counterclockwiseRotationAngle:27});</div>
<div class="line">    myRectangle.transform(CoordinateSpaces.pasteboardCoordinates, [[72, 72], AnchorPoint.topLeftAnchor], myRotateMatrix, undefined, <span class="keyword">true</span>);</div>
<div class="line">    alert(<span class="stringliteral">&quot;Rotated around 72x, 72y.&quot;</span>);</div>
<div class="line">    myDocument.undo();</div>
<div class="line">    <span class="comment">//Scale a rectangle &quot;myRectangle&quot; around a specified ruler point ([72, 72]).</span></div>
<div class="line">    var myScaleMatrix = app.transformationMatrices.add({horizontalScaleFactor:.5, verticalScaleFactor:.5});</div>
<div class="line">    myRectangle.transform(CoordinateSpaces.pasteboardCoordinates, [[72, 72], AnchorPoint.topLeftAnchor], myScaleMatrix, undefined, <span class="keyword">true</span>);</div>
<div class="line">    alert(<span class="stringliteral">&quot;Scaled around 72x, 72y&quot;</span>);</div>
<div class="line">    myDocument.undo();</div>
</div><!-- fragment --><p> For a script that "wraps" transformation routines in a series of easy-to-use functions, refer to the Transform script.</p>
<h3><a class="anchor" id="id_js_working_with_transformation_matrices"></a>
Working with transformation matrices</h3>
<p>A transformation matrix cannot be changed once it has been created, but a variety of methods can interact with the transformation matrix to create a new transformation matrix based on the existing transformation matrix. In the following examples, we show how to apply transformations to a transformation matrix and replace the original matrix. (For the complete script, see TransformMatrix.)</p>
<div class="fragment"><div class="line"><span class="comment">//Scale a transformation matrix by 50% in both horizontal and vertical dimensions.</span></div>
<div class="line">var myTransformationMatrix = myTransformationMatrix.scaleMatrix(.5, .5);</div>
<div class="line"></div>
<div class="line"><span class="comment">//Rotate a transformation matrix by 45 degrees.</span></div>
<div class="line">myTransformationMatrix = myTransformationMatrix.rotateMatrix(45);</div>
<div class="line"></div>
<div class="line"><span class="comment">//Shear a transformation matrix by 15 degrees.</span></div>
<div class="line">myTransformationMatrix = myTransformationMatrix.shearMatrix(15);</div>
</div><!-- fragment --><p>When you use the rotateMatrix method, you can use a sine or cosine value to transform the matrix, rather than an angle in degrees, as shown in the RotateMatrix script. </p>
<div class="fragment"><div class="line">    var myTransformationMatrix = app.transformationMatrices.add({counterclockwiseRotationAngle:0});</div>
<div class="line">    <span class="comment">//rotateMatrix can take the following parameters: byAngle, byCosine, bySine;</span></div>
<div class="line">    <span class="comment">//Replace the current matrix with the rotated matrix.</span></div>
<div class="line">    <span class="comment">//The following statements are equivalent (0.25881904510252 is the sine of 15 degrees, 0.96592582628907 is the cosine).</span></div>
<div class="line">    <span class="comment">//myTransformationMatrix = myTransformationMatrix.rotateMatrix(15);</span></div>
<div class="line">    <span class="comment">//myTransformationMatrix = myTransformationMatrix.rotateMatrix(undefined, 0.96592582628907);</span></div>
<div class="line">    <span class="comment">//myTransformationMatrix = myTransformationMatrix.rotateMatrix(undefined, undefined, 0.25881904510252);</span></div>
<div class="line">    myTransformationMatrix = myTransformationMatrix.rotateMatrix(15);</div>
<div class="line">    myRectangle.transform(CoordinateSpaces.pasteboardCoordinates, AnchorPoint.centerAnchor, myTransformationMatrix);</div>
</div><!-- fragment --><p> When you use the shearMatrixmethod, you can provide a slope, rather than an angle in degrees, as shown in the ShearMatrix script. </p>
<div class="fragment"><div class="line">    <span class="comment">//The following statements are equivalent. slope = rise/run--so a 45 degree slope is 1.</span></div>
<div class="line">    <span class="comment">//myTransformationMatrix = myTransformationMatrix.shearMatrix(45);</span></div>
<div class="line">    <span class="comment">//myTransformationMatrix = myTransformationMatrix.shearMatrix(undefined, 1);    </span></div>
<div class="line">    myTransformationMatrix = myTransformationMatrix.shearMatrix(45);</div>
<div class="line">    myRectangle.transform(CoordinateSpaces.pasteboardCoordinates, AnchorPoint.centerAnchor, myTransformationMatrix);</div>
</div><!-- fragment --><p> You can get the inverse of a transformation matrix using the invertMatrix method, as shown in the following example. (For the complete script, see InvertMatrix.) You can use the inverted transformation matrix to undo the effect of the matrix. </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a document with a rectangle on page 1...</span></div>
<div class="line">    var myRectangle = app.documents.item(0).pages.item(0).rectangles.item(0);</div>
<div class="line">    var myTransformationMatrix = app.transformationMatrices.add({counterclockwiseRotationAngle:30, horizontalTranslation:12, verticalTranslation:12});</div>
<div class="line">    myRectangle.transform(CoordinateSpaces.pasteboardCoordinates, AnchorPoint.centerAnchor, myTransformationMatrix);</div>
<div class="line">    var myNewRectangle = myRectangle.duplicate();</div>
<div class="line">    <span class="comment">//Move the duplicated rectangle to the location of the original </span></div>
<div class="line">    <span class="comment">//rectangle by inverting, then applying the transformation matrix.</span></div>
<div class="line">    myTransformationMatrix = myTransformationMatrix.invertMatrix();</div>
<div class="line">    myRectangle.transform(CoordinateSpaces.pasteboardCoordinates, AnchorPoint.centerAnchor, myTransformationMatrix);</div>
</div><!-- fragment --><p> You can add transformation matrices using the catenateMatrix method, as shown in the following example. (For the complete script, see CatenateMatrix.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a document with a rectangle on page 1...</span></div>
<div class="line">    var myRectangle = app.documents.item(0).pages.item(0).rectangles.item(0);</div>
<div class="line">    var myTransformationMatrixA = app.transformationMatrices.add({counterclockwiseRotationAngle:30});</div>
<div class="line">    var myTransformationMatrixB = app.transformationMatrices.add({horizontalTranslation:12, verticalTranslation:12});</div>
<div class="line">    var myNewRectangle = myRectangle.duplicate();</div>
<div class="line">    <span class="comment">//Rotate the duplicated rectangle.</span></div>
<div class="line">    myNewRectangle.transform(CoordinateSpaces.pasteboardCoordinates, AnchorPoint.centerAnchor, myTransformationMatrixA);</div>
<div class="line">    myNewRectangle = myRectangle.duplicate();</div>
<div class="line">    <span class="comment">//Move the duplicate (unrotated) rectangle.</span></div>
<div class="line">    myNewRectangle.transform(CoordinateSpaces.pasteboardCoordinates, AnchorPoint.centerAnchor, myTransformationMatrixB);</div>
<div class="line">    <span class="comment">//Merge the two transformation matrices.</span></div>
<div class="line">    myTransformationMatrix = myTransformationMatrixA.catenateMatrix(myTransformationMatrixB);</div>
<div class="line">    myNewRectangle = myRectangle.duplicate();</div>
<div class="line">    <span class="comment">//The duplicated rectangle will be both moved and rotated.</span></div>
<div class="line">    myNewRectangle.transform(CoordinateSpaces.pasteboardCoordinates, AnchorPoint.centerAnchor, myTransformationMatrix);</div>
</div><!-- fragment --><p> When an object is transformed, you can get the transformation matrix that was applied to it, using the transformValuesOf method, as shown in the following script fragment. (For the complete script, see TransformValuesOf.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a document with a rectangle on page 1...</span></div>
<div class="line">    var myRectangle = app.documents.item(0).pages.item(0).rectangles.item(0);</div>
<div class="line">    <span class="comment">//Note that transformValuesOf() always returns an array containing a single transformationMatrix.</span></div>
<div class="line">    var myTransformArray = myRectangle.transformValuesOf(CoordinateSpaces.pasteboardCoordinates);   </div>
<div class="line">    var myTransformationMatrix = myTransformArray[0];</div>
<div class="line">    var myRotationAngle = myTransformationMatrix.counterclockwiseRotationAngle;</div>
<div class="line">    var myShearAngle = myTransformationMatrix.clockwiseShearAngle;</div>
<div class="line">    var myXScale = myTransformationMatrix.horizontalScaleFactor;</div>
<div class="line">    var myYScale = myTransformationMatrix.verticalScaleFactor;</div>
<div class="line">    var myXTranslate = myTransformationMatrix.horizontalTranslation;</div>
<div class="line">    var myYTranslate = myTransformationMatrix.verticalTranslation;</div>
<div class="line">    var myString = <span class="stringliteral">&quot;Rotation Angle: &quot;</span> + myRotationAngle + <span class="stringliteral">&quot;\r&quot;</span>;</div>
<div class="line">    myString += <span class="stringliteral">&quot;Shear Angle: &quot;</span> + myShearAngle + <span class="stringliteral">&quot;\r&quot;</span>;</div>
<div class="line">    myString += <span class="stringliteral">&quot;Horizontal Scale Factor: &quot;</span> + myXScale + <span class="stringliteral">&quot;\r&quot;</span>;</div>
<div class="line">    myString += <span class="stringliteral">&quot;Vertical Scale Factor: &quot;</span> + myYScale + <span class="stringliteral">&quot;\r&quot;</span>;</div>
<div class="line">    myString += <span class="stringliteral">&quot;Horizontal Translation: &quot;</span> + myXTranslate + <span class="stringliteral">&quot;\r&quot;</span>;</div>
<div class="line">    myString += <span class="stringliteral">&quot;Vertical Translation: &quot;</span> + myYTranslate + <span class="stringliteral">&quot;\r\r&quot;</span>;</div>
<div class="line">    myString += <span class="stringliteral">&quot;Note the Horizontal Translation and Vertical Translation\r&quot;</span></div>
<div class="line">    myString += <span class="stringliteral">&quot;values--objects created using scripting are actually created at the\r&quot;</span>;</div>
<div class="line">    myString += <span class="stringliteral">&quot;spread origin and then moved to the ruler coordinates you specify.&quot;</span></div>
<div class="line">    alert(myString);</div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>The values in the horizontal- and vertical-translation fields of the transformation matrix returned by this method are the location of the upper-left anchor of the object, in pasteboard coordinates.</dd></dl>
<h3><a class="anchor" id="id_js_coordinate_spaces"></a>
Coordinate spaces</h3>
<p>In the transformation scripts we presented earlier, you might have noticed the CoordinateSpaces.pasteboardCoordinates enumeration provided as a parameter for the transform method. This parameter determines the system of coordinates, or coordinate space, in which the transform operation occurs. The coordinate space can be one of the following values:</p>
<ul>
<li>pasteboard coordinates is the coordinate space of the entire InDesign document. This coordinate space extends behind all spreads in a document. It does not correspond to InDesign's rulers or zero point, nor does it have anything to do with the pasteboard area you can see around pages in the InDesign user interface. Transformations applied to objects have no effect on this coordinate space (e.g., the angle of the horizontal and vertical axes do not change).</li>
<li>parent coordinates is the coordinate space of the parent of the object. Any transformations applied to the parent affect the parent coordinates; for example, rotating the parent object changes the angle of the horizontal and vertical axes of this coordinate space. In this case, the parent object refers to the group or page item containing the object; if the parent of the object is a page or spread, parent coordinates are the same as spread coordinates.</li>
<li>inner coordinates is the coordinate space in which the object itself was created.</li>
<li>spread coordinates is the coordinate space of the spread. The origin of this space is at the center of the spread, and does not correspond to the rulers you see in the user interface.</li>
</ul>
<p>The following script shows the differences between the coordinate spaces. (For the complete script, see CoordinateSpaces.) </p>
<div class="fragment"><div class="line">    var myRectangle = app.documents.item(0).pages.item(0).groups.item(0).rectangles.item(0);</div>
<div class="line">    myString = <span class="stringliteral">&quot;The page contains a group which has been\r&quot;</span></div>
<div class="line">    myString += <span class="stringliteral">&quot;rotated 45 degrees (counterclockwise).\r&quot;</span></div>
<div class="line">    myString += <span class="stringliteral">&quot;The rectangle inside the group was\r&quot;</span></div>
<div class="line">    myString += <span class="stringliteral">&quot;rotated 45 degrees counterclockwise\r&quot;</span></div>
<div class="line">    myString += <span class="stringliteral">&quot;before it was added to the group.\r&quot;</span></div>
<div class="line">    myString += <span class="stringliteral">&quot;Watch as we apply a series of scaling\r&quot;</span></div>
<div class="line">    myString += <span class="stringliteral">&quot;operations in different coordinate spaces.\r&quot;</span></div>
<div class="line">    myString += <span class="stringliteral">&quot;(You might need to move the alert aside\r&quot;</span></div>
<div class="line">    myString += <span class="stringliteral">&quot;to see the effect of the transformations.)&quot;</span></div>
<div class="line">    alert(myString);</div>
<div class="line">    <span class="comment">// Create a transformation matrix with horizontal scale factor = 2.</span></div>
<div class="line">    var myTransformationMatrix = app.transformationMatrices.add(2);</div>
<div class="line">    <span class="comment">// Transform the rectangle using inner coordinates.</span></div>
<div class="line">    myRectangle.transform(CoordinateSpaces.innerCoordinates, AnchorPoint.centerAnchor, myTransformationMatrix);</div>
<div class="line">    <span class="comment">// Select the rectangle and display an alert.</span></div>
<div class="line">    app.select(myRectangle);</div>
<div class="line">    alert(<span class="stringliteral">&quot;Transformed by inner coordinates.&quot;</span>);</div>
<div class="line">    <span class="comment">// Undo the transformation.</span></div>
<div class="line">    app.documents.item(0).undo();</div>
<div class="line">    <span class="comment">// Transform using parent coordinates.</span></div>
<div class="line">    myRectangle.transform(CoordinateSpaces.parentCoordinates, AnchorPoint.centerAnchor, myTransformationMatrix);</div>
<div class="line">    app.select(myRectangle);</div>
<div class="line">    alert(<span class="stringliteral">&quot;Transformed by parent coordinates.&quot;</span>);</div>
<div class="line">    app.documents.item(0).undo();</div>
<div class="line">    <span class="comment">// Transform using pasteboard coordinates.</span></div>
<div class="line">    myRectangle.transform(CoordinateSpaces.pasteboardCoordinates, AnchorPoint.centerAnchor, myTransformationMatrix);</div>
<div class="line">    app.select(myRectangle);</div>
<div class="line">    alert(<span class="stringliteral">&quot;Transformed by pasteboard coordinates.&quot;</span>);</div>
<div class="line">    app.documents.item(0).undo();</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_transformation_origin"></a>
Transformation origin</h3>
<p>The transformation origin is the center point of the transformation. The transformation origin can be specified in several ways:</p>
<ul>
<li>Bounds space:<ul>
<li>anchor - An anchor point on the object itself. <div class="fragment"><div class="line">AnchorPoint.centerAnchor</div>
</div><!-- fragment --></li>
<li>anchor, bounds type - An anchor point specified relative to the geometric bounds of the object (BoundingBoxLimits.geometricPathBounds) or the visible bounds of the object (BoundingBoxLimits.outerStrokeBounds). <div class="fragment"><div class="line">[AnchorPoint.bottomLeftAnchor, BoundingBoxLimits.outerStrokeBounds]</div>
</div><!-- fragment --></li>
<li>anchor, bounds type, coordinate system - An anchor point specified as the geometric bounds of the object (BoundingBoxLimits.geometricPathBounds) or the visible bounds of the object (BoundingBoxLimits.outerStrokeBounds) in a given coordinate space. <div class="fragment"><div class="line">[AnchorPoint.bottomLeftAnchor, BoundingBoxLimits.outerStrokeBounds, CoordinateSpaces.pasteboardCoordinates]</div>
</div><!-- fragment --></li>
<li>(x,y), bounds type - A point specified relative to the geometric bounds of the object (BoundingBoxLimits.geometricPathBounds) or the visible bounds of the object (BoundingBoxLimits.outerStrokeBounds). In this case, the top-left corner of the bounding box is (0, 0); the bottom-right corner, (1, 1). The center anchor is located at (.5, .5). <div class="fragment"><div class="line">[[.5, .5], BoundingBoxLimits.outerStrokeBounds]</div>
</div><!-- fragment --></li>
<li>(x, y), bounds type, coordinate space - A point specified relative to the geometric bounds of the object (BoundingBoxLimits.geometricPathBounds) or the visible bounds of the object (BoundingBoxLimits.outerStrokeBounds) in a given coordinate space. In this case, the top-left corner of the bounding box is (0, 0); the bottom-right corner, (1, 1). The center anchor is located at (.5, .5). <div class="fragment"><div class="line">[[.5, .5], BoundingBoxLimits.outerStrokeBounds,     CoordinateSpaces.pasteboardCoordinates]</div>
</div><!-- fragment --></li>
</ul>
</li>
<li>Ruler space:<ul>
<li>(x, y), page index - A point, relative to the ruler origin on a specified page of a spread. <div class="fragment"><div class="line">[[72, 144], 0]</div>
</div><!-- fragment --></li>
<li>(x, y), location - A point, relative to the parent page of the specified location of the object. Location can be specified as an anchor point or a coordinate pair. It can be specified relative to the object's geometric or visible bounds, and it can be specified in a given coordinate space. <div class="fragment"><div class="line">[[72, 144], AnchorPoint.centerAnchor]</div>
</div><!-- fragment --></li>
</ul>
</li>
<li>Transform space:<ul>
<li>(x, y) - A point in the pasteboard coordinate space. <div class="fragment"><div class="line">[72, 72]</div>
</div><!-- fragment --></li>
<li>(x, y), coordinate system - A point in the specified coordinate space. <div class="fragment"><div class="line">[[72, 72], CoordinateSpaces.parentCoordinates]</div>
</div><!-- fragment --></li>
<li>((x, y)) - A point in the coordinate space given as the in parameter of the transform method. <div class="fragment"><div class="line">[[72, 72]]</div>
</div><!-- fragment --></li>
</ul>
</li>
</ul>
<p>The following script example shows how to use some of the transformation origin options. (For the complete script, see TransformationOrigin.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Rotate around the duplicated rectangle&#39;s center point.</span></div>
<div class="line">    myNewRectangle.transform(CoordinateSpaces.pasteboardCoordinates, AnchorPoint.centerAnchor, myTransformationMatrix);</div>
<div class="line">    <span class="comment">//Select the rectangle and display an alert.</span></div>
<div class="line">    app.select(myNewRectangle);</div>
<div class="line">    alert(<span class="stringliteral">&quot;Rotated around center anchor.&quot;</span>);</div>
<div class="line">    <span class="comment">//Undo the transformation.</span></div>
<div class="line">    app.documents.item(0).undo();</div>
<div class="line">    <span class="comment">//Rotate the rectangle around the ruler location [-100, -100]. Note that the anchor point specified here specifes the page</span></div>
<div class="line">    <span class="comment">//containing the point--*not* that transformation point itself. The transformation gets the ruler coordinate [-100, -100] based</span></div>
<div class="line">    <span class="comment">//on that page. Setting the considerRulerUnits parameter to true makes certain that the transformation uses the current</span></div>
<div class="line">    <span class="comment">//ruler units.</span></div>
<div class="line">    myNewRectangle.transform(CoordinateSpaces.pasteboardCoordinates, [[-100, -100], AnchorPoint.topLeftAnchor], myTransformationMatrix, undefined, <span class="keyword">true</span>);</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_resolving_locations"></a>
Resolving locations</h3>
<p>Sometimes, you need to get the location of a point specified in one coordinate space in the context of another coordinate space. To do this, use the resolve method, as shown in the following script example. (For the complete script, see ResolveLocation.) </p>
<div class="fragment"><div class="line">    var myPageLocation = myRectangle.resolve([[72, 72], AnchorPoint.topRightAnchor], CoordinateSpaces.pasteboardCoordinates, <span class="keyword">true</span>);</div>
<div class="line">    <span class="comment">//resolve() returns an array containing a single item.</span></div>
<div class="line">    alert(<span class="stringliteral">&quot;X: &quot;</span> + myPageLocation[0][0] + <span class="stringliteral">&quot;\rY: &quot;</span> + myPageLocation[0][1]);</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_transforming_points"></a>
Transforming points</h3>
<p>You can transform points as well as objects, which means scripts can perform a variety of mathematical operations without having to include the calculations in the script itself. The ChangeCoordinates sample script shows how to draw a series of regular polygons using this approach: </p>
<div class="fragment"><div class="line"><span class="comment">//General purpose routine for drawing regular polygons from their center point.</span></div>
<div class="line"><span class="keyword">function</span> myDrawPolygon(myParent, myCenterPoint, myNumberOfPoints, myRadius, myStarPolygon, myStarInset){</div>
<div class="line">    var myTransformedPoint;</div>
<div class="line">    var myPathPoints = <span class="keyword">new</span> Array;</div>
<div class="line">    var myPoint = [0,0];</div>
<div class="line">    <span class="keywordflow">if</span>(myStarPolygon == <span class="keyword">true</span>){</div>
<div class="line">        myNumberOfPoints = myNumberOfPoints * 2;</div>
<div class="line">    }</div>
<div class="line">    var myInnerRadius = myRadius * myStarInset;</div>
<div class="line">    var myAngle = 360/myNumberOfPoints;</div>
<div class="line">    var myRotateMatrix = app.transformationMatrices.add({counterclockwiseRotationAngle:myAngle});</div>
<div class="line">    var myOuterTranslateMatrix = app.transformationMatrices.add({horizontalTranslation:myRadius});</div>
<div class="line">    var myInnerTranslateMatrix = app.transformationMatrices.add({horizontalTranslation:myInnerRadius});</div>
<div class="line">    <span class="keywordflow">for</span> (var myPointCounter = 0; myPointCounter &lt; myNumberOfPoints;myPointCounter ++){</div>
<div class="line">        <span class="comment">//Translate the point to the inner/outer radius.</span></div>
<div class="line">        <span class="keywordflow">if</span> ((myStarInset == 1)||(myIsEven(myPointCounter)==<span class="keyword">true</span>)){</div>
<div class="line">            myTransformedPoint = myOuterTranslateMatrix.changeCoordinates(myPoint);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span>{</div>
<div class="line">            myTransformedPoint = myInnerTranslateMatrix.changeCoordinates(myPoint);</div>
<div class="line">        }</div>
<div class="line">        myTransformedPoint = myRotateMatrix.changeCoordinates(myTransformedPoint);</div>
<div class="line">        myPathPoints.push(myTransformedPoint);</div>
<div class="line">        myRotateMatrix = myRotateMatrix.rotateMatrix(myAngle);</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Create a new polygon.</span></div>
<div class="line">    var myPolygon = myParent.polygons.add();</div>
<div class="line">    <span class="comment">//Set the entire path of the polygon to the array we&#39;ve created.</span></div>
<div class="line">    myPolygon.paths.item(0).entirePath = myPathPoints;</div>
<div class="line">    <span class="comment">//If the center point is somewhere other than [0,0],</span></div>
<div class="line">    <span class="comment">//translate the polygon to the center point.</span></div>
<div class="line">    <span class="keywordflow">if</span>((myCenterPoint[0] != 0)||((myCenterPoint[1] != 0))){</div>
<div class="line">        var myTranslateMatrix = app.transformationMatrices.add({horizontalTranslation:myCenterPoint[0],verticalTranslation:myCenterPoint[1]});</div>
<div class="line">        myPolygon.transform(CoordinateSpaces.pasteboardCoordinates,</div>
<div class="line">        AnchorPoint.centerAnchor, myTranslateMatrix);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="comment">//This function returns true if myNumber is even, false if it is not.</span></div>
<div class="line"><span class="keyword">function</span> myIsEven(myNumber){</div>
<div class="line">    var myResult = (myNumber%2)?<span class="keyword">false</span>:<span class="keyword">true</span>;</div>
<div class="line">    <span class="keywordflow">return</span> myResult;</div>
<div class="line">}</div>
</div><!-- fragment --><p> You also can use the changeCoordinates method to change the positions of curve control points, as shown in the FunWithTransformations sample script.</p>
<h3><a class="anchor" id="id_js_transforming_again"></a>
Transforming again</h3>
<p>Just as you can apply a transformation or sequence of transformations again in the user interface, you can do so using scripting. There are four methods for applying transformations again:</p>
<ul>
<li>transformAgain</li>
<li>transformAgainIndividually</li>
<li>transformSequenceAgain</li>
<li>transformSequenceAgainIndividually</li>
</ul>
<p>The following script fragment shows how to use transformAgain. (For the complete script, see TransformAgain.) </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a document with a rectangle on page 1...</span></div>
<div class="line">    var myPage = app.documents.item(0).pages.item(0);</div>
<div class="line">    var myRectangle = myPage.rectangles.item(0);</div>
<div class="line">    var myBounds = myRectangle.geometricBounds;</div>
<div class="line">    var myX1 = myBounds[1];</div>
<div class="line">    var myY1 = myBounds[0];</div>
<div class="line">    var myRectangleA = myPage.rectangles.add({geometricBounds:[myY1-12, myX1-12, myY1+12, myX1+12]});</div>
<div class="line">    var myTransformationMatrix = app.transformationMatrices.add({counterclockwiseRotationAngle:45});</div>
<div class="line">    myRectangleA.transform(CoordinateSpaces.pasteboardCoordinates, AnchorPoint.centerAnchor, myTransformationMatrix);</div>
<div class="line">    var myRectangleB = myRectangleA.duplicate();</div>
<div class="line">    myRectangleB.transform(CoordinateSpaces.pasteboardCoordinates, [[0,0], AnchorPoint.topLeftAnchor], myTransformationMatrix, undefined, <span class="keyword">true</span>);</div>
<div class="line">    var myRectangleC = myRectangleB.duplicate();</div>
<div class="line">    myRectangleC.transformAgain();</div>
<div class="line">    var myRectangleD = myRectangleC.duplicate();</div>
<div class="line">    myRectangleD.transformAgain();</div>
<div class="line">    var myRectangleE = myRectangleD.duplicate();</div>
<div class="line">    myRectangleE.transformAgain();</div>
<div class="line">    var myRectangleF = myRectangleE.duplicate();</div>
<div class="line">    myRectangleF.transformAgain();</div>
<div class="line">    var myRectangleG = myRectangleF.duplicate();</div>
<div class="line">    myRectangleG.transformAgain();</div>
<div class="line">    var myRectangleH = myRectangleG.duplicate();</div>
<div class="line">    myRectangleH.transformAgain();</div>
<div class="line">    myRectangleB.transform(CoordinateSpaces.pasteboardCoordinates, AnchorPoint.centerAnchor, myTransformationMatrix);</div>
<div class="line">    myRectangleD.transformAgain();</div>
<div class="line">    myRectangleF.transformAgain();  </div>
<div class="line">    myRectangleH.transformAgain();</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_resize_and_reframe"></a>
Resize and Reframe</h2>
<p>In addition to scaling page items using the transform method, you can also change the size of the shape using two other methods: resize and reframe. These methods change the location of the path points of the page item without scaling the content or stroke weight of the page item. The following script fragment shows how to use the resize method. For the complete script, see Resize. </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a reference to a rectangle &quot;myRectangle&quot;...</span></div>
<div class="line">    var myDuplicate = myRectangle.duplicate();</div>
<div class="line">    myDuplicate.resize(CoordinateSpaces.innerCoordinates, AnchorPoint.centerAnchor, ResizeMethods.multiplyingCurrentDimensionsBy, [2, 2]);</div>
</div><!-- fragment --><p> The following script fragment shows how to use the reframe method. For the complete script, see Reframe. </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a reference to a rectangle &quot;myRectangle&quot;...</span></div>
<div class="line">    var myDuplicate = myRectangle.duplicate();</div>
<div class="line">    var myTopLeft = myDuplicate.resolve(AnchorPoint.topLeftAnchor, CoordinateSpaces.innerCoordinates, <span class="keyword">false</span>)[0];</div>
<div class="line">    var myBottomRight = myDuplicate.resolve(AnchorPoint.bottomRightAnchor, CoordinateSpaces.innerCoordinates, <span class="keyword">false</span>)[0];</div>
<div class="line">    var myWidth = myBottomRight[0]-myTopLeft[0];</div>
<div class="line">    myDuplicate.reframe(CoordinateSpaces.innerCoordinates, [[myTopLeft[0]+myWidth, myTopLeft[1]], [myBottomRight[0]+myWidth, myBottomRight[1]]]);</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_working_with_articles"></a>
Working with Articles</h2>
<p>Articles provide designers and production artists an easy way to create relationships among page items. These relationships can be used to define the content to be used while exporting to ePub, HTML or Accessible PDFs; and to define the order of the content. You can create articles from a combination of existing page items within a layout, including images, graphics, or text. Once an article has been created, page items can be added, removed, or re-ordered.</p>
<h3><a class="anchor" id="id_js_retrieving_an_article_list"></a>
Retrieving an article list</h3>
<p>To get the articles in a document, use the following script (for the complete script, see CreateArticle). </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    <span class="comment">//Retrieve the articles for the document.</span></div>
<div class="line">    var articles = myDocument.articles;</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_adding_new_articles"></a>
Adding new articles</h3>
<p>To add a new article to a document, use the following script (for the complete script, see CreateArticle). </p>
<div class="fragment"><div class="line">    <span class="comment">//Create new articles.</span></div>
<div class="line">    <span class="comment">//The second parameter specifies the article&#39;s export status.</span></div>
<div class="line">    var article1 = myDocument.articles.add(<span class="stringliteral">&quot;Article1&quot;</span>, <span class="keyword">true</span>);   </div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_removing_an_article"></a>
Removing an article</h3>
<p>To remove an article, tell the article to remove itself as shown in the following script (for the complete script, see RemoveArticle). </p>
<div class="fragment"><div class="line">    article.remove();    </div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_reordering_articles"></a>
Reordering articles</h3>
<p>To reorder articles, tell the article to move the reference article and the location relative to the reference article as shown in the following script (for the complete script, see ReorderArticles). </p>
<div class="fragment"><div class="line">    var article1 = articles.add(<span class="stringliteral">&quot;Article1&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line">    var article2 = articles.add(<span class="stringliteral">&quot;Article2&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line">    var article3 = articles.add(<span class="stringliteral">&quot;Article3&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line">    var article4 = articles.add(<span class="stringliteral">&quot;Article4&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line">    <span class="comment">//Reverse the order of articles.</span></div>
<div class="line">    <span class="comment">//Move article4 to the first.</span></div>
<div class="line">    article4.move(LocationOptions.AT_BEGINNING);</div>
<div class="line">    <span class="comment">//Move article1 to the end.</span></div>
<div class="line">    article1.move(LocationOptions.AT_END);</div>
<div class="line">    <span class="comment">//Move article3 to the second place.</span></div>
<div class="line">    article3.move(LocationOptions.AFTER, article4);</div>
<div class="line">    <span class="comment">//Move article2 to the third place.</span></div>
<div class="line">    article2.move(LocationOptions.BEFORE, article1);</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_adding_new_members_to_an_article"></a>
Adding new members to an article</h3>
<p>To add new members to an article, use the following script (for the complete script, see AddRemoveArticleMember). </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    <span class="comment">//Retrieve the articles for the document.</span></div>
<div class="line">    var articles = myDocument.articles;    </div>
<div class="line">    </div>
<div class="line">    <span class="comment">//Create new articles</span></div>
<div class="line">    var article1 = articles.add(<span class="stringliteral">&quot;Article1&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line">    var article2 = articles.add(<span class="stringliteral">&quot;Article2&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line">    var article3 = articles.add(<span class="stringliteral">&quot;Article3&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line">    </div>
<div class="line">    var myPage = myDocument.pages.item(0);</div>
<div class="line">    </div>
<div class="line">    var article1Members = article1.articleMembers;</div>
<div class="line">    article1Members.add(myPage.rectangles.item(0));</div>
<div class="line">    article1Members.add(myPage.ovals.item(0));</div>
<div class="line">    </div>
<div class="line">    var article2Members = article2.articleMembers;</div>
<div class="line">    article2Members.add(myPage.rectangles.item(1));</div>
<div class="line">    article2Members.add(myPage.ovals.item(1));</div>
<div class="line">     </div>
<div class="line">    var article3Members = article3.articleMembers; </div>
<div class="line">    var myGroup = myPage.groups.item(0);</div>
<div class="line">    <span class="comment">//Add group as article member.</span></div>
<div class="line">    article3Members.add(myGroup);</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_reordering_members_of_an_article"></a>
Reordering members of an article</h3>
<p>To reorder members of an article, tell the member to move the reference object and the location relative to the reference object as shown in the following script (for the complete script, see ReorderArticleMembers). </p>
<div class="fragment"><div class="line">    var articleMembers = article.articleMembers;</div>
<div class="line">    articleMembers.add(myPage.rectangles.item(0));</div>
<div class="line">    articleMembers.add(myPage.ovals.item(0));</div>
<div class="line">    articleMembers.add(myPage.textFrames.item(0));</div>
<div class="line">    articleMembers.add(myPage.groups.item(0));    </div>
<div class="line"></div>
<div class="line">    articleMembers.item(0).move(LocationOptions.AT_END);</div>
<div class="line">    articleMembers.item(2).move(LocationOptions.AT_BEGINNING);</div>
<div class="line">    articleMembers.item(1).move(LocationOptions.AFTER, articleMembers.item(2));</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_removing_members_from_an_article"></a>
Removing members from an article</h3>
<p>To remove a member from an article, tell the article member to remove itself, as shown in the following script (for the complete script, see AddRemoveArticleMember). </p>
<div class="fragment"><div class="line">    var articleMember = article1Members.item(0);</div>
<div class="line">    articleMember.remove();</div>
</div><!-- fragment --> <h1><a class="anchor" id="id_js_user_interfaces"></a>
User Interfaces</h1>
<p>JavaScript can create dialogs for simple yes/no questions and text entry, but you probably will need to create more complex dialogs for your scripts. InDesign scripting can add dialogs and populate them with common user-interface controls, like pop-up lists, text-entry fields, and numeric-entry fields. If you want your script to collect and act on information entered by you or any other user of your script, use the dialog object.</p>
<p>This section shows how to work with InDesign dialog scripting. The sample scripts in this section are presented in order of complexity, starting with very simple scripts and building toward more complex operations.</p>
<dl class="section note"><dt>Note</dt><dd>InDesign scripts written in JavaScript also can include user interfaces created using the Adobe ScriptUI component. This section includes some ScriptUI scripting tutorials; for more information, see Adobe JavaScript Tools Guide.</dd></dl>
<p>We assume that you have already read Adobe InDesign Scripting Tutorial and know how to create and run a script.</p>
<h2><a class="anchor" id="id_js_dialog_overview"></a>
Dialog Overview</h2>
<p>An InDesign dialog box is an object like any other InDesign scripting object. The dialog box can contain several different types of elements (known collectively as "widgets"), as shown in the following figure. The elements of the figure are described in the table following the figure.</p>
<div class="image">
<img src="InDesign_ScriptingGuide-5.gif" alt="InDesign_ScriptingGuide-5.gif"/>
</div>
<table class="doxtable">
<tr>
<th>Dialog box element </th><th>InDesign name </th></tr>
<tr>
<td>Text-edit fields </td><td>Text editbox control </td></tr>
<tr>
<td>Numeric-entry fields </td><td>Real editbox, integer editbox, measurement editbox, percent editbox, angle editbox </td></tr>
<tr>
<td>Pop-up menus </td><td>Drop-down control </td></tr>
<tr>
<td>Control that combines a text-edit field with a pop-up menu </td><td>Combo-box control </td></tr>
<tr>
<td>Check box </td><td>Check-box control </td></tr>
<tr>
<td>Radio buttons </td><td>Radio-button control </td></tr>
</table>
<p>The dialog object itself does not directly contain the controls; that is the purpose of the dialogColumn object. dialogColumns give you a way to control the positioning of controls within a dialog box. Inside dialogColumns, you can further subdivide the dialog box into other dialogColumns or borderPanels (both of which can, if necessary, contain more dialogColumns and borderPanels).</p>
<p>Like any other InDesign scripting object, each part of a dialog box has its own properties. A checkboxControl, for example, has a property for its text (staticLabel) and another property for its state (checkedState). The dropdown control has a property (stringList) for setting the list of options that appears on the control's menu.</p>
<p>To use a dialog box in your script, create the dialog object, populate it with various controls, display the dialog box, and then gather values from the dialog-box controls to use in your script. Dialog boxes remain in InDesign's memory until they are destroyed. This means you can keep a dialog box in memory and have data stored in its properties used by multiple scripts, but it also means the dialog boxes take up memory and should be disposed of when they are not in use. In general, you should destroy a dialog-box object before your script finishes executing.</p>
<h2><a class="anchor" id="id_js_your_first_indesign_dialog"></a>
Your First InDesign Dialog</h2>
<p>The process of creating an InDesign dialog is very simple: add a dialog, add a dialog column to the dialog, and add controls to the dialog column. The following script demonstrates the process (for the complete script, see SimpleDialog): </p>
<div class="fragment"><div class="line">    var myDialog = app.dialogs.add({name:<span class="stringliteral">&quot;Simple Dialog&quot;</span>});</div>
<div class="line">    <span class="comment">//Add a dialog column.</span></div>
<div class="line">    with(myDialog.dialogColumns.add()){</div>
<div class="line">        staticTexts.add({staticLabel:<span class="stringliteral">&quot;This is a very simple dialog box.&quot;</span>});</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Show the dialog box.</span></div>
<div class="line">    var myResult = myDialog.show();</div>
<div class="line">    <span class="comment">//If the user clicked OK, display one message;</span></div>
<div class="line">    <span class="comment">//if they clicked Cancel, display a different message.</span></div>
<div class="line">    <span class="keywordflow">if</span>(myResult == <span class="keyword">true</span>){</div>
<div class="line">        alert(<span class="stringliteral">&quot;You clicked the OK button.&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span>{</div>
<div class="line">        alert(<span class="stringliteral">&quot;You clicked the Cancel button.&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Remove the dialog box from memory.</span></div>
<div class="line">    myDialog.destroy();</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_adding_a_user_interface_to_"></a>
Adding a User Interface to "Hello World"</h2>
<p>In this example, we add a simple user interface to the Hello World tutorial script presented in <a class="el" href="id_scripting_tutorial.html">Adobe InDesign Scripting Tutorial</a>. The options in the dialog box provide a way for you to specify the sample text and change the point size of the text: </p>
<div class="fragment"><div class="line">    var myDialog = app.dialogs.add({name:<span class="stringliteral">&quot;Simple User Interface Example Script&quot;</span>,canCancel:<span class="keyword">true</span>});</div>
<div class="line">    with(myDialog){</div>
<div class="line">        <span class="comment">//Add a dialog column.</span></div>
<div class="line">        with(dialogColumns.add()){</div>
<div class="line">            <span class="comment">//Create a text edit field.</span></div>
<div class="line">            var myTextEditField = textEditboxes.add({editContents:<span class="stringliteral">&quot;Hello World!&quot;</span>, minWidth:180});</div>
<div class="line">            <span class="comment">//Create a number (real) entry field.</span></div>
<div class="line">            var myPointSizeField = measurementEditboxes.add({editValue:72, editUnits:MeasurementUnits.points});</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Display the dialog box.</span></div>
<div class="line">    var myResult = myDialog.show();</div>
<div class="line">    <span class="keywordflow">if</span>(myResult == <span class="keyword">true</span>){</div>
<div class="line">        <span class="comment">//Get the values from the dialog box controls.</span></div>
<div class="line">        var myString = myTextEditField.editContents;</div>
<div class="line">        var myPointSize = myPointSizeField.editValue;</div>
<div class="line">        <span class="comment">//Remove the dialog box from memory.</span></div>
<div class="line">        myDialog.destroy();</div>
<div class="line">        myMakeDocument(myString, myPointSize);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span>{</div>
<div class="line">        myDialog.destroy();</div>
<div class="line">    }</div>
</div><!-- fragment --><p> Here is the myMakeDocument function referred to in the above fragment: </p>
<div class="fragment"><div class="line"><span class="keyword">function</span> myMakeDocument(myString, myPointSize){</div>
<div class="line">    <span class="comment">//Create a new document.</span></div>
<div class="line">    var myDocument = app.documents.add()</div>
<div class="line">    with(myDocument){</div>
<div class="line">        <span class="comment">//Create a text frame.</span></div>
<div class="line">        var myTextFrame = pages.item(0).textFrames.add();</div>
<div class="line">        <span class="comment">//Resize the text frame to the &quot;live&quot; area of the page (using the function &quot;myGetBounds&quot;).</span></div>
<div class="line">        var myBounds = myGetBounds(myDocument, myDocument.pages.item(0));</div>
<div class="line">        myTextFrame.geometricBounds=myBounds;</div>
<div class="line">        <span class="comment">//Enter the text from the dialog box in the text frame.</span></div>
<div class="line">        myTextFrame.contents=myString;</div>
<div class="line">        <span class="comment">//Set the size of the text to the size you entered in the dialog box.</span></div>
<div class="line">        myTextFrame.texts.item(0).pointSize = myPointSize;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_creating_a_more_complex_user_interface"></a>
Creating a More Complex User Interface</h2>
<p>In the next example, we add more controls and different types of controls to the sample dialog box. The example creates a dialog box that resembles the following: </p>
<div class="image">
<img src="InDesign_ScriptingGuide-6.gif" alt="InDesign_ScriptingGuide-6.gif"/>
</div>
<p>For the complete script, see ComplexUI. </p>
<div class="fragment"><div class="line">    var myDialog = app.dialogs.add({name:<span class="stringliteral">&quot;User Interface Example Script&quot;</span>, canCancel:<span class="keyword">true</span>});</div>
<div class="line">    with(myDialog){</div>
<div class="line">        <span class="comment">//Add a dialog column.</span></div>
<div class="line">        with(dialogColumns.add()){</div>
<div class="line">            <span class="comment">//Create a border panel.</span></div>
<div class="line">            with(borderPanels.add()){</div>
<div class="line">                with(dialogColumns.add()){</div>
<div class="line">                    <span class="comment">//The following line shows how to set a property as you create an object.</span></div>
<div class="line">                    staticTexts.add({staticLabel:<span class="stringliteral">&quot;Message:&quot;</span>});</div>
<div class="line">                }</div>
<div class="line">                with(dialogColumns.add()){</div>
<div class="line">                    <span class="comment">//The following line shows how to set multiple properties as you create an object.</span></div>
<div class="line">                    var myTextEditField = textEditboxes.add({editContents:<span class="stringliteral">&quot;Hello World!&quot;</span>, minWidth:180});</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="comment">//Create another border panel.</span></div>
<div class="line">            with(borderPanels.add()){</div>
<div class="line">                with(dialogColumns.add()){</div>
<div class="line">                    staticTexts.add({staticLabel:<span class="stringliteral">&quot;Point Size:&quot;</span>});</div>
<div class="line">                }</div>
<div class="line">                with(dialogColumns.add()){</div>
<div class="line">                    <span class="comment">//Create a number entry field. Note that this field uses editValue</span></div>
<div class="line">                    <span class="comment">//rather than editText (as a textEditBox would).</span></div>
<div class="line">                    var myPointSizeField = measurementEditboxes.add({editValue:72});</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="comment">//Create another border panel.</span></div>
<div class="line">            with(borderPanels.add()){</div>
<div class="line">                with(dialogColumns.add()){</div>
<div class="line">                    staticTexts.add({staticLabel:<span class="stringliteral">&quot;Vertical Justification:&quot;</span>});</div>
<div class="line">                }   </div>
<div class="line">                with(dialogColumns.add()){</div>
<div class="line">                    <span class="comment">//Create a pop-up menu (&quot;dropdown&quot;) control.</span></div>
<div class="line">                    var myVerticalJustificationMenu = dropdowns.add({stringList:[<span class="stringliteral">&quot;Top&quot;</span>, <span class="stringliteral">&quot;Center&quot;</span>, <span class="stringliteral">&quot;Bottom&quot;</span>], selectedIndex:0});</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="comment">//Create another border panel.</span></div>
<div class="line">            with(borderPanels.add()){</div>
<div class="line">                staticTexts.add({staticLabel:<span class="stringliteral">&quot;Paragraph Alignment:&quot;</span>});</div>
<div class="line">                var myRadioButtonGroup = radiobuttonGroups.add();</div>
<div class="line">                with(myRadioButtonGroup){</div>
<div class="line">                    var myLeftRadioButton = radiobuttonControls.add({staticLabel:<span class="stringliteral">&quot;Left&quot;</span>, checkedState:<span class="keyword">true</span>});</div>
<div class="line">                    var myCenterRadioButton = radiobuttonControls.add({staticLabel:<span class="stringliteral">&quot;Center&quot;</span>});</div>
<div class="line">                    var myRightRadioButton = radiobuttonControls.add({staticLabel:<span class="stringliteral">&quot;Right&quot;</span>});</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Display the dialog box.</span></div>
<div class="line">    <span class="keywordflow">if</span>(myDialog.show() == <span class="keyword">true</span>){</div>
<div class="line">        var myParagraphAlignment, myString, myPointSize, myVerticalJustification;</div>
<div class="line">        <span class="comment">//If the user didnt click the Cancel button,</span></div>
<div class="line">        <span class="comment">//then get the values back from the dialog box. </span></div>
<div class="line">        <span class="comment">//Get the example text from the text edit field.</span></div>
<div class="line">        myString = myTextEditField.editContents </div>
<div class="line">        <span class="comment">//Get the point size from the point size field.</span></div>
<div class="line">        myPointSize = myPointSizeField.editValue; </div>
<div class="line">        <span class="comment">//Get the vertical justification setting from the pop-up menu.</span></div>
<div class="line">        <span class="keywordflow">if</span>(myVerticalJustificationMenu.selectedIndex == 0){</div>
<div class="line">            myVerticalJustification = VerticalJustification.topAlign;   </div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(myVerticalJustificationMenu.selectedIndex == 1){</div>
<div class="line">            myVerticalJustification = VerticalJustification.centerAlign;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span>{</div>
<div class="line">            myVerticalJustification = VerticalJustification.bottomAlign;</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">//Get the paragraph alignment setting from the radiobutton group.</span></div>
<div class="line">        <span class="keywordflow">if</span>(myRadioButtonGroup.selectedButton == 0){</div>
<div class="line">            myParagraphAlignment = Justification.leftAlign;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(myRadioButtonGroup.selectedButton == 1){</div>
<div class="line">            myParagraphAlignment = Justification.centerAlign;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span>{</div>
<div class="line">            myParagraphAlignment = Justification.rightAlign;</div>
<div class="line">        }</div>
<div class="line">        myDialog.destroy();</div>
<div class="line">        myMakeDocument(myString, myPointSize, myParagraphAlignment, myVerticalJustification);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span>{</div>
<div class="line">        myDialog.destroy()</div>
<div class="line">    }</div>
</div><!-- fragment --><p> Here is the myMakeDocument function referred to in the above fragment: </p>
<div class="fragment"><div class="line"><span class="keyword">function</span> myMakeDocument(myString, myPointSize, myParagraphAlignment, myVerticalJustification){</div>
<div class="line">    <span class="comment">//Create a new document.</span></div>
<div class="line">    var myDocument = app.documents.add();</div>
<div class="line">    with(myDocument){</div>
<div class="line">        viewPreferences.horizontalMeasurementUnits = MeasurementUnits.points;</div>
<div class="line">        viewPreferences.verticalMeasurementUnits = MeasurementUnits.points;</div>
<div class="line">        var myPage = pages[0];</div>
<div class="line">        with(myPage){</div>
<div class="line">            <span class="comment">//Create a text frame.</span></div>
<div class="line">            var myTextFrame = pages.item(0).textFrames.add();</div>
<div class="line">            with(myTextFrame){</div>
<div class="line">                <span class="comment">//Set the geometric bounds of the frame using the &quot;myGetBounds&quot; function.</span></div>
<div class="line">                geometricBounds = myGetBounds(myDocument, myPage);</div>
<div class="line">                <span class="comment">//Set the contents of the frame to the string you entered in the dialog box.</span></div>
<div class="line">                contents = myString;</div>
<div class="line">                <span class="comment">//Set the alignment of the paragraph.</span></div>
<div class="line">                texts.item(0).justification = myParagraphAlignment;</div>
<div class="line">                <span class="comment">//Set the point size of the text.</span></div>
<div class="line">                texts.item(0).pointSize = myPointSize;</div>
<div class="line">                <span class="comment">//Set the vertical justification of the text frame.</span></div>
<div class="line">                textFramePreferences.verticalJustification = myVerticalJustification;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_working_with_scriptui"></a>
Working with ScriptUI</h2>
<p>JavaScripts can create and define user-interface elements using an Adobe scripting component named ScriptUI. ScriptUI gives scripters a way to create floating palettes, progress bars, and interactive dialog boxes that are far more complex than InDesign's built-in dialog object.</p>
<p>This does not mean, however, that user-interface elements written using Script UI are not accessible to JavaScript users. InDesign scripts can execute scripts written in other scripting languages using the DoScript method.</p>
<h3><a class="anchor" id="id_js_creating_a_progress_bar_with_scriptui"></a>
Creating a progress bar with ScriptUI</h3>
<p>The following sample script shows how to create a progress bar using JavaScript and ScriptUI, then use the progress bar from another script (for the complete script, see ProgressBar): </p>
<div class="fragment"><div class="line"><span class="preprocessor">#targetengine &quot;session&quot;</span></div>
<div class="line"><span class="preprocessor"></span><span class="comment">//Because these terms are defined in the &quot;session&quot; engine,</span></div>
<div class="line"><span class="comment">//they will be available to any other JavaScript running</span></div>
<div class="line"><span class="comment">//in that instance of the engine.</span></div>
<div class="line">var myMaximumValue = 300;</div>
<div class="line">var myProgressBarWidth = 300;</div>
<div class="line">var myIncrement = myMaximumValue/myProgressBarWidth;</div>
<div class="line">myCreateProgressPanel(myMaximumValue, myProgressBarWidth);</div>
<div class="line"><span class="keyword">function</span> myCreateProgressPanel(myMaximumValue, myProgressBarWidth){</div>
<div class="line">    myProgressPanel = <span class="keyword">new</span> Window(<span class="stringliteral">&#39;window&#39;</span>, <span class="stringliteral">&#39;Progress&#39;</span>);</div>
<div class="line">    with(myProgressPanel){</div>
<div class="line">        myProgressPanel.myProgressBar = add(<span class="stringliteral">&#39;progressbar&#39;</span>, [12, 12,</div>
<div class="line">    myProgressBarWidth, 24], 0, myMaximumValue);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p> The following script fragment shows how to call the progress bar created in the above script using a separate JavaScript (for the complete script, see CallProgressBar): </p>
<div class="fragment"><div class="line"><span class="preprocessor">    #targetengine &quot;session&quot;</span></div>
<div class="line"><span class="preprocessor"></span>    myCreateProgressPanel(100, 400);</div>
<div class="line">    myProgressPanel.show();</div>
<div class="line">    <span class="keywordflow">for</span>(var myCounter = 0; myCounter &lt; 40; myCounter ++){</div>
<div class="line">        <span class="comment">//Scale the value change to the maximum value of the progress bar.</span></div>
<div class="line">        myProgressPanel.myProgressBar.value = myCounter/myIncrement;</div>
<div class="line">        app.documents.item(0).pages.add();</div>
<div class="line">        <span class="keywordflow">if</span>(myCounter == 39){</div>
<div class="line">            myProgressPanel.myProgressBar.value = 0;</div>
<div class="line">            myProgressPanel.hide();</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment --> <h1><a class="anchor" id="id_js_events"></a>
Events</h1>
<p>InDesign scripting can respond to common application and document events, such as opening a file, creating a new file, printing, and importing text and graphic files from disk. In InDesign scripting, the event object responds to an event that occurs in the application. Scripts can be attached to events using the eventListener scripting object. Scripts that use events are the same as other scripts -the only difference is that they run automatically when the corresponding event occurs, rather than being run by the user (from the Scripts palette).</p>
<p>This section shows how to work with InDesign event scripting. The sample scripts in this section are presented in order of complexity, starting with very simple scripts and building toward more complex operations.</p>
<p>We assume that you have already read Adobe InDesign Scripting Tutorial and know how to create, install, and run a script.</p>
<p>For a discussion of events related to menus, see <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_menus">Menus.</a></p>
<p>The InDesign event scripting model is similar to the Worldwide Web Consortium (W3C) recommendation for Document Object Model Events. For more information, see <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_menus">Menus</a> <a href="http://www.w3c.org">http://www.w3c.org </a>.</p>
<h2><a class="anchor" id="id_js_understanding_the_event_scripting_model"></a>
Understanding the Event Scripting Model</h2>
<p>The InDesign event scripting model consists of a series of objects that correspond to the events that occur as you work with the application. The first object is the event, which corresponds to one of a limited series of actions in the InDesign user interface (or corresponding actions triggered by scripts).</p>
<p>To respond to an event, you register an eventListener with an object capable of receiving the event. When the specified event reaches the object, the eventListener executes the script function defined in its handler function (which can be either a script function or a reference to a script file on disk).</p>
<p>You can view the available events using the Object Model Viewer in the ExtendScript Toolkit. In the ExtendScript Toolkit, select the Event class, then click Class in the Types list to display a list of available event types in the Properties and Methods list.</p>
<h3><a class="anchor" id="id_js_about_event_properties_and_event_propagation"></a>
About event properties and event propagation</h3>
<p>When an action-whether initiated by a user or by a script-triggers an event, the event can spread, or propagate, through the scripting objects capable of responding to the event. When an event reaches an object that has an eventListener registered for that event, the eventListener is triggered by the event. An event can be handled by more than one object as it propagates.</p>
<p>There are two types of event propagation:</p>
<ul>
<li>None - Only the eventListeners registered to the event target are triggered by the event. The beforeDisplay event is an example of an event that does not propagate.</li>
<li>Bubbling - The event starts propagation at its target and triggers any qualifying eventListeners registered to the target. The event then proceeds upward through the scripting object model, triggering any qualifying eventListeners registered to objects above the target in the scripting object model hierarchy.</li>
</ul>
<p>The following table provides more detail on the properties of an event and the ways in which they relate to event propagation through the scripting object model.</p>
<table class="doxtable">
<tr>
<th>Property </th><th>Description </th></tr>
<tr>
<td>Bubbles </td><td>If true, the event propagates to scripting objects above the object initiating the event. </td></tr>
<tr>
<td>Cancelable </td><td>If true, the default behavior of the event on its target can be canceled. To do this, use the PreventDefault method . </td></tr>
<tr>
<td>CurrentTarget </td><td>The current scripting object processing the event. See target in this table. </td></tr>
<tr>
<td>DefaultPrevented </td><td>If true, the default behavior of the event on the current target was prevented, thereby canceling the action. See target in this table. </td></tr>
<tr>
<td>EventPhase </td><td>The current stage of the event propagation process. </td></tr>
<tr>
<td>EventType </td><td>The type of the event, as a string (for example, "beforeNew"). </td></tr>
<tr>
<td>PropagationStopped </td><td>If true, the event has stopped propagating beyond the current target (see target in this table). To stop event propagation, use the stopPropagation method. </td></tr>
<tr>
<td>Target </td><td>The object from which the event originates. For example, the target of a beforeImport event is a document; of a beforeNew event, the application. </td></tr>
<tr>
<td>TimeStamp </td><td>The time and date when the event occurred. </td></tr>
</table>
<h2><a class="anchor" id="id_js_working_with_event_listeners"></a>
Working with Event Listeners</h2>
<p>When you create an eventListener, you specify the event type and the event handler (as a function or file reference). The following script fragment shows how to add an eventListener for a specific event (for the complete script, see AddEventListener). </p>
<div class="fragment"><div class="line">    var myEventListener = app.addEventListener(<span class="stringliteral">&quot;afterNew&quot;</span>, myDisplayEventType);</div>
</div><!-- fragment --><p> The preceding script fragment refers to the following function: </p>
<div class="fragment"><div class="line"><span class="keyword">function</span> myDisplayEventType(myEvent){</div>
<div class="line">    alert(<span class="stringliteral">&quot;This event is the &quot;</span> + myEvent.eventType + <span class="stringliteral">&quot; event.&quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment --><p> To remove the eventListener created by the preceding script, run the following script (from the RemoveEventListener tutorial script): </p>
<div class="fragment"><div class="line">    var myResult = app.removeEventListener(<span class="stringliteral">&quot;afterNew&quot;</span>, myDisplayEventType);</div>
</div><!-- fragment --><p> When an eventListener responds to an event, the event may still be processed by other eventListeners that might be monitoring the event (depending on the propagation of the event). For example, the afterOpen event can be observed by eventListeners associated with both the application and the document. eventListeners do not persist beyond the current InDesign session. To make an eventListener available in every InDesign session, add the script to the startup scripts folder. (For more on installing scripts, see "Installing Scripts" in Adobe InDesign Scripting Tutorial.) When you add an eventListener script to a document, it is not saved with the document or exported to IDML.</p>
<dl class="section note"><dt>Note</dt><dd>If you are having trouble with a script that defines an eventListener, you can either run a script that removes the eventListener or quit and restart InDesign. eventListeners that use handler functions defined inside the script (rather than in an external file) must use #targetengine "session". If the script is run using #targetengine "main" (the default), the function is not available when the event occurs, and the script generates an error.</dd></dl>
<p>An event can trigger multiple eventListeners as it propagates through the scripting object model. The following sample script demonstrates an event triggering eventListeners registered to different objects (for the full script, see MultipleEventListeners): </p>
<div class="fragment"><div class="line">    var myApplicationEventListener = app.eventListeners.add(<span class="stringliteral">&quot;beforeImport&quot;</span>, myEventInfo);</div>
<div class="line">    var myDocumentEventListener = app.documents.item(0).eventListeners.add(<span class="stringliteral">&quot;beforeImport&quot;</span>, myEventInfo);</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">function</span> myEventInfo(myEvent){</div>
<div class="line">    var myString = <span class="stringliteral">&quot;Current Target: &quot;</span> + myEvent.currentTarget.name;</div>
<div class="line">    alert(myString);</div>
<div class="line">}</div>
</div><!-- fragment --><p> When you run the preceding script and place a file, InDesign displays alerts showing, in sequence, the name of the document, then the name of the application. To remove the event listeners added by the preceding script, run the RemoveMultipleEventListeners script.</p>
<p>The following sample script creates an eventListener for each document event and displays information about the event in a simple dialog box. For the complete script, see EventListenersOn. </p>
<div class="fragment"><div class="line">    var myEventNames = [</div>
<div class="line">        <span class="stringliteral">&quot;beforeQuit&quot;</span>, <span class="stringliteral">&quot;afterQuit&quot;</span>,</div>
<div class="line">        <span class="stringliteral">&quot;beforeNew&quot;</span>, <span class="stringliteral">&quot;afterNew&quot;</span>,</div>
<div class="line">        <span class="stringliteral">&quot;beforeOpen&quot;</span>, <span class="stringliteral">&quot;afterOpen&quot;</span>,</div>
<div class="line">        <span class="stringliteral">&quot;beforeClose&quot;</span>, <span class="stringliteral">&quot;afterClose&quot;</span>,</div>
<div class="line">        <span class="stringliteral">&quot;beforeSave&quot;</span>, <span class="stringliteral">&quot;afterSave&quot;</span>,</div>
<div class="line">        <span class="stringliteral">&quot;beforeSaveAs&quot;</span>, <span class="stringliteral">&quot;afterSaveAs&quot;</span>,</div>
<div class="line">        <span class="stringliteral">&quot;beforeSaveACopy&quot;</span>, <span class="stringliteral">&quot;afterSaveACopy&quot;</span>,</div>
<div class="line">        <span class="stringliteral">&quot;beforeRevert&quot;</span>, <span class="stringliteral">&quot;afterRevert&quot;</span>,</div>
<div class="line">        <span class="stringliteral">&quot;beforePrint&quot;</span>, <span class="stringliteral">&quot;afterPrint&quot;</span>,</div>
<div class="line">        <span class="stringliteral">&quot;beforeExport&quot;</span>, <span class="stringliteral">&quot;afterExport&quot;</span>,</div>
<div class="line">        <span class="stringliteral">&quot;beforeImport&quot;</span>, <span class="stringliteral">&quot;afterImport&quot;</span></div>
<div class="line">    ] ;</div>
<div class="line">    <span class="keywordflow">for</span> (var myCounter = 0; myCounter &lt; myEventNames.length; myCounter ++){</div>
<div class="line">        app.addEventListener(myEventNames[myCounter], myEventInfo);</div>
<div class="line">    }</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">function</span> myEventInfo(myEvent){</div>
<div class="line">    <span class="keywordflow">try</span>{</div>
<div class="line">        var myString = <span class="stringliteral">&quot;Handling Event: &quot;</span> +myEvent.eventType;</div>
<div class="line">        myString += <span class="stringliteral">&quot;\r\rTarget: &quot;</span> + myEvent.target + <span class="stringliteral">&quot; &quot;</span> +myEvent.target.name;</div>
<div class="line">        myString += <span class="stringliteral">&quot;\rCurrent: &quot;</span> +myEvent.currentTarget + <span class="stringliteral">&quot; &quot;</span> + myEvent.currentTarget.name;</div>
<div class="line">        myString += <span class="stringliteral">&quot;\r\rPhase: &quot;</span> + myGetPhaseName(myEvent.eventPhase );</div>
<div class="line">        myString += <span class="stringliteral">&quot;\rBubbles: &quot;</span> + myEvent.bubbles;</div>
<div class="line">        myString += <span class="stringliteral">&quot;\r\rCancelable: &quot;</span> +myEvent.cancelable;</div>
<div class="line">        myString += <span class="stringliteral">&quot;\rStopped: &quot;</span> +myEvent.propagationStopped;</div>
<div class="line">        myString += <span class="stringliteral">&quot;\rCanceled: &quot;</span> +myEvent.defaultPrevented;</div>
<div class="line">        myString += <span class="stringliteral">&quot;\r\rTime: &quot;</span> +myEvent.timeStamp;</div>
<div class="line">        alert(myString);</div>
<div class="line">        <span class="keyword">function</span> myGetPhaseName(myPhase){</div>
<div class="line">            <span class="keywordflow">switch</span>(myPhase){</div>
<div class="line">                <span class="keywordflow">case</span> EventPhases.atTarget:</div>
<div class="line">                    myPhaseName = <span class="stringliteral">&quot;At Target&quot;</span>;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EventPhases.bubblingPhase:</div>
<div class="line">                    myPhaseName = <span class="stringliteral">&quot;Bubbling&quot;</span>;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EventPhases.done:</div>
<div class="line">                    myPhaseName = <span class="stringliteral">&quot;Done&quot;</span>;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> EventPhases.notDispatching:</div>
<div class="line">                    myPhaseName = <span class="stringliteral">&quot;Not Dispatching&quot;</span>;</div>
<div class="line">                    <span class="keywordflow">break</span>;          </div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> myPhaseName;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span>(myError){</div>
<div class="line">        alert(<span class="stringliteral">&quot;Error getting event properties.&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p> The following sample script shows how to turn off all eventListeners on the application object. For the complete script, see EventListenersOff. </p>
<div class="fragment"><div class="line">    <span class="keywordflow">if</span>(app.eventListeners.length &gt; 0){</div>
<div class="line">        <span class="keywordflow">for</span>(var myCounter = 0; myCounter &lt; app.eventListeners.length; myCounter++){</div>
<div class="line">            app.eventListeners.item(0).remove();</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_sample_afternew_event_listener"></a>
Sample afterNew Event Listener</h2>
<p>The afterNew event provides a convenient place to add information to the document, such as the user name, the date the document was created, copyright information, and other job-tracking information. The following tutorial script shows how to add this kind of information to a text frame in the slug area of the first master spread in the document (for the complete script, see AfterNew). This script also adds document metadata (also known as file info or XMP information). </p>
<div class="fragment"><div class="line">    var myEventListener = app.eventListeners.add(<span class="stringliteral">&quot;afterNew&quot;</span>, myAfterNewHandler);</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">function</span> myAfterNewHandler(myEvent){</div>
<div class="line">    var myDocument = myEvent.parent;</div>
<div class="line">    myDocument.viewPreferences.horizontalMeasurementUnits = MeasurementUnits.points;</div>
<div class="line">    myDocument.viewPreferences.verticalMeasurementUnits = MeasurementUnits.points;</div>
<div class="line">    myDocument.viewPreferences.rulerOrigin = RulerOrigin.pageOrigin;</div>
<div class="line">    myCreateSlug(myDocument);</div>
<div class="line">    myAddXMPData(myDocument);</div>
<div class="line">    <span class="keyword">function</span> myCreateSlug(myDocument){</div>
<div class="line">        <span class="comment">//mySlugOffset is the distance from the bottom of the page to the top of the slug.</span></div>
<div class="line">        var mySlugOffset = 24;</div>
<div class="line">        <span class="comment">//mySlugHeight is the height of the slug text frame.</span></div>
<div class="line">        var mySlugHeight = 72;</div>
<div class="line">            with(myDocument.documentPreferences){</div>
<div class="line">                documentSlugUniformSize = <span class="keyword">false</span>;</div>
<div class="line">                slugBottomOffset = mySlugOffset + mySlugHeight;</div>
<div class="line">                slugTopOffset = 0;</div>
<div class="line">                slugInsideOrLeftOffset = 0;</div>
<div class="line">                slugRightOrOutsideOffset = 0;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">for</span>(var myCounter = 0; myCounter &lt; myDocument.masterSpreads.length; myCounter++){</div>
<div class="line">            var myMasterSpread = myDocument.masterSpreads.item(myCounter);</div>
<div class="line">            <span class="keywordflow">for</span>(var myMasterPageCounter = 0; myMasterPageCounter &lt; myMasterSpread.pages.length; myMasterPageCounter ++){</div>
<div class="line">                var myPage = myMasterSpread.pages.item(myMasterPageCounter);</div>
<div class="line">                var mySlugBounds = myGetSlugBounds(myDocument, myPage, mySlugOffset, mySlugHeight);</div>
<div class="line">                var mySlugFrame = myPage.textFrames.add({geometricBounds:mySlugBounds, contents:<span class="stringliteral">&quot;Created: &quot;</span> + myEvent.timeStamp + <span class="stringliteral">&quot;\rby: &quot;</span> + app.userName});</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keyword">function</span> myAddXMPData(myDocument){</div>
<div class="line">        with(myDocument.metadataPreferences){</div>
<div class="line">            author = <span class="stringliteral">&quot;Adobe Systems&quot;</span>;</div>
<div class="line">            description = <span class="stringliteral">&quot;This is a sample document with XMP metadata.&quot;</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keyword">function</span> myGetSlugBounds(myDocument, myPage, mySlugOffset, mySlugHeight){</div>
<div class="line">        var myPageWidth = myDocument.documentPreferences.pageWidth;</div>
<div class="line">        var myPageHeight = myDocument.documentPreferences.pageHeight</div>
<div class="line">        <span class="comment">//Because &quot;right&quot; and &quot;left&quot; margins become &quot;inside&quot; and &quot;outside&quot; for pages in</span></div>
<div class="line">        <span class="comment">//a facing pages view, we have to use a special case for left hand pages.</span></div>
<div class="line">        <span class="keywordflow">if</span>(myPage.side == PageSideOptions.leftHand){</div>
<div class="line">            var myX2 = myPageWidth - myPage.marginPreferences.left;</div>
<div class="line">            var myX1 = myPage.marginPreferences.right;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span>{</div>
<div class="line">            var myX1 = myPage.marginPreferences.left;</div>
<div class="line">            var myX2 = myPageWidth - myPage.marginPreferences.right;</div>
<div class="line">        }</div>
<div class="line">        var myY1 = myPageHeight + mySlugOffset;</div>
<div class="line">        var myY2 = myY1 + mySlugHeight;</div>
<div class="line">        <span class="keywordflow">return</span> [myY1, myX1, myY2, myX2];</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_sample_beforeprint_event_listener"></a>
Sample beforePrint Event Listener</h2>
<p>The beforePrint event provides a perfect place to execute a script that performs various preflight checks on a document. The following script shows how to add an event listener that checks a document for certain attributes before printing (for the complete script, see BeforePrint): </p>
<div class="fragment"><div class="line">    var myEventListener = app.eventListeners.add(<span class="stringliteral">&quot;beforePrint&quot;</span>, myBeforePrintHandler);</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">function</span> myBeforePrintHandler(myEvent){</div>
<div class="line">    <span class="comment">//The parent of the event is the document.</span></div>
<div class="line">    var myDocument = myEvent.parent;</div>
<div class="line">    <span class="keywordflow">if</span>(myPreflight(myDocument) == <span class="keyword">false</span>){</div>
<div class="line">        myEvent.stopPropagation();</div>
<div class="line">        myEvent.preventDefault();</div>
<div class="line">        alert(<span class="stringliteral">&quot;Document did not pass preflight check. Please fix the problems and try again.&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span>{</div>
<div class="line">        alert(<span class="stringliteral">&quot;Document passed preflight check. Ready to print.&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keyword">function</span> myPreflight(myDocument){</div>
<div class="line">        var myPreflightCheck = <span class="keyword">true</span>;</div>
<div class="line">        var myFontCheck = myCheckFonts(myDocument);</div>
<div class="line">        var myGraphicsCheck = myCheckGraphics(myDocument);</div>
<div class="line">        alert(<span class="stringliteral">&quot;Fonts: &quot;</span> + myFontCheck + <span class="stringliteral">&quot;\r&quot;</span> + <span class="stringliteral">&quot;Links:&quot;</span> + myGraphicsCheck);</div>
<div class="line">        <span class="keywordflow">if</span>((myFontCheck == <span class="keyword">false</span>)||(myGraphicsCheck == <span class="keyword">false</span>)){</div>
<div class="line">            myPreflightCheck = <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> myPreflightCheck;</div>
<div class="line">    }</div>
<div class="line">    <span class="keyword">function</span> myCheckFonts(myDocument){</div>
<div class="line">        var myFontCheck = <span class="keyword">true</span>;</div>
<div class="line">        <span class="keywordflow">for</span>(var myCounter = 0; myCounter &lt; myDocument.fonts.length; myCounter ++){</div>
<div class="line">            <span class="keywordflow">if</span>(myDocument.fonts.item(myCounter).status != FontStatus.installed){</div>
<div class="line">                myFontCheck = <span class="keyword">false</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> myFontCheck;</div>
<div class="line">    }</div>
<div class="line">    <span class="keyword">function</span> myCheckGraphics(myDocument){</div>
<div class="line">        var myGraphicsCheck = <span class="keyword">true</span>;</div>
<div class="line">        <span class="keywordflow">for</span>(var myCounter = 0; myCounter &lt; myDocument.allGraphics.length; myCounter++){</div>
<div class="line">            var myGraphic = myDocument.allGraphics[myCounter];</div>
<div class="line">            <span class="keywordflow">if</span>(myGraphic.itemLink.status != LinkStatus.normal){</div>
<div class="line">                myGraphicsCheck = <span class="keyword">false</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> myGraphicsCheck;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_sample_selection_event_listeners"></a>
Sample Selection Event Listeners</h2>
<p>InDesign can respond to events related to selection. When you select or deselect objects in an InDesign document, InDesign generates the afterSelectionChanged event. When you change an attribute (the formatting or position) of the selected object or objects, InDesign generates the afterSelectionAttributeChanged event. These two events are useful when you want to create a script that responds to user actions.</p>
<p>The following script fragment shows how to get and display the type of an object when the selection changes. For the complete script, see AfterSelectionChanged. </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.add();</div>
<div class="line">    myDocument.addEventListener(<span class="stringliteral">&quot;afterSelectionChanged&quot;</span>, myDisplaySelectionType);</div>
</div><!-- fragment --><p> The event handler referred to in the preceding script fragment looks like this: </p>
<div class="fragment"><div class="line"><span class="keyword">function</span> myDisplaySelectionType(myEvent){</div>
<div class="line">    <span class="keywordflow">if</span>(app.documents.length != 0){</div>
<div class="line">        <span class="keywordflow">if</span>(app.documents.item(0).selection.length != 0){</div>
<div class="line">            var mySelection = app.documents.item(0).selection;</div>
<div class="line">            var myString = <span class="stringliteral">&quot;Selection Contents:\r&quot;</span>;</div>
<div class="line">            <span class="keywordflow">for</span>(var myCounter = 0; myCounter &lt; mySelection.length; myCounter++){</div>
<div class="line">                myString = myString + mySelection[myCounter].constructor.name + <span class="stringliteral">&quot;\r&quot;</span></div>
<div class="line">            }</div>
<div class="line">            alert(myString);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p> To remove the event listener added by the preceding script, run the RemoveAfterSelectionChanged script.</p>
<p>The following script fragment shows how to respond to a change in the attributes of a selection. In this example, the event handler checks the selection to see whether the Registration swatch has been applied. (Accidental application of the Registration swatch can cause problems at your commercial printer.) If the Registration swatch has been applied, the script asks whether the change was intentional. For the complete script, see AfterSelectionAttributeChanged. </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.add();</div>
<div class="line">    myDocument.eventListeners.add(<span class="stringliteral">&quot;afterSelectionAttributeChanged&quot;</span>, myCheckForRegistration);</div>
</div><!-- fragment --><p> The event handler referred to in the preceding script fragment looks like this: </p>
<div class="fragment"><div class="line"><span class="keyword">function</span> myCheckForRegistration(myEvent){</div>
<div class="line">    var myRegistrationSwatchUsed = <span class="keyword">false</span>;</div>
<div class="line">    <span class="keywordflow">if</span>(app.selection.length != 0){      </div>
<div class="line">        <span class="keywordflow">for</span>(var myCounter = 0; myCounter &lt; app.selection.length; myCounter++){</div>
<div class="line">            <span class="keywordflow">if</span>(</div>
<div class="line">                (</div>
<div class="line">                    app.documents.item(0).selection[myCounter].fillColor == app.documents.item(0).swatches.item(<span class="stringliteral">&quot;Registration&quot;</span>)</div>
<div class="line">                )</div>
<div class="line">                ||</div>
<div class="line">                (</div>
<div class="line">                    app.documents.item(0).selection[myCounter].strokeColor == app.documents.item(0).swatches.item(<span class="stringliteral">&quot;Registration&quot;</span>)</div>
<div class="line">                )</div>
<div class="line">            ){</div>
<div class="line">                myRegistrationSwatchUsed = <span class="keyword">true</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span>(myRegistrationSwatchUsed == <span class="keyword">true</span>){</div>
<div class="line">        alert(<span class="stringliteral">&quot;The Registration swatch is applied to some of the\robjects in the selection. Did you really intend to apply this swatch?&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p> To remove the event listener added by the preceding script, run the RemoveAfterSelectionAttributeChanged script.</p>
<h2><a class="anchor" id="id_js_sample_onidle_event_listener"></a>
Sample onIdle Event Listener</h2>
<p>InDesign's idle tasks execute when there are no events in the event queue for the application to process. It is easy to run idle tasks by scripting. The onIdle event provides a way to run scripting-based idle tasks. It can be used to automatically execute a script when InDesign/InCopy is idle. Its event target is IdleTask, and its event object is IdleEvent.</p>
<p>The sleep property of the idle task is the amount of time that elapses before InDesign calls the task again. It should be obvious that you need to set the sleep time to a value high enough that it does not interfere with your work, though this value will vary depending on what tasks the script performs.</p>
<p>Setting the sleep time to zero deletes the task (though it does not remove the event listener). This is the most convenient way to stop an idle task.</p>
<p>The following script shows how to add an eventListener and show a message box from the idle task (for the complete script, see Reminder): </p>
<div class="fragment"><div class="line">    var myIdleTask = app.idleTasks.add({name:<span class="stringliteral">&quot;my_idle_task&quot;</span>, sleep:10000});</div>
<div class="line">    var onIdleEventListener = myIdleTask.addEventListener(<span class="stringliteral">&quot;onIdle&quot;</span>, onIdleEventHandler, <span class="keyword">false</span>);</div>
<div class="line">    alert(<span class="stringliteral">&quot;Created idle task &quot;</span> + myIdleTask.name + <span class="stringliteral">&quot;; added event listener on &quot;</span> + onIdleEventListener.eventType);</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">function</span> onIdleEventHandler(myIdleEvent)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (app.documents.length == 0)</div>
<div class="line">    {</div>
<div class="line">        var myDoc = app.documents.add();</div>
<div class="line">        alert(<span class="stringliteral">&quot;Created document &quot;</span> + myDoc.name + <span class="stringliteral">&quot; in idle task.&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">     }</div>
<div class="line"></div>
<div class="line">    var myTextFrames = app.activeDocument.pages.item(0).textFrames;</div>
<div class="line">    <span class="keywordflow">if</span> (myTextFrames.length == 0)</div>
<div class="line">    {</div>
<div class="line">         var myTextFrame = myTextFrames.add();</div>
<div class="line">         myTextFrame.geometricBounds = [<span class="stringliteral">&quot;72pt&quot;</span>, <span class="stringliteral">&quot;72pt&quot;</span>, <span class="stringliteral">&quot;288pt&quot;</span>, <span class="stringliteral">&quot;288pt&quot;</span>];</div>
<div class="line">         myTextFrame.contents = <span class="stringliteral">&quot;Text frame created in idle task&quot;</span>;</div>
<div class="line">         alert(<span class="stringliteral">&quot;Created a text frame in idle task.&quot;</span>);</div>
<div class="line">         <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">//Delete idle task by setting its sleep time to zero.</span></div>
<div class="line">    myIdleEvent.parent.sleep = 0;</div>
<div class="line">    alert(<span class="stringliteral">&quot;Nothing to do. Delete idle task.&quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment --><p> To remove the idle task created by preceding script, run the following script (for the complete script, see RemoveIdleTask): </p>
<div class="fragment"><div class="line">    <span class="keywordflow">if</span> (app.idleTasks.length == 0)</div>
<div class="line">    {</div>
<div class="line">        alert(<span class="stringliteral">&quot;There is no idle task.&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        var myIdleTaskName = <span class="stringliteral">&quot;my_idle_task&quot;</span>;</div>
<div class="line">        var myIdleTask = app.idleTasks.itemByName(myIdleTaskName);</div>
<div class="line">        <span class="keywordflow">if</span> (myIdleTask != null)</div>
<div class="line">        {</div>
<div class="line">            myIdleTask.remove();</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            alert(<span class="stringliteral">&quot;There is no idle task &quot;</span> + myIdleTaskName);</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment --><p> To remove all idle tasks, run the following script (for the complete script, see RemoveAllIdleTasks): </p>
<div class="fragment"><div class="line">    var length = app.idleTasks.length;</div>
<div class="line">    <span class="keywordflow">if</span> (length == 0)</div>
<div class="line">    {</div>
<div class="line">        alert(<span class="stringliteral">&quot;There is no idle task.&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">for</span> (var i = length-1; i &gt;=0; i--)</div>
<div class="line">        {</div>
<div class="line">            app.idleTasks.item(i).remove();</div>
<div class="line">        }</div>
<div class="line">        alert(length + <span class="stringliteral">&quot; idle task(s) removed.&quot;</span>);</div>
<div class="line">    }</div>
</div><!-- fragment --><p> To list existing idle tasks, run the following script (for the complete script, see ListIdleTasks): </p>
<div class="fragment"><div class="line">    var length = app.idleTasks.length;</div>
<div class="line">    <span class="keywordflow">if</span> (length == 0)</div>
<div class="line">    {</div>
<div class="line">        alert(<span class="stringliteral">&quot;There is no idle task.&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        var str = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">        <span class="keywordflow">for</span> (var i = 0; i &lt; length; i++)</div>
<div class="line">        {</div>
<div class="line">            var myIdleTask = app.idleTasks.item(i);</div>
<div class="line">            str += <span class="stringliteral">&quot;idle task &quot;</span> + myIdleTask.id + <span class="stringliteral">&quot;: &quot;</span> + myIdleTask.name + <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">        }</div>
<div class="line">        alert(str);</div>
<div class="line">    }</div>
</div><!-- fragment --> <h1><a class="anchor" id="id_js_menus"></a>
Menus</h1>
<p>InDesign scripting can add menu items, remove menu items, perform any menu command, and attach scripts to menu items.</p>
<p>This section shows how to work with InDesign menu scripting. The sample scripts in this section are presented in order of complexity, starting with very simple scripts and building toward more complex operations.</p>
<p>We assume that you have already read Adobe InDesign Scripting Tutorial and know how to create, install, and run a script.</p>
<h2><a class="anchor" id="id_js_understanding_the_menu_model"></a>
Understanding the Menu Model</h2>
<p>The InDesign menu-scripting model is made up of a series of objects that correspond to the menus you see in the application's user interface, including menus associated with panels as well as those displayed on the main menu bar. A menu object contains the following objects:</p>
<ul>
<li>menuItems - The menu options shown on a menu. This does not include submenus.</li>
<li>menuSeparators - Lines used to separate menu options on a menu.</li>
<li>submenus - Menu options that contain further menu choices.</li>
<li>menuElements - All menuItems, menuSeparators and submenus shown on a menu.</li>
<li>eventListeners - These respond to user (or script) actions related to a menu.</li>
<li>events - The events triggered by a menu.</li>
</ul>
<p>Every menuItem is connected to a menuAction through the associatedMenuAction property. The properties of the menuAction define what happens when the menu item is chosen. In addition to the menuActions defined by the user interface, InDesign scripters can create their own, scriptMenuActions, which associate a script with a menu selection.</p>
<p>A menuAction or scriptMenuAction can be connected to zero, one, or more menuItems.</p>
<p>The following diagram shows how the different menu objects relate to each other: </p>
<div class="image">
<img src="InDesign_ScriptingGuide-7.gif" alt="InDesign_ScriptingGuide-7.gif"/>
</div>
<p>To create a list (as a text file) of all menu actions, run the following script fragment (from the GetMenuActions tutorial script): </p>
<div class="fragment"><div class="line">    var myMenuActionNames = app.menuActions.everyItem().name;</div>
<div class="line">    <span class="comment">//Open a new text file.</span></div>
<div class="line">    var myTextFile = File.saveDialog(<span class="stringliteral">&quot;Save Menu Action Names As&quot;</span>, undefined);</div>
<div class="line">    <span class="comment">//If the user clicked the Cancel button, the result is null.</span></div>
<div class="line">    <span class="keywordflow">if</span>(myTextFile != null){</div>
<div class="line">        <span class="comment">//Open the file with write access.</span></div>
<div class="line">        myTextFile.open(<span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line">        <span class="keywordflow">for</span>(var myCounter = 0; myCounter &lt; myMenuActionNames.length; myCounter++){</div>
<div class="line">            myTextFile.writeln(myMenuActionNames[myCounter]);</div>
<div class="line">        }</div>
<div class="line">        myTextFile.close();</div>
<div class="line">    }</div>
</div><!-- fragment --><p> To create a list (as a text file) of all available menus, run the following script fragment (for the complete script, see GetMenuNames). These scripts can be very slow, as there are many menu names in InDesign. </p>
<div class="fragment"><div class="line">    var myMenu;</div>
<div class="line">    <span class="comment">//Open a new text file.</span></div>
<div class="line">    var myTextFile = File.saveDialog(<span class="stringliteral">&quot;Save Menu Names As&quot;</span>, undefined);</div>
<div class="line">    <span class="comment">//If the user clicked the Cancel button, the result is null.</span></div>
<div class="line">    <span class="keywordflow">if</span>(myTextFile != null){</div>
<div class="line">        <span class="comment">//Open the file with write access.</span></div>
<div class="line">        myTextFile.open(<span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line">        <span class="keywordflow">for</span>(var myMenuCounter = 0;myMenuCounter&lt; app.menus.length; myMenuCounter++){</div>
<div class="line">            myMenu = app.menus.item(myMenuCounter);</div>
<div class="line">            myTextFile.writeln(myMenu.name);</div>
<div class="line">            myProcessMenu(myMenu, myTextFile);</div>
<div class="line">        }</div>
<div class="line">        myTextFile.close();</div>
<div class="line">        alert(<span class="stringliteral">&quot;done!&quot;</span>);</div>
<div class="line">    }</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">function</span> myProcessMenu(myMenu, myTextFile){</div>
<div class="line">    var myMenuElement;</div>
<div class="line">    var myIndent = myGetIndent(myMenu);</div>
<div class="line">    <span class="keywordflow">for</span>(var myCounter = 0; myCounter &lt; myMenu.menuElements.length; myCounter++){</div>
<div class="line">        myMenuElement = myMenu.menuElements.item(myCounter);</div>
<div class="line">        var elementName = myMenuElement.getElements()[0].constructor.name;</div>
<div class="line">        <span class="keywordflow">if</span>(elementName != <span class="stringliteral">&quot;MenuSeparator&quot;</span>){</div>
<div class="line">            myTextFile.writeln(myIndent + myMenuElement.name);</div>
<div class="line">            <span class="keywordflow">if</span>(elementName == <span class="stringliteral">&quot;Submenus&quot;</span>){</div>
<div class="line">                <span class="keywordflow">if</span>(myMenuElement.menuElements.length &gt; 0){</div>
<div class="line">                    myProcessMenu(myMenuElement, myTextFile);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="keyword">function</span> myGetIndent(myObject){</div>
<div class="line">    var myString = <span class="stringliteral">&quot;\t&quot;</span>;</div>
<div class="line">    var myDone = <span class="keyword">false</span>;</div>
<div class="line">    <span class="keywordflow">do</span>{</div>
<div class="line">        <span class="keywordflow">if</span>((myObject.parent.constructor.name == <span class="stringliteral">&quot;Menu&quot;</span>)||(myObject.parent.constructor.name == <span class="stringliteral">&quot;Application&quot;</span>)){</div>
<div class="line">            myDone = <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span>{</div>
<div class="line">            myString = myString + <span class="stringliteral">&quot;\t&quot;</span>;</div>
<div class="line">            myObject = myObject.parent;</div>
<div class="line">        }</div>
<div class="line">    }<span class="keywordflow">while</span>(myDone == <span class="keyword">false</span>)</div>
<div class="line">    <span class="keywordflow">return</span> myString;</div>
<div class="line">}</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_localization_and_menu_names"></a>
Localization and menu names</h3>
<p>In InDesign scripting, menuItems, menus, menuActions, and submenus are all referred to by name. Because of this, scripts need a method of locating these objects that is independent of the installed locale of the application. To do this, you can use an internal database of strings that refer to a specific item, regardless of locale. For example, to get the locale-independent name of a menu action, you can use the following script fragment (for the complete script, see GetKeyStrings): </p>
<div class="fragment"><div class="line">    var myDialog = app.dialogs.add({name:<span class="stringliteral">&quot;Get Key Strings&quot;</span>});</div>
<div class="line">    with(myDialog.dialogColumns.add()){</div>
<div class="line">        with(dialogRows.add()){</div>
<div class="line">            staticTexts.add({staticLabel:<span class="stringliteral">&quot;User Interface Name:&quot;</span>});</div>
<div class="line">            var myStringField = textEditboxes.add({editContents:<span class="stringliteral">&quot;Convert to Note&quot;</span>});</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    var myResult = myDialog.show();</div>
<div class="line">    <span class="keywordflow">if</span>(myResult == <span class="keyword">true</span>){</div>
<div class="line">        var myString = myStringField.editContents;</div>
<div class="line">        myDialog.destroy();</div>
<div class="line">        var myKeyStrings = app.findKeyStrings(myString);</div>
<div class="line">        myString = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">        <span class="keywordflow">if</span>(myKeyStrings.constructor.name == <span class="stringliteral">&quot;Array&quot;</span>){</div>
<div class="line">            <span class="keywordflow">for</span>(var myCounter = 0; myCounter &lt; myKeyStrings.length; myCounter ++){</div>
<div class="line">                myString += myKeyStrings[myCounter] + <span class="stringliteral">&quot;\r&quot;</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span>{</div>
<div class="line">            myString = myKeyStrings;</div>
<div class="line">        }</div>
<div class="line">        alert(myString);        </div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span>{</div>
<div class="line">        myDialog.destroy();</div>
<div class="line">    }</div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>It is much better to get the locale-independent name of a menuAction than of a menu, menuItem, or submenu, because the title of a menuAction is more likely to be a single string. Many of the other menu objects return multiple strings when you use the findKeyStrings method.</dd></dl>
<p>Once you have the locale-independent string you want to use, you can include it in your scripts. Scripts that use these strings will function properly in locales other than that of your version of InDesign.</p>
<p>To translate a locale-independent string into the current locale, use the following script fragment (from the TranslateKeyString tutorial script): </p>
<div class="fragment"><div class="line">    var myDialog = app.dialogs.add({name:<span class="stringliteral">&quot;Translate Key String&quot;</span>});</div>
<div class="line">    with(myDialog.dialogColumns.add()){</div>
<div class="line">        with(dialogRows.add()){</div>
<div class="line">            staticTexts.add({staticLabel:<span class="stringliteral">&quot;Key String:&quot;</span>});</div>
<div class="line">            var myStringField = textEditboxes.add({editContents:<span class="stringliteral">&quot;$ID/Convert to Note&quot;</span>, minWidth:200});</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    var myResult = myDialog.show();</div>
<div class="line">    <span class="keywordflow">if</span>(myResult == <span class="keyword">true</span>){</div>
<div class="line">        var myString = myStringField.editContents;</div>
<div class="line">        myDialog.destroy();</div>
<div class="line">        myString = app.translateKeyString(myString);</div>
<div class="line">        <span class="keywordflow">if</span>(myString != <span class="stringliteral">&quot;&quot;</span>){</div>
<div class="line">            alert(myString);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span>{</div>
<div class="line">            alert(<span class="stringliteral">&quot;Localized string not found.&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span>{</div>
<div class="line">        myDialog.destroy();</div>
<div class="line">    }</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_running_a_menu_action_from_a_script"></a>
Running a Menu Action from a Script</h2>
<p>Any of InDesign's built-in menuActions can be run from a script. The menuAction does not need to be attached to a menuItem; however, in every other way, running a menuItem from a script is exactly the same as choosing a menu option in the user interface. For example, If selecting the menu option displays a dialog box, running the corresponding menuAction from a script also displays a dialog box.</p>
<p>The following script shows how to run a menuAction from a script (for the complete script, see InvokeMenuAction): </p>
<div class="fragment"><div class="line">    var myMenuAction = app.menuActions.item(<span class="stringliteral">&quot;$ID/Convert to Note&quot;</span>);</div>
<div class="line">    <span class="keywordflow">if</span>(app.selection.length &gt; 0){</div>
<div class="line">        <span class="keywordflow">switch</span>(app.selection[0].constructor.name){</div>
<div class="line">            <span class="keywordflow">case</span> <span class="stringliteral">&quot;InsertionPoint&quot;</span>:</div>
<div class="line">            <span class="keywordflow">case</span> <span class="stringliteral">&quot;Character&quot;</span>:</div>
<div class="line">            <span class="keywordflow">case</span> <span class="stringliteral">&quot;Word&quot;</span>:</div>
<div class="line">            <span class="keywordflow">case</span> <span class="stringliteral">&quot;TextStyleRange&quot;</span>:</div>
<div class="line">            <span class="keywordflow">case</span> <span class="stringliteral">&quot;Line&quot;</span>:</div>
<div class="line">            <span class="keywordflow">case</span> <span class="stringliteral">&quot;Paragraph&quot;</span>:</div>
<div class="line">            <span class="keywordflow">case</span> <span class="stringliteral">&quot;TextColumn&quot;</span>:</div>
<div class="line">            <span class="keywordflow">case</span> <span class="stringliteral">&quot;Text&quot;</span>:</div>
<div class="line">            <span class="keywordflow">case</span> <span class="stringliteral">&quot;Story&quot;</span>:</div>
<div class="line">                myMenuAction.invoke();</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">default</span>:</div>
<div class="line">                alert(<span class="stringliteral">&quot;Please select some text and try again.&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span>{</div>
<div class="line">        alert(<span class="stringliteral">&quot;Please select some text and try again.&quot;</span>);</div>
<div class="line">    }</div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>In general, you should not try to automate InDesign processes by scripting menu actions and user-interface selections; InDesign's scripting object model provides a much more robust and powerful way to work. Menu actions depend on a variety of user-interface conditions, like the selection and the state of the window. Scripts using the object model work with the objects in an InDesign document directly, which means they do not depend on the user interface; this, in turn, makes them faster and more consistent.</dd></dl>
<h2><a class="anchor" id="id_js_adding_menus_and_menu_items"></a>
Adding Menus and Menu Items</h2>
<p>Scripts also can create new menus and menu items or remove menus and menu items, just as you can in the InDesign user interface. The following sample script shows how to duplicate the contents of a submenu to a new menu in another menu location (for the complete script, see CustomizeMenu): </p>
<div class="fragment"><div class="line">    var myMainMenu = app.menus.item(<span class="stringliteral">&quot;Main&quot;</span>);</div>
<div class="line">    var myTypeMenu = myMainMenu.menuElements.item(<span class="stringliteral">&quot;Type&quot;</span>);</div>
<div class="line">    var myFontMenu = myTypeMenu.menuElements.item(<span class="stringliteral">&quot;Font&quot;</span>);</div>
<div class="line">    var myKozukaMenu = myFontMenu.submenus.item(<span class="stringliteral">&quot;Kozuka Mincho Pro &quot;</span>);</div>
<div class="line">    var mySpecialFontMenu = myMainMenu.submenus.add(<span class="stringliteral">&quot;Kozuka Mincho Pro&quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span>(myCounter = 0;myCounter &lt; myKozukaMenu.menuItems.length; myCounter++){</div>
<div class="line">        var myAssociatedMenuAction = myKozukaMenu.menuItems.item(myCounter).associatedMenuAction;</div>
<div class="line">        mySpecialFontMenu.menuItems.add(myAssociatedMenuAction);</div>
<div class="line">    }</div>
</div><!-- fragment --><p> To remove the custom menu item created by the above script, use RemoveCustomMenu. </p>
<div class="fragment"><div class="line">var myMainMenu = app.menus.item(<span class="stringliteral">&quot;$ID/Main&quot;</span>);</div>
<div class="line"><span class="keywordflow">try</span>{</div>
<div class="line">    var mySpecialFontMenu = myMainMenu.submenus.item(<span class="stringliteral">&quot;Kozuka Mincho Pro&quot;</span>);</div>
<div class="line">    mySpecialFontMenu.remove();</div>
<div class="line">}<span class="keywordflow">catch</span>(myError){}</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_menus_and_events"></a>
Menus and Events</h2>
<p>Menus and submenus generate events as they are chosen in the user interface, and menuActions and scriptMenuActions generate events as they are used. Scripts can install eventListeners to respond to these events. The following table shows the events for the different menu scripting components:</p>
<table class="doxtable">
<tr>
<th>Object</th><th>Event</th><th>Description  </th></tr>
<tr>
<td>menu</td><td>beforeDisplay</td><td>Runs the attached script before the contents of the menu is shown.  </td></tr>
<tr>
<td rowspan="2" colspan="1">menuAction</td><td>afterInvoke</td><td>Runs the attached script when the associated menuItem is selected, but after the onInvoke event.  </td></tr>
<tr>
<td>beforeInvoke</td><td>Runs the attached script when the associated menuItem is selected, but before the onInvoke event.  </td></tr>
<tr>
<td rowspan="4" colspan="1">scriptMenuAction</td><td>afterInvoke</td><td>Runs the attached script when the associated menuItem is selected, but after the onInvoke event.  </td></tr>
<tr>
<td>beforeInvoke</td><td>Runs the attached script when the associated menuItem is selected, but before the onInvoke event.  </td></tr>
<tr>
<td>beforeDisplay</td><td>Runs the attached script before an internal request for the enabled/checked status of the scriptMenuActionscriptMenuAction.  </td></tr>
<tr>
<td>onInvoke</td><td>Runs the attached script when the scriptMenuAction is invoked.  </td></tr>
<tr>
<td>submenu</td><td>beforeDisplay</td><td>Runs the attached script before the contents of the submenu are shown.  </td></tr>
</table>
<p>For more about events and eventListeners, see <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_events">Events</a>.</p>
<p>To change the items displayed in a menu, add an eventListener for the beforeDisplay event. When the menu is selected, the eventListener can then run a script that enables or disables menu items, changes the wording of menu item, or performs other tasks related to the menu. This mechanism is used internally to change the menu listing of available fonts, recent documents, or open windows.</p>
<h2><a class="anchor" id="id_js_working_with_scriptmenuactions"></a>
Working with scriptMenuActions</h2>
<p>You can use scriptMenuActionto create a new menuAction whose behavior is implemented through the script registered to run when the onInvoke event is triggered.</p>
<p>The following script shows how to create a scriptMenuAction and attach it to a menu item (for the complete script, see MakeScriptMenuAction). This script simply displays an alert when the menu item is selected. </p>
<div class="fragment"><div class="line">    var mySampleScriptAction = app.scriptMenuActions.add(<span class="stringliteral">&quot;Display Alert&quot;</span>);</div>
<div class="line">    var myEventListener = mySampleScriptAction.eventListeners.add(<span class="stringliteral">&quot;onInvoke&quot;</span>, myFunction, <span class="keyword">false</span>);</div>
<div class="line">    <span class="comment">//If the submenu &quot;Script Menu Action&quot; does not already exist, create it.</span></div>
<div class="line">    <span class="comment">//You might have to force InDesign to redraw the menu (by switching</span></div>
<div class="line">    <span class="comment">//out of the application and back again) to make the menu item appear.</span></div>
<div class="line">    <span class="keywordflow">try</span>{</div>
<div class="line">        var mySampleScriptMenu = app.menus.item(<span class="stringliteral">&quot;$ID/Main&quot;</span>).submenus.item(<span class="stringliteral">&quot;Script Menu Action&quot;</span>);</div>
<div class="line">        mySampleScriptMenu.title;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span> (myError){</div>
<div class="line">        var mySampleScriptMenu = app.menus.item(<span class="stringliteral">&quot;$ID/Main&quot;</span>).submenus.add(<span class="stringliteral">&quot;Script Menu Action&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    var mySampleScriptMenuItem = mySampleScriptMenu.menuItems.add(mySampleScriptAction);</div>
</div><!-- fragment --><p> To remove the menu, submenu, menuItem, and scriptMenuAction created by the above script, run the following script fragment (from the RemoveScriptMenuAction tutorial script): </p>
<div class="fragment"><div class="line">    <span class="keywordflow">try</span>{</div>
<div class="line">        app.scriptMenuActions.item(<span class="stringliteral">&quot;Display Alert&quot;</span>).remove();</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span>(myError){}</div>
<div class="line">    <span class="keywordflow">try</span>{</div>
<div class="line">        app.menus.item(<span class="stringliteral">&quot;$ID/Main&quot;</span>).submenus.item(<span class="stringliteral">&quot;Script Menu Action&quot;</span>).remove();</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span>(myError){}</div>
</div><!-- fragment --><p> You also can remove all scriptMenuAction, as shown in the following script fragment (from the RemoveAllScriptMenuActions tutorial script). This script also removes the menu listings of the scriptMenuAction, but it does not delete any menus or submenus you might have created. </p>
<div class="fragment"><div class="line">    app.scriptMenuActions.everyItem().remove();</div>
</div><!-- fragment --><p> You can create a list of all current scriptMenuActions, as shown in the following script fragment (from the ListScriptMenuActions tutorial script): </p>
<div class="fragment"><div class="line">    var myScriptMenuActionNames = app.menuActions.everyItem().name;</div>
<div class="line">    <span class="comment">//Open a new text file.so</span></div>
<div class="line">    var myTextFile = File.saveDialog(<span class="stringliteral">&quot;Save Script Menu Action Names As&quot;</span>, undefined);</div>
<div class="line">    <span class="comment">//If the user clicked the Cancel button, the result is null.</span></div>
<div class="line">    <span class="keywordflow">if</span>(myTextFile != null){</div>
<div class="line">        <span class="comment">//Open the file with write access.</span></div>
<div class="line">        myTextFile.open(<span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line">        <span class="keywordflow">for</span>(var myCounter = 0; myCounter &lt; myScriptMenuActionNames.length; myCounter++){</div>
<div class="line">            myTextFile.writeln(myScriptMenuActionNames[myCounter]);</div>
<div class="line">        }</div>
<div class="line">        myTextFile.close();</div>
<div class="line">    }</div>
</div><!-- fragment --><p> scriptMenuAction also can run scripts during their beforeDisplay event, in which case they are executed before an internal request for the state of the scriptMenuAction (e.g., when the menu item is about to be displayed). Among other things, the script can then change the menu names and/or set the enabled/checked status.</p>
<p>In the following sample script, we add an eventListener to the beforeDisplay event that checks the current selection. If there is no selection, the script in the eventListener disables the menu item. If an item is selected, the menu item is enabled, and choosing the menu item displays the type of the first item in the selection. (For the complete script, see BeforeDisplay.) </p>
<div class="fragment"><div class="line">    var mySampleScriptAction = app.scriptMenuActions.add(<span class="stringliteral">&quot;Display Message&quot;</span>);</div>
<div class="line">    var myEventListener = mySampleScriptAction.eventListeners.add(<span class="stringliteral">&quot;onInvoke&quot;</span>, myOnInvokeHandler, <span class="keyword">false</span>);</div>
<div class="line">    var mySampleScriptMenu = app.menus.item(<span class="stringliteral">&quot;$ID/Main&quot;</span>).submenus.add(<span class="stringliteral">&quot;Script Menu Action&quot;</span>);</div>
<div class="line">    var mySampleScriptMenuItem = mySampleScriptMenu.menuItems.add(mySampleScriptAction);</div>
<div class="line">    mySampleScriptMenu.eventListeners.add(<span class="stringliteral">&quot;beforeDisplay&quot;</span>, myBeforeDisplayHandler, <span class="keyword">false</span>);</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">//JavaScript function to run before the menu item is drawn.</span></div>
<div class="line"><span class="keyword">function</span> myBeforeDisplayHandler(myEvent){</div>
<div class="line">    var mySampleScriptAction = app.scriptMenuActions.item(<span class="stringliteral">&quot;Display Message&quot;</span>);</div>
<div class="line">    <span class="keywordflow">if</span>(app.documents.length &gt; 0){</div>
<div class="line">        <span class="keywordflow">if</span>(app.selection.length &gt; 0){</div>
<div class="line">            mySampleScriptAction.enabled = <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span>{</div>
<div class="line">            mySampleScriptAction.enabled = <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span>{</div>
<div class="line">        mySampleScriptAction.enabled = <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="comment">//JavaScript function to run when the menu item is selected.</span></div>
<div class="line"><span class="keyword">function</span> myOnInvokeHandler(myEvent){</div>
<div class="line">    myString = app.selection[0].constructor.name;</div>
<div class="line">    alert(<span class="stringliteral">&quot;The first item in the selection is a &quot;</span> + myString + <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_a_more_complex_menu-scripting_example"></a>
A More Complex Menu-Scripting Example</h2>
<p>You have probably noticed that selecting different items in the InDesign user interface changes the contents of the context menus. The following sample script shows how to modify the context menu based on the properties of the object you select. Fragments of the script are shown below; for the complete script, see LayoutContextMenu.</p>
<p>The following snippet shows how to create a new menu item on the Layout context menu (the context menu that appears when you have a page item selected). The following snippet adds a beforeDisplay eventListener which checks for the existence of a menuItem and removes it if it already exists. We do this to ensure the menuItem does not appear on the context menu when the selection does not contain a graphic, and to avoid adding multiple menu choices to the context menu. The eventListener then checks the selection to see if it contains a graphic; if so, it creates a new scriptMenuItem. </p>
<div class="fragment"><div class="line">    <span class="comment">//The local-independent name (aka &quot;key string&quot;) for the </span></div>
<div class="line">    <span class="comment">//Layout context menu is &quot;$ID/RtMouseLayout&quot;.</span></div>
<div class="line">    var myLayoutContextMenu = app.menus.item(<span class="stringliteral">&quot;$ID/RtMouseLayout&quot;</span>);</div>
<div class="line">    <span class="comment">//Create the event handler for the &quot;beforeDisplay&quot; event of the Layout context menu.</span></div>
<div class="line">    var myBeforeDisplayListener = myLayoutContextMenu.addEventListener(<span class="stringliteral">&quot;beforeDisplay&quot;</span>, myBeforeDisplayHandler, <span class="keyword">false</span>);</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">//This event handler checks the type of the selection.</span></div>
<div class="line"><span class="comment">//If a graphic is selected, the event handler adds the script menu action to the menu.</span></div>
<div class="line"><span class="keyword">function</span> myBeforeDisplayHandler(myEvent){</div>
<div class="line">    var myLayoutContextMenu = app.menus.item(<span class="stringliteral">&quot;$ID/RtMouseLayout&quot;</span>);</div>
<div class="line">    <span class="comment">//Check for open documents is a basic sanity check--</span></div>
<div class="line">    <span class="comment">//it should never be needed, as this menu won&#39;t be</span></div>
<div class="line">    <span class="comment">//displayed unless an item is selected. But it&#39;s best</span></div>
<div class="line">    <span class="comment">//to err on the side of safety.</span></div>
<div class="line">    <span class="keywordflow">if</span>(app.documents.length != 0){</div>
<div class="line">        <span class="keywordflow">if</span>(app.selection.length &gt; 0){</div>
<div class="line">            var myObjectList = <span class="keyword">new</span> Array;</div>
<div class="line">            <span class="comment">//Does the selection contain any graphics?</span></div>
<div class="line">            <span class="keywordflow">for</span>(var myCounter = 0; myCounter &lt; app.selection.length; myCounter ++){</div>
<div class="line">                <span class="keywordflow">switch</span>(app.selection[myCounter].constructor.name){</div>
<div class="line">                    <span class="keywordflow">case</span> <span class="stringliteral">&quot;PDF&quot;</span>:</div>
<div class="line">                    <span class="keywordflow">case</span> <span class="stringliteral">&quot;EPS&quot;</span>:</div>
<div class="line">                    <span class="keywordflow">case</span> <span class="stringliteral">&quot;Image&quot;</span>:</div>
<div class="line">                            <span class="comment">//Do not add the graphic to the array if it is an inline/anchored graphic.</span></div>
<div class="line">                            <span class="keywordflow">switch</span>(app.selection[myCounter].parent.parent.constructor.name){</div>
<div class="line">                                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Page&quot;</span>:</div>
<div class="line">                                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Spread&quot;</span>:</div>
<div class="line">                                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Group&quot;</span>:</div>
<div class="line">                                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Rectangle&quot;</span>:</div>
<div class="line">                                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Oval&quot;</span>:</div>
<div class="line">                                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Polygon&quot;</span>:</div>
<div class="line">                                    myObjectList.push(app.selection[myCounter]);</div>
<div class="line">                                    <span class="keywordflow">break</span>;</div>
<div class="line">                            }</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="keywordflow">case</span> <span class="stringliteral">&quot;Rectangle&quot;</span>:</div>
<div class="line">                    <span class="keywordflow">case</span> <span class="stringliteral">&quot;Oval&quot;</span>:</div>
<div class="line">                    <span class="keywordflow">case</span> <span class="stringliteral">&quot;Polygon&quot;</span>:</div>
<div class="line">                        <span class="comment">//Do not add the graphic to the array if it is an inline/anchored graphic.</span></div>
<div class="line">                        <span class="keywordflow">if</span>(app.selection[myCounter].graphics.length != 0){</div>
<div class="line">                            <span class="keywordflow">switch</span>(app.selection[myCounter].parent.constructor.name){</div>
<div class="line">                                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Page&quot;</span>:</div>
<div class="line">                                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Spread&quot;</span>:</div>
<div class="line">                                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Group&quot;</span>:</div>
<div class="line">                                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Rectangle&quot;</span>:</div>
<div class="line">                                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Oval&quot;</span>:</div>
<div class="line">                                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Polygon&quot;</span>:</div>
<div class="line">                                    myObjectList.push(app.selection[myCounter].graphics.item(0));</div>
<div class="line">                                    <span class="keywordflow">break</span>;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span>(myObjectList.length &gt; 0){</div>
<div class="line">                <span class="comment">//Add the menu item if it does not already exist.</span></div>
<div class="line">                <span class="keywordflow">if</span>(myCheckForMenuItem(myLayoutContextMenu, <span class="stringliteral">&quot;Label Graphic&quot;</span>) == <span class="keyword">false</span>){</div>
<div class="line">                    myMakeLabelGraphicMenuItem();</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span>{</div>
<div class="line">                <span class="comment">//Remove the menu item, if it exists.</span></div>
<div class="line">                <span class="keywordflow">if</span>(myCheckForMenuItem(myLayoutContextMenu, <span class="stringliteral">&quot;Label Graphic&quot;</span>) == <span class="keyword">true</span>){</div>
<div class="line">                    myLayoutContextMenu.menuItems.item(<span class="stringliteral">&quot;Label Graphic&quot;</span>).remove();</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keyword">function</span> myMakeLabelGraphicMenuItem(){</div>
<div class="line">        <span class="comment">//alert(&quot;Got to the myMakeLabelGraphicMenuItem function!&quot;);</span></div>
<div class="line">        <span class="keywordflow">if</span>(myCheckForScriptMenuItem(<span class="stringliteral">&quot;Label Graphic&quot;</span>) == <span class="keyword">false</span>){</div>
<div class="line">            <span class="comment">//alert(&quot;Making a new script menu action!&quot;);</span></div>
<div class="line">            var myLabelGraphicMenuAction = app.scriptMenuActions.add(<span class="stringliteral">&quot;Label Graphic&quot;</span>);</div>
<div class="line">            var myLabelGraphicEventListener = myLabelGraphicMenuAction.eventListeners.add(<span class="stringliteral">&quot;onInvoke&quot;</span>, myLabelGraphicEventHandler, <span class="keyword">false</span>);</div>
<div class="line">        }</div>
<div class="line">        var myLabelGraphicMenuItem = app.menus.item(<span class="stringliteral">&quot;$ID/RtMouseLayout&quot;</span>).menuItems.add(app.scriptMenuActions.item(<span class="stringliteral">&quot;Label Graphic&quot;</span>));</div>
<div class="line">        <span class="keyword">function</span> myLabelGraphicEventHandler(myEvent){</div>
<div class="line">            <span class="comment">//alert(&quot;Got to myLabelGraphicEventListener!&quot;);</span></div>
<div class="line">            <span class="keywordflow">if</span>(app.selection.length &gt; 0){</div>
<div class="line">                var myObjectList = <span class="keyword">new</span> Array;</div>
<div class="line">                <span class="comment">//Does the selection contain any graphics?</span></div>
<div class="line">                <span class="keywordflow">for</span>(var myCounter = 0; myCounter &lt; app.selection.length; myCounter ++){</div>
<div class="line">                    <span class="keywordflow">switch</span>(app.selection[myCounter].constructor.name){</div>
<div class="line">                        <span class="keywordflow">case</span> <span class="stringliteral">&quot;PDF&quot;</span>:</div>
<div class="line">                        <span class="keywordflow">case</span> <span class="stringliteral">&quot;EPS&quot;</span>:</div>
<div class="line">                        <span class="keywordflow">case</span> <span class="stringliteral">&quot;Image&quot;</span>:</div>
<div class="line">                                <span class="comment">//Do not add the graphic to the array if it is an inline/anchored graphic.</span></div>
<div class="line">                                <span class="keywordflow">switch</span>(app.selection[myCounter].parent.parent.constructor.name){</div>
<div class="line">                                    <span class="keywordflow">case</span> <span class="stringliteral">&quot;Page&quot;</span>:</div>
<div class="line">                                    <span class="keywordflow">case</span> <span class="stringliteral">&quot;Spread&quot;</span>:</div>
<div class="line">                                    <span class="keywordflow">case</span> <span class="stringliteral">&quot;Group&quot;</span>:</div>
<div class="line">                                    <span class="keywordflow">case</span> <span class="stringliteral">&quot;Rectangle&quot;</span>:</div>
<div class="line">                                    <span class="keywordflow">case</span> <span class="stringliteral">&quot;Oval&quot;</span>:</div>
<div class="line">                                    <span class="keywordflow">case</span> <span class="stringliteral">&quot;Polygon&quot;</span>:</div>
<div class="line">                                        myObjectList.push(app.selection[myCounter]);</div>
<div class="line">                                        <span class="keywordflow">break</span>;</div>
<div class="line">                                }</div>
<div class="line">                            <span class="keywordflow">break</span>;</div>
<div class="line">                        <span class="keywordflow">case</span> <span class="stringliteral">&quot;Rectangle&quot;</span>:</div>
<div class="line">                        <span class="keywordflow">case</span> <span class="stringliteral">&quot;Oval&quot;</span>:</div>
<div class="line">                        <span class="keywordflow">case</span> <span class="stringliteral">&quot;Polygon&quot;</span>:</div>
<div class="line">                            <span class="comment">//Do not add the graphic to the array if it is an inline/anchored graphic.</span></div>
<div class="line">                            <span class="keywordflow">if</span>(app.selection[myCounter].graphics.length != 0){</div>
<div class="line">                                <span class="keywordflow">switch</span>(app.selection[myCounter].parent.constructor.name){</div>
<div class="line">                                    <span class="keywordflow">case</span> <span class="stringliteral">&quot;Page&quot;</span>:</div>
<div class="line">                                    <span class="keywordflow">case</span> <span class="stringliteral">&quot;Spread&quot;</span>:</div>
<div class="line">                                    <span class="keywordflow">case</span> <span class="stringliteral">&quot;Group&quot;</span>:</div>
<div class="line">                                    <span class="keywordflow">case</span> <span class="stringliteral">&quot;Rectangle&quot;</span>:</div>
<div class="line">                                    <span class="keywordflow">case</span> <span class="stringliteral">&quot;Oval&quot;</span>:</div>
<div class="line">                                    <span class="keywordflow">case</span> <span class="stringliteral">&quot;Polygon&quot;</span>:</div>
<div class="line">                                        myObjectList.push(app.selection[myCounter].graphics.item(0));</div>
<div class="line">                                        <span class="keywordflow">break</span>;</div>
<div class="line">                            }</div>
<div class="line">                            <span class="keywordflow">break</span>;</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span>(myObjectList.length &gt; 0){</div>
<div class="line">                    myDisplayDialog(myObjectList);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span>{</div>
<div class="line">                    alert(<span class="stringliteral">&quot;Please select an independent graphic and try again.&quot;</span>);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="comment">//Function that adds the label.</span></div>
<div class="line">            <span class="keyword">function</span> myAddLabel(myGraphic, myLabelType, myLabelHeight, myLabelOffset, myLabelStyleName, myLayerName){</div>
<div class="line">                var myLabelLayer;</div>
<div class="line">                var myDocument = app.documents.item(0);</div>
<div class="line">                var myLabel;</div>
<div class="line">                myLabelStyle = myDocument.paragraphStyles.item(myLabelStyleName);</div>
<div class="line">                var myLink = myGraphic.itemLink;</div>
<div class="line">                <span class="keywordflow">try</span>{</div>
<div class="line">                    myLabelLayer = myDocument.layers.item(myLayerName);</div>
<div class="line">                    <span class="comment">//if the layer does not exist, trying to get the layer name will cause an error.</span></div>
<div class="line">                    myLabelLayer.name;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">catch</span> (myError){</div>
<div class="line">                    myLabelLayer = myDocument.layers.add(myLayerName); </div>
<div class="line">                } </div>
<div class="line">                <span class="comment">//Label type defines the text that goes in the label.</span></div>
<div class="line">                <span class="keywordflow">switch</span>(myLabelType){</div>
<div class="line">                    <span class="comment">//File name</span></div>
<div class="line">                    <span class="keywordflow">case</span> 0:</div>
<div class="line">                        myLabel = myLink.name;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="comment">//File path</span></div>
<div class="line">                    <span class="keywordflow">case</span> 1:</div>
<div class="line">                        myLabel = myLink.filePath;</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="comment">//XMP description</span></div>
<div class="line">                    <span class="keywordflow">case</span> 2:</div>
<div class="line">                        <span class="keywordflow">try</span>{</div>
<div class="line">                            myLabel = myLink.linkXmp.description;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">catch</span>(myError){</div>
<div class="line">                            myLabel = <span class="stringliteral">&quot;No description available.&quot;</span>;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                    <span class="comment">//XMP author</span></div>
<div class="line">                    <span class="keywordflow">case</span> 3:</div>
<div class="line">                        <span class="keywordflow">try</span>{</div>
<div class="line">                            myLabel = myLink.linkXmp.author</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">catch</span>(myError){</div>
<div class="line">                            myLabel = <span class="stringliteral">&quot;No author available.&quot;</span>;</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">                var myFrame = myGraphic.parent;</div>
<div class="line">                var myX1 = myFrame.geometricBounds[1]; </div>
<div class="line">                var myY1 = myFrame.geometricBounds[2] + myLabelOffset; </div>
<div class="line">                var myX2 = myFrame.geometricBounds[3]; </div>
<div class="line">                var myY2 = myY1 + myLabelHeight;</div>
<div class="line">                var myTextFrame = myFrame.parent.textFrames.add(myLabelLayer, undefined, undefined,{geometricBounds:[myY1, myX1, myY2, myX2], contents:myLabel}); </div>
<div class="line">                myTextFrame.textFramePreferences.firstBaselineOffset = FirstBaseline.leadingOffset; </div>
<div class="line">                myTextFrame.paragraphs.item(0).appliedParagraphStyle = myLabelStyle;                </div>
<div class="line">            }</div>
<div class="line">            <span class="keyword">function</span> myDisplayDialog(myObjectList){</div>
<div class="line">                var myLabelWidth = 100;</div>
<div class="line">                var myStyleNames = myGetParagraphStyleNames(app.documents.item(0));</div>
<div class="line">                var myLayerNames = myGetLayerNames(app.documents.item(0));</div>
<div class="line">                var myDialog = app.dialogs.add({name:<span class="stringliteral">&quot;LabelGraphics&quot;</span>});</div>
<div class="line">                with(myDialog.dialogColumns.add()){</div>
<div class="line">                    <span class="comment">//Label type</span></div>
<div class="line">                    with(dialogRows.add()){</div>
<div class="line">                        with(dialogColumns.add()){</div>
<div class="line">                            staticTexts.add({staticLabel:<span class="stringliteral">&quot;Label Type:&quot;</span>, minWidth:myLabelWidth});</div>
<div class="line">                        }</div>
<div class="line">                        with(dialogColumns.add()){</div>
<div class="line">                            var myLabelTypeDropdown = dropdowns.add({stringList:[<span class="stringliteral">&quot;File name&quot;</span>, <span class="stringliteral">&quot;File path&quot;</span>, <span class="stringliteral">&quot;XMP description&quot;</span>, <span class="stringliteral">&quot;XMP author&quot;</span>], selectedIndex:0});</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                    <span class="comment">//Text frame height</span></div>
<div class="line">                    with(dialogRows.add()){</div>
<div class="line">                        with(dialogColumns.add()){</div>
<div class="line">                            staticTexts.add({staticLabel:<span class="stringliteral">&quot;Label Height:&quot;</span>, minWidth:myLabelWidth});</div>
<div class="line">                        }</div>
<div class="line">                        with(dialogColumns.add()){</div>
<div class="line">                            var myLabelHeightField = measurementEditboxes.add({editValue:24, editUnits:MeasurementUnits.points});</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                    <span class="comment">//Text frame offset</span></div>
<div class="line">                    with(dialogRows.add()){</div>
<div class="line">                        with(dialogColumns.add()){</div>
<div class="line">                            staticTexts.add({staticLabel:<span class="stringliteral">&quot;Label Offset:&quot;</span>, minWidth:myLabelWidth});</div>
<div class="line">                        }</div>
<div class="line">                        with(dialogColumns.add()){</div>
<div class="line">                            var myLabelOffsetField = measurementEditboxes.add({editValue:0, editUnits:MeasurementUnits.points});</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                    <span class="comment">//Style to apply</span></div>
<div class="line">                    with(dialogRows.add()){</div>
<div class="line">                        with(dialogColumns.add()){</div>
<div class="line">                            staticTexts.add({staticLabel:<span class="stringliteral">&quot;Label Style:&quot;</span>, minWidth:myLabelWidth});</div>
<div class="line">                        }</div>
<div class="line">                        with(dialogColumns.add()){</div>
<div class="line">                            var myLabelStyleDropdown = dropdowns.add({stringList:myStyleNames, selectedIndex:0});</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                    <span class="comment">//Layer</span></div>
<div class="line">                    with(dialogRows.add()){</div>
<div class="line">                        with(dialogColumns.add()){</div>
<div class="line">                            staticTexts.add({staticLabel:<span class="stringliteral">&quot;Layer:&quot;</span>, minWidth:myLabelWidth});</div>
<div class="line">                        }</div>
<div class="line">                        with(dialogColumns.add()){</div>
<div class="line">                            var myLayerDropdown = dropdowns.add({stringList:myLayerNames, selectedIndex:0});</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">                var myResult = myDialog.show();</div>
<div class="line">                <span class="keywordflow">if</span>(myResult == <span class="keyword">true</span>){</div>
<div class="line">                    var myLabelType = myLabelTypeDropdown.selectedIndex;</div>
<div class="line">                    var myLabelHeight = myLabelHeightField.editValue;</div>
<div class="line">                    var myLabelOffset = myLabelOffsetField.editValue;</div>
<div class="line">                    var myLabelStyle = myStyleNames[myLabelStyleDropdown.selectedIndex];</div>
<div class="line">                    var myLayerName = myLayerNames[myLayerDropdown.selectedIndex];</div>
<div class="line">                    myDialog.destroy();</div>
<div class="line">                    var myOldXUnits = app.documents.item(0).viewPreferences.horizontalMeasurementUnits;</div>
<div class="line">                    var myOldYUnits = app.documents.item(0).viewPreferences.verticalMeasurementUnits;</div>
<div class="line">                    app.documents.item(0).viewPreferences.horizontalMeasurementUnits = MeasurementUnits.points;</div>
<div class="line">                    app.documents.item(0).viewPreferences.verticalMeasurementUnits = MeasurementUnits.points;</div>
<div class="line">                    <span class="keywordflow">for</span>(var myCounter = 0; myCounter &lt; myObjectList.length; myCounter++){</div>
<div class="line">                        var myGraphic = myObjectList[myCounter];</div>
<div class="line">                        myAddLabel(myGraphic, myLabelType, myLabelHeight, myLabelOffset, myLabelStyle, myLayerName);</div>
<div class="line">                    }</div>
<div class="line">                    app.documents.item(0).viewPreferences.horizontalMeasurementUnits = myOldXUnits;</div>
<div class="line">                    app.documents.item(0).viewPreferences.verticalMeasurementUnits = myOldYUnits;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span>{</div>
<div class="line">                    myDialog.destroy();</div>
<div class="line">                }</div>
<div class="line">                <span class="keyword">function</span> myGetParagraphStyleNames(myDocument){</div>
<div class="line">                    var myStyleNames = myDocument.paragraphStyles.everyItem().name;</div>
<div class="line">                    <span class="keywordflow">return</span> myStyleNames;</div>
<div class="line">                }</div>
<div class="line">                <span class="keyword">function</span> myGetLayerNames(myDocument){</div>
<div class="line">                    var myLayerNames = <span class="keyword">new</span> Array;</div>
<div class="line">                    var myAddLabelLayer = <span class="keyword">true</span>;</div>
<div class="line">                    <span class="keywordflow">for</span>(var myCounter = 0; myCounter&lt;myDocument.layers.length; myCounter++){</div>
<div class="line">                        myLayerNames.push(myDocument.layers.item(myCounter).name);</div>
<div class="line">                        <span class="keywordflow">if</span> (myDocument.layers.item(myCounter).name == <span class="stringliteral">&quot;Labels&quot;</span>){</div>
<div class="line">                            myAddLabelLayer = <span class="keyword">false</span>;</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">if</span>(myAddLabelLayer == <span class="keyword">true</span>){</div>
<div class="line">                        myLayerNames.push(<span class="stringliteral">&quot;Labels&quot;</span>);</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">return</span> myLayerNames;</div>
<div class="line">                }</div>
<div class="line">            }               </div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment --> <h1><a class="anchor" id="id_js_working_with_preflight"></a>
Working with Preflight</h1>
<p>Preflight is a way to verify that you have all required files, fonts, assets (e.g., placed images and PDF files), printer settings, trapping styles, etc., before you send a publication to an output device. For example, if you placed an image as a low-resolution proxy but do not have the high-resolution original image accessible on your hard disk (or workgroup server), that may result in an error during the printing process. Preflight checks for this sort of problem. It can be run in the background as you work.</p>
<p>This section demonstrates how to interact with the preflight system using scripting. For illustration purposes, we show how to configure preflight to raise an error if the page size is something other than letter size (8.5" x 11"). We briefly highlight how it is done in the user interface, then show how to achieve the same results through scripting.</p>
<p>We assume that you have already read Adobe InDesign Scripting Tutorial and know how to create, install, and run a script.</p>
<h2><a class="anchor" id="id_js_exploring_preflight_profiles"></a>
Exploring Preflight Profiles</h2>
<p>InDesign's preflight feature is profile based, rule driven, and parameterized. There might be one or more preflight profiles. Initially, there is one profile, [Basic], which is read-only; you cannot modify or delete it.</p>
<p>A preflight profile contains many preflight rules. Each rule has a name and multiple data objects. Each data object has a name, data type, and data value. The data value can be changed. Each rule can be configured as follows:</p>
<ul>
<li>Disabled - The preflight rule is disabled.</li>
<li>Return as error - The preflight rule returns error-level feedback.</li>
<li>Return as warning - The preflight rule returns warning-level feedback.</li>
<li>Return as informational- The preflight rule returns informational-level feedback.</li>
</ul>
<p>To check the profile in InDesign, choose Preflight Panel &gt; Define Profiles. You also can get profile information by scripting.</p>
<h3><a class="anchor" id="id_js_listing_preflight_profiles"></a>
Listing preflight profiles</h3>
<p>This script fragment shows how to list all preflight profiles. For the complete script, see ListPreflightProfiles. </p>
<div class="fragment"><div class="line">    var profiles = app.preflightProfiles;</div>
<div class="line">    var profileCount = profiles.length;</div>
<div class="line">    var str = <span class="stringliteral">&quot;Preflight profiles: &quot;</span>;</div>
<div class="line">    <span class="keywordflow">for</span> (var i = 0; i &lt; profileCount; i++)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (i != 0)</div>
<div class="line">        {</div>
<div class="line">            str += <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line">        }</div>
<div class="line">        str += profiles.item(i).name;</div>
<div class="line">    }</div>
<div class="line">    alert(str);</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_listing_preflight_rules"></a>
Listing preflight rules</h3>
<p>This script fragment shows how to list all preflight rules in a profile. For the complete script, see ListPreflightRules. </p>
<div class="fragment"><div class="line">    <span class="comment">// Assume the [Basic] profile exists</span></div>
<div class="line">    var myProfile = app.preflightProfiles.item(0);</div>
<div class="line">    var myRules = myProfile.preflightProfileRules;</div>
<div class="line">    var ruleCount = myRules.length;</div>
<div class="line">    var str = <span class="stringliteral">&quot;Preflight rules of &quot;</span> + myProfile.name + <span class="stringliteral">&quot;: &quot;</span>;</div>
<div class="line">    <span class="keywordflow">for</span> (var i = 0; i &lt; ruleCount; i++)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (i &gt; 0)</div>
<div class="line">        {</div>
<div class="line">            str += <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line">        }</div>
<div class="line">        str += myRules.item(i).name;</div>
<div class="line">    }</div>
<div class="line">    alert(str);</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_listing_preflight_data_objects"></a>
Listing preflight data objects</h3>
<p>This script fragment shows how to list all preflight data objects in a profile rule. For the complete script, see ListPreflightDataObjects. </p>
<div class="fragment"><div class="line">    <span class="comment">// Assume the [Basic] profile exists.</span></div>
<div class="line">    var myProfile = app.preflightProfiles.item(0);</div>
<div class="line">    <span class="comment">// rule ADBE_BlankPages</span></div>
<div class="line">    var myRule = myProfile.preflightProfileRules.item(0);</div>
<div class="line">    var dataObjects = myRule.ruleDataObjects;</div>
<div class="line">    var dataObjectCount = dataObjects.length;</div>
<div class="line">    var str = <span class="stringliteral">&quot;Preflight rule data objects of &quot;</span> + myProfile.name + <span class="stringliteral">&quot;.&quot;</span> + myRule.name + <span class="stringliteral">&quot;: &quot;</span>;</div>
<div class="line">    <span class="keywordflow">for</span> (var i = 0; i &lt; dataObjectCount; i++)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (i &gt; 0)</div>
<div class="line">        {</div>
<div class="line">            str += <span class="stringliteral">&quot;; &quot;</span>;</div>
<div class="line">        }</div>
<div class="line">        str += dataObjects.item(i).name + <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line">        str += getDataObjectDataType(dataObjects.item(i).dataType) + <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line">        str += dataObjects.item(i).dataValue;</div>
<div class="line">    }</div>
<div class="line">    alert(str);</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">function</span> getDataObjectDataType(type)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (type == RuleDataType.BOOLEAN_DATA_TYPE)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="stringliteral">&quot;Boolean&quot;</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == RuleDataType.INTEGER_DATA_TYPE)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="stringliteral">&quot;Integer&quot;</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == RuleDataType.LIST_DATA_TYPE)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="stringliteral">&quot;List&quot;</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == RuleDataType.OBJECT_DATA_TYPE)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="stringliteral">&quot;Object&quot;</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == RuleDataType.REAL_DATA_TYPE)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="stringliteral">&quot;Real&quot;</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == RuleDataType.SHORT_INTEGER_DATA_TYPE)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="stringliteral">&quot;Short Integer&quot;</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == RuleDataType.STRING_DATA_TYPE)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="stringliteral">&quot;String&quot;</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> type;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_importing_a_preflight_profile"></a>
Importing a Preflight Profile</h2>
<p>To import a preflight profile from the Preflight panel, choose Preflight Panel &gt; Define Profiles, then choose Load Profile from the drop-down menu in the Preflight Profiles window.</p>
<div class="image">
<img src="InDesign_ScriptingGuide-8.gif" alt="InDesign_ScriptingGuide-8.gif"/>
</div>
<p>You also can load a profile with scripting. The following script fragment imports a profile called Test. For the complete script, see ImportPreflightProfile. </p>
<div class="fragment"><div class="line">    var myProfile = app.loadPreflightProfile(File(<span class="stringliteral">&quot;/c/Test.idpp&quot;</span>));</div>
<div class="line">    <span class="keywordflow">if</span> (myProfile == null)</div>
<div class="line">    {</div>
<div class="line">        alert(<span class="stringliteral">&quot;The profile did not load successfully&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        alert(<span class="stringliteral">&quot;Preflight profile &quot;</span> + myProfile.name + <span class="stringliteral">&quot; is loaded.&quot;</span>)</div>
<div class="line">    }</div>
</div><!-- fragment --><p> It is easier to create profiles using the Preflight panel than with scripting. One workflow would be to create all profiles in the user interface, export them to files, and import them using scripting. This approach avoids the challenges involved with manually adding rules via scripting.</p>
<h2><a class="anchor" id="id_js_creating_a_preflight_profile"></a>
Creating a Preflight Profile</h2>
<p>To create a preflight profile from the Preflight panel, choose Preflight Panel &gt; Define Profiles, then choose the plus sign (+) to add a new preflight profile. Name the profile and fill in all data values for the available rules. </p>
<div class="image">
<img src="InDesign_ScriptingGuide-9.gif" alt="InDesign_ScriptingGuide-9.gif"/>
</div>
<p>You also can create a profile with scripting. The following script fragment adds a single profile called Test. For the complete script, see CreatePreflightProfile. </p>
<div class="fragment"><div class="line">    <span class="comment">//Add a new preflight profile.</span></div>
<div class="line">    var myProfile = app.preflightProfiles.add();</div>
<div class="line">    <span class="keywordflow">if</span> (myProfile == null)</div>
<div class="line">    {</div>
<div class="line">        alert(<span class="stringliteral">&quot;The profile did not add successfully.&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        alert(<span class="stringliteral">&quot;Preflight profile &quot;</span> + myProfile.name + <span class="stringliteral">&quot; is added.&quot;</span>)</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Rename the profile.</span></div>
<div class="line">    var oldName = myProfile.name</div>
<div class="line">    myProfile.name = <span class="stringliteral">&quot;Test&quot;</span>;</div>
<div class="line">    myProfile.description = <span class="stringliteral">&quot;Test description&quot;</span>;</div>
<div class="line">    alert(<span class="stringliteral">&quot;Preflight profile &quot;</span> + oldName + <span class="stringliteral">&quot; is renamed to &quot;</span> + myProfile.name + <span class="stringliteral">&quot;.&quot;</span>)</div>
</div><!-- fragment --><p> Preflight-profile names must be unique. If the script above is executed more than once within the same InDesign instance, an error is raised, indicating that a profile with that name already exists. To avoid this, either access the existing profile using app.preflightProfiles.itemByName(), or check to see if a profile exists and remove it; see the following script fragment. For the complete script, see DeletePreflightProfile. </p>
<div class="fragment"><div class="line"><span class="keyword">function</span> removeProfile(name)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">//Lookup the existing preflight profile by name</span></div>
<div class="line">    var oldProfile = app.preflightProfiles.itemByName(name);</div>
<div class="line">    <span class="comment">//If a profile with that name was found</span></div>
<div class="line">    <span class="keywordflow">if</span> (oldProfile != null)</div>
<div class="line">    {</div>
<div class="line">        oldProfile.remove();</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_adding_rules"></a>
Adding Rules</h2>
<p>A preflight profile contains a mutually exclusive set of rules. To add a rule to a profile, follow these steps:</p>
<ol type="1">
<li>Add a rule to a profile by name. Rules are added by name. For information on rule names, see <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_available_rules">Available Rules</a>. The following adds the ADBE_PageSizeOrientation rule to the profile. <div class="fragment"><div class="line"><span class="comment">//Add a rule that requires a specific page size and orientation </span></div>
<div class="line"><span class="comment">//(portrait or landscape).</span></div>
<div class="line"><span class="keyword">const</span> RULE_NAME = <span class="stringliteral">&quot;ADBE_PageSizeOrientation&quot;</span>;</div>
<div class="line">var myRule = myProfile.preflightProfileRules.add(RULE_NAME);</div>
</div><!-- fragment --></li>
<li>Set the rule's data values. Many, but not all, rules have data properties. For a complete specification of the rules available with InDesign, see <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_available_rules">Available Rules</a>. The ADBE_PageSizeOrientation rule contains particular data properties that allow you to specify a page size. The following sets the acceptable page height and width, a tolerance (fudge factor), and an option for handling page orientation. <div class="fragment"><div class="line"><span class="comment">//Requires the page size to be 8.5in x 11in (Letter Size)</span></div>
<div class="line"><span class="comment">//enters a value for tolerance</span></div>
<div class="line">myRule.ruleDataObjects.add(<span class="stringliteral">&quot;tolerance&quot;</span>, RuleDataType.realDataType, 0.01);</div>
<div class="line"></div>
<div class="line"><span class="comment">//Sets the width  to the point equivalent of 8.5 inches</span></div>
<div class="line">myRule.ruleDataObjects.add(<span class="stringliteral">&quot;width&quot;</span>, RuleDataType.realDataType, 612);</div>
<div class="line"></div>
<div class="line"><span class="comment">//Sets the width  to the point equivalent of 11 inches</span></div>
<div class="line">myRule.ruleDataObjects.add(<span class="stringliteral">&quot;height&quot;</span>, RuleDataType.realDataType, 792);</div>
<div class="line"></div>
<div class="line"><span class="comment">//true = ignore orientation is checked</span></div>
<div class="line">myRule.ruleDataObjects.add(<span class="stringliteral">&quot;ignore_orientation&quot;</span>, RuleDataType.booleanDataType, <span class="keyword">true</span>);</div>
</div><!-- fragment --></li>
<li>Set the rule's reporting state. This is done using the rule's flag property. There are several choices (disabled, information, warning, and error), controlled by the PreflightRuleFlag enumeration. <div class="fragment"><div class="line"><span class="comment">//set the rule to return an error</span></div>
<div class="line">myRule.flag = PreflightRuleFlag.returnAsError;</div>
</div><!-- fragment --></li>
</ol>
<h2><a class="anchor" id="id_js_processing_a_profile"></a>
Processing a Profile</h2>
<p>In the desktop version of InDesign, preflight errors are reported in the user interface. In scripting (especially for InDesign Server), the errors are generated on demand. The following script processes an InDesign document. (For the complete script, see ProcessPreflightProfile.) If there are errors, it writes the results to a new PDF file. For an example of the output, see the figure below the script. </p>
<div class="fragment"><div class="line">    <span class="comment">// Assume there is a document.</span></div>
<div class="line">    var myDoc = app.documents.item(0);</div>
<div class="line">    <span class="comment">// Assume the Test preflight profile exists.</span></div>
<div class="line">    var myProfile = app.preflightProfiles.itemByName(<span class="stringliteral">&quot;Test&quot;</span>);</div>
<div class="line">    <span class="comment">//Process the myDoc with the rule</span></div>
<div class="line">    var myProcess = app.preflightProcesses.add(myDoc, myProfile);</div>
<div class="line">    myProcess.waitForProcess();</div>
<div class="line">    var myResults = myProcess.processResults;</div>
<div class="line">    <span class="comment">//If errors were found</span></div>
<div class="line">    <span class="keywordflow">if</span> (myResults != <span class="stringliteral">&quot;None&quot;</span>)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">//Export the file to PDF. The &quot;true&quot; value selects to open the file after export.</span></div>
<div class="line">        myProcess.saveReport(File(<span class="stringliteral">&quot;/c/PreflightResults.pdf&quot;</span>), <span class="keyword">true</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Cleanup</span></div>
<div class="line">    myProcess.remove();</div>
</div><!-- fragment --> <div class="image">
<img src="InDesign_ScriptingGuide-10.gif" alt="InDesign_ScriptingGuide-10.gif"/>
</div>
<p>If you would rather produce a text file, simply name your output file with a .txt extension.</p>
<p>Alternately, you may prefer to iterate the errors yourself. The following demonstrates how to access the errors array. For the complete script, see ProcessPreflightProfileShowErrors. </p>
<div class="fragment"><div class="line">    <span class="comment">//If Errors were found</span></div>
<div class="line">    <span class="keywordflow">if</span> (myResults != <span class="stringliteral">&quot;None&quot;</span>)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// array containing detailed results</span></div>
<div class="line">        var errors = myProcess.aggregatedResults</div>
<div class="line">        <span class="comment">// Show the errors in a message box.</span></div>
<div class="line">        var str = <span class="stringliteral">&quot;Document: &quot;</span> + errors[0] + <span class="stringliteral">&quot;, Profile: &quot;</span> + errors[1] + <span class="stringliteral">&quot;, Results: [&quot;</span></div>
<div class="line">        var errorResults = errors[2]</div>
<div class="line">        <span class="keywordflow">for</span> (var i = 0; i &lt; errorResults.length; i++)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (i &gt; 1)</div>
<div class="line">            {</div>
<div class="line">                str += <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line">            }</div>
<div class="line">            str += errorResults[i][1]</div>
<div class="line">        }</div>
<div class="line">        str = str + <span class="stringliteral">&quot;]&quot;</span></div>
<div class="line">        alert(str)</div>
<div class="line">    }</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_custom_rules"></a>
Custom Rules</h2>
<p>It is not possible to create custom rules through the Preflight panel or scripting; however, this can be done through a C++ plug-in. The InDesign Products SDK contains a sample, PreflightRule, that demonstrates how to add custom rules with a plug-in.</p>
<h2><a class="anchor" id="id_js_available_rules"></a>
Available Rules</h2>
<p>One of the hardest aspects of scripting rules is discovering rule names and properties. Due to the dynamic nature of rules (they really are just strings), specific rule names and properties do not appear in the Extend Script Tool Kit's Object Model Viewer. To discover this information, see <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_exploring_preflight_profiles">Exploring Preflight Profiles</a>. For your convenience, the DumpPreflightRules.jsx script is provided in the SDK to produce the following output as an HTML file (SDK\docs\references\PreflightRules.html). If you use a plug-in that adds custom rules, you can run the script to extract the new names and properties.</p>
<table class="doxtable">
<tr>
<th>Rule name </th><th>Rule properties </th></tr>
<tr>
<td>ADBE_BlankPages </td><td>"ADBE_BlankPages" </td></tr>
<tr>
<td>ADBE_BleedSlug </td><td>"ADBE_BleedSlug" </td></tr>
<tr>
<td>ADBE_BleedTrimHazard </td><td>"ADBE_BleedTrimHazard" </td></tr>
<tr>
<td>ADBE_CMYPlates </td><td>no </td></tr>
<tr>
<td>ADBE_Colorspace </td><td>"ADBE_Colorspace" </td></tr>
<tr>
<td>ADBE_ConditionIndicators </td><td>no </td></tr>
<tr>
<td>ADBE_CrossReferences </td><td>"ADBE_CrossReferences" </td></tr>
<tr>
<td>ADBE_FontUsage </td><td>"ADBE_FontUsage" </td></tr>
<tr>
<td>ADBE_ImageColorManagement </td><td>"ADBE_ImageColorManagement" </td></tr>
<tr>
<td>ADBE_ImageResolution </td><td>"ADBE_ImageResolution" </td></tr>
<tr>
<td>ADBE_InteractiveContent </td><td>no </td></tr>
<tr>
<td>ADBE_LayerVisibility </td><td>no </td></tr>
<tr>
<td>ADBE_MissingFonts </td><td>no </td></tr>
<tr>
<td>ADBE_MissingGlyph </td><td>no </td></tr>
<tr>
<td>ADBE_MissingModifiedGraphics </td><td>no </td></tr>
<tr>
<td>ADBE_OPI </td><td>no </td></tr>
<tr>
<td>ADBE_Overprint </td><td>no </td></tr>
<tr>
<td>ADBE_OversetText </td><td>no </td></tr>
<tr>
<td>ADBE_PageCount </td><td>"ADBE_PageCount" </td></tr>
<tr>
<td>ADBE_PageSizeOrientation </td><td>"ADBE_PageSizeOrientation" </td></tr>
<tr>
<td>ADBE_Registration </td><td>no </td></tr>
<tr>
<td>ADBE_ScaledGraphics </td><td>"ADBE_ScaledGraphics" </td></tr>
<tr>
<td>ADBE_ScaledType </td><td>"ADBE_ScaledType" </td></tr>
<tr>
<td>ADBE_SmallText </td><td>"ADBE_SmallText" </td></tr>
<tr>
<td>ADBE_SpellCheck </td><td>no </td></tr>
<tr>
<td>ADBE_SpotColorSetup </td><td>"ADBE_SpotColorSetup" </td></tr>
<tr>
<td>ADBE_StrokeRequirements </td><td>"ADBE_StrokeRequirements" </td></tr>
<tr>
<td>ADBE_TextOverrides </td><td>"ADBE_TextOverrides" </td></tr>
<tr>
<td>ADBE_TransparencyBlending </td><td>"ADBE_TransparencyBlending" </td></tr>
<tr>
<td>ADBE_TransparencyUsage </td><td>no </td></tr>
<tr>
<td>ADBE_WhiteOverprint </td><td>no </td></tr>
</table>
<h3><a class="anchor" id="id_js_adbe_blankpages"></a>
ADBE_BlankPages</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value</th></tr>
<tr>
<td>Boolean </td><td>ignore_master </td><td>true </td></tr>
<tr>
<td>Boolean </td><td>ignore_nonprinting </td><td>true </td></tr>
</table>
<h3><a class="anchor" id="id_js_adbe_bleedslug"></a>
ADBE_BleedSlug</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Real </td><td>bleed_b </td><td>9 </td></tr>
<tr>
<td>Real </td><td>bleed_b_aux </td><td>9 </td></tr>
<tr>
<td>Integer </td><td>bleed_comparison_type </td><td>3 </td></tr>
<tr>
<td>Boolean </td><td>bleed_enabled </td><td>true </td></tr>
<tr>
<td>Real </td><td>bleed_l </td><td>9 </td></tr>
<tr>
<td>Real </td><td>bleed_l_aux </td><td>9 </td></tr>
<tr>
<td>Real </td><td>bleed_r </td><td>9 </td></tr>
<tr>
<td>Real </td><td>bleed_r_aux </td><td>9 </td></tr>
<tr>
<td>Real </td><td>bleed_t </td><td>9 </td></tr>
<tr>
<td>Real </td><td>bleed_t_aux </td><td>9 </td></tr>
<tr>
<td>Real </td><td>slug_b </td><td>18 </td></tr>
<tr>
<td>Real </td><td>slug_b_aux </td><td>18 </td></tr>
<tr>
<td>Integer </td><td>slug_comparison_type </td><td>3 </td></tr>
<tr>
<td>Boolean </td><td>slug_enabled </td><td>false </td></tr>
<tr>
<td>Real </td><td>slug_l </td><td>18 </td></tr>
<tr>
<td>Real </td><td>slug_l_aux </td><td>18 </td></tr>
<tr>
<td>Real </td><td>slug_r </td><td>18 </td></tr>
<tr>
<td>Real </td><td>slug_r_aux </td><td>18 </td></tr>
<tr>
<td>Real </td><td>slug_t </td><td>18 </td></tr>
<tr>
<td>Real </td><td>slug_t_aux </td><td>18 </td></tr>
<tr>
<td>Real </td><td>tolerance </td><td>0.01 </td></tr>
</table>
<h3><a class="anchor" id="id_js_adbe_bleedtrimhazard"></a>
ADBE_BleedTrimHazard</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Boolean </td><td>binding_enabled </td><td>false </td></tr>
<tr>
<td>Real </td><td>binding_width </td><td>1 </td></tr>
<tr>
<td>Real </td><td>live_b </td><td>18 </td></tr>
<tr>
<td>Real </td><td>live_l </td><td>18 </td></tr>
<tr>
<td>Real </td><td>live_r </td><td>18 </td></tr>
<tr>
<td>Real </td><td>live_t </td><td>18 </td></tr>
<tr>
<td>Real </td><td>tolerance </td><td>0.01 </td></tr>
</table>
<h3><a class="anchor" id="id_js_adbe_colorspace"></a>
ADBE_Colorspace</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Boolean </td><td>no_cmyk </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_gray </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_lab </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_rgb </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_spot </td><td>false </td></tr>
</table>
<h3><a class="anchor" id="id_js_adbe_crossreferences"></a>
ADBE_CrossReferences</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Boolean </td><td>xrefs_out_of_date </td><td>true </td></tr>
<tr>
<td>Boolean </td><td>xrefs_unresolved </td><td>true </td></tr>
</table>
<h3><a class="anchor" id="id_js_adbe_fontusage"></a>
ADBE_FontUsage</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Boolean </td><td>no_ATC </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_Bitmap </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_CID </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_MultipleMaster </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_OpenTypeCFF </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_OpenTypeCID </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_OpenTypeTT </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_TrueType </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_Type1 </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_protected </td><td>true </td></tr>
</table>
<h3><a class="anchor" id="id_js_adbe_imagecolormanagement"></a>
ADBE_ImageColorManagement</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Boolean </td><td>no_cmyk_profiles </td><td>true </td></tr>
<tr>
<td>Boolean </td><td>no_image_overrides </td><td>true </td></tr>
<tr>
<td>Boolean </td><td>overrides_exclude_uncal </td><td>true </td></tr>
</table>
<h3><a class="anchor" id="id_js_adbe_imageresolution"></a>
ADBE_ImageResolution</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Boolean </td><td>bw_max_enabled </td><td>false </td></tr>
<tr>
<td>Real </td><td>bw_max_res </td><td>2400 </td></tr>
<tr>
<td>Boolean </td><td>bw_min_enabled </td><td>true </td></tr>
<tr>
<td>Real </td><td>bw_min_res </td><td>800 </td></tr>
<tr>
<td>Boolean </td><td>color_max_enabled </td><td>false </td></tr>
<tr>
<td>Real </td><td>color_max_res </td><td>1200 </td></tr>
<tr>
<td>Boolean </td><td>color_min_enabled </td><td>true </td></tr>
<tr>
<td>Real </td><td>color_min_res </td><td>250 </td></tr>
<tr>
<td>Boolean </td><td>gray_max_enabled </td><td>false </td></tr>
<tr>
<td>Real </td><td>gray_max_res </td><td>1200 </td></tr>
<tr>
<td>Boolean </td><td>gray_min_enabled </td><td>true </td></tr>
<tr>
<td>Real </td><td>gray_min_res </td><td>250 </td></tr>
<tr>
<td>Real </td><td>tolerance </td><td>0.5 </td></tr>
</table>
<h3><a class="anchor" id="id_js_adbe_pagecount"></a>
ADBE_PageCount</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Integer </td><td>comparison_type </td><td>2 </td></tr>
<tr>
<td>Integer </td><td>comparison_value </td><td>1 </td></tr>
<tr>
<td>Integer </td><td>comparison_value_aux </td><td>1 </td></tr>
</table>
<h3><a class="anchor" id="id_js_adbe_pagesizeorientation"></a>
ADBE_PageSizeOrientation</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Real </td><td>height </td><td>792 </td></tr>
<tr>
<td>Boolean </td><td>ignore_orientation </td><td>false </td></tr>
<tr>
<td>Real </td><td>tolerance </td><td>0.01 </td></tr>
<tr>
<td>Real </td><td>width </td><td>612 </td></tr>
</table>
<h3><a class="anchor" id="id_js_adbe_scaledgraphics"></a>
ADBE_ScaledGraphics</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Real </td><td>max_scale </td><td>100.5 </td></tr>
</table>
<h3><a class="anchor" id="id_js_adbe_scaledtype"></a>
ADBE_ScaledType</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Boolean </td><td>ignore_justification </td><td>true </td></tr>
<tr>
<td>Real </td><td>max_scale </td><td>100.5 </td></tr>
</table>
<h3><a class="anchor" id="id_js_adbe_smalltext"></a>
ADBE_SmallText</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Real </td><td>minSize </td><td>4 </td></tr>
<tr>
<td>Boolean </td><td>minSize_trap_safe_only </td><td>false </td></tr>
</table>
<h3><a class="anchor" id="id_js_adbe_spotcolorsetup"></a>
ADBE_SpotColorSetup</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Boolean </td><td>lab_spots </td><td>true </td></tr>
<tr>
<td>Boolean </td><td>lab_spots_enabled </td><td>false </td></tr>
<tr>
<td>Integer </td><td>max_spots </td><td>1 </td></tr>
<tr>
<td>Boolean </td><td>max_spots_enabled </td><td>true </td></tr>
</table>
<h3><a class="anchor" id="id_js_adbe_strokerequirements"></a>
ADBE_StrokeRequirements</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Real </td><td>min_width </td><td>0.125 </td></tr>
</table>
<p>Boolean | min_width_trap_safe_only | false</p>
<h3><a class="anchor" id="id_js_adbe_textoverrides"></a>
ADBE_TextOverrides</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Boolean </td><td>ignore_color_overrides </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>ignore_font_overrides </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>ignore_kerning_tracking_overrides </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>ignore_language_overrides </td><td>false </td></tr>
</table>
<h3><a class="anchor" id="id_js_adbe_transparencyblending"></a>
ADBE_TransparencyBlending</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Integer </td><td>space </td><td>3 </td></tr>
</table>
<h1><a class="anchor" id="id_js_creating_dynamic_documents"></a>
Creating Dynamic Documents</h1>
<p>InDesign can create documents for web and online use, also known as Rich Interactive Documents (RID). Dynamic documents contain sounds, animations, hyperlinks, and other interactive content. InDesign documents can be exported to SWF, XFL, or PDF. For SWF and XFL files, documents can include animations, buttons, multistate objects, movies, and sound clips. You can use the Preview panel in InDesign to test some types of dynamic content before exporting.</p>
<p>This section shows how to create dynamic documents using scripting. For more on exporting as PDF, SWF, and XFL, refer to <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_documents">Documents</a>.</p>
<h2><a class="anchor" id="id_js_importing_movies_and_sounds"></a>
Importing Movies and Sounds</h2>
<p>InDesign can import movie and sound files that can then be viewed or listened to in exported PDF, SWF, or XFL documents. Movies and sounds in an InDesign document are very similar to graphics in that they exist inside container objects on an InDesign page. Unlike graphics, however, you cannot see (or hear) the content of the imported multimedia files on an InDesign page. For that, you'll need to either view the page in the Preview panel, or export the file, then open the file in a viewer capable of displaying the content (such as Acrobat Reader or a web browser).</p>
<p>Scripts can control the playback properties of a sound or movie in an exported dynamic document. You can also add a preview, or "poster," image to the page item containing the sound or movie.</p>
<p>The following script fragment shows how to import a movie and control the way that the movie is shown and played in an exported document (for the complete script, refer to PlaceMovie). </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a page &quot;myPage&quot;... </span></div>
<div class="line">    var myFrame = myPage.rectangles.add({geometricBounds:[72, 72, 288, 288]});</div>
<div class="line">    <span class="comment">//Import a movie file (you&#39;ll have to provide a valid file path on your system);</span></div>
<div class="line">    var myMovie = myFrame.place(File(<span class="stringliteral">&quot;/c/movie.avi&quot;</span>))[0];</div>
<div class="line">    <span class="comment">//Set movie properties.</span></div>
<div class="line">    myMovie.embedInPDF = <span class="keyword">true</span>;</div>
<div class="line">    myMovie.showControls = <span class="keyword">true</span>;</div>
<div class="line">    <span class="comment">//Add a preview image. You&#39;ll have to provide a valid path on your system.</span></div>
<div class="line">    myMovie.posterFile = File(<span class="stringliteral">&quot;/c/movie poster.jpg&quot;</span>);</div>
</div><!-- fragment --><p> The following script fragment shows how to import a sound file and control the playback and display of the sound in an exported document (for the complete script, refer to PlaceSound). </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a page &quot;myPage&quot;... </span></div>
<div class="line">    <span class="comment">//Import a sound file (you&#39;ll have to provide a valid file path on your system);</span></div>
<div class="line">    var mySound = myPage.place(File(<span class="stringliteral">&quot;/c/sound.mp3&quot;</span>), [72, 72])[0];</div>
<div class="line">    <span class="comment">//Set sound properties.</span></div>
<div class="line">    mySound.embedInPDF = <span class="keyword">true</span>;</div>
<div class="line">    mySound.doNotPrintPoster = <span class="keyword">true</span>;</div>
<div class="line">    mySound.soundLoop = <span class="keyword">true</span>;</div>
<div class="line">    mySound.stopOnPageTurn = <span class="keyword">true</span>;</div>
<div class="line">    <span class="comment">//Add a preview image. You&#39;ll have to provide a valid path on your system.</span></div>
<div class="line">    mySound.posterFile = File(<span class="stringliteral">&quot;/c/sound poster.jpg&quot;</span>);</div>
</div><!-- fragment --><p> Buttons can be used to control the playback of sounds and movies. For information on how to script buttons, see the next section.</p>
<h2><a class="anchor" id="id_js_creating_buttons"></a>
Creating Buttons</h2>
<p>Buttons are often used for navigation in dynamic documents. Buttons contain three states, known as "Normal," "Rollover," and "Click," which, in turn, can contain page items such as rectangles, ovals, text frames, or images. The button can display only one state at a time; the other states are displayed when triggered by mouse actions.</p>
<p>Behaviors control what the button does when you perform a specific mouse action. Behaviors correspond to the Actions shown in the Buttons panel in InDesign's user interface. Buttons can contain multiple behaviors.</p>
<p>The following script fragment shows how to create a simple button that displays the next page in an exported PDF or SWF (for the complete script, refer to SimpleButton). This button makes use of only the Normal state. </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a page &quot;myPage&quot; and a document containing the color &quot;Red&quot;...</span></div>
<div class="line">    <span class="comment">//Make a button by converting a page item.</span></div>
<div class="line">    var myRightArrow = myPage.polygons.add({fillColor:myDocument.colors.item(<span class="stringliteral">&quot;Red&quot;</span>), name:<span class="stringliteral">&quot;GoToNextPageButton&quot;</span>});</div>
<div class="line">    myRightArrow.paths.item(0).entirePath = [[72, 72],[144,108],[72, 144]];</div>
<div class="line">    var myButton = myPage.buttons.add({geometricBounds:[72, 72, 144, 144]});</div>
<div class="line">    myButton.states.item(0).addItemsToState(myRightArrow);</div>
<div class="line">    var myGoToNextPageBehavior = myButton.gotoNextPageBehaviors.add({behaviorEvent:BehaviorEvents.mouseUp});</div>
</div><!-- fragment --><p> The following script fragment shows how to create a somewhat more complicated button, containing page items that change the appearance of each of the three button states. For the complete script, refer to ButtonStates. </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a page &quot;myPage&quot; in a document &quot;myDocument,&quot; containing the colors</span></div>
<div class="line">    <span class="comment">//&quot;Blue&quot; and &quot;Red&quot;...</span></div>
<div class="line">    <span class="comment">//Make a button &quot;from scratch.&quot;</span></div>
<div class="line">    var myButton = myPage.buttons.add({geometricBounds:[72, 72, 144, 144], name:<span class="stringliteral">&quot;GoToNextPageButton&quot;</span>});</div>
<div class="line">    var myRightArrow = myButton.states.item(0).polygons.add({fillColor:myDocument.colors.item(<span class="stringliteral">&quot;Red&quot;</span>)});</div>
<div class="line">    myRightArrow.paths.item(0).entirePath = [[72, 72],[144,108],[72, 144]];</div>
<div class="line">    <span class="comment">//Add the Rollover state.</span></div>
<div class="line">    var myRolloverState = myButton.states.add();</div>
<div class="line">    <span class="comment">//Add a shadow to the polygon in the Rollover state.</span></div>
<div class="line">    var myRolloverArrow = myRolloverState.polygons.add({fillColor:myDocument.colors.item(<span class="stringliteral">&quot;Red&quot;</span>)});</div>
<div class="line">    myRolloverArrow.paths.item(0).entirePath = [[72, 72],[144,108],[72, 144]];</div>
<div class="line">    var myFillTransparencySettings = myRolloverArrow.fillTransparencySettings;</div>
<div class="line">    myFillTransparencySettings.dropShadowSettings.mode = ShadowMode.drop;</div>
<div class="line">    myFillTransparencySettings.dropShadowSettings.angle = 90;</div>
<div class="line">    myFillTransparencySettings.dropShadowSettings.xOffset = 0;</div>
<div class="line">    myFillTransparencySettings.dropShadowSettings.yOffset = 0;</div>
<div class="line">    myFillTransparencySettings.dropShadowSettings.size = 6;</div>
<div class="line">    <span class="comment">//Add a shadow to the polygon in the Click state.</span></div>
<div class="line">    var myClickState = myButton.states.add();</div>
<div class="line">    var myClickArrow = myClickState.polygons.add({fillColor:myDocument.colors.item(<span class="stringliteral">&quot;Blue&quot;</span>)});</div>
<div class="line">    myClickArrow.paths.item(0).entirePath = [[72, 72],[144,108],[72, 144]];</div>
<div class="line">    <span class="comment">//Set the behavior for the button.</span></div>
<div class="line">    var myGoToNextPageBehavior = myButton.gotoNextPageBehaviors.add({behaviorEvent:BehaviorEvents.mouseUp});</div>
</div><!-- fragment --><p> Buttons can be used to control the playback of movie and sound files. The following script fragment shows an example of using a set of buttons to control the playback of a moving file (for the complete script, refer to MovieControl). </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a page &quot;myPage&quot; in a document &quot;myDocument,&quot; </span></div>
<div class="line">    <span class="comment">//containing the colors &quot;Gray&quot; and &quot;Red&quot;...</span></div>
<div class="line">    var myFrame = myPage.rectangles.add({geometricBounds:[72, 72, 288, 288]});</div>
<div class="line">    <span class="comment">//Import a movie file (you&#39;ll have to provide a valid file path on your system);</span></div>
<div class="line">    myFrame.place(File(<span class="stringliteral">&quot;/c/movie.avi&quot;</span>));</div>
<div class="line">    <span class="comment">//Create the movie &quot;Start&quot; button.</span></div>
<div class="line">    var myPlayButton = myPage.buttons.add({geometricBounds:[294,186,354,282], name:<span class="stringliteral">&quot;PlayMovieButton&quot;</span>});</div>
<div class="line">    var myRightArrow = myPlayButton.states.item(0).polygons.add({fillColor:myDocument.colors.item(<span class="stringliteral">&quot;Gray&quot;</span>)});</div>
<div class="line">    myRightArrow.paths.item(0).entirePath = [[186, 294],[186,354],[282, 324]];</div>
<div class="line">    <span class="comment">//Add the Rollover state.</span></div>
<div class="line">    var myRolloverState = myPlayButton.states.add();</div>
<div class="line">    <span class="comment">//Add a shadow to the polygon in the Rollover state.</span></div>
<div class="line">    var myRolloverArrow = myRolloverState.polygons.add({fillColor:myDocument.colors.item(<span class="stringliteral">&quot;Gray&quot;</span>)});</div>
<div class="line">    myRolloverArrow.paths.item(0).entirePath = [[186, 294],[186,354],[282, 324]];</div>
<div class="line">    var myFillTransparencySettings = myRolloverArrow.fillTransparencySettings;</div>
<div class="line">    myFillTransparencySettings.dropShadowSettings.mode = ShadowMode.drop;</div>
<div class="line">    myFillTransparencySettings.dropShadowSettings.angle = 90;</div>
<div class="line">    myFillTransparencySettings.dropShadowSettings.xOffset = 0;</div>
<div class="line">    myFillTransparencySettings.dropShadowSettings.yOffset = 0;</div>
<div class="line">    myFillTransparencySettings.dropShadowSettings.size = 6;</div>
<div class="line">    <span class="comment">//Add a shadow to the polygon in the Click state.</span></div>
<div class="line">    var myClickState = myPlayButton.states.add();</div>
<div class="line">    var myClickArrow = myClickState.polygons.add({fillColor:myDocument.colors.item(<span class="stringliteral">&quot;Red&quot;</span>)});</div>
<div class="line">    myClickArrow.paths.item(0).entirePath = [[186, 294],[186,354],[282, 324]];</div>
<div class="line">    <span class="comment">//Set the behavior for the button.</span></div>
<div class="line">    var myMovieStartBehavior = myPlayButton.movieBehaviors.add({movieItem:myFrame.movies.item(0), behaviorEvent:BehaviorEvents.mouseUp, operation:MoviePlayOperations.play});</div>
<div class="line">    <span class="comment">//Create the movie &quot;Stop&quot; button.</span></div>
<div class="line">    var myStopButton = myPage.buttons.add({geometricBounds:[294,78,354,174], name:<span class="stringliteral">&quot;StopMovieButton&quot;</span>});</div>
<div class="line">    var myNormalRectangle = myStopButton.states.item(0).rectangles.add({geometricBounds:[294,78,354,174], fillColor:myDocument.colors.item(<span class="stringliteral">&quot;Gray&quot;</span>)});</div>
<div class="line">    myRolloverState = myStopButton.states.add();</div>
<div class="line">    var myRolloverRectangle = myRolloverState.rectangles.add({geometricBounds:[294,78,354,174], fillColor:myDocument.colors.item(<span class="stringliteral">&quot;Gray&quot;</span>)});</div>
<div class="line">    var myFillTransparencySettings = myRolloverRectangle.fillTransparencySettings;</div>
<div class="line">    myFillTransparencySettings.dropShadowSettings.mode = ShadowMode.drop;</div>
<div class="line">    myFillTransparencySettings.dropShadowSettings.angle = 90;</div>
<div class="line">    myFillTransparencySettings.dropShadowSettings.xOffset = 0;</div>
<div class="line">    myFillTransparencySettings.dropShadowSettings.yOffset = 0;</div>
<div class="line">    myFillTransparencySettings.dropShadowSettings.size = 6;</div>
<div class="line">    myClickState = myStopButton.states.add();</div>
<div class="line">    var myClickRectangle = myClickState.rectangles.add({geometricBounds:[294,78,354,174], fillColor:myDocument.colors.item(<span class="stringliteral">&quot;Red&quot;</span>)});</div>
<div class="line">    var myMovieStopBehavior = myStopButton.movieBehaviors.add({movieItem:myFrame.movies.item(0), behaviorEvent:BehaviorEvents.mouseUp, operation:MoviePlayOperations.stop});</div>
</div><!-- fragment --><p> Buttons are also important in controlling the appearance of multistate objects, as we'll demonstrate in the next section.</p>
<h2><a class="anchor" id="id_js_creating_multistate_objects"></a>
Creating Multistate Objects</h2>
<p>Multistate objects (or MSOs) are similar to buttons in that they contains states, and that only one state can be visible at a time. They are unlike buttons in that they can contain any number of states; buttons can contain three states, at most. Multistate objects rely on buttons to change the way they display their states.</p>
<p>The following script fragment shows how to create a simple multistate object and add a button to control the display of the states in the object (for the complete script, refer to MakeMultiStateObject). </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a document &quot;myDocument&quot; and a page &quot;myPage&quot; and</span></div>
<div class="line">    <span class="comment">//four colors &quot;myColorA,&quot; &quot;myColorB,&quot; &quot;myColorC,&quot; and &quot;myColorD&quot;...</span></div>
<div class="line">    var myMSO = myPage.multiStateObjects.add({name:<span class="stringliteral">&quot;Spinner&quot;</span>, geometricBounds:[72, 72, 144, 144]});</div>
<div class="line">    <span class="comment">//New multi-state objects contain two states when they&#39;re created. Add two more.</span></div>
<div class="line">    myMSO.states.item(0).name = <span class="stringliteral">&quot;Up&quot;</span>;</div>
<div class="line">    myMSO.states.item(1).name = <span class="stringliteral">&quot;Right&quot;</span>;</div>
<div class="line">    <span class="comment">//Add two more states.</span></div>
<div class="line">    myMSO.states.add({name:<span class="stringliteral">&quot;Down&quot;</span>});</div>
<div class="line">    myMSO.states.add({name:<span class="stringliteral">&quot;Left&quot;</span>});</div>
<div class="line">    <span class="comment">//Add page items to the states.</span></div>
<div class="line">    var myPolygon = myMSO.states.item(0).polygons.add({fillColor:myColorA, strokeColor:myDocument.swatches.item(<span class="stringliteral">&quot;None&quot;</span>)});</div>
<div class="line">    myPolygon.paths.item(0).entirePath = [[72, 144], [144, 144], [108, 72]];</div>
<div class="line">    myPolygon = myMSO.states.item(1).polygons.add({fillColor:myColorB, strokeColor:myDocument.swatches.item(<span class="stringliteral">&quot;None&quot;</span>)});</div>
<div class="line">    myPolygon.paths.item(0).entirePath = [[72, 72], [72, 144], [144, 108]];</div>
<div class="line">    myPolygon = myMSO.states.item(2).polygons.add({fillColor:myColorC, strokeColor:myDocument.swatches.item(<span class="stringliteral">&quot;None&quot;</span>)});</div>
<div class="line">    myPolygon.paths.item(0).entirePath = [[72, 72], [108, 144], [144, 72]];</div>
<div class="line">    myPolygon = myMSO.states.item(3).polygons.add({fillColor:myColorD, strokeColor:myDocument.swatches.item(<span class="stringliteral">&quot;None&quot;</span>)});</div>
<div class="line">    myPolygon.paths.item(0).entirePath = [[144, 72], [72, 108], [144, 144]];</div>
</div><!-- fragment --><p> Typically, you'll control the display of the states in a multistate object using a button. The following script fragment shows how to do this (for the complete script, refer to MultiStateObjectControl). </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a document &quot;myDocument&quot; and a page &quot;myPage&quot; and</span></div>
<div class="line">    <span class="comment">//four colors &quot;myColorA,&quot; &quot;myColorB,&quot; &quot;myColorC,&quot; and &quot;myColorD&quot;...</span></div>
<div class="line">    var myMSO = myPage.multiStateObjects.add({name:<span class="stringliteral">&quot;Spinner&quot;</span>, geometricBounds:[72, 72, 144, 144]});</div>
<div class="line">    <span class="comment">//New multi-state objects contain two states when they&#39;re created. Add two more.</span></div>
<div class="line">    myMSO.states.item(0).name = <span class="stringliteral">&quot;Up&quot;</span>;</div>
<div class="line">    myMSO.states.item(1).name = <span class="stringliteral">&quot;Right&quot;</span>;</div>
<div class="line">    <span class="comment">//Add two more states.</span></div>
<div class="line">    myMSO.states.add({name:<span class="stringliteral">&quot;Down&quot;</span>});</div>
<div class="line">    myMSO.states.add({name:<span class="stringliteral">&quot;Left&quot;</span>});</div>
<div class="line">    <span class="comment">//Add page items to the states.</span></div>
<div class="line">    var myPolygon = myMSO.states.item(0).polygons.add({fillColor:myColorA, strokeColor:myDocument.swatches.item(<span class="stringliteral">&quot;None&quot;</span>)});</div>
<div class="line">    myPolygon.paths.item(0).entirePath = [[72, 144], [144, 144], [108, 72]];</div>
<div class="line">    myPolygon = myMSO.states.item(1).polygons.add({fillColor:myColorB, strokeColor:myDocument.swatches.item(<span class="stringliteral">&quot;None&quot;</span>)});</div>
<div class="line">    myPolygon.paths.item(0).entirePath = [[72, 72], [72, 144], [144, 108]];</div>
<div class="line">    myPolygon = myMSO.states.item(2).polygons.add({fillColor:myColorC, strokeColor:myDocument.swatches.item(<span class="stringliteral">&quot;None&quot;</span>)});</div>
<div class="line">    myPolygon.paths.item(0).entirePath = [[72, 72], [108, 144], [144, 72]];</div>
<div class="line">    myPolygon = myMSO.states.item(3).polygons.add({fillColor:myColorD, strokeColor:myDocument.swatches.item(<span class="stringliteral">&quot;None&quot;</span>)});</div>
<div class="line">    myPolygon.paths.item(0).entirePath = [[144, 72], [72, 108], [144, 144]];</div>
<div class="line">    var myButton = myPage.buttons.add({geometricBounds:[72, 72, 144, 144]});</div>
<div class="line">    myRolloverState = myButton.states.add();</div>
<div class="line">    var myRolloverRectangle = myRolloverState.groups.item(0).rectangles.item(0);</div>
<div class="line">    myRolloverRectangle.strokeColor = myColorD;</div>
<div class="line">    myRolloverRectangle.strokeWeight = 1;</div>
<div class="line">    var myStrokeTransparencySettings = myRolloverRectangle.strokeTransparencySettings;</div>
<div class="line">    myStrokeTransparencySettings.dropShadowSettings.mode = ShadowMode.drop;</div>
<div class="line">    myStrokeTransparencySettings.dropShadowSettings.angle = 90;</div>
<div class="line">    myStrokeTransparencySettings.dropShadowSettings.xOffset = 0;</div>
<div class="line">    myStrokeTransparencySettings.dropShadowSettings.yOffset = 0;</div>
<div class="line">    myStrokeTransparencySettings.dropShadowSettings.size = 6;</div>
<div class="line">    var myClickState = myButton.states.add();</div>
<div class="line">    var myNextStateBehavior = myButton.gotoNextStateBehaviors.add({associatedMultiStateObject:myMSO, behaviorEvent:BehaviorEvents.mouseDown, enableBehavior:<span class="keyword">true</span>, loopsToNextOrPrevious:<span class="keyword">true</span>}); </div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_working_with_animation"></a>
Working with Animation</h2>
<p>Page items can be animated, adding motion to the dynamic documents you create using InDesign. You apply animation to objects using motion presets, define the movement of animated objects using motion paths, and control the duration of the animation using timing settings, timing lists, and timing groups.</p>
<p>The animationSettings of an object control the animation that will be applied to the object. When animation settings have been applied to an object, InDesign sets the hasCustomSettings property of the object to true; if the object is not to be animated, this property is false.</p>
<p>The point at which an animation begins to play, relative to the event that triggers the animation, is controlled by the objects and properties of the timingSettings object attached to the page item or to one of its parent containers (usually the spread).</p>
<h3><a class="anchor" id="id_js_basic_animation"></a>
Basic animation</h3>
<p>The following script fragment shows how to create a simple animation (for the complete script, refer to SimpleAnimation). The most basic forms of animation can be applied without using timing settings. </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a document &quot;myDocument&quot; and a page &quot;myPage&quot; and a color &quot;myColorA&quot;...</span></div>
<div class="line">    <span class="comment">//Add a page items to animate.</span></div>
<div class="line">    var myPolygon = myPage.polygons.add({fillColor:myColorA, strokeColor:myDocument.swatches.item(<span class="stringliteral">&quot;None&quot;</span>)});</div>
<div class="line">    myPolygon.paths.item(0).entirePath = [[72, 72], [72, 144], [144, 108]];</div>
<div class="line">    <span class="comment">//Create a motion path.</span></div>
<div class="line">    var myMotionPathPoints = [[[[108,108],[108,108],[108,108]],[[516, 108],[516, 108],[516, 108]]],<span class="keyword">true</span>];</div>
<div class="line">    <span class="comment">//Set animation preferences for the polygon. We havent&#39; set a dynamic trigger</span></div>
<div class="line">    <span class="comment">//for the animation, so the polygon&#39;s animation will be triggered by </span></div>
<div class="line">    <span class="comment">//DynamicTriggerEvents.onPageLoad (the default).</span></div>
<div class="line">    myPolygon.animationSettings.duration = 2;</div>
<div class="line">    myPolygon.animationSettings.motionPathPoints = myMotionPathPoints;</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_timingsettings"></a>
TimingSettings</h3>
<p>The timingSettings objects of spreads, pages, and page items control the timing of the animation(s) applied to the object and to any objects contained by the object. timingSettings contain:</p>
<ul>
<li>timingLists, which define the trigger event (page load, page click, and so on) that start the animation.</li>
<li>timingGroups, which associate a page item or series of page items with a specific timing and define the sequence in which animations are shown.</li>
</ul>
<p>timingGroups contain timingTargets, which define the objects associated with a given timingGroup. timingTargets also specify a delay value for the animation applied to the page item, relative to the start of the animation of the timingGroup (for the first item in the timingGroup), or from the start of the previous item in the timingGroup (for other items in the timingGroup).</p>
<p>The following script fragment shows how to control the timing of the animation of an object using the various timing objects (for the complete script, refer to TimingSettings). Note that the parameters used to create a timingGroup specify the properties of the first timingTarget in the timingGroup; subsequent timingTargets, if any, can be added separately. </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a document &quot;myDocument&quot; and a page &quot;myPage&quot; and the color &quot;myColorA&quot;,</span></div>
<div class="line">    <span class="comment">//&quot;myColorB&quot;, and &quot;myColorC&quot;...</span></div>
<div class="line">    <span class="comment">//Add a page items to animate.</span></div>
<div class="line">    var myPolygonA = myPage.polygons.add({fillColor:myColorA, strokeColor:myDocument.swatches.item(<span class="stringliteral">&quot;None&quot;</span>)});</div>
<div class="line">    myPolygonA.paths.item(0).entirePath = [[72, 72], [72, 144], [144, 108]];</div>
<div class="line">    var myPolygonB = myPage.polygons.add({fillColor:myColorB, strokeColor:myDocument.swatches.item(<span class="stringliteral">&quot;None&quot;</span>)});</div>
<div class="line">    myPolygonB.paths.item(0).entirePath = [[72, 72], [72, 144], [144, 108]];</div>
<div class="line">    var myPolygonC = myPage.polygons.add({fillColor:myColorC, strokeColor:myDocument.swatches.item(<span class="stringliteral">&quot;None&quot;</span>)});</div>
<div class="line">    myPolygonC.paths.item(0).entirePath = [[72, 72], [72, 144], [144, 108]];</div>
<div class="line">    <span class="comment">//Create a motion path.</span></div>
<div class="line">    var myMotionPathPoints = [[[[108,108],[108,108],[108,108]],[[516, 108],[516, 108],[516, 108]]],<span class="keyword">true</span>];</div>
<div class="line">    <span class="comment">//Set animation preferences for the polygons. </span></div>
<div class="line">    myPolygonA.animationSettings.duration = 2;</div>
<div class="line">    myPolygonA.animationSettings.motionPathPoints = myMotionPathPoints;</div>
<div class="line">    myPolygonB.animationSettings.duration = 2;</div>
<div class="line">    myPolygonB.animationSettings.motionPathPoints = myMotionPathPoints;</div>
<div class="line">    myPolygonC.animationSettings.duration = 2;</div>
<div class="line">    myPolygonC.animationSettings.motionPathPoints = myMotionPathPoints;</div>
<div class="line">    var myTimingSettings = myPage.parent.timingSettings;</div>
<div class="line">    <span class="comment">//Remove the default timing list.</span></div>
<div class="line">    myTimingSettings.timingLists.item(0).remove();</div>
<div class="line">    <span class="comment">//Add a new timing list that triggers when the page is clicked.</span></div>
<div class="line">    var myTimingList = myTimingSettings.timingLists.add(DynamicTriggerEvents.onPageClick);</div>
<div class="line">    <span class="comment">//Add the polygons to a single timing group.</span></div>
<div class="line">    var myTimingGroup = myTimingList.timingGroups.add(myPolygonA, 0);</div>
<div class="line">    myTimingGroup.timingTargets.add(myPolygonB, 2);</div>
<div class="line">    myTimingGroup.timingTargets.add(myPolygonC, 2);</div>
</div><!-- fragment --><p> Note that attempting to add a page item whose hasCustomSettings property (in the animationSettings object of the page item) is false to a timingTarget generates an error.</p>
<p>The following script fragment shows how to control the sequence of animations applied to objects on a page (for the complete script, refer to MultipleTimingGroups). Note that the order in which timingGroups are added to a timingList determines the order in which the animations play when the trigger event specified in the timingList occurs. Some trigger events, such as DynamicTriggerEvents.onPageLoad, trigger the animations in the timingList (in sequence); others, such as DynamicTriggerEvents.onPageClick, trigger the animations one by one, in sequence, with each instance of the event. For example, a timingList containing five timingGroups, each containing a single timingTarget, and having the trigger event DynamicTriggerEvents.onPageClick requires five mouse clicks to process all the animations. </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a document &quot;myDocument&quot; and a page &quot;myPage&quot; and the color &quot;myColorA&quot;,</span></div>
<div class="line">    <span class="comment">//&quot;myColorB&quot;, and &quot;myColorC&quot;...</span></div>
<div class="line">    <span class="comment">//Add a page items to animate.</span></div>
<div class="line">    var myPolygonA = myPage.polygons.add({fillColor:myColorA, strokeColor:myDocument.swatches.item(<span class="stringliteral">&quot;None&quot;</span>)});</div>
<div class="line">    myPolygonA.paths.item(0).entirePath = [[72, 72], [72, 144], [144, 108]];</div>
<div class="line">    var myPolygonB = myPage.polygons.add({fillColor:myColorB, strokeColor:myDocument.swatches.item(<span class="stringliteral">&quot;None&quot;</span>)});</div>
<div class="line">    myPolygonB.paths.item(0).entirePath = [[72, 72], [72, 144], [144, 108]];</div>
<div class="line">    var myPolygonC = myPage.polygons.add({fillColor:myColorC, strokeColor:myDocument.swatches.item(<span class="stringliteral">&quot;None&quot;</span>)});</div>
<div class="line">    myPolygonC.paths.item(0).entirePath = [[72, 72], [72, 144], [144, 108]];</div>
<div class="line">    var myPolygonD = myPage.polygons.add({fillColor:myColorA, strokeColor:myDocument.swatches.item(<span class="stringliteral">&quot;None&quot;</span>)});</div>
<div class="line">    myPolygonD.paths.item(0).entirePath = [[72, 144], [72, 216], [144, 180]];</div>
<div class="line">    var myPolygonE = myPage.polygons.add({fillColor:myColorB, strokeColor:myDocument.swatches.item(<span class="stringliteral">&quot;None&quot;</span>)});</div>
<div class="line">    myPolygonE.paths.item(0).entirePath = [[72, 144], [72, 216], [144, 180]]</div>
<div class="line">    var myPolygonF = myPage.polygons.add({fillColor:myColorC, strokeColor:myDocument.swatches.item(<span class="stringliteral">&quot;None&quot;</span>)});</div>
<div class="line">    myPolygonF.paths.item(0).entirePath = [[72, 144], [72, 216], [144, 180]];</div>
<div class="line">    <span class="comment">//Create a motion path.</span></div>
<div class="line">    var myMotionPathPointsA = [[[[108,108],[108,108],[108,108]],[[516, 108],[516, 108],[516, 108]]],<span class="keyword">true</span>];</div>
<div class="line">    var myMotionPathPointsB = [[[[108,180],[108,180],[108,180]],[[516, 180],[516, 180],[516, 180]]],<span class="keyword">true</span>];</div>
<div class="line">    <span class="comment">//Set animation preferences for the polygons. </span></div>
<div class="line">    <span class="comment">//DynamicTriggerEvents.onPageLoad (the default).</span></div>
<div class="line">    myPolygonA.animationSettings.duration = 2;</div>
<div class="line">    myPolygonA.animationSettings.motionPathPoints = myMotionPathPointsA;</div>
<div class="line">    myPolygonB.animationSettings.duration = 2;</div>
<div class="line">    myPolygonB.animationSettings.motionPathPoints = myMotionPathPointsA;</div>
<div class="line">    myPolygonC.animationSettings.duration = 2;</div>
<div class="line">    myPolygonC.animationSettings.motionPathPoints = myMotionPathPointsA;</div>
<div class="line">    myPolygonD.animationSettings.duration = 2;</div>
<div class="line">    myPolygonD.animationSettings.motionPathPoints = myMotionPathPointsB;</div>
<div class="line">    myPolygonE.animationSettings.duration = 2;</div>
<div class="line">    myPolygonE.animationSettings.motionPathPoints = myMotionPathPointsB;</div>
<div class="line">    myPolygonF.animationSettings.duration = 2;</div>
<div class="line">    myPolygonF.animationSettings.motionPathPoints = myMotionPathPointsB;</div>
<div class="line">    var myTimingSettings = myPage.parent.timingSettings;</div>
<div class="line">    <span class="comment">//Remove the default timing list.</span></div>
<div class="line">    myTimingSettings.timingLists.item(0).remove();</div>
<div class="line">    <span class="comment">//Add a new timing list that triggers when the page is clicked.</span></div>
<div class="line">    var myTimingList = myTimingSettings.timingLists.add(DynamicTriggerEvents.onPageClick);</div>
<div class="line">    <span class="comment">//Add the polygons to a single timing group.</span></div>
<div class="line">    var myTimingGroupA = myTimingList.timingGroups.add(myPolygonA, 0);</div>
<div class="line">    myTimingGroupA.timingTargets.add(myPolygonB, 2);</div>
<div class="line">    myTimingGroupA.timingTargets.add(myPolygonC, 2);</div>
<div class="line">    <span class="comment">//myTimingGroupB will play on the second page click.</span></div>
<div class="line">    var myTimingGroupB = myTimingList.timingGroups.add(myPolygonD, 0);</div>
<div class="line">    myTimingGroupB.timingTargets.add(myPolygonE, 2);</div>
<div class="line">    myTimingGroupB.timingTargets.add(myPolygonF, 2);</div>
</div><!-- fragment --><p> A given timingSettings object can contain multiple timingList objects, each of which responds to a different trigger event. The following script fragment shows a series of animations triggered by DynamicTriggerEvents.onPageLoad, by DynamicTriggerEvents.onPageClick (for the complete script, refer to MultipleTimingLists). </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a document &quot;myDocument&quot; and a page &quot;myPage&quot; containg 6 polygons: </span></div>
<div class="line">    <span class="comment">//&quot;myPolygonA&quot;, &quot;myPolygonB&quot;, &quot;myPolygonC&quot;, &quot;myPolygonD&quot;, &quot;myPolygonE&quot;, &quot;myPolygonF&quot;. </span></div>
<div class="line">    <span class="comment">//Add a page items to animate.</span></div>
<div class="line">    var myTimingSettings = myPage.parent.timingSettings;</div>
<div class="line">    <span class="comment">//At this point, all of the polygons have already been added as timing targets</span></div>
<div class="line">    <span class="comment">//of the default timing list. Change the delay of myPolygonB and myPolygonC,</span></div>
<div class="line">    <span class="comment">//which are the targets of the second and third timing groups (item(1) and item(2)).</span></div>
<div class="line">    var myTimingListA = myTimingSettings.timingLists.item(0);</div>
<div class="line">    var myTimingGroup = myTimingListA.timingGroups.item(1);</div>
<div class="line">    myTimingGroup.timingTargets.item(0).delaySeconds = 2;</div>
<div class="line">    myTimingGroup = myTimingListA.timingGroups.item(2);</div>
<div class="line">    myTimingGroup.timingTargets.item(0).delaySeconds = 2;</div>
<div class="line">    <span class="comment">//Remove the last three timing groups in the timing list.</span></div>
<div class="line">    <span class="comment">//We have to do this, because we don&#39;t want these polygons to be</span></div>
<div class="line">    <span class="comment">//animated when the page loads.</span></div>
<div class="line">    myTimingListA.timingGroups.item(-1).remove();</div>
<div class="line">    myTimingListA.timingGroups.item(-1).remove();</div>
<div class="line">    myTimingListA.timingGroups.item(-1).remove();   </div>
<div class="line">    <span class="comment">//Add a new timing list that triggers when the page is clicked.</span></div>
<div class="line">    var myTimingListB = myTimingSettings.timingLists.add(DynamicTriggerEvents.onPageClick);</div>
<div class="line">    var myTimingGroupB = myTimingListB.timingGroups.add(myPolygonD, 0);</div>
<div class="line">    myTimingGroupB.timingTargets.add(myPolygonE, 2);</div>
<div class="line">    myTimingGroupB.timingTargets.add(myPolygonF, 2);</div>
</div><!-- fragment --><p> In the previous examples, we've worked with the timingSettings of the spread containing the page items we want to animate. When you want to animate a page item when a user clicks the item, you'll need to use the timingSettings of the page item itself, as shown in the following script fragment (for the complete script, refer to PageItemTimingSettings). </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a document &quot;myDocument&quot; and a page &quot;myPage&quot; containg a polygon &quot;myPolygonA&quot;...</span></div>
<div class="line">    <span class="comment">//Remove the default timing list in the timing settings for the spread.</span></div>
<div class="line">    <span class="comment">//Set animation preferences for the polygon. </span></div>
<div class="line">    myPolygonA.animationSettings.duration = 2;</div>
<div class="line">    myPolygonA.animationSettings.motionPathPoints = myMotionPathPointsA;    </div>
<div class="line">    myPage.parent.timingSettings.timingLists.item(0).remove();</div>
<div class="line">    var myTimingSettings = myPolygonA.timingSettings;</div>
<div class="line">    var myTimingList = myTimingSettings.timingLists.add(DynamicTriggerEvents.onClick);</div>
<div class="line">    var myTimingGroup = myTimingList.timingGroups.add(myPolygonA, 0);</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_animating_transformations"></a>
Animating transformations</h3>
<p>Page items can change size, rotation or skewing angles, opacity, and visibility as their animation plays. The animationSettings of the page item contain properties (such as rotationArray or hiddenAfter) that define the transformations that are applied during animation. The following script fragment shows how to make a page item rotate as it follows a motion path (for the complete script, refer to AnimateRotation). </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a document &quot;myDocument&quot; and a page &quot;myPage&quot; and the color &quot;myColorA&quot;...</span></div>
<div class="line">    <span class="comment">//Add a page items to animate.</span></div>
<div class="line">    var myPolygonA = myPage.polygons.add({fillColor:myColorA, strokeColor:myDocument.swatches.item(<span class="stringliteral">&quot;None&quot;</span>)});</div>
<div class="line">    myPolygonA.paths.item(0).entirePath = [[72, 72], [72, 144], [144, 108]];</div>
<div class="line">    <span class="comment">//Create a motion path.</span></div>
<div class="line">    var myMotionPathPoints = [[[[108,108],[108,108],[108,108]],[[516, 108],[516, 108],[516, 108]]],<span class="keyword">true</span>];</div>
<div class="line">    <span class="comment">//Set animation preferences for the polygon.</span></div>
<div class="line">    myPolygonA.animationSettings.duration = 2;</div>
<div class="line">    myPolygonA.animationSettings.motionPathPoints = myMotionPathPoints;</div>
<div class="line">    <span class="comment">//Assuming 24 Frames Per Second (FPS)</span></div>
<div class="line">    <span class="comment">//23 = 1 second, 47 = 2 seconds, 71 = 3 seconds, 95 = 4 seconds, 119 = 5 seconds, 143 = 6 seconds</span></div>
<div class="line">    <span class="comment">//Since the duration of our animation is 2 seconds, the following line will</span></div>
<div class="line">    <span class="comment">//make the polygon rotate 360 degrees from the start to the end</span></div>
<div class="line">    <span class="comment">//of the animation.</span></div>
<div class="line">    myPolygonA.animationSettings.rotationArray = [[0, 0], [47, 360]];</div>
<div class="line">    var myTimingSettings = myPage.parent.timingSettings;</div>
<div class="line">    <span class="comment">//Remove the default timing list.</span></div>
<div class="line">    myTimingSettings.timingLists.item(0).remove();</div>
<div class="line">    <span class="comment">//Add a new timing list that triggers when the page is clicked.</span></div>
<div class="line">    var myTimingList = myTimingSettings.timingLists.add(DynamicTriggerEvents.onPageClick);</div>
<div class="line">    <span class="comment">//Add the polygons to a single timing group.</span></div>
<div class="line">    var myTimingGroup = myTimingList.timingGroups.add(myPolygonA, 0);</div>
</div><!-- fragment --><p> Scripting offers more control over animation than can be achieved with InDesign's user interface. A scripted animation can, for example, apply transformations at each key frame of a given motion path. For more on this topic, see <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_key_frames">Key frames</a> later in this section.</p>
<h3><a class="anchor" id="id_js_motion_presets"></a>
Motion presets</h3>
<p>In the preceding examples, we've constructed motion paths and specified animation settings as if we were creating animations from the basic level in InDesign's user interface. But InDesign can also use motion presets to define the animation of page items in a layout. A motion preset can apply a number of animation properties at once, as seen in the following script fragment (for the complete script, refer to MotionPreset). InDesign comes with a large number of motion presets, and you can add new presets using either the user interface or scripting. </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a page containing the ovals &quot;myOvalA&quot;... </span></div>
<div class="line">    var myMotionPreset = app.motionPresets.item(<span class="stringliteral">&quot;move-right-grow&quot;</span>);</div>
<div class="line">    myOvalA.animationSettings.duration = 2;</div>
<div class="line">    myOvalA.animationSettings.playsLoop = <span class="keyword">true</span>;</div>
<div class="line">    myOvalA.animationSettings.preset = myMotionPreset;</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_design_options"></a>
Design options</h3>
<p>Design options affect the way that an animated object appears, relative to the motion specified in the object's animation settings. The following script fragment shows how the design options for an animated shape can affect the playback of the animation (for the complete script, refer to DesignOptions). </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a page containing the ovals &quot;myOvalA&quot; and &quot;myOvalB&quot;... </span></div>
<div class="line">    var myMotionPreset = app.motionPresets.item(<span class="stringliteral">&quot;move-right-grow&quot;</span>);</div>
<div class="line">    myOvalA.animationSettings.duration = 2;</div>
<div class="line">    myOvalA.animationSettings.playsLoop = <span class="keyword">true</span>;</div>
<div class="line">    myOvalA.animationSettings.preset = myMotionPreset;</div>
<div class="line">    myOvalA.animationSettings.designOption = DesignOptions.fromCurrentAppearance;</div>
<div class="line">    myOvalB.animationSettings.duration = 2;</div>
<div class="line">    myOvalB.animationSettings.playsLoop = <span class="keyword">true</span>;</div>
<div class="line">    myOvalB.animationSettings.preset = myMotionPreset;</div>
<div class="line">    myOvalB.animationSettings.designOption = DesignOptions.toCurrentAppearance;</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_key_frames"></a>
Key frames</h3>
<p>Key frames are points in the timeline of an animation. With InDesign scripting, you can add key frames at any time in the animation, which gives you the ability to apply changes to objects as they are animated. Key frames are part of the motion path applied to an animated page item, and are specified relative to the duration and speed of the animation. For example, for an animation with a duration of two seconds, playing at 24 frames per second, the last frame in the animation is frame 48.</p>
<p>The following script fragment shows how to add key frames to a motion path, and how to change the transformations applied to an animated page item at each key frame. For the complete script, refer to TransformAnimation. </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a page containing ovals &quot;myOvalA,&quot; &quot;myOvalB,&quot; and &quot;myOvalC&quot;... </span></div>
<div class="line">    <span class="comment">//The motion path is constructed relative to the center of the object, and key frames</span></div>
<div class="line">    <span class="comment">//are based on the duration of the animation divided by the number of frames per second</span></div>
<div class="line">    <span class="comment">//(usually 24). The following array sets key frames at the start, midpoint, and end</span></div>
<div class="line">    <span class="comment">//of a path.</span></div>
<div class="line">    var myMotionPath = [[0,[[0,0], [0,0], [0,0]]], [23,[[234,0], [234,0], [234,0]]], [47,[[468,0], [468,0], [468,0]]]];</div>
<div class="line">    myOvalA.animationSettings.duration = 2;</div>
<div class="line">    myOvalA.animationSettings.motionPath = myMotionPath;</div>
<div class="line">    <span class="comment">//The transformation changes at each key frame.</span></div>
<div class="line">    <span class="comment">//scaleXArray in the form [[keyframe, scale_percentage], [keyframe, scalePercentage], ...]</span></div>
<div class="line">    myOvalA.animationSettings.scaleXArray = [[0, 100], [23,200], [47, 100]];</div>
<div class="line">    <span class="comment">//scaleYArray in the form [[keyframe, scale_percentage], [keyframe, scalePercentage], ...]</span></div>
<div class="line">    myOvalA.animationSettings.scaleYArray = [[0, 100], [23,200], [47, 100]];</div>
<div class="line">    <span class="comment">//opacityArray in the form [[keyframe, opacity], [keyframe, opacity],...];</span></div>
<div class="line">    myOvalA.animationSettings.opacityArray = [[0, 100], [23, 20], [47, 100]];</div>
<div class="line">    myOvalA.animationSettings.playsLoop = <span class="keyword">true</span>;</div>
<div class="line">    myOvalB.animationSettings.duration = 2;</div>
<div class="line">    myOvalB.animationSettings.motionPath = myMotionPath;</div>
<div class="line">    myOvalB.animationSettings.scaleXArray = [[0, 200], [23,300], [47, 50]];</div>
<div class="line">    myOvalB.animationSettings.scaleYArray = [[0, 200], [23,300], [47, 50]];</div>
<div class="line">    myOvalB.animationSettings.opacityArray = [[0, 10], [23, 80], [47, 60]];</div>
<div class="line">    myOvalB.animationSettings.playsLoop = <span class="keyword">true</span>;</div>
<div class="line">    myOvalC.animationSettings.duration = 2;</div>
<div class="line">    myOvalC.animationSettings.motionPath = myMotionPath;</div>
<div class="line">    myOvalC.animationSettings.scaleXArray = [[0, 50], [23,200], [47, 400]];</div>
<div class="line">    myOvalC.animationSettings.scaleYArray = [[0, 50], [23,200], [47, 400]];</div>
<div class="line">    myOvalC.animationSettings.opacityArray = [[0, 100], [23, 40], [47, 80]];</div>
<div class="line">    myOvalC.animationSettings.playsLoop = <span class="keyword">true</span>;</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_adding_page_transitions"></a>
Adding Page Transitions</h2>
<p>Page transitions are special effects that appear when you change pages in an exported dynamic document. Adding page transitions using scripting is easy, as shown in the following script fragment (for the complete script, refer to PageTransitions). </p>
<div class="fragment"><div class="line">    <span class="comment">//Given a document &quot;myDocument&quot; containing at least two spreads...</span></div>
<div class="line">    <span class="keywordflow">for</span>(var myCounter = 0; myCounter &lt; myDocument.spreads.length; myCounter++){</div>
<div class="line">        myDocument.spreads.item(myCounter).pageTransitionType = PageTransitionTypeOptions.pageTurnTransition;</div>
<div class="line">        <span class="comment">//This page transition option does not support the pageTransitionDirection or pageTransitionDuration</span></div>
<div class="line">        <span class="comment">//properties. If you chose PageTransitionTypeOptions.wipeTransition (for example), you would be </span></div>
<div class="line">        <span class="comment">//able to set those options, as shown in the next two lines:</span></div>
<div class="line">        <span class="comment">//myDocument.spreads.item(myCounter).pageTransitionDirection = PageTransitionDirectionOptions.leftToRight;</span></div>
<div class="line">        <span class="comment">//myDocument.spreads.item(myCounter).pageTransitionDuration = PageTransitionDurationOptions.medium;</span></div>
<div class="line">    }</div>
</div><!-- fragment --> <h1><a class="anchor" id="id_js_xml"></a>
XML</h1>
<p>Extensible Markup Language, or XML, is a text-based mark-up system created and managed by the World Wide Web Consortium (<a href="http://www.w3c.org">http://www.w3c.org </a>). Like Hypertext Markup Language (HTML), XML uses angle brackets to indicate markup tags (for example, &lt;article&gt; or &lt;para&gt;). While HTML has a predefined set of tags, XML allows you to describe content more precisely by creating custom tags.</p>
<p>Because of its flexibility, XML increasingly is used as a format for storing data. InDesign includes a complete set of features for importing XML data into page layouts, and these features can be controlled using scripting.</p>
<p>We assume that you have already read Adobe InDesign Scripting Tutorial and know how to create and run a script. We also assume that you have some knowledge of XML, DTDs, and XSLT.</p>
<h2><a class="anchor" id="id_js_overview"></a>
Overview</h2>
<p>Because XML is entirely concerned with content and explicitly not concerned with formatting, making XML work in a page-layout context is challenging. InDesign's approach to XML is quite complete and flexible, but it has a few limitations:</p>
<ul>
<li>Once XML elements are imported into an InDesign document, they become InDesign elements that correspond to the XML structure. The InDesign representations of the XML elements are not the same thing as the XML elements themselves.</li>
<li>Each XML element can appear only once in a layout. If you want to duplicate the information of the XML element in the layout, you must duplicate the XML element itself.</li>
<li>The order in which XML elements appear in a layout largely depends on the order in which they appear in the XML structure.</li>
<li>Any text that appears in a story associated with an XML element becomes part of that element's data.</li>
</ul>
<h2><a class="anchor" id="id_js_the_best_approach_to_scripting_xml_in_indesign"></a>
The Best Approach to Scripting XML in InDesign</h2>
<p>You might want to do most of the work on an XML file outside InDesign, before you import the file into an InDesign layout. Working with XML outside InDesign, you can use a wide variety of excellent tools, such as XML editors and parsers.</p>
<p>When you need to rearrange or duplicate elements in a large XML data structure, the best approach is to transform the XML using XSLT. You can do this as you import the XML file.</p>
<p>If the XML data is already formatted in an InDesign document, you probably will want to use XML rules if you are doing more than the simplest of operations. XML rules can search the XML structure in a document and process matching XML elements much faster than a script that does not use XML rules.</p>
<p>For more on working with XML rules, see <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_xml_rules">XML Rules.</a></p>
<h2><a class="anchor" id="id_js_scripting_xml_elements"></a>
Scripting XML Elements</h2>
<p>This section shows how to set XML preferences and XML import preferences, import XML, create XML elements, and add XML attributes. The scripts in this section demonstrate techniques for working with the XML content itself; for scripts that apply formatting to XML elements, see <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_adding_xml_elements_to_a_layout">Adding XML Elements to a Layout</a>.</p>
<h3><a class="anchor" id="id_js_setting_xml_preferences"></a>
Setting XML preferences</h3>
<p>You can control the appearance of the InDesign structure panel using the XML view-preferences object, as shown in the following script fragment (from the XMLViewPreferences tutorial script): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myXMLViewPreferences = myDocument.xmlViewPreferences;</div>
<div class="line">    myXMLViewPreferences.showAttributes = <span class="keyword">true</span>;</div>
<div class="line">    myXMLViewPreferences.showStructure = <span class="keyword">true</span>;</div>
<div class="line">    myXMLViewPreferences.showTaggedFrames = <span class="keyword">true</span>;</div>
<div class="line">    myXMLViewPreferences.showTagMarkers = <span class="keyword">true</span>;</div>
<div class="line">    myXMLViewPreferences.showTextSnippets = <span class="keyword">true</span>;</div>
</div><!-- fragment --><p> You also can specify XML tagging preset preferences (the default tag names and user-interface colors for tables and stories) using the XML preferences object., as shown in the following script fragment (from the XMLPreferences tutorial script): </p>
<div class="fragment"><div class="line">    var myDocument = app.activeDocument;</div>
<div class="line">    var myXMLPreferences = myDocument.xmlPreferences;</div>
<div class="line">    myXMLPreferences.defaultCellTagColor = UIColors.blue;</div>
<div class="line">    myXMLPreferences.defaultCellTagName = <span class="stringliteral">&quot;cell&quot;</span>;</div>
<div class="line">    myXMLPreferences.defaultImageTagColor = UIColors.brickRed;</div>
<div class="line">    myXMLPreferences.defaultImageTagName = <span class="stringliteral">&quot;image&quot;</span>;</div>
<div class="line">    myXMLPreferences.defaultStoryTagColor = UIColors.charcoal;</div>
<div class="line">    myXMLPreferences.defaultStoryTagName = <span class="stringliteral">&quot;text&quot;</span>;</div>
<div class="line">    myXMLPreferences.defaultTableTagColor = UIColors.cuteTeal;</div>
<div class="line">    myXMLPreferences.defaultTableTagName = <span class="stringliteral">&quot;table&quot;</span>;</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_setting_xml_import_preferences"></a>
Setting XML import preferences</h3>
<p>Before importing an XML file, you can set XML import preferences that can apply an XSLT transform, govern the way white space in the XML file is handled, or create repeating text elements. You do this using the XML import-preferences object, as shown in the following script fragment (from the XMLImportPreferences tutorial script): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myXMLImportPreferences = myDocument.xmlImportPreferences;</div>
<div class="line">    myXMLImportPreferences.allowTransform = <span class="keyword">false</span>;</div>
<div class="line">    myXMLImportPreferences.createLinkToXML = <span class="keyword">false</span>;</div>
<div class="line">    myXMLImportPreferences.ignoreUnmatchedIncoming = <span class="keyword">true</span>;</div>
<div class="line">    myXMLImportPreferences.ignoreWhitespace = <span class="keyword">true</span>;</div>
<div class="line">    myXMLImportPreferences.importCALSTables = <span class="keyword">true</span>;</div>
<div class="line">    myXMLImportPreferences.importStyle = XMLImportStyles.mergeImport;</div>
<div class="line">    myXMLImportPreferences.importTextIntoTables = <span class="keyword">false</span>;</div>
<div class="line">    myXMLImportPreferences.importToSelected = <span class="keyword">false</span>;</div>
<div class="line">    myXMLImportPreferences.removeUnmatchedExisting = <span class="keyword">false</span>;</div>
<div class="line">    myXMLImportPreferences.repeatTextElements = <span class="keyword">true</span>;</div>
<div class="line">    <span class="comment">//The following properties are only used when the</span></div>
<div class="line">    <span class="comment">//AllowTransform property is set to True.</span></div>
<div class="line">    <span class="comment">//myXMLImportPreferences.transformFilename = &quot;c:\myTransform.xsl&quot;</span></div>
<div class="line">    <span class="comment">//If you have defined parameters in your XSL file, then you can pass</span></div>
<div class="line">    <span class="comment">//parameters to the file during the XML import process. For each parameter,</span></div>
<div class="line">    <span class="comment">//enter an array containing two strings. The first string is the name of the</span></div>
<div class="line">    <span class="comment">//parameter, the second is the value of the parameter.</span></div>
<div class="line">    <span class="comment">//myXMLImportPreferences.transformParameters = [[&quot;format&quot;, &quot;1&quot;]];</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_importing_xml"></a>
Importing XML</h3>
<p>Once you set the XML import preferences the way you want them, you can import an XML file, as shown in the following script fragment (from the ImportXML tutorial script): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    myDocument.xmlElements.item(0).importXML(File(Folder.desktop + <span class="stringliteral">&quot;/test.xml&quot;</span>));</div>
</div><!-- fragment --><p> When you need to import the contents of an XML file into a specific XML element, use the importXML method of the XML element, rather than the corresponding method of the document. See the following script fragment (from the ImportXMLIntoElement tutorial script): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myPage = app.activeWindow.activePage;</div>
<div class="line">    myDocument.importXML(File(Folder.desktop + <span class="stringliteral">&quot;/test.xml&quot;</span>));</div>
<div class="line">    var myRootXMLElement = myDocument.xmlElements.item(0);</div>
<div class="line">    var myLastXMLElement = myRootXMLElement.xmlElements.item(-1);</div>
<div class="line">    <span class="comment">//Select the XML element</span></div>
<div class="line">    myDocument.select(myLastXMLElement, SelectionOptions.replaceWith);</div>
<div class="line">    myDocument.xmlImportPreferences.importToSelected = <span class="keyword">true</span>;</div>
<div class="line">    myDocument.importXML(File(Folder.desktop + <span class="stringliteral">&quot;/test.xml&quot;</span>));</div>
</div><!-- fragment --><p> You also can set the importToSelected property of the xmlImportPreferences object to true, then select the XML element, and then import the XML file, as shown in the following script fragment (from the ImportXMLIntoSelectedElement tutorial script): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myXMLTag = myDocument.xmlTags.item(<span class="stringliteral">&quot;xml_element&quot;</span>);</div>
<div class="line">    var myXMLElement = myDocument.xmlElements.item(0).xmlElements.add(myXMLTag);</div>
<div class="line">    myDocument.select(myXMLElement);</div>
<div class="line">    myDocument.xmlImportPreferences.importToSelected = <span class="keyword">true</span>;</div>
<div class="line">    <span class="comment">//Import into the selected XML element.</span></div>
<div class="line">    myDocument.importXML(File(Folder.desktop + <span class="stringliteral">&quot;/test.xml&quot;</span>));</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_creating_an_xml_tag"></a>
Creating an XML tag</h3>
<p>XML tags are the names of the XML elements you want to create in a document. When you import XML, the element names in the XML file are added to the list of XML tags in the document. You also can create XML tags directly, as shown in the following script fragment (from the MakeXMLTags tutorial script): </p>
<div class="fragment"><div class="line">    <span class="comment">//Access the active document and page.</span></div>
<div class="line">    var myDocument = app.activeDocument;</div>
<div class="line">    var myPage = app.activeWindow.activePage;</div>
<div class="line">    <span class="comment">//You can create an XML tag without specifying a color for the tag.</span></div>
<div class="line">    var myXMLTagA = myDocument.xmlTags.add(<span class="stringliteral">&quot;XML_tag_A&quot;</span>);</div>
<div class="line">    <span class="comment">//You can define the highlight color of the XML tag using the UIColors enumeration...</span></div>
<div class="line">    var myXMLTagB = myDocument.xmlTags.add(<span class="stringliteral">&quot;XML_tag_B&quot;</span>, UIColors.gray);</div>
<div class="line">    <span class="comment">//...or you can provide an RGB array to set the color of the tag.</span></div>
<div class="line">    var myXMLTagC = myDocument.xmlTags.add(<span class="stringliteral">&quot;XML_tag_C&quot;</span>, [0, 92, 128]);</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_loading_xml_tags"></a>
Loading XML tags</h3>
<p>You can import XML tags from an XML file without importing the XML contents of the file. You might want to do this to work out a tag-to-style or style-to-tag mapping before you import the XML data., as shown in the following script fragment (from the LoadXMLTags tutorial script): </p>
<div class="fragment"><div class="line">    myDocument.loadXMLTags (File(Folder.desktop + <span class="stringliteral">&quot;/xml_tags.indd&quot;</span>));</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_saving_xml_tags"></a>
Saving XML tags</h3>
<p>Just as you can load XML tags from a file, you can save XML tags to a file, as shown in the following script. When you do this, only the tags themselves are saved in the XML file; document data is not included. As you would expect, this process is much faster than exporting XML, and the resulting file is much smaller. The following sample script shows how to save XML tags (for the complete script, see SaveXMLTags): </p>
<div class="fragment"><div class="line">    <span class="comment">//You&#39;ll have to fill in a valid file path for your system.</span></div>
<div class="line">    myDocument.saveXMLTags(File(Folder.desktop + <span class="stringliteral">&quot;/xml_tags.xml&quot;</span>));</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_creating_an_xml_element"></a>
Creating an XML element</h3>
<p>Ordinarily, you create XML elements by importing an XML file, but you also can create an XML element using InDesign scripting, as shown in the following script fragment (from the CreateXMLElement tutorial script): </p>
<div class="fragment"><div class="line">    <span class="comment">//Access the active document.</span></div>
<div class="line">    var myDocument = app.activeDocument;</div>
<div class="line">    var myXMLTagA = myDocument.xmlTags.add(<span class="stringliteral">&quot;XML_tag_A&quot;</span>);</div>
<div class="line">    var myXMLElementA = myDocument.xmlElements.item(0).xmlElements.add(myXMLTagA);</div>
<div class="line">    myXMLElementA.contents = <span class="stringliteral">&quot;This is an XML element containing text.&quot;</span>;</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_moving_an_xml_element"></a>
Moving an XML element</h3>
<p>You can move XML elements within the XML structure using the move method, as shown in the following script fragment (from the MoveXMLElement tutorial script): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myRootXMLElement = myDocument.xmlElements.item(0);</div>
<div class="line">    <span class="comment">//Move the XML element containing &quot;A&quot; to after the XML element cotnainign &quot;C&quot;</span></div>
<div class="line">    var myXMLElementA = myRootXMLElement.xmlElements.item(0);</div>
<div class="line">    myXMLElementA.move(LocationOptions.after, myRootXMLElement.xmlElements.item(2));</div>
<div class="line">    <span class="comment">//Move the XML element containing &quot;D&quot; to the beginning of its parent.</span></div>
<div class="line">    myRootXMLElement.xmlElements.item(-1).move(LocationOptions.atBeginning);</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_deleting_an_xml_element"></a>
Deleting an XML element</h3>
<p>Deleting an XML element removes it from both the layout and the XML structure, as shown in the following script fragment (from the DeleteXMLElement tutorial script). </p>
<div class="fragment"><div class="line">    <span class="comment">//Delete the XML element containing &quot;A&quot;</span></div>
<div class="line">    myRootXMLElement.xmlElements.item(0).remove();</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_duplicating_an_xml_element"></a>
Duplicating an XML element</h3>
<p>When you duplicate an XML element, the new XML element appears immediately after the original XML element in the XML structure, as shown in the following script fragment (from the DuplicateXMLElement tutorial script): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myRootXMLElement = myDocument.xmlElements.item(0);</div>
<div class="line">    <span class="comment">//Duplicate the XML element containing &quot;A&quot;</span></div>
<div class="line">    var myNewXMLElement = myRootXMLElement.xmlElements.item(0).duplicate();</div>
<div class="line">    <span class="comment">//Change the content of the duplicated XML element.</span></div>
<div class="line">    myNewXMLElement.contents = myNewXMLElement.contents + <span class="stringliteral">&quot; duplicate&quot;</span>;</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_removing_items_from_the_xml_structure"></a>
Removing items from the XML structure</h3>
<p>To break the association between a page item or text and an XML element, use the untag method, as shown in the following script. The objects are not deleted, but they are no longer tied to an XML element (which is deleted). Any content of the deleted XML element becomes associated with the parent XML element. If the XML element is the root XML element, any layout objects (text or page items) associated with the XML element remain in the document. (For the complete script, see UntagXMLElement.) </p>
<div class="fragment"><div class="line">    var myXMLElement = myDocument.xmlElements.item(0).xmlElements.item(0);</div>
<div class="line">    myXMLElement.untag();</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_creating_an_xml_comment"></a>
Creating an XML comment</h3>
<p>XML comments are used to make notes in XML data structures. You can add an XML comment using something like the following script fragment (from the MakeXMLComment tutorial script): </p>
<div class="fragment"><div class="line">    var myRootXMLElement = myDocument.xmlElements.item(0);</div>
<div class="line">    var myXMLElementB = myRootXMLElement.xmlElements.item(1);</div>
<div class="line">    myXMLElementB.xmlComments.add(<span class="stringliteral">&quot;This is an XML comment. It will not appear in the layout!&quot;</span>);</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_creating_an_xml_processing_instruction"></a>
Creating an XML processing instruction</h3>
<p>A processing instruction (PI) is an XML element that contains directions for the application reading the XML document. XML processing instructions are ignored by InDesign but can be inserted in an InDesign XML structure for export to other applications. An XML document can contain multiple processing instructions.</p>
<p>An XML processing instruction has two parts, target and value. The following is an example: </p>
<div class="fragment"><div class="line">&lt;?xml-stylesheet type=<span class="stringliteral">&quot;text/css&quot;</span> href=<span class="stringliteral">&quot;generic.css&quot;</span>?&gt;</div>
</div><!-- fragment --><p>The following script fragment shows how to add an XML processing instruction (for the complete script, see MakeProcessingInstruction): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myRootXMLElement = myDocument.xmlElements.item(0);</div>
<div class="line">    var myXMLProcessingInstruction = myRootXMLElement.xmlInstructions.add(<span class="stringliteral">&quot;xml-stylesheet type=\&quot;text/css\&quot; &quot;</span>, <span class="stringliteral">&quot;href=\&quot;generic.css\&quot;&quot;</span>); </div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_working_with_xml_attributes"></a>
Working with XML attributes</h3>
<p>XML attributes are "metadata" that can be associated with an XML element. To add an XML attribute to an XML element, use something like the following script fragment (from the MakeXMLAttribute tutorial script). An XML element can have any number of XML attributes, but each attribute name must be unique within the element (that is, you cannot have two attributes named "id"). </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myRootXMLElement = myDocument.xmlElements.item(0);</div>
<div class="line">    var myXMLElementB = myRootXMLElement.xmlElements.item(1);</div>
<div class="line">    myXMLElementB.xmlAttributes.add(<span class="stringliteral">&quot;example_attribute&quot;</span>, <span class="stringliteral">&quot;This is an XML attribute. It will not appear in the layout!&quot;</span>);</div>
</div><!-- fragment --><p> In addition to creating attributes directly using scripting, you can convert XML elements to attributes. When you do this, the text contents of the XML element become the value of an XML attribute added to the parent of the XML element. Because the name of the XML element becomes the name of the attribute, this method can fail when an attribute with that name already exists in the parent of the XML element. If the XML element contains page items, those page items are deleted from the layout.</p>
<p>When you convert an XML attribute to an XML element, you can specify the location where the new XML element is added. The new XML element can be added to the beginning or end of the parent of the XML attribute. By default, the new element is added at the beginning of the parent element.</p>
<p>You also can specify am XML mark-up tag for the new XML element. If you omit this parameter, the new XML element is created with the same XML tag as XML element containing the XML attribute.</p>
<p>The following script shows how to convert an XML element to an XML attribute (for the complete script, see ConvertElementToAttribute): </p>
<div class="fragment"><div class="line">    var myRootXMLElement = myDocument.xmlElements.item(0);</div>
<div class="line">    myRootXMLElement.xmlElements.item(-1).convertToAttribute();</div>
</div><!-- fragment --><p> You also can convert an XML attribute to an XML element, as shown in the following script fragment (from the ConvertAttributeToElement tutorial script): </p>
<div class="fragment"><div class="line">    var myDocument = app.activeDocument;</div>
<div class="line">    var myRootXMLElement = myDocument.xmlElements.item(0);</div>
<div class="line">    var myXMLElementB = myRootXMLElement.xmlElements.item(1);</div>
<div class="line">    myXMLElementB.xmlAttributes.item(0).convertToElement(XMLElementLocation.elementEnd, myDocument.xmlTags.item(<span class="stringliteral">&quot;xml_element&quot;</span>));</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_working_with_xml_stories"></a>
Working with XML stories</h3>
<p>When you import XML elements that were not associated with a layout element (a story or page item), they are stored in an XML story. You can work with text in unplaced XML elements just as you would work with the text in a text frame. The following script fragment shows how this works (for the complete script, see XMLStory): </p>
<div class="fragment"><div class="line">    var myXMLStory = myDocument.xmlStories.item(0);</div>
<div class="line">    <span class="comment">//Though the text has not yet been placed in the layout, all text</span></div>
<div class="line">    <span class="comment">//properties are available.</span></div>
<div class="line">    myXMLStory.paragraphs.item(0).pointSize = 72;</div>
<div class="line">    <span class="comment">//Place the XML element in the layout to see the result.</span></div>
<div class="line">    myDocument.xmlElements.item(0).xmlElements.item(0).placeXML(myDocument.pages.item(0).textFrames.item(0));</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_exporting_xml"></a>
Exporting XML</h3>
<p>To export XML from an InDesign document, export either the entire XML structure in the document or one XML element (including any child XML elements it contains). The following script fragment shows how to do this (for the complete script, see ExportXML): </p>
<div class="fragment"><div class="line">    <span class="comment">//Export the entire XML structure in the document.</span></div>
<div class="line">    myDocument.exportFile(ExportFormat.xml, File(Folder.desktop + <span class="stringliteral">&quot;/CompleteDocumentXML.xml&quot;</span>));</div>
<div class="line">    <span class="comment">//Export a specific XML element and its child XML elements.</span></div>
<div class="line">    var myXMLElement = myDocument.xmlElements.item(0).xmlElements.item(-1);</div>
<div class="line">    myXMLElement.exportFile(ExportFormat.xml, File(Folder.desktop + <span class="stringliteral">&quot;/PartialDocumentXML.xml&quot;</span>));</div>
</div><!-- fragment --><p> In addition, you can use the exportFromSelected property of the xmlExportPreferences object to export an XML element selected in the user interface. The following script fragment shows how to do this (for the complete script, see ExportSelectedXMLElement): </p>
<div class="fragment"><div class="line">    var myDocument = app.activeDocument;</div>
<div class="line">    myDocument.select(myDocument.xmlElements.item(0).xmlElements.item(1));</div>
<div class="line">    myDocument.xmlExportPreferences.exportFromSelected = <span class="keyword">true</span>;</div>
<div class="line">    <span class="comment">//Export the entire XML structure in the document.</span></div>
<div class="line">    myDocument.exportFile(ExportFormat.xml, File(Folder.desktop+ <span class="stringliteral">&quot;/SelectedXMLElement.xml&quot;</span>));</div>
<div class="line">    myDocument.xmlExportPreferences.exportFromSelected = <span class="keyword">false</span>;</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_adding_xml_elements_to_a_layout"></a>
Adding XML Elements to a Layout</h2>
<p>Previously, we covered the process of getting XML data into InDesign documents and working with the XML structure in a document. In this section, we discuss techniques for getting XML information into a page layout and applying formatting to it.</p>
<h3><a class="anchor" id="id_js_associating_xml_elements_with_page_items_and_text"></a>
Associating XML elements with page items and text</h3>
<p>To associate a page item or text with an existing XML element, use the placeXML method. This replaces the content of the page item with the content of the XML element, as shown in the following script fragment (from the PlaceXML tutorial script): </p>
<div class="fragment"><div class="line">    var myPage = myDocument.pages.item(0);</div>
<div class="line">    myDocument.xmlElements.item(0).placeXML(myPage.textFrames.item(0));</div>
</div><!-- fragment --><p> To associate an existing page item or text object with an existing XML element, use the markup method. This merges the content of the page item or text with the content of the XML element (if any). The following script fragment shows how to use the markup method (for the complete script, see Markup): </p>
<div class="fragment"><div class="line">    myDocument.xmlElements.item(0).xmlElements.item(0).markup(myPage.textFrames.item(0));</div>
</div><!-- fragment --><p> <b>Placing XML into page items</b></p>
<p>Another way to associate an XML element with a page item is to use the placeIntoFrame method. With this method, you can create a frame as you place the XML, as shown in the following script fragment (for the complete script, see PlaceIntoFrame): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    <span class="comment">//PlaceIntoFrame has two parameters:</span></div>
<div class="line">    <span class="comment">//On: The page, spread, or master spread on which to create the frame</span></div>
<div class="line">    <span class="comment">//GeometricBounds: The bounds of the new frame (in page coordinates).</span></div>
<div class="line">    myDocument.xmlElements.item(0).xmlElements.item(0).placeIntoFrame(myDocument.pages.item(0), [72, 72, 288, 288]);</div>
</div><!-- fragment --><p> To associate an XML element with an inline page item (i.e., an anchored object), use the placeIntoCopy method, as shown in the following script fragment (from the PlaceIntoCopy tutorial script): </p>
<div class="fragment"><div class="line">    var myPage = myDocument.pages.item(0);</div>
<div class="line">    <span class="comment">//Function PlaceIntoCopy(On, PlacePoint, CopyItem As PageItem, [RetainExistingFrame As Boolean = False]) As PageItem    </span></div>
<div class="line">    var myXMLElement = myDocument.xmlElements.item(0);</div>
<div class="line">    myXMLElement.placeIntoCopy(myPage, [288, 72], myPage.textFrames.item(0), <span class="keyword">true</span>);</div>
</div><!-- fragment --><p> To associate an existing page item (or a copy of an existing page item) with an XML element and insert the page item into the XML structure at the location of the element, use the placeIntoInlineCopy method, as shown in the following script fragment (from the PlaceIntoInlineCopy tutorial script): </p>
<div class="fragment"><div class="line">    var myPage = myDocument.pages.item(0);</div>
<div class="line">    var myTextFrame = myDocument.textFrames.add({geometricBounds:[72, 72, 96, 144]});</div>
<div class="line">    var myXMLElement = myDocument.xmlElements.item(0).xmlElements.item(2);</div>
<div class="line">    myXMLElement.placeIntoInlineCopy(myTextFrame, <span class="keyword">false</span>);</div>
</div><!-- fragment --><p> To associate an XML element with a new inline frame, use the placeIntoInlineFrame method, as shown in the following script fragment (from the PlaceIntoInlineFrame tutorial script): </p>
<div class="fragment"><div class="line">    var myXMLElement = myDocument.xmlElements.item(0).xmlElements.item(2);</div>
<div class="line">    myXMLElement.placeIntoInlineFrame([72, 24]);</div>
</div><!-- fragment --><p> <b>Inserting text in and around XML text elements</b></p>
<p>When you place XML data into an InDesign layout, you often need to add white space (for example, return and tab characters) and static text (labels like "name" or "address") to the text of your XML elements. The following sample script shows how to add text in and around XML elements (for the complete script, see InsertTextAsContent): </p>
<div class="fragment"><div class="line">    var myXMLElement = myDocument.xmlElements.item(0).xmlElements.item(0);</div>
<div class="line">    <span class="comment">//By inserting the return character after the XML element, the character</span></div>
<div class="line">    <span class="comment">//becomes part of the content of the parent XML element, not of the element itself.</span></div>
<div class="line">    myXMLElement.insertTextAsContent(<span class="stringliteral">&quot;\r&quot;</span>, XMLElementPosition.afterElement);</div>
<div class="line">    myXMLElement = myDocument.xmlElements.item(0).xmlElements.item(1);</div>
<div class="line">    myXMLElement.insertTextAsContent(<span class="stringliteral">&quot;Static text: &quot;</span>, XMLElementPosition.beforeElement);</div>
<div class="line">    myXMLElement.insertTextAsContent(<span class="stringliteral">&quot;\r&quot;</span>, XMLElementPosition.afterElement);</div>
<div class="line">    <span class="comment">//To add text inside the element, set the location option to beginning or end.</span></div>
<div class="line">    myXMLElement = myDocument.xmlElements.item(0).xmlElements.item(2);</div>
<div class="line">    myXMLElement.insertTextAsContent(<span class="stringliteral">&quot;Text at the start of the element: &quot;</span>, XMLElementPosition.elementStart);</div>
<div class="line">    myXMLElement.insertTextAsContent(<span class="stringliteral">&quot; Text at the end of the element.&quot;</span>, XMLElementPosition.elementEnd);</div>
<div class="line">    myXMLElement.insertTextAsContent(<span class="stringliteral">&quot;\r&quot;</span>, XMLElementPosition.afterElement);</div>
<div class="line">    <span class="comment">//Add static text outside the element.</span></div>
<div class="line">    myXMLElement = myDocument.xmlElements.item(0).xmlElements.item(3);</div>
<div class="line">    myXMLElement.insertTextAsContent(<span class="stringliteral">&quot;Text before the element: &quot;</span>, XMLElementPosition.beforeElement);</div>
<div class="line">    myXMLElement.insertTextAsContent(<span class="stringliteral">&quot; Text after the element.&quot;</span>, XMLElementPosition.afterElement);</div>
<div class="line">    <span class="comment">//To insert text inside the text of an element, work with the text objects contained by the element.</span></div>
<div class="line">    myXMLElement.words.item(2).insertionPoints.item(0).contents = <span class="stringliteral">&quot;(the third word of) &quot;</span>;</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_marking_up_existing_layouts"></a>
Marking up existing layouts</h3>
<p>In some cases, an XML publishing project does not start with an XML file-especially when you need to convert an existing page layout to XML. For this type of project, you can mark up existing page-layout content and add it to an XML structure. You can then export this structure for further processing by XML tools outside InDesign.</p>
<p><b>Mapping tags to styles</b></p>
<p>One of the quickest ways to apply formatting to XML text elements is to use XMLImportMaps, also known as tag-to-style mapping. When you do this, you can associate a specific XML tag with a paragraph or character style. When you use the mapXMLTagsToStyles method of the document, InDesign applies the style to the text, as shown in the following script fragment (from the MapTagsToStyles tutorial script): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myPage = myDocument.pages.item(0);</div>
<div class="line">    <span class="comment">//Create a tag to style mapping.</span></div>
<div class="line">    myDocument.xmlImportMaps.add(myDocument.xmlTags.item(<span class="stringliteral">&quot;heading_1&quot;</span>), myDocument.paragraphStyles.item(<span class="stringliteral">&quot;heading 1&quot;</span>));</div>
<div class="line">    myDocument.xmlImportMaps.add(myDocument.xmlTags.item(<span class="stringliteral">&quot;heading_2&quot;</span>), myDocument.paragraphStyles.item(<span class="stringliteral">&quot;heading 2&quot;</span>));</div>
<div class="line">    myDocument.xmlImportMaps.add(myDocument.xmlTags.item(<span class="stringliteral">&quot;para_1&quot;</span>), myDocument.paragraphStyles.item(<span class="stringliteral">&quot;para 1&quot;</span>));</div>
<div class="line">    myDocument.xmlImportMaps.add(myDocument.xmlTags.item(<span class="stringliteral">&quot;body_text&quot;</span>), myDocument.paragraphStyles.item(<span class="stringliteral">&quot;body text&quot;</span>));</div>
<div class="line">    <span class="comment">//Map the XML tags to the defined styles.</span></div>
<div class="line">    myDocument.mapXMLTagsToStyles();</div>
<div class="line">    <span class="comment">//Place the XML element in the layout to see the result.</span></div>
<div class="line">    var myTextFrame = myPage.textFrames.add({geometricBounds:myGetBounds(myDocument, myPage)});</div>
<div class="line">    var myStory = myTextFrame.parentStory;</div>
<div class="line">    myStory.placeXML(myDocument.xmlElements.item(0));</div>
</div><!-- fragment --><p> <b>Mapping styles to tags</b></p>
<p>When you have formatted text that is not associated with any XML elements, and you want to move that text into an XML structure, use style-to-tag mapping, which associates paragraph and character styles with XML tags. To do this, use xmlExportMap objects to create the links between XML tags and styles, then use the mapStylesToXMLTags method to create the corresponding XML elements, as shown in the following script fragment (from the MapStylesToTags tutorial script): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    <span class="comment">//Create a style to tag mapping.</span></div>
<div class="line">    myDocument.xmlExportMaps.add(myDocument.paragraphStyles.item(<span class="stringliteral">&quot;heading 1&quot;</span>), myDocument.xmlTags.item(<span class="stringliteral">&quot;heading_1&quot;</span>));</div>
<div class="line">    myDocument.xmlExportMaps.add(myDocument.paragraphStyles.item(<span class="stringliteral">&quot;heading 2&quot;</span>), myDocument.xmlTags.item(<span class="stringliteral">&quot;heading_2&quot;</span>));</div>
<div class="line">    myDocument.xmlExportMaps.add(myDocument.paragraphStyles.item(<span class="stringliteral">&quot;para 1&quot;</span>), myDocument.xmlTags.item(<span class="stringliteral">&quot;para_1&quot;</span>));</div>
<div class="line">    myDocument.xmlExportMaps.add(myDocument.paragraphStyles.item(<span class="stringliteral">&quot;body text&quot;</span>), myDocument.xmlTags.item(<span class="stringliteral">&quot;body_text&quot;</span>));</div>
<div class="line">    <span class="comment">//Apply the style to tag mapping.</span></div>
<div class="line">    myDocument.mapStylesToXMLTags();</div>
</div><!-- fragment --><p> Another approach is simply to have your script create a new XML tag for each paragraph or character style in the document, and then apply the style to tag mapping, as shown in the following script fragment (from the MapAllStylesToTags tutorial script): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    <span class="comment">//Create tags that match the style names in the document,</span></div>
<div class="line">    <span class="comment">//creating an XMLExportMap for each tag/style pair.</span></div>
<div class="line">    <span class="keywordflow">for</span>(var myCounter = 0; myCounter&lt;myDocument.paragraphStyles.length; myCounter++){</div>
<div class="line">        var myParagraphStyle = myDocument.paragraphStyles.item(myCounter);</div>
<div class="line">        var myParagraphStyleName = myParagraphStyle.name;</div>
<div class="line">        var myXMLTagName = myParagraphStyleName.replace(/\ /gi, <span class="stringliteral">&quot;_&quot;</span>)</div>
<div class="line">        myXMLTagName = myXMLTagName.replace(/\[/gi, <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line">        myXMLTagName = myXMLTagName.replace(/\]/gi, <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line">        var myXMLTag = myDocument.xmlTags.add(myXMLTagName);</div>
<div class="line">        myDocument.xmlExportMaps.add(myParagraphStyle, myXMLTag);</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">//Apply the style to tag mapping.</span></div>
<div class="line">    myDocument.mapStylesToXMLTags();</div>
</div><!-- fragment --><p> <b>Marking up graphics</b></p>
<p>The following script fragment shows how to associate an XML element with a graphic (for the complete script, see MarkingUpGraphics): </p>
<div class="fragment"><div class="line">    var myXMLTag = myDocument.xmlTags.add(<span class="stringliteral">&quot;graphic&quot;</span>);</div>
<div class="line">    var myGraphic = myDocument.pages.item(0).pageItems.item(0).graphics.item(0);</div>
<div class="line">    <span class="comment">//Associate the graphic with a new XML element as you create the element.</span></div>
<div class="line">    var myXMLElement = myDocument.xmlElements.item(0).xmlElements.add(myXMLTag, myGraphic);</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_applying_styles_to_xml_elements"></a>
Applying styles to XML elements</h3>
<p>In addition to using tag-to-style and style-to-tag mappings or applying styles to the text and page items associated with XML elements, you also can apply styles to XML elements directly. The following script fragment shows how to use three methods: applyParagraphStyle, applyCharacterStyle, and applyObjectStyle. (For the complete script, see ApplyStylesToXMLElements.) </p>
<div class="fragment"><div class="line">    var myDocument = app.activeDocument;</div>
<div class="line">    var myPage = app.activeWindow.activePage;</div>
<div class="line">    myDocument.viewPreferences.horizontalMeasurementUnits = MeasurementUnits.points;</div>
<div class="line">    myDocument.viewPreferences.verticalMeasurementUnits = MeasurementUnits.points;</div>
<div class="line">    <span class="comment">//Create a series of XML tags.</span></div>
<div class="line">    var myHeading1XMLTag = myDocument.xmlTags.add(<span class="stringliteral">&quot;heading_1&quot;</span>);</div>
<div class="line">    var myHeading2XMLTag = myDocument.xmlTags.add(<span class="stringliteral">&quot;heading_2&quot;</span>);</div>
<div class="line">    var myPara1XMLTag = myDocument.xmlTags.add(<span class="stringliteral">&quot;para_1&quot;</span>);</div>
<div class="line">    var myBodyTextXMLTag = myDocument.xmlTags.add(<span class="stringliteral">&quot;body_text&quot;</span>);</div>
<div class="line">    <span class="comment">//Create a series of paragraph styles.</span></div>
<div class="line">    var myHeading1Style = myDocument.paragraphStyles.add();</div>
<div class="line">    myHeading1Style.name = <span class="stringliteral">&quot;heading 1&quot;</span>;</div>
<div class="line">    myHeading1Style.pointSize = 24;</div>
<div class="line">    var myHeading2Style = myDocument.paragraphStyles.add();</div>
<div class="line">    myHeading2Style.name = <span class="stringliteral">&quot;heading 2&quot;</span>;</div>
<div class="line">    myHeading2Style.pointSize = 14;</div>
<div class="line">    myHeading2Style.spaceBefore = 12;</div>
<div class="line">    var myPara1Style = myDocument.paragraphStyles.add();</div>
<div class="line">    myPara1Style.name = <span class="stringliteral">&quot;para 1&quot;</span>;</div>
<div class="line">    myPara1Style.pointSize = 12;</div>
<div class="line">    myPara1Style.firstLineIndent = 0;</div>
<div class="line">    var myBodyTextStyle = myDocument.paragraphStyles.add();</div>
<div class="line">    myBodyTextStyle.name = <span class="stringliteral">&quot;body text&quot;</span>;</div>
<div class="line">    myBodyTextStyle.pointSize = 12;</div>
<div class="line">    myBodyTextStyle.firstLineIndent = 24;</div>
<div class="line">    <span class="comment">//Create a character style.</span></div>
<div class="line">    var myCharacterStyle = myDocument.characterStyles.add();</div>
<div class="line">    myCharacterStyle.name = <span class="stringliteral">&quot;Emphasis&quot;</span>;</div>
<div class="line">    myCharacterStyle.fontStyle = <span class="stringliteral">&quot;Italic&quot;</span>;</div>
<div class="line">    <span class="comment">//Add XML elements and apply paragraph styles.</span></div>
<div class="line">    var myRootXMLElement = myDocument.xmlElements.item(0);</div>
<div class="line">    var myXMLElementA = myRootXMLElement.xmlElements.add(myHeading1XMLTag);</div>
<div class="line">    myXMLElementA.contents = <span class="stringliteral">&quot;Heading 1&quot;</span>;</div>
<div class="line">    myXMLElementA.insertTextAsContent(<span class="stringliteral">&quot;\r&quot;</span>, XMLElementPosition.afterElement);</div>
<div class="line">    myXMLElementA.applyParagraphStyle(myHeading1Style, <span class="keyword">true</span>);</div>
<div class="line">    var myXMLElementB = myRootXMLElement.xmlElements.add(myPara1XMLTag);</div>
<div class="line">    myXMLElementB.contents = <span class="stringliteral">&quot;This is the first paragraph in the article.&quot;</span>;</div>
<div class="line">    myXMLElementB.insertTextAsContent(<span class="stringliteral">&quot;\r&quot;</span>, XMLElementPosition.afterElement);</div>
<div class="line">    myXMLElementB.applyParagraphStyle(myPara1Style, <span class="keyword">true</span>);</div>
<div class="line">    var myXMLElementC = myRootXMLElement.xmlElements.add(myBodyTextXMLTag);</div>
<div class="line">    myXMLElementC.contents = <span class="stringliteral">&quot;This is the second paragraph in the article.&quot;</span>;</div>
<div class="line">    myXMLElementC.insertTextAsContent(<span class="stringliteral">&quot;\r&quot;</span>, XMLElementPosition.afterElement);</div>
<div class="line">    myXMLElementC.applyParagraphStyle(myBodyTextStyle, <span class="keyword">true</span>);</div>
<div class="line">    var myXMLElementD = myRootXMLElement.xmlElements.add(myHeading2XMLTag);</div>
<div class="line">    myXMLElementD.contents = <span class="stringliteral">&quot;Heading 2&quot;</span>;</div>
<div class="line">    myXMLElementD.insertTextAsContent(<span class="stringliteral">&quot;\r&quot;</span>, XMLElementPosition.afterElement);</div>
<div class="line">    myXMLElementD.applyParagraphStyle(myHeading2Style, <span class="keyword">true</span>);</div>
<div class="line">    var myXMLElementE = myRootXMLElement.xmlElements.add(myPara1XMLTag);</div>
<div class="line">    myXMLElementE.contents = <span class="stringliteral">&quot;This is the first paragraph following the subhead.&quot;</span>;</div>
<div class="line">    myXMLElementE.insertTextAsContent(<span class="stringliteral">&quot;\r&quot;</span>, XMLElementPosition.afterElement);</div>
<div class="line">    myXMLElementE.applyParagraphStyle(myPara1Style, <span class="keyword">true</span>);</div>
<div class="line">    var myXMLElementF = myRootXMLElement.xmlElements.add(myBodyTextXMLTag);</div>
<div class="line">    myXMLElementF.contents = <span class="stringliteral">&quot;This is the second paragraph following the subhead.&quot;</span>;</div>
<div class="line">    myXMLElementF.insertTextAsContent(<span class="stringliteral">&quot;\r&quot;</span>, XMLElementPosition.afterElement);</div>
<div class="line">    myXMLElementF.applyParagraphStyle(myBodyTextStyle, <span class="keyword">true</span>);</div>
<div class="line">    var myXMLElementG = myRootXMLElement.xmlElements.add(myBodyTextXMLTag);</div>
<div class="line">    myXMLElementG.contents = <span class="stringliteral">&quot;Note:&quot;</span>;</div>
<div class="line">    myXMLElementG = myXMLElementG.move(LocationOptions.atBeginning, myXMLElementF)</div>
<div class="line">    myXMLElementG.insertTextAsContent(<span class="stringliteral">&quot; &quot;</span>, XMLElementPosition.afterElement);</div>
<div class="line">    myXMLElementG.applyCharacterStyle(myCharacterStyle, <span class="keyword">true</span>);</div>
<div class="line">    <span class="comment">// Add text elements.</span></div>
<div class="line">    var myTextFrame = myPage.textFrames.add({geometricBounds:myGetBounds(myDocument, myPage)});</div>
<div class="line">    var myStory = myTextFrame.parentStory;</div>
<div class="line">    myStory.placeXML(myRootXMLElement);</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_working_with_xml_tables"></a>
Working with XML tables</h3>
<p>InDesign automatically imports XML data into table cells when the data is marked up using HTML standard table tags. If you cannot use the default table mark-up or prefer not to use it, InDesign can convert XML elements to a table using the convertElementToTable method.</p>
<p>To use this method, the XML elements to be converted to a table must conform to a specific structure. Each row of the table must correspond to a specific XML element, and that element must contain a series of XML elements corresponding to the cells in the row. The following script fragment shows how to use this method (for the complete script, see ConvertXMLElementToTable). The XML element used to denote the table row is consumed by this process. </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myPage = myDocument.pages.item(0);</div>
<div class="line">    <span class="comment">//Create a series of XML tags.</span></div>
<div class="line">    var myRowTag = myDocument.xmlTags.add(<span class="stringliteral">&quot;row&quot;</span>);</div>
<div class="line">    var myCellTag = myDocument.xmlTags.add(<span class="stringliteral">&quot;cell&quot;</span>);</div>
<div class="line">    var myTableTag = myDocument.xmlTags.add(<span class="stringliteral">&quot;table&quot;</span>);</div>
<div class="line">    <span class="comment">//Add XML elements.</span></div>
<div class="line">    var myRootXMLElement = myDocument.xmlElements.item(0);</div>
<div class="line">    with(myRootXMLElement){</div>
<div class="line">        var myTableXMLElement = xmlElements.add(myTableTag);</div>
<div class="line">        with(myTableXMLElement){</div>
<div class="line">            <span class="keywordflow">for</span>(var myRowCounter = 1;myRowCounter &lt; 7;myRowCounter++){</div>
<div class="line">                with(xmlElements.add(myRowTag)){</div>
<div class="line">                    myString = <span class="stringliteral">&quot;Row &quot;</span> + myRowCounter;</div>
<div class="line">                    <span class="keywordflow">for</span>(var myCellCounter = 1; myCellCounter &lt; 5; myCellCounter++){</div>
<div class="line">                        with(xmlElements.add(myCellTag)){</div>
<div class="line">                            contents = myString + <span class="stringliteral">&quot;:Cell &quot;</span> + myCellCounter;</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    var myTable = myTableXMLElement.convertElementToTable(myRowTag, myCellTag);</div>
<div class="line">    <span class="comment">// Add text elements.</span></div>
<div class="line">    var myTextFrame = myPage.textFrames.add({geometricBounds:myGetBounds(myDocument, myPage)});</div>
<div class="line">    var myStory = myTextFrame.parentStory;</div>
<div class="line">    myStory.placeXML(myRootXMLElement);</div>
</div><!-- fragment --><p> Once you are working with a table containing XML elements, you can apply table styles and cell styles to the XML elements directly, rather than having to apply the styles to the tables or cells associated with the XML elements. To do this, use the applyTableStyle and applyCellStyle methods, as shown in the following script fragment (from the ApplyTableStyles tutorial script): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.add();</div>
<div class="line">    <span class="comment">//Create a series of XML tags.</span></div>
<div class="line">    var myRowTag = myDocument.xmlTags.add(<span class="stringliteral">&quot;row&quot;</span>);</div>
<div class="line">    var myCellTag = myDocument.xmlTags.add(<span class="stringliteral">&quot;cell&quot;</span>);</div>
<div class="line">    var myTableTag = myDocument.xmlTags.add(<span class="stringliteral">&quot;table&quot;</span>);</div>
<div class="line">    <span class="comment">//Create a table style and a cell style.</span></div>
<div class="line">    var myTableStyle = myDocument.tableStyles.add({name:<span class="stringliteral">&quot;myTableStyle&quot;</span>});</div>
<div class="line">    myTableStyle.startRowFillColor = myDocument.colors.item(<span class="stringliteral">&quot;Black&quot;</span>);</div>
<div class="line">    myTableStyle.startRowFillTint = 25;</div>
<div class="line">    myTableStyle.endRowFillColor = myDocument.colors.item(<span class="stringliteral">&quot;Black&quot;</span>);</div>
<div class="line">    myTableStyle.endRowFillTint = 10;</div>
<div class="line">    var myCellStyle = myDocument.cellStyles.add();</div>
<div class="line">    myCellStyle.fillColor = myDocument.colors.item(<span class="stringliteral">&quot;Black&quot;</span>);</div>
<div class="line">    myCellStyle.fillTint = 45</div>
<div class="line">    <span class="comment">//Add XML elements.</span></div>
<div class="line">    var myRootXMLElement = myDocument.xmlElements.item(0);</div>
<div class="line">    with(myRootXMLElement){</div>
<div class="line">        var myTableXMLElement = xmlElements.add(myTableTag);</div>
<div class="line">        with(myTableXMLElement){</div>
<div class="line">            <span class="keywordflow">for</span>(var myRowCounter = 1;myRowCounter &lt; 7;myRowCounter++){</div>
<div class="line">                with(xmlElements.add(myRowTag)){</div>
<div class="line">                    myString = <span class="stringliteral">&quot;Row &quot;</span> + myRowCounter;</div>
<div class="line">                    <span class="keywordflow">for</span>(var myCellCounter = 1; myCellCounter &lt; 5; myCellCounter++){</div>
<div class="line">                        with(xmlElements.add(myCellTag)){</div>
<div class="line">                            contents = myString + <span class="stringliteral">&quot;:Cell &quot;</span> + myCellCounter;</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    var myTable = myTableXMLElement.convertElementToTable(myRowTag, myCellTag);</div>
<div class="line">    var myTableXMLElement = myDocument.xmlElements.item(0).xmlElements.item(0);</div>
<div class="line">    myTableXMLElement.applyTableStyle(myTableStyle);</div>
<div class="line">    myTableXMLElement.xmlElements.item(0).applyCellStyle(myCellStyle);</div>
<div class="line">    myTableXMLElement.xmlElements.item(5).applyCellStyle(myCellStyle);</div>
<div class="line">    myTableXMLElement.xmlElements.item(10).applyCellStyle(myCellStyle);</div>
<div class="line">    myTableXMLElement.xmlElements.item(15).applyCellStyle(myCellStyle);</div>
<div class="line">    myTableXMLElement.xmlElements.item(16).applyCellStyle(myCellStyle);</div>
<div class="line">    myTableXMLElement.xmlElements.item(21).applyCellStyle(myCellStyle);</div>
<div class="line">    <span class="comment">// Add text elements.</span></div>
<div class="line">    var myPage = myDocument.pages.item(0);</div>
<div class="line">    var myTextFrame = myPage.textFrames.add({geometricBounds:myGetBounds(myDocument, myPage)});</div>
<div class="line">    var myStory = myTextFrame.parentStory;</div>
<div class="line">    myStory.placeXML(myRootXMLElement);</div>
<div class="line">    myTable.alternatingFills = AlternatingFillsTypes.alternatingRows;</div>
</div><!-- fragment --> <h1><a class="anchor" id="id_js_xml_rules"></a>
XML Rules</h1>
<p>The InDesign XML- rules feature provides a powerful set of scripting tools for working with the XML content of your documents. XML rules also greatly simplify the process of writing scripts to work with XML elements and dramatically improve performance of finding, changing, and formatting XML elements.</p>
<p>While XML rules can be triggered by application events, like open, place, and close, typically you will run XML rules after importing XML into a document. (For more information on attaching scripts to events, see <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_events">Events</a>).</p>
<p>We assume that you have already read Adobe InDesign Scripting Tutorial and know how to create and run a script. We also assume that you have some knowledge of XML and have read <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_xml">XML.</a></p>
<h2><a class="anchor" id="id_js_overview"></a>
Overview</h2>
<p>InDesign's XML rules feature has three parts:</p>
<ul>
<li>XML rules processor (a scripting object) - Locates XML elements in an XML structure using XPath and applies the appropriate XML rule(s). It is important to note that a script can contain multiple XML rule processor objects, and each rule-processor object is associated with a given XML rule set.</li>
<li>Glue code - A set of routines provided by Adobe to make the process of writing XML rules and interacting with the XML rules-processor easier.</li>
<li>XML rules - The XML actions you add to a script. XML rules are written in scripting code. A rule combines an XPath-based condition and a function to apply when the condition is met. The "apply" function can perform any set of operations that can be defined in InDesign scripting, including changing the XML structure; applying formatting; and creating new pages, page items, or documents.</li>
</ul>
<p>A script can define any number of rules and apply them to the entire XML structure of an InDesign document or any subset of elements within the XML structure. When an XML rule is triggered by an XML rule processor, the rule can apply changes to the matching XML element or any other object in the document.</p>
<p>You can think of the XML rules feature as being something like XSLT. Just as XSLT uses XPath to locate XML elements in an XML structure, then transforms the XML elements in some way, XML rules use XPath to locate and act on XML elements inside InDesign. Just as an XSLT template uses an XML parser outside InDesign to apply transformations to XML data, InDesign's XML Rules Processor uses XML rules to apply transformations to XML data inside InDesign.</p>
<h3><a class="anchor" id="id_js_why_use_xml_rules"></a>
Why use XML rules?</h3>
<p>In prior releases of InDesign, you could not use XPath to navigate the XML structure in your InDesign files. Instead, you needed to write recursive script functions to iterate through the XML structure, examining each element in turn. This was difficult and slow.</p>
<p>XML rules makes it easy to find XML elements in the structure, by using XPath and relying on InDesign's XML-rules processors to find XML elements. An XML-rule processor handles the work of iterating through the XML elements in your document, and it can do so much faster than a script.</p>
<h3><a class="anchor" id="id_js_xml-rules_programming_model"></a>
XML-rules programming model</h3>
<p>An XML rule contains three things:</p>
<ol type="1">
<li>A name (as a string).</li>
<li>An XPath statement (as a string).</li>
<li>An apply function.</li>
</ol>
<p>The XPath statement defines the location in the XML structure; when the XML rules processor finds a matching element, it executes the apply function defined in the rule.</p>
<p>Here is a sample XML rule: </p>
<div class="fragment"><div class="line"><span class="keyword">function</span> RuleName() {</div>
<div class="line">    this.name = <span class="stringliteral">&quot;RuleNameAsString&quot;</span>;</div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;ValidXPathSpecifier&quot;</span>;</div>
<div class="line">    this.apply = <span class="keyword">function</span> (element, ruleSet, ruleProcessor){</div>
<div class="line">        <span class="comment">//Do something here.</span></div>
<div class="line">        <span class="comment">//Return true to stop further processing of the XML element</span></div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;     </div>
<div class="line">    }; <span class="comment">// end of Apply function</span></div>
<div class="line">}</div>
</div><!-- fragment --><p> In the above example, RuleNameAsString is the name of the rule and matches the RuleName; ValidXPathSpecifier is an XPath expression. Later in this section, we present a series of functioning XML-rule examples.</p>
<dl class="section note"><dt>Note</dt><dd>XML rules support a limited subset of XPath 1.0. See "XPath limitations" in <a class="el" href="id_as_adobe_indesign_cc_scripting_guide_applescript.html#id_as_overview">XML Rules Overview</a>.</dd></dl>
<p><b>XML-rule sets</b></p>
<p>An XML-rule set is an array of one or more XML rules to be applied by an XML-rules processor. The rules are applied in the order in which they appear in the array. Here is a sample XML-rule set: </p>
<div class="fragment"><div class="line">var myRuleSet = <span class="keyword">new</span> Array (<span class="keyword">new</span> SortByName,</div>
<div class="line">                            <span class="keyword">new</span> AddStaticText,</div>
<div class="line">                            <span class="keyword">new</span> LayoutElements,</div>
<div class="line">                            <span class="keyword">new</span> FormatElements</div>
<div class="line">                            );</div>
</div><!-- fragment --><p> In the above example, the rules listed in the myRuleSet array are defined elsewhere in the script. Later in this section, we present several functioning scripts containing XML-rule sets.</p>
<p>'<b>Glue</b>' <b>code</b></p>
<p>In addition to the XML-rules processor object built into InDesign's scripting model, Adobe provides a set of functions intended to make the process of writing XML rules much easier. These functions are defined within the glue code.jsx file:</p>
<ul>
<li>__processRuleSet(root, ruleSet) - To execute a set of XML rules, your script must call the __processRuleSet function and provide an XML element and an XML rule set. The XML element defines the point in the XML structure at which to begin processing the rules.</li>
<li>__processChildren(ruleProcessor) - This function directs the XML-rules processor to apply matching XML rules to child elements of the matched XML element. This allows the rule applied to a parent XML element to execute code after the child XML elements are processed. By default, when an XML-rules processor applies a rule to the c hildren of an XML element, control does not return to the rule. You can use the __processChildren function to return control to the apply function of the rule after the child XML elements are processed.</li>
<li>__skipChildren(ruleProcessor) - This function tells the processor not to process any descendants of the current XML element using the XML rule. Use this function when you want to move or delete the current XML element or improve performance by skipping irrelevant parts of an XML structure.</li>
</ul>
<p><b>Iterating through an XML structure</b></p>
<p>The XML-rules processor iterates through the XML structure of a document by processing each XML element in the order in which it appears in the XML hierarchy of the document. The XML-rules processor uses a forward-only traversal of the XML structure, and it visits each XML element in the structure twice (in the order parent-child-parent, just like the normal ordering of nested tags in an XML file). For any XML element, the XML-rules processor tries to apply all matching XML rules in the order in which they are added to the current XML rule set.</p>
<p>The __processRuleSet function applies rules to XML elements in "depth first" order; that is, XML elements and their child elements are processed in the order in which they appear in the XML structure. For each "branch" of the XML structure, the XML-rules processor visits each XML element before moving on to the next branch.</p>
<p>After an XML rule is applied to an XML element, the XML-rules processor continues searching for rules to apply to the descendents of that XML element. An XML rule can alter this behavior by using the __skipChildren or __processChildren function, or by changing the operation of other rules.</p>
<p>To see how all these functions work together, import the DepthFirstProcessingOrder.xml file into a new document, then run the DepthFirstProcessingOrder.jsx script. InDesign creates a text frame, that lists the attribute names of each element in the sample XML file in the order in which they were visited by each rule. You can use this script in conjunction with the AddAttribute tutorial script to troubleshoot XML traversal problems in your own XML documents (you must edit the AddAttribute script to suit your XML structure).</p>
<p>Normal iteration (assuming a rule that matches every XML element in the structure) is shown in the following figure: </p>
<div class="image">
<img src="InDesign_ScriptingGuide-11.gif" alt="InDesign_ScriptingGuide-11.gif"/>
</div>
<p>Iteration with __processChildren (assuming a rule that matches every XML element in the structure) is shown in the following figure: </p>
<div class="image">
<img src="InDesign_ScriptingGuide-12.gif" alt="InDesign_ScriptingGuide-12.gif"/>
</div>
<p>Iteration given the following rule set is shown in the figure after the script fragment. The rule set includes two rules that match every element, including one that uses __processChildren. Every element is processed twice. (For the complete script, see ProcessChildren.) </p>
<div class="fragment"><div class="line"><span class="comment">//XML rules follow.</span></div>
<div class="line"><span class="keyword">function</span> NormalRule(){</div>
<div class="line">    this.name = <span class="stringliteral">&quot;NormalRule&quot;</span>;</div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;//XMLElement&quot;</span>;    </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        app.documents.item(0).stories.item(0).insertionPoints.item(-1).contents = myElement.xmlAttributes.item(0).value + <span class="stringliteral">&quot;\r&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="keyword">function</span> ProcessChildrenRule(){</div>
<div class="line">    this.name = <span class="stringliteral">&quot;ProcessChildrenRule&quot;</span>;</div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;//XMLElement&quot;</span>;    </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        __processChildren(myRuleProcessor);</div>
<div class="line">        app.documents.item(0).stories.item(0).insertionPoints.item(-1).contents = myElement.xmlAttributes.item(0).value + <span class="stringliteral">&quot;\r&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> <div class="image">
<img src="InDesign_ScriptingGuide-13.gif" alt="InDesign_ScriptingGuide-13.gif"/>
</div>
<p><b>Changing structure during iteration</b></p>
<p>When an XML-rules processor finds a matching XML element and applies an XML rule, the rule can change the XML structure of the document. This can conflict with the process of applying other rules, if the affected XML elements in the structure are part of the current path of the XML-rules processor. To prevent errors that might cause the XML-rules processor to become invalid, the following limitations are placed on XML structure changes you might make within an XML rule:</p>
<ul>
<li>Deleting an ancestor XML element - To delete an ancestor XML element of the matched XML element, create a separate rule that matches and processes the ancestor XML element.</li>
<li>Inserting a parent XML element - To add an ancestor XML element to the matched XML element, do so after processing the current XML element. The ancestor XML element you add is not processed by the XML-rules processor during this rule iteration (as it appears "above" the current element in the hierarchy).</li>
<li>Deleting the current XML element - You cannot delete or move the matched XML element until any child XML elements contained by the element are processed. To make this sort of change, use the __skipChildren function before making the change.</li>
<li>No repetitive processing - Changes to nodes that were already processed will not cause the XML rule to be evaluated again.</li>
</ul>
<p><b>Handling multiple matching rules</b></p>
<p>When multiple rules match an XML element, the XML-rules processor can apply some or all of the matching rules. XML rules are applied in the order in which they appear in the rule set, up to the point that one of the rule apply functions returns true. In essence, returning true means the element was processed. Once a rule returns true, any other XML rules matching the XML element are ignored. You can alter this behavior and allow the next matching rule to be applied, by having the XML rule apply function return false.</p>
<p>When an apply function returns false, you can control the matching behavior of the XML rule based on a condition other than the XPath property defined in the XML rule, like the state of another variable in the script.</p>
<p><b>XPath limitations</b></p>
<p>InDesign's XML rules support a limited subset of the XPath 1.0 specification, specifically including the following capabilities:</p>
<ul>
<li>Find an element by name, specifying a path from the root; for example, /doc/title.</li>
<li>Find paths with wildcards and node matches; for example, /doc/* /subtree/node().</li>
<li>Find an element with a specified attribute that matches a specified value; for example, /doc/para[@font='Courier'].</li>
<li>Find an element with a specified attribute that does not match a specified value; for example, /doc/para[@font !='Courier'].</li>
<li>Find a child element by numeric position (but not last()); for example, /doc/para[3].</li>
<li>Find self or any descendent; for example, //para.</li>
<li>Find comment as a terminal; for example, /doc/comment().</li>
<li>Find PI by target or any; for example, /doc/processing-instruction('foo').</li>
<li>Find multiple predicates; for example, /doc/para[@font='Courier'][@size=5][2].</li>
<li>Find along following-sibling axes; for example, /doc/note/following-sibling::*.</li>
</ul>
<p>Due to the one-pass nature of this implementation, the following XPath expressions are specifically excluded:</p>
<ul>
<li>No ancestor or preceding-sibling axes, including .., ancestor::, preceding-sibling::.</li>
<li>No path specifications in predicates; for example,foo[bar/c].</li>
<li>No last() function.</li>
<li>No text() function or text comparisons; however, you can use InDesign scripting to examine the text content of an XML element matched by a given XML rule.</li>
<li>No compound Boolean predicates; for example, foo[@bar=font or @c=size].</li>
<li>No relational predicates; for example, foo[@bar &lt;font or <code>&gt;</code> 3].</li>
<li>No relative paths; for example, doc/chapter.</li>
</ul>
<p><b>Error handling</b></p>
<p>Because XML rules are part of the InDesign scripting model, scripts that use rules do not differ in nature from ordinary scripts, and they benefit from the same error-handling mechanism. When InDesign generates an error, an XML-rules script behaves no differently than any other script. InDesign errors can be captured in the script using whatever tools the scripting language provides to achieve that; for example, try...catch blocks.</p>
<p>InDesign does include a series of errors specific to XML-rules processing. An InDesign error can occur at XML-rules processor initialization, when a rule uses a non-conforming XPath specifier (see "XPath limitations" in <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_overview">XML Rules Overview</a> ). An InDesign error also can be caused by a model change that invalidates the state of an XML-rules processor. XML structure changes caused by the operation of XML rules can invalidate the XML-rules processor. These changes to the XML structure can be caused by the script containing the XML-rules processor, another concurrently executing script, or a user action initiated from the user interface.</p>
<p>XML structure changes that invalidate an XML-rules processor lead to errors when the XML-rules processor's iteration resumes. The error message indicates which XML structural change caused the error.</p>
<p><b>XML rules flow of control</b></p>
<p>As a script containing XML rules executes, the flow of control passes from the script function containing the XML rules to each XML rule, and from each rule to the functions defined in the glue code. Those functions pass control to the XML-rules processor which, in turn, iterates through the XML elements in the structure. Results and errors are passed back up the chain until they are handled by a function or cause a scripting error. The following diagram provides a simplified overview of the flow of control in an XML-rules script: </p>
<div class="image">
<img src="InDesign_ScriptingGuide-14.gif" alt="InDesign_ScriptingGuide-14.gif"/>
</div>
<h2><a class="anchor" id="id_js_xml_rules_examples"></a>
XML Rules Examples</h2>
<p>Because XML rules rely on XPath statements to find qualifying XML elements, XML rules are closely tied to the structure of the XML in a document. This means it is almost impossible to demonstrate a functional XML-rules script without having an XML structure to test it against. In the remainder of this section, we present a series of XML-rules exercises based on a sample XML data file. For our example, we use the product list of an imaginary integrated-circuit manufacturer. Each record in the XML data file has the following structure: </p>
<div class="fragment"><div class="line">&lt;device&gt;</div>
<div class="line">    &lt;name&gt;&lt;/name&gt;</div>
<div class="line">    &lt;type&gt;&lt;/type&gt;</div>
<div class="line">    &lt;part_number&gt;&lt;/part_number&gt;</div>
<div class="line">    &lt;supply_voltage&gt;</div>
<div class="line">        &lt;minimum&gt;&lt;/minimum&gt;</div>
<div class="line">        &lt;maximum&gt;&lt;/maximum&gt;</div>
<div class="line">    &lt;/supply_voltage&gt;</div>
<div class="line">    &lt;package&gt;</div>
<div class="line">        &lt;type&gt;&lt;/type&gt;</div>
<div class="line">        &lt;pins&gt;&lt;/pins&gt;</div>
<div class="line">    &lt;/package&gt;</div>
<div class="line">    &lt;price&gt;&lt;/price&gt;</div>
<div class="line">    &lt;description&gt;&lt;/description&gt;</div>
<div class="line">&lt;/device&gt;</div>
</div><!-- fragment --><p>The scripts are presented in order of complexity, starting with a very simple script and building toward more complex operations.</p>
<h3><a class="anchor" id="id_js_setting_up_a_sample_document"></a>
Setting up a sample document</h3>
<p>Before you run each script in this section, import the XMLRulesExampleData.xml data file into a document. When you import the XML, turn on the Do Not Import Contents of Whitespace-Only Elements option in the XML Import Options dialog box. Save the file, then choose File &gt; Revert before running each sample script in this section. Alternately, run the following script before you run each sample XML-rule script (see the XMLRulesExampleSetup.jsx script file): </p>
<div class="fragment"><div class="line">main();</div>
<div class="line"><span class="keyword">function</span> main(){</div>
<div class="line">    var myDocument = app.documents.add();</div>
<div class="line">    myDocument.xmlImportPreferences.allowTransform = <span class="keyword">false</span>;</div>
<div class="line">    myDocument.xmlImportPreferences.ignoreWhitespace = <span class="keyword">true</span>;</div>
<div class="line">    var myScriptPath = myGetScriptPath();</div>
<div class="line">    var myFilePath = myScriptPath.path + <span class="stringliteral">&quot;/XMLRulesExampleData.xml&quot;</span></div>
<div class="line">    myDocument.importXML(File(myFilePath));</div>
<div class="line">    var myBounds = myGetBounds(myDocument, myDocument.pages.item(0));</div>
<div class="line">    myDocument.xmlElements.item(0).placeIntoFrame(myDocument.pages.item(0), myBounds);</div>
<div class="line">    <span class="keyword">function</span> myGetBounds(myDocument, myPage){</div>
<div class="line">        var myWidth = myDocument.documentPreferences.pageWidth;</div>
<div class="line">        var myHeight = myDocument.documentPreferences.pageHeight;</div>
<div class="line">        var myX1 = myPage.marginPreferences.left;</div>
<div class="line">        var myY1 = myPage.marginPreferences.top;</div>
<div class="line">        var myX2 = myWidth - myPage.marginPreferences.right;</div>
<div class="line">        var myY2 = myHeight - myPage.marginPreferences.bottom;</div>
<div class="line">        <span class="keywordflow">return</span> [myY1, myX1, myY2, myX2];</div>
<div class="line">    }</div>
<div class="line">    <span class="keyword">function</span> myGetScriptPath() {</div>
<div class="line">        <span class="keywordflow">try</span> {</div>
<div class="line">            <span class="keywordflow">return</span> app.activeScript;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span>(myError){</div>
<div class="line">            <span class="keywordflow">return</span> File(myError.fileName);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_getting_started_with_xml_rules"></a>
Getting started with XML rules</h3>
<p>Here is a very simple XML rule-it does nothing more than add a return character after every XML element in the document. The XML-rule set contains one rule. For the complete script, see AddReturns. </p>
<div class="fragment"><div class="line">    <span class="keywordflow">if</span> (app.documents.length != 0){</div>
<div class="line">        var myDocument = app.documents.item(0); </div>
<div class="line">        <span class="comment">//This rule set contains a single rule.</span></div>
<div class="line">        var myRuleSet = <span class="keyword">new</span> Array (<span class="keyword">new</span> AddReturns);</div>
<div class="line">        with(myDocument){</div>
<div class="line">            var elements = xmlElements;</div>
<div class="line">            __processRuleSet(elements.item(0), myRuleSet);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span>{</div>
<div class="line">        alert(<span class="stringliteral">&quot;No open document&quot;</span>);</div>
<div class="line">    }</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">function</span> AddReturns(){</div>
<div class="line">    <span class="comment">//Adds a return character at the end of every XML element.</span></div>
<div class="line">    this.name = <span class="stringliteral">&quot;AddReturns&quot;</span>;</div>
<div class="line">    <span class="comment">//XPath will match on every XML element in the XML structure.</span></div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;//*&quot;</span>; </div>
<div class="line">    <span class="comment">// Define the apply function.</span></div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        with(myElement){</div>
<div class="line">            <span class="comment">//Add a return character at the end of the XML element.</span></div>
<div class="line">            insertTextAsContent(<span class="stringliteral">&quot;\r&quot;</span>, XMLElementPosition.ELEMENT_END);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p> <b>Adding white space and static text</b></p>
<p>The following XML rule script is similar to the previous script, in that it adds white space and static text. It is somewhat more complex, however, in that it treats some XML elements differently based on their element names. For the complete script, see AddReturnsAndStaticText. </p>
<div class="fragment"><div class="line">    <span class="keywordflow">if</span> (app.documents.length != 0){</div>
<div class="line">        var myDocument = app.documents.item(0); </div>
<div class="line">        <span class="comment">//This rule set contains a single rule.</span></div>
<div class="line">        var myRuleSet = <span class="keyword">new</span> Array (<span class="keyword">new</span> ProcessDevice,</div>
<div class="line">                                        <span class="keyword">new</span> ProcessName,</div>
<div class="line">                                        <span class="keyword">new</span> ProcessType,</div>
<div class="line">                                        <span class="keyword">new</span> ProcessPartNumber,</div>
<div class="line">                                        <span class="keyword">new</span> ProcessSupplyVoltage,</div>
<div class="line">                                        <span class="keyword">new</span> ProcessPackageType,</div>
<div class="line">                                        <span class="keyword">new</span> ProcessPackageOne,</div>
<div class="line">                                        <span class="keyword">new</span> ProcessPackages,</div>
<div class="line">                                        <span class="keyword">new</span> ProcessPrice);</div>
<div class="line">        with(myDocument){</div>
<div class="line">            var elements = xmlElements;</div>
<div class="line">            __processRuleSet(elements.item(0), myRuleSet);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span>{</div>
<div class="line">        alert(<span class="stringliteral">&quot;No open document&quot;</span>);</div>
<div class="line">    }</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">//Adds a return character at the end of the &quot;device&quot; XML element.</span></div>
<div class="line"><span class="keyword">function</span> ProcessDevice(){</div>
<div class="line">    this.name = <span class="stringliteral">&quot;ProcessDevice&quot;</span>;</div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;/devices/device&quot;</span>; </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        with(myElement){</div>
<div class="line">            <span class="comment">//Add a return character at the end of the XML element.</span></div>
<div class="line">            insertTextAsContent(<span class="stringliteral">&quot;\r&quot;</span>, XMLElementPosition.afterElement);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="comment">//Adds a return character at the end of the &quot;name&quot; XML element.</span></div>
<div class="line"><span class="keyword">function</span> ProcessName(){</div>
<div class="line">    this.name = <span class="stringliteral">&quot;ProcessName&quot;</span>;</div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;/devices/device/name&quot;</span>;    </div>
<div class="line">    <span class="comment">// Define the apply function.</span></div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        with(myElement){</div>
<div class="line">            <span class="comment">//Add static text at the beginning of the XML element.</span></div>
<div class="line">            insertTextAsContent(<span class="stringliteral">&quot;Device Name: &quot;</span>, XMLElementPosition.beforeElement);</div>
<div class="line">            <span class="comment">//Add a return character at the end of the XML element.</span></div>
<div class="line">            insertTextAsContent(<span class="stringliteral">&quot;\r&quot;</span>, XMLElementPosition.afterElement);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="comment">//Adds a return character at the end of the &quot;type&quot; XML element.</span></div>
<div class="line"><span class="keyword">function</span> ProcessType(){</div>
<div class="line">    this.name = <span class="stringliteral">&quot;ProcessType&quot;</span>;</div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;/devices/device/type&quot;</span>;    </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        with(myElement){</div>
<div class="line">            <span class="comment">//Add static text at the beginning of the XML element.</span></div>
<div class="line">            insertTextAsContent(<span class="stringliteral">&quot;Circuit Type: &quot;</span>, XMLElementPosition.beforeElement);</div>
<div class="line">            <span class="comment">//Add a return character at the end of the XML element.</span></div>
<div class="line">            insertTextAsContent(<span class="stringliteral">&quot;\r&quot;</span>, XMLElementPosition.beforeElement);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="comment">//Adds a return character at the end of the &quot;part_number&quot; XML element.</span></div>
<div class="line"><span class="keyword">function</span> ProcessPartNumber(){</div>
<div class="line">    this.name = <span class="stringliteral">&quot;ProcessPartNumber&quot;</span>;</div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;/devices/device/part_number&quot;</span>; </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        with(myElement){</div>
<div class="line">            <span class="comment">//Add static text at the beginning of the XML element.</span></div>
<div class="line">            insertTextAsContent(<span class="stringliteral">&quot;Part Number: &quot;</span>, XMLElementPosition.beforeElement);</div>
<div class="line">            <span class="comment">//Add a return character at the end of the XML element.</span></div>
<div class="line">            insertTextAsContent(<span class="stringliteral">&quot;\r&quot;</span>, XMLElementPosition.afterElement);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="comment">//Adds static text around the &quot;minimum&quot; and &quot;maximum&quot;</span></div>
<div class="line"><span class="comment">//XML elements of the &quot;supply_voltage&quot; XML element.</span></div>
<div class="line"><span class="keyword">function</span> ProcessSupplyVoltage(){</div>
<div class="line">    this.name = <span class="stringliteral">&quot;ProcessSupplyVoltage&quot;</span>;</div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;/devices/device/supply_voltage&quot;</span>;  </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        <span class="comment">//Note the positions at which we insert the static text. If we use</span></div>
<div class="line">        <span class="comment">//XMLElementPosition.elementEnd, the static text will appear inside the XML element.</span></div>
<div class="line">        <span class="comment">//If we use XMLElementPosition.afterElement, the static text appears outside the</span></div>
<div class="line">        <span class="comment">//XML elment (as a text element of the parent element).</span></div>
<div class="line">        with(myElement){</div>
<div class="line">            <span class="comment">//Add static text to the beginning of the voltage range.</span></div>
<div class="line">            insertTextAsContent(<span class="stringliteral">&quot;Supply Voltage: From &quot;</span>, XMLElementPosition.elementStart);              </div>
<div class="line">            with(myElement.xmlElements.item(0)){</div>
<div class="line">                insertTextAsContent(<span class="stringliteral">&quot; to &quot;</span>, XMLElementPosition.afterElement);               </div>
<div class="line">            }</div>
<div class="line">            with(myElement.xmlElements.item(-1)){</div>
<div class="line">                <span class="comment">//Add static text to the beginning of the voltage range.</span></div>
<div class="line">                insertTextAsContent(<span class="stringliteral">&quot; volts&quot;</span>, XMLElementPosition.afterElement);             </div>
<div class="line">            }</div>
<div class="line">            <span class="comment">//Add a return at the end of the XML element.</span></div>
<div class="line">            insertTextAsContent(<span class="stringliteral">&quot;\r&quot;</span>, XMLElementPosition.afterElement);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="keyword">function</span> ProcessPackageType(){</div>
<div class="line">    this.name = <span class="stringliteral">&quot;ProcessPackageType&quot;</span>;</div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;/devices/device/package/type&quot;</span>;    </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        with(myElement){</div>
<div class="line">            insertTextAsContent(<span class="stringliteral">&quot;-&quot;</span>, XMLElementPosition.afterElement);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="comment">//Add the text &quot;Package:&quot; before the list of packages.</span></div>
<div class="line"><span class="keyword">function</span> ProcessPackageOne(){</div>
<div class="line">    this.name = <span class="stringliteral">&quot;ProcessPackageOne&quot;</span>;</div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;/devices/device/package[1]&quot;</span>;  </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        with(myElement){</div>
<div class="line">            insertTextAsContent(<span class="stringliteral">&quot;Package: &quot;</span>, XMLElementPosition.elementStart);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">//Return false to let other XML rules process the element.</span></div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="comment">//Add commas between the package types.</span></div>
<div class="line"><span class="keyword">function</span> ProcessPackages(){</div>
<div class="line">    this.name = <span class="stringliteral">&quot;ProcessPackages&quot;</span>;</div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;/devices/device/package&quot;</span>; </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        with(myElement){</div>
<div class="line">            <span class="keywordflow">if</span>(myElement.parent.xmlElements.nextItem(myElement).markupTag.name == <span class="stringliteral">&quot;package&quot;</span>){</div>
<div class="line">                insertTextAsContent(<span class="stringliteral">&quot;, &quot;</span>, XMLElementPosition.elementEnd);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span>{</div>
<div class="line">                insertTextAsContent(<span class="stringliteral">&quot;\r&quot;</span>, XMLElementPosition.afterElement);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="keyword">function</span> ProcessPrice(){</div>
<div class="line">    this.name = <span class="stringliteral">&quot;ProcessPrice&quot;</span>;</div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;/devices/device/price&quot;</span>;   </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        with(myElement){</div>
<div class="line">            insertTextAsContent(<span class="stringliteral">&quot;Price: $&quot;</span>, XMLElementPosition.beforeElement);</div>
<div class="line">            <span class="comment">//Add a return at the end of the XML element.</span></div>
<div class="line">            insertTextAsContent(<span class="stringliteral">&quot;\r&quot;</span>, XMLElementPosition.afterElement);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>The above script uses scripting logic to add commas between repeating elements (in the ProcessPackages XML rule). If you have a sequence of similar elements at the same level, you can use forward-axis matching to do the same thing. Given the following example XML structure: <div class="fragment"><div class="line">&lt;xmlElement&gt;</div>
<div class="line">    &lt;item&gt;1&lt;/item&gt;</div>
<div class="line">    &lt;item&gt;2&lt;/item&gt;</div>
<div class="line">    &lt;item&gt;3&lt;/item&gt;</div>
<div class="line">    &lt;item&gt;4&lt;/item&gt;</div>
<div class="line">&lt;/xmlElement&gt;</div>
</div><!-- fragment --> To add commas between each item XML element in a layout, you could use an XML rule like the following (from the ListProcessing tutorial script): <div class="fragment"><div class="line">    var myDocument = app.activeDocument;</div>
<div class="line">    var myRuleSet = <span class="keyword">new</span> Array (<span class="keyword">new</span> ListItems);</div>
<div class="line">    with(myDocument){</div>
<div class="line">        var elements = xmlElements;</div>
<div class="line">        __processRuleSet(elements.item(0), myRuleSet);</div>
<div class="line">    }</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">function</span> ListItems(){</div>
<div class="line">    <span class="comment">//Add commas between each &quot;item&quot; element.</span></div>
<div class="line">    this.name = <span class="stringliteral">&quot;ListItems&quot;</span>;</div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;//xmlElement/item[1]/following-sibling::*&quot;</span>;   </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        with(myElement){</div>
<div class="line">            insertTextAsContent(<span class="stringliteral">&quot;, &quot;</span>, XMLElementPosition.beforeElement);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> </dd></dl>
<h3><a class="anchor" id="id_js_changing_the_xml_structure_using_xml_rules"></a>
Changing the XML structure using XML rules</h3>
<p>Because the order of XML elements is significant in InDesign's XML implementation, you might need to use XML rules to change the sequence of elements in the structure. In general, large-scale changes to the structure of an XML document are best done using an XSLT file to transform the document before or during XML import into InDesign.</p>
<p>The following XML rule script shows how to use the move method to accomplish this. Note the use of the __skipChildren function from the glue code to prevent the XML-rules processor from becoming invalid. For the complete script, see MoveXMLElement. </p>
<div class="fragment"><div class="line">    <span class="keywordflow">if</span> (app.documents.length != 0){</div>
<div class="line">        var myDocument = app.documents.item(0); </div>
<div class="line">        <span class="comment">//This rule set contains a single rule.</span></div>
<div class="line">        var myRuleSet = <span class="keyword">new</span> Array (<span class="keyword">new</span> MoveElement);</div>
<div class="line">        with(myDocument){</div>
<div class="line">            var elements = xmlElements;</div>
<div class="line">            __processRuleSet(elements.item(0), myRuleSet);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span>{</div>
<div class="line">        alert(<span class="stringliteral">&quot;No open document&quot;</span>);</div>
<div class="line">    }</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">//Adds a return character at the end of every XML element.</span></div>
<div class="line"><span class="keyword">function</span> MoveElement(){</div>
<div class="line">    this.name = <span class="stringliteral">&quot;MoveElement&quot;</span>;</div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;/devices/device/part_number&quot;</span>; </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        <span class="comment">//Moves the part_number XML element to the start of </span></div>
<div class="line">        <span class="comment">//the device XML element (the parent).</span></div>
<div class="line">        __skipChildren(myRuleProcessor);</div>
<div class="line">        myElement.move(LocationOptions.before, myElement.parent.xmlElements.item(0));</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    } </div>
<div class="line">}</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_duplicating_xml_elements_with_xml_rules"></a>
Duplicating XML elements with XML rules</h3>
<p>XML elements have a one-to-one relationship with their expression in a layout. If you want the content of an XML element to appear more than once in a layout, you need to duplicate the element. The following script shows how to duplicate elements using XML rules. For the complete script, see DuplicateXMLElement. Again, this rule uses __skipChildren to avoid invalid XML object references. </p>
<div class="fragment"><div class="line">    <span class="keywordflow">if</span> (app.documents.length != 0){</div>
<div class="line">        var myDocument = app.documents.item(0); </div>
<div class="line">        <span class="comment">//This rule set contains a single rule.</span></div>
<div class="line">        var myRuleSet = <span class="keyword">new</span> Array (<span class="keyword">new</span> DuplicateElement);</div>
<div class="line">        with(myDocument){</div>
<div class="line">            var elements = xmlElements;</div>
<div class="line">            __processRuleSet(elements.item(0), myRuleSet);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span>{</div>
<div class="line">        alert(<span class="stringliteral">&quot;No open document&quot;</span>);</div>
<div class="line">    }</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">//Duplicates the part number element in each XML element.</span></div>
<div class="line"><span class="keyword">function</span> DuplicateElement(){</div>
<div class="line">    this.name = <span class="stringliteral">&quot;DuplicateElement&quot;</span>;</div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;/devices/device/part_number&quot;</span>; </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        <span class="comment">//Duplicates the part_number XML element.</span></div>
<div class="line">        __skipChildren(myRuleProcessor);</div>
<div class="line">        myElement.duplicate();</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_xml_rules_and_xml_attributes"></a>
XML rules and XML attributes</h3>
<p>The following XML rule adds attributes to XML elements based on the content of their "name" element. When you need to find an element by its text contents, copying or moving XML element contents to XML attributes attached to their parent XML element can be very useful in XML-rule scripting. While the subset of XPath supported by XML rules cannot search the text of an element, it can find elements by a specified attribute value. For the complete script, see AddAttribute. </p>
<div class="fragment"><div class="line">    <span class="keywordflow">if</span> (app.documents.length != 0){</div>
<div class="line">        var myDocument = app.documents.item(0); </div>
<div class="line">        var myRuleSet = <span class="keyword">new</span> Array (<span class="keyword">new</span> AddAttribute);</div>
<div class="line">        with(myDocument){</div>
<div class="line">            var elements = xmlElements;</div>
<div class="line">            __processRuleSet(elements.item(0), myRuleSet);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span>{</div>
<div class="line">        alert(<span class="stringliteral">&quot;No open document&quot;</span>);</div>
<div class="line">    }</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">function</span> AddAttribute(){</div>
<div class="line">    this.name = <span class="stringliteral">&quot;AddAttribute&quot;</span>;</div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;/devices/device/part_number&quot;</span>; </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        myElement.parent.xmlAttributes.add(<span class="stringliteral">&quot;part_number&quot;</span>, myElement.texts.item(0).contents);</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p> In the previous XML rule, we copied the data from an XML element into an XML attribute attached to its parent XML element. Instead, what if we want to move the XML element data into an attribute and remove the XML element itself? Use the convertToAttribute method, as shown in the following script (from the ConvertToAttribute tutorial script): </p>
<div class="fragment"><div class="line">    <span class="keywordflow">if</span> (app.documents.length != 0){</div>
<div class="line">        var myDocument = app.documents.item(0); </div>
<div class="line">        var myRuleSet = <span class="keyword">new</span> Array (<span class="keyword">new</span> ConvertToAttribute);</div>
<div class="line">        with(myDocument){</div>
<div class="line">            var elements = xmlElements;</div>
<div class="line">            __processRuleSet(elements.item(0), myRuleSet);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span>{</div>
<div class="line">        alert(<span class="stringliteral">&quot;No open document&quot;</span>);</div>
<div class="line">    }</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">//Converts all part_number XML elements to XML attributes.</span></div>
<div class="line"><span class="keyword">function</span> ConvertToAttribute(){</div>
<div class="line">    this.name = <span class="stringliteral">&quot;ConvertToAttribute&quot;</span>;</div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;/devices/device/part_number&quot;</span>; </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        <span class="comment">//Use __skipChildren to prevent the XML rule processor from becoming</span></div>
<div class="line">        <span class="comment">//invalid when we convert the XML element to an attribute.</span></div>
<div class="line">        __skipChildren(myRuleProcessor);</div>
<div class="line">        <span class="comment">//Converts the XML element to an XML attribute of its parent XML element. </span></div>
<div class="line">        myElement.convertToAttribute(<span class="stringliteral">&quot;PartNumber&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p> To move data from an XML attribute to an XML element, use the convertToElement method, as described in <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_xml">XML</a>.</p>
<h3><a class="anchor" id="id_js_applying_multiple_matching_rules"></a>
Applying multiple matching rules</h3>
<p>When the apply function of an XML rule returns true, the XML-rules processor does not apply any further XML rules to the matched XML element. When the apply function returns false, however, the XML-rules processor can apply other rules to the XML element. The following script shows an example of an XML-rule apply function that returns false. This script contains two rules that will match every XML element in the document. The only difference between them is that the first rule applies a color and returns false, while the second rule applies a different color to every other XML element (based on the state of a variable, myCounter). For the complete script, see ReturningFalse. </p>
<div class="fragment"><div class="line">    myCounter = 0;</div>
<div class="line">    <span class="keywordflow">if</span> (app.documents.length != 0){</div>
<div class="line">        var myDocument = app.documents.item(0);</div>
<div class="line">        <span class="comment">//Define two colors. </span></div>
<div class="line">        var myColorA = myDocument.colors.add({model:ColorModel.process, colorValue:[0, 100, 80, 0], name:<span class="stringliteral">&quot;ColorA&quot;</span>});</div>
<div class="line">        var myColorB = myDocument.colors.add({model:ColorModel.process, colorValue:[100, 0, 80, 0], name:<span class="stringliteral">&quot;ColorB&quot;</span>})</div>
<div class="line">        var myRuleSet = <span class="keyword">new</span> Array (<span class="keyword">new</span> ReturnFalse, <span class="keyword">new</span> ReturnTrue);</div>
<div class="line">        with(myDocument){</div>
<div class="line">            var elements = xmlElements;</div>
<div class="line">            __processRuleSet(elements.item(0), myRuleSet);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span>{</div>
<div class="line">        alert(<span class="stringliteral">&quot;No open document&quot;</span>);</div>
<div class="line">    }</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">//Adds a color to the text of every element in the structure.</span></div>
<div class="line"><span class="keyword">function</span> ReturnFalse(){</div>
<div class="line">    this.name = <span class="stringliteral">&quot;ReturnFalse&quot;</span>;</div>
<div class="line">    <span class="comment">//XPath will match on every XML element in the XML structure.</span></div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;//*&quot;</span>; </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        with(myElement){</div>
<div class="line">            myElement.texts.item(0).fillColor = app.documents.item(0).colors.item(<span class="stringliteral">&quot;ColorA&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">// Leaves the XML element available to further processing.</span></div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="comment">//Adds a color to the text of every other element in the structure.</span></div>
<div class="line"><span class="keyword">function</span> ReturnTrue(){</div>
<div class="line">    this.name = <span class="stringliteral">&quot;ReturnTrue&quot;</span>;</div>
<div class="line">    <span class="comment">//XPath will match on every XML element in the XML structure.</span></div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;//*&quot;</span>; </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        with(myElement){</div>
<div class="line">            <span class="keywordflow">if</span>(myCounter % 2 == 0){</div>
<div class="line">                myElement.texts.item(0).fillColor = app.documents.item(0).colors.item(<span class="stringliteral">&quot;ColorB&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">            myCounter++;</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">//Do not process the element with any further matching rules.</span></div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_finding_xml_elements"></a>
Finding XML elements</h3>
<p>As noted earlier, the subset of XPath supported by XML rules does not allow for searching the text contents of XML elements. To get around this limitation, you can either use attributes to find the XML elements you want or search the text of the matching XML elements. The following script shows how to match XML elements using attributes. This script applies a color to the text of elements it finds, but a practical script would do more. For the complete script, see FindXMLElementByAttribute. </p>
<div class="fragment"><div class="line">    <span class="keywordflow">if</span> (app.documents.length != 0){</div>
<div class="line">        var myDocument = app.documents.item(0); </div>
<div class="line">        var myRuleSet = <span class="keyword">new</span> Array(<span class="keyword">new</span> AddAttribute);</div>
<div class="line">        with(myDocument){</div>
<div class="line">            var elements = xmlElements;</div>
<div class="line">            __processRuleSet(elements.item(0), myRuleSet);</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">//Now that the attributes have been added, find and format</span></div>
<div class="line">        <span class="comment">//the XML element whose attribute content matches a specific string.</span></div>
<div class="line">        var myRuleSet = <span class="keyword">new</span> Array(<span class="keyword">new</span> FindAttribute);</div>
<div class="line">        with(myDocument){</div>
<div class="line">            var elements = xmlElements;</div>
<div class="line">            __processRuleSet(elements.item(0), myRuleSet);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span>{</div>
<div class="line">        alert(<span class="stringliteral">&quot;No open document&quot;</span>);</div>
<div class="line">    }</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">function</span> AddAttribute(){</div>
<div class="line">    this.name = <span class="stringliteral">&quot;AddAttribute&quot;</span>;</div>
<div class="line">    <span class="comment">//XPath will match on every part_number XML element in the XML structure.</span></div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;/devices/device/part_number&quot;</span>; </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        myElement.parent.xmlAttributes.add(<span class="stringliteral">&quot;part_number&quot;</span>, myElement.texts.item(0).contents);</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="keyword">function</span> FindAttribute(){</div>
<div class="line">    this.name = <span class="stringliteral">&quot;FindAttribute&quot;</span>;</div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;/devices/device[@part_number = &#39;DS001&#39;]&quot;</span>; </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        myElement.xmlElements.item(0).texts.item(0).fillColor = app.documents.item(0).swatches.item(-1);</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p> The following script shows how to use a JavaScript regular expression (RegExp) to find and format XML elements by their content (for the complete script, see FindXMLElementByRegExp): </p>
<div class="fragment"><div class="line">    <span class="keywordflow">if</span> (app.documents.length != 0){</div>
<div class="line">        var myDocument = app.documents.item(0);</div>
<div class="line">        var myRuleSet = <span class="keyword">new</span> Array (<span class="keyword">new</span> FindByContent);</div>
<div class="line">        with(myDocument){</div>
<div class="line">            var elements = xmlElements;</div>
<div class="line">            __processRuleSet(elements.item(0), myRuleSet);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span>{</div>
<div class="line">        alert(<span class="stringliteral">&quot;No open document&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keyword">function</span> FindByContent(){</div>
<div class="line">        <span class="comment">//Find descriptions that contain both &quot;triangle&quot; and &quot;pulse&quot;.</span></div>
<div class="line">        var myRegExp = /triangle.*?pulse|pulse.*?triangle/i</div>
<div class="line">        this.name = <span class="stringliteral">&quot;FindByContent&quot;</span>;</div>
<div class="line">        this.xpath = <span class="stringliteral">&quot;/devices/device/description&quot;</span>; </div>
<div class="line">        this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">            <span class="keywordflow">if</span>(myRegExp.test(myElement.texts.item(0).contents) == <span class="keyword">true</span>){</div>
<div class="line">                myElement.texts.item(0).fillColor = app.documents.item(0).swatches.item(-1);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment --><p> The following script shows how to use the findText method to find and format XML content (for the complete script, see FindXMLElementByFindText): </p>
<div class="fragment"><div class="line">    <span class="keywordflow">if</span> (app.documents.length != 0){</div>
<div class="line">        var myDocument = app.documents.item(0);</div>
<div class="line">        var myRuleSet = <span class="keyword">new</span> Array (<span class="keyword">new</span> FindByFindText);</div>
<div class="line">        with(myDocument){</div>
<div class="line">            var elements = xmlElements;</div>
<div class="line">            __processRuleSet(elements.item(0), myRuleSet);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span>{</div>
<div class="line">        alert(<span class="stringliteral">&quot;No open document&quot;</span>);</div>
<div class="line">    }</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">function</span> FindByFindText(){</div>
<div class="line">    this.name = <span class="stringliteral">&quot;FindByFindText&quot;</span>;</div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;/devices/device/description&quot;</span>; </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        <span class="keywordflow">if</span>(myElement.texts.item(0).contents != <span class="stringliteral">&quot;&quot;</span>){</div>
<div class="line">            <span class="comment">//Clear the find text preferences.</span></div>
<div class="line">            myResetFindText();</div>
<div class="line">            <span class="comment">//Search for the word &quot;triangle&quot; in the content of the element.</span></div>
<div class="line">            app.findTextPreferences.findWhat = <span class="stringliteral">&quot;triangle&quot;</span>;</div>
<div class="line">            var myFoundItems = myElement.texts.item(0).findText();</div>
<div class="line">            <span class="keywordflow">if</span>(myFoundItems.length != 0){</div>
<div class="line">                myElement.texts.item(0).fillColor = app.documents.item(0).swatches.item(-1);</div>
<div class="line">            }</div>
<div class="line">            myResetFindText();</div>
<div class="line">        }</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="keyword">function</span> myResetFindText(){</div>
<div class="line">    app.findTextPreferences = NothingEnum.nothing;</div>
<div class="line">    app.changeTextPreferences = NothingEnum.nothing;</div>
<div class="line">}</div>
</div><!-- fragment --><p> The following script shows how to use the findGrep method to find and format XML content (for the complete script, see FindXMLElementByFindGrep): </p>
<div class="fragment"><div class="line">    <span class="keywordflow">if</span> (app.documents.length != 0){</div>
<div class="line">        var myDocument = app.documents.item(0);</div>
<div class="line">        var myRuleSet = <span class="keyword">new</span> Array (<span class="keyword">new</span> FindByContent);</div>
<div class="line">        myResetFindChangeGrep();</div>
<div class="line">        app.findGrepPreferences.findWhat = <span class="stringliteral">&quot;(?i)pulse.*?triangle|triangle.*?pulse&quot;</span>;</div>
<div class="line">        with(myDocument){</div>
<div class="line">            var elements = xmlElements;</div>
<div class="line">            __processRuleSet(elements.item(0), myRuleSet);</div>
<div class="line">        }</div>
<div class="line">        myResetFindChangeGrep();</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span>{</div>
<div class="line">        alert(<span class="stringliteral">&quot;No open document&quot;</span>);</div>
<div class="line">    }</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">function</span> FindByContent(){</div>
<div class="line">    <span class="comment">//Find descriptions that contain both &quot;triangle&quot; and &quot;pulse&quot;.</span></div>
<div class="line">    this.name = <span class="stringliteral">&quot;FindByContent&quot;</span>;</div>
<div class="line">    <span class="comment">//XPath will match on every description in the XML structure.</span></div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;/devices/device/description&quot;</span>; </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        var myFoundItems = myElement.texts.item(0).findGrep();</div>
<div class="line">        <span class="keywordflow">if</span>(myFoundItems.length != 0){</div>
<div class="line">            myElement.texts.item(0).fillColor = app.documents.item(0).swatches.item(-1);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="keyword">function</span> myResetFindChangeGrep(){</div>
<div class="line">    app.findGrepPreferences = NothingEnum.nothing;</div>
<div class="line">    app.changeGrepPreferences = NothingEnum.nothing;</div>
<div class="line">}</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_extracting_xml_elements_with_xml_rules"></a>
Extracting XML elements with XML rules</h3>
<p>XSLT often is used to extract a specific subset of data from an XML file. You can accomplish the same thing using XML rules. The following sample script shows how to duplicate a set of sample XML elements and move them to another position in the XML element hierarchy. Note that you must add the duplicated XML elements at a point in the XML structure that will not be matched by the XML rule, or you run the risk of creating an endless loop. For the complete script, see ExtractSubset. </p>
<div class="fragment"><div class="line">    <span class="keywordflow">if</span> (app.documents.length != 0){</div>
<div class="line">        var myDocument = app.documents.item(0); </div>
<div class="line">        var myRuleSet = <span class="keyword">new</span> Array (<span class="keyword">new</span> ExtractVCO);</div>
<div class="line">        var myMarkupTag = myDocument.xmlTags.add(<span class="stringliteral">&quot;VCOs&quot;</span>);</div>
<div class="line">        var myContainerElement = myDocument.xmlElements.item(0).xmlElements.add(myMarkupTag);</div>
<div class="line">        with(myDocument){</div>
<div class="line">            var elements = xmlElements;</div>
<div class="line">            __processRuleSet(elements.item(0), myRuleSet);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span>{</div>
<div class="line">        alert(<span class="stringliteral">&quot;No open document&quot;</span>);</div>
<div class="line">    }</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">function</span> ExtractVCO(){</div>
<div class="line">    var myNewElement;</div>
<div class="line">    this.name = <span class="stringliteral">&quot;ExtractVCO&quot;</span>;</div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;/devices/device/type&quot;</span>;    </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        with(myElement){</div>
<div class="line">            <span class="keywordflow">if</span>(myElement.texts.item(0).contents == <span class="stringliteral">&quot;VCO&quot;</span>){</div>
<div class="line">                myNewElement = myElement.parent.duplicate();</div>
<div class="line">                myNewElement.move(LocationOptions.atEnd, app.documents.item(0).xmlElements.item(0).xmlElements.item(-1));</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_applying_formatting_with_xml_rules"></a>
Applying formatting with XML rules</h3>
<p>The previous XML-rule examples have shown basic techniques for finding XML elements, rearranging the order of XML elements, and adding text to XML elements. Because XML rules are part of scripts, they can perform almost any action-from applying text formatting to creating entirely new page items, pages, and documents. The following XML-rule examples show how to apply formatting to XML elements using XML rules and how to create new page items based on XML-rule matching.</p>
<p>The following script adds static text and applies formatting to the example XML data (for the complete script, see XMLRulesApplyFormatting): </p>
<div class="fragment"><div class="line">    <span class="keywordflow">if</span> (app.documents.length != 0){</div>
<div class="line">        var myDocument = app.documents.item(0);</div>
<div class="line">        <span class="comment">//Document set-up.</span></div>
<div class="line">        myDocument.viewPreferences.horizontalMeasurementUnits = MeasurementUnits.points;</div>
<div class="line">        myDocument.viewPreferences.verticalMeasurementUnits = MeasurementUnits.points;</div>
<div class="line">        myDocument.colors.add({model:ColorModel.process, colorValue:[0, 100, 100, 0], name:<span class="stringliteral">&quot;Red&quot;</span>});</div>
<div class="line">        myDocument.paragraphStyles.add({name:<span class="stringliteral">&quot;DeviceName&quot;</span>, pointSize:24, leading:24, spaceBefore:24, fillColor:<span class="stringliteral">&quot;Red&quot;</span>, paragraphRuleAbove:<span class="keyword">true</span>});</div>
<div class="line">        myDocument.paragraphStyles.add({name:<span class="stringliteral">&quot;DeviceType&quot;</span>, pointSize:12, fontStyle:<span class="stringliteral">&quot;Bold&quot;</span>, leading:12});</div>
<div class="line">        myDocument.paragraphStyles.add({name:<span class="stringliteral">&quot;PartNumber&quot;</span>, pointSize:12, fontStyle:<span class="stringliteral">&quot;Bold&quot;</span>, leading:12});</div>
<div class="line">        myDocument.paragraphStyles.add({name:<span class="stringliteral">&quot;Voltage&quot;</span>, pointSize:10, leading:12});</div>
<div class="line">        myDocument.paragraphStyles.add({name:<span class="stringliteral">&quot;DevicePackage&quot;</span>, pointSize:10, leading:12});</div>
<div class="line">        myDocument.paragraphStyles.add({name:<span class="stringliteral">&quot;Price&quot;</span>, pointSize:10, leading:12, fontStyle:<span class="stringliteral">&quot;Bold&quot;</span>});</div>
<div class="line">        var myRuleSet = <span class="keyword">new</span> Array (<span class="keyword">new</span> ProcessDevice,</div>
<div class="line">                                        <span class="keyword">new</span> ProcessName,</div>
<div class="line">                                        <span class="keyword">new</span> ProcessType,</div>
<div class="line">                                        <span class="keyword">new</span> ProcessPartNumber,</div>
<div class="line">                                        <span class="keyword">new</span> ProcessSupplyVoltage,</div>
<div class="line">                                        <span class="keyword">new</span> ProcessPackageType,</div>
<div class="line">                                        <span class="keyword">new</span> ProcessPackageOne,</div>
<div class="line">                                        <span class="keyword">new</span> ProcessPackages,</div>
<div class="line">                                        <span class="keyword">new</span> ProcessPrice);</div>
<div class="line">        with(myDocument){</div>
<div class="line">            var elements = xmlElements;</div>
<div class="line">            __processRuleSet(elements.item(0), myRuleSet);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span>{</div>
<div class="line">        alert(<span class="stringliteral">&quot;No open document&quot;</span>);</div>
<div class="line">    }</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">function</span> ProcessDevice(){</div>
<div class="line">    this.name = <span class="stringliteral">&quot;ProcessDevice&quot;</span>;</div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;/devices/device&quot;</span>; </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        with(myElement){</div>
<div class="line">            insertTextAsContent(<span class="stringliteral">&quot;\r&quot;</span>, XMLElementPosition.afterElement);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    } </div>
<div class="line">}</div>
<div class="line"><span class="keyword">function</span> ProcessName(){</div>
<div class="line">    this.name = <span class="stringliteral">&quot;ProcessName&quot;</span>;</div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;/devices/device/name&quot;</span>;    </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        var myDocument = app.documents.item(0);</div>
<div class="line">        with(myElement){</div>
<div class="line">            insertTextAsContent(<span class="stringliteral">&quot;\r&quot;</span>, XMLElementPosition.afterElement);</div>
<div class="line">            applyParagraphStyle(myDocument.paragraphStyles.item(<span class="stringliteral">&quot;DeviceName&quot;</span>));</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="keyword">function</span> ProcessType(){</div>
<div class="line">    this.name = <span class="stringliteral">&quot;ProcessType&quot;</span>;</div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;/devices/device/type&quot;</span>;    </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        var myDocument = app.documents.item(0);</div>
<div class="line">        with(myElement){</div>
<div class="line">            insertTextAsContent(<span class="stringliteral">&quot;Circuit Type: &quot;</span>, XMLElementPosition.beforeElement);</div>
<div class="line">            insertTextAsContent(<span class="stringliteral">&quot;\r&quot;</span>, XMLElementPosition.afterElement);</div>
<div class="line">            applyParagraphStyle(myDocument.paragraphStyles.item(<span class="stringliteral">&quot;DeviceType&quot;</span>));</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="keyword">function</span> ProcessPartNumber(){</div>
<div class="line">    this.name = <span class="stringliteral">&quot;ProcessPartNumber&quot;</span>;</div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;/devices/device/part_number&quot;</span>; </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        var myDocument = app.documents.item(0);</div>
<div class="line">        with(myElement){</div>
<div class="line">            <span class="comment">//Add static text at the beginning of the XML element.</span></div>
<div class="line">            insertTextAsContent(<span class="stringliteral">&quot;Part Number: &quot;</span>, XMLElementPosition.beforeElement);</div>
<div class="line">            <span class="comment">//Add a return character at the end of the XML element.</span></div>
<div class="line">            insertTextAsContent(<span class="stringliteral">&quot;\r&quot;</span>, XMLElementPosition.afterElement);</div>
<div class="line">            applyParagraphStyle(myDocument.paragraphStyles.item(<span class="stringliteral">&quot;PartNumber&quot;</span>));             </div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="comment">//Adds static text around the &quot;minimum&quot; and &quot;maximum&quot;</span></div>
<div class="line"><span class="comment">//XML elements of the &quot;supply_voltage&quot; XML element.</span></div>
<div class="line"><span class="keyword">function</span> ProcessSupplyVoltage(){</div>
<div class="line">    this.name = <span class="stringliteral">&quot;ProcessSupplyVoltage&quot;</span>;</div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;/devices/device/supply_voltage&quot;</span>;  </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        var myDocument = app.documents.item(0);</div>
<div class="line">        <span class="comment">//Note the positions at which we insert the static text. </span></div>
<div class="line">        <span class="comment">//If we use XMLElementPosition.elementEnd, the static text </span></div>
<div class="line">        <span class="comment">//will appear inside the XML element. If we use </span></div>
<div class="line">        <span class="comment">//XMLElementPosition.afterElement, the static text appears</span></div>
<div class="line">        <span class="comment">//outside the XML elment (as a text element of the parent element).</span></div>
<div class="line">        with(myElement){</div>
<div class="line">            <span class="comment">//Add static text to the beginning of the voltage range.</span></div>
<div class="line">            insertTextAsContent(<span class="stringliteral">&quot;Supply Voltage: From &quot;</span>, XMLElementPosition.beforeElement);             </div>
<div class="line">            with(myElement.xmlElements.item(0)){</div>
<div class="line">                insertTextAsContent(<span class="stringliteral">&quot; to &quot;</span>, XMLElementPosition.afterElement);               </div>
<div class="line">            }</div>
<div class="line">            with(myElement.xmlElements.item(-1)){</div>
<div class="line">                <span class="comment">//Add static text to the beginning of the voltage range.</span></div>
<div class="line">                insertTextAsContent(<span class="stringliteral">&quot; volts&quot;</span>, XMLElementPosition.afterElement);             </div>
<div class="line">            }</div>
<div class="line">            <span class="comment">//Add a return at the end of the XML element.</span></div>
<div class="line">            insertTextAsContent(<span class="stringliteral">&quot;\r&quot;</span>, XMLElementPosition.afterElement);</div>
<div class="line">            applyParagraphStyle(myDocument.paragraphStyles.item(<span class="stringliteral">&quot;Voltage&quot;</span>));</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="keyword">function</span> ProcessPackageType(){</div>
<div class="line">    this.name = <span class="stringliteral">&quot;ProcessPackageType&quot;</span>;</div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;/devices/device/package/type&quot;</span>;    </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        with(myElement){</div>
<div class="line">            insertTextAsContent(<span class="stringliteral">&quot;-&quot;</span>, XMLElementPosition.afterElement);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="comment">//Add the text &quot;Package:&quot; before the list of packages.</span></div>
<div class="line"><span class="keyword">function</span> ProcessPackageOne(){</div>
<div class="line">    this.name = <span class="stringliteral">&quot;ProcessPackageOne&quot;</span>;</div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;/devices/device/package[1]&quot;</span>;  </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        with(myElement){</div>
<div class="line">            insertTextAsContent(<span class="stringliteral">&quot;Package: &quot;</span>, XMLElementPosition.beforeElement);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">//Return false to let other XML rules process the element.</span></div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="comment">//Add commas between the package types.</span></div>
<div class="line"><span class="keyword">function</span> ProcessPackages(){</div>
<div class="line">    this.name = <span class="stringliteral">&quot;ProcessPackages&quot;</span>;</div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;/devices/device/package&quot;</span>; </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        var myDocument = app.documents.item(0);</div>
<div class="line">        with(myElement){</div>
<div class="line">            <span class="keywordflow">if</span>(myElement.parent.xmlElements.nextItem(myElement).markupTag.name == <span class="stringliteral">&quot;package&quot;</span>){</div>
<div class="line">                insertTextAsContent(<span class="stringliteral">&quot;, &quot;</span>, XMLElementPosition.afterElement);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span>{</div>
<div class="line">                insertTextAsContent(<span class="stringliteral">&quot;\r&quot;</span>, XMLElementPosition.afterElement);</div>
<div class="line">                applyParagraphStyle(myDocument.paragraphStyles.item(<span class="stringliteral">&quot;DevicePackage&quot;</span>));</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="keyword">function</span> ProcessPrice(){</div>
<div class="line">    this.name = <span class="stringliteral">&quot;ProcessPrice&quot;</span>;</div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;/devices/device/price&quot;</span>;   </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        var myDocument = app.documents.item(0);</div>
<div class="line">        with(myElement){</div>
<div class="line">            insertTextAsContent(<span class="stringliteral">&quot;Price: $&quot;</span>, XMLElementPosition.beforeElement);</div>
<div class="line">            <span class="comment">//Add a return at the end of the XML element.</span></div>
<div class="line">            insertTextAsContent(<span class="stringliteral">&quot;\r&quot;</span>, XMLElementPosition.afterElement);</div>
<div class="line">            applyParagraphStyle(myDocument.paragraphStyles.item(<span class="stringliteral">&quot;Price&quot;</span>));              </div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_creating_page_items_with_xml_rules"></a>
Creating page items with XML rules</h3>
<p>The following script creates new page items, inserts the content of XML elements in the page items, adds static text, and applies formatting. We include only the relevant XML-rule portions of the script here; for more information, see the complete script (XMLRulesLayout).</p>
<p>The first rule creates a new text frame for each "device" XML element: </p>
<div class="fragment"><div class="line"><span class="comment">//Creates a new text frame on each page.</span></div>
<div class="line"><span class="keyword">function</span> ProcessDevice(){</div>
<div class="line">    this.name = <span class="stringliteral">&quot;ProcessDevice&quot;</span>;</div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;/devices/device&quot;</span>; </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        var myDocument = app.documents.item(0);</div>
<div class="line">        with(myElement){</div>
<div class="line">            insertTextAsContent(<span class="stringliteral">&quot;\r&quot;</span>, XMLElementPosition.afterElement);</div>
<div class="line">            <span class="keywordflow">if</span>(myDocument.pages.item(0).textFrames.length == 0){</div>
<div class="line">                myPage = myDocument.pages.item(0);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span>{</div>
<div class="line">                myPage = myDocument.pages.add();</div>
<div class="line">            }</div>
<div class="line">            var myBounds = myGetBounds(myDocument, myPage);</div>
<div class="line">            var myTextFrame = placeIntoFrame(myPage, myBounds);</div>
<div class="line">            myTextFrame.textFramePreferences.firstBaselineOffset = FirstBaseline.leadingOffset;</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p> The "ProcessType" rule moves the "type" XML element to a new frame on the page: </p>
<div class="fragment"><div class="line"><span class="comment">//Creates a new text frame at the top of the page to contain the &quot;type&quot; XML element.</span></div>
<div class="line"><span class="keyword">function</span> ProcessType(){</div>
<div class="line">    this.name = <span class="stringliteral">&quot;ProcessType&quot;</span>;</div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;/devices/device/type&quot;</span>;    </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        var myDocument = app.documents.item(0);</div>
<div class="line">        with(myElement){</div>
<div class="line">            var myBounds = myGetBounds(myDocument, myDocument.pages.item(-1));</div>
<div class="line">            myBounds = [myBounds[0]-24, myBounds[1], myBounds[0], myBounds[2]];</div>
<div class="line">            var myTextFrame = placeIntoFrame(myPage, myBounds);</div>
<div class="line">            applyParagraphStyle(myDocument.paragraphStyles.item(<span class="stringliteral">&quot;DeviceType&quot;</span>));</div>
<div class="line">            myTextFrame.textFramePreferences.insetSpacing = [6, 6, 6, 6];</div>
<div class="line">            myTextFrame.fillColor = myDocument.swatches.item(<span class="stringliteral">&quot;Red&quot;</span>)</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_creating_tables_using_xml_rules"></a>
Creating Tables using XML Rules</h2>
<p>You can use the convertElementToTable method to turn an XML element into a table. This method has a limitation in that it assumes that all of the XML elements inside the table conform to a very specific set of XML tags-one tag for a row element; another for a cell, or column element. Typically, the XML data we want to put into a table does not conform to this structure: it is likely that the XML elements we want to arrange in columns use heterogeneous XML tags (price, part number, etc.).</p>
<p>To get around this limitation, we can "wrap" each XML element we want to add to a table row using a container XML element, as shown in the following script fragments (see XMLRulesTable). In this example, a specific XML rule creates an XML element for each row. </p>
<div class="fragment"><div class="line"><span class="keyword">function</span> ProcessDevice(){</div>
<div class="line">    this.name = <span class="stringliteral">&quot;ProcessDevice&quot;</span>;</div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;//device[@type = &#39;VCO&#39;]&quot;</span>; </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">            var myNewElement = myContainerElement.xmlElements.add(app.documents.item(0).xmlTags.item(<span class="stringliteral">&quot;Row&quot;</span>));</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }       </div>
<div class="line">}</div>
</div><!-- fragment --><p> Successive rules move and format their content into container elements inside the row XML element. </p>
<div class="fragment"><div class="line"><span class="keyword">function</span> ProcessPrice(){</div>
<div class="line">    this.name = <span class="stringliteral">&quot;ProcessPrice&quot;</span>;</div>
<div class="line">    this.xpath = <span class="stringliteral">&quot;//device[@type = &#39;VCO&#39;]/price&quot;</span>;   </div>
<div class="line">    this.apply = <span class="keyword">function</span>(myElement, myRuleProcessor){</div>
<div class="line">        with(myElement){</div>
<div class="line">            __skipChildren(myRuleProcessor);</div>
<div class="line">            var myNewElement = myContainerElement.xmlElements.item(-1).xmlElements.add(app.documents.item(0).xmlTags.item(<span class="stringliteral">&quot;Column&quot;</span>));</div>
<div class="line">            var myElement = myElement.move(LocationOptions.atBeginning, myNewElement);</div>
<div class="line">            myElement.insertTextAsContent(<span class="stringliteral">&quot;$&quot;</span>, XMLElementPosition.beforeElement);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }       </div>
<div class="line">}</div>
</div><!-- fragment --><p> Once all of the specified XML elements have been "wrapped," we can convert the container element to a table. </p>
<div class="fragment"><div class="line">    var myTable = myContainerElement.convertElementToTable(myRowTag, myColumnTag);</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_scripting_the_xml-rules_processor_object"></a>
Scripting the XML-rules Processor Object</h2>
<p>While we have provided a set of utility functions in glue code.jsx, you also can script the XML-rules processor object directly. You might want do this to develop your own support routines for XML rules or to use the XML-rules processor in other ways.</p>
<p>When you script XML elements outside the context of XML rules, you cannot locate elements using XPath. You can, however, create an XML rule that does nothing more than return matching XML elements, and apply the rule using an XML-rules processor, as shown in the following script. (This script uses the same XML data file as the sample scripts in previous sections.) For the complete script, see XMLRulesProcessor. </p>
<div class="fragment"><div class="line">    var myXPath = [<span class="stringliteral">&quot;/devices/device&quot;</span>];</div>
<div class="line">    var myXMLMatches = mySimulateXPath(myXPath);</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">function</span> mySimulateXPath(myXPath){</div>
<div class="line">    var myXMLElements = <span class="keyword">new</span> Array;</div>
<div class="line">    var myRuleProcessor = app.xmlRuleProcessors.add(myXPath);</div>
<div class="line">    <span class="keywordflow">try</span>{</div>
<div class="line">        var myMatchData = myRuleProcessor.startProcessingRuleSet(app.documents.item(0).xmlElements.item(0));</div>
<div class="line">        <span class="keywordflow">while</span>(myMatchData != undefined){</div>
<div class="line">            var myElement = myMatchData.element;</div>
<div class="line">            myXMLElements.push(myElement);</div>
<div class="line">            myMatchData = myRuleProcessor.findNextMatch();</div>
<div class="line">        }    </div>
<div class="line">        myRuleProcessor.endProcessingRuleSet();</div>
<div class="line">        myRuleProcessor.remove();</div>
<div class="line">        <span class="keywordflow">return</span> myXMLElements;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span> (myError){</div>
<div class="line">        myRuleProcessor.endProcessingRuleSet();</div>
<div class="line">        myRuleProcessor.remove();</div>
<div class="line">        <span class="keywordflow">throw</span> myError;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> <h1><a class="anchor" id="id_js_track_changes"></a>
Track Changes</h1>
<p>Writers can track, show, hide, accept, and reject changes as a document moves through the writing and editing process. All changes are recorded and visualized to make it easier to review a document.</p>
<p>This tutorial shows how to script the most common operations involving tracking changes.</p>
<p>We assume that you have already read Adobe InDesign Scripting Tutorial and know how to create, install, and run a script. We also assume that you have some knowledge of working with text in InDesign and understand basic typesetting terms.</p>
<h2><a class="anchor" id="id_js_tracking_changes"></a>
Tracking Changes</h2>
<p>This section shows how to navigate tracked changes, accept changes, and reject changes using scripting.</p>
<p>Whenever anyone adds, deletes, or moves text within an existing story, the change is marked in galley and story views.</p>
<h3><a class="anchor" id="id_js_navigating_tracked_changes"></a>
Navigating tracked changes</h3>
<p>If the story contains a record of tracked changes, the user can navigate sequentially through tracked changes. The following script show how to navigate the tracked changes (for the complete script, refer to GetTrackchange).</p>
<p>The script below uses the nextItem method to navigate to the change following the insertion point: </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myStory = myDocument.stories.item(0);</div>
<div class="line">    <span class="comment">//Story.trackChanges  If true, track changes is turned on.</span></div>
<div class="line">    <span class="keywordflow">if</span>(myStory.trackChanges==<span class="keyword">true</span>)</div>
<div class="line">    {</div>
<div class="line">        var myChangeCount = myStory.changes.length;</div>
<div class="line">        var myChange = myStory.changes.item(0);</div>
<div class="line">        <span class="keywordflow">if</span>(myChangeCount&gt;1)</div>
<div class="line">        {</div>
<div class="line">            var myChange0 = myStory.changes.nextItem(myChange);</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment --><p> In the script below, we use the previousItem method to navigate to the change following the insertion point: </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myStory = myDocument.stories.item(0);</div>
<div class="line">    <span class="comment">//Story.trackChanges  If true, track changes is turned on.</span></div>
<div class="line">    <span class="keywordflow">if</span>(myStory.trackChanges==<span class="keyword">true</span>)</div>
<div class="line">    {</div>
<div class="line">        var myChangeCount = myStory.changes.length;</div>
<div class="line">        var myChange = myStory.changes.lastItem();</div>
<div class="line">        <span class="keywordflow">if</span>(myChangeCount&gt;1)</div>
<div class="line">        {</div>
<div class="line">            var myChange0 = myStory.changes.previousItem(myChange);</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_accepting_and_reject_tracked_changes"></a>
Accepting and reject tracked changes</h3>
<p>When changes are made to a story, by you or others, the change-tracking feature enables you to review all changes and decide whether to incorporate them into the story. You can accept and reject changes -added, deleted, or moved text-made by any user.</p>
<p>In the following script, the change is accepted (for the complete script, refer to AcceptChange): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myStory = myDocument.stories.item(0);</div>
<div class="line">    var myChange = myStory.changes.item(0);</div>
<div class="line">    myChange.accept() ;</div>
</div><!-- fragment --><p> In the following script, the change is rejected (for the complete script, refer to RejectChange): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myCount = myDocument.assignments.count();</div>
<div class="line">    var myStory = myDocument.stories.item(0);</div>
<div class="line">    var myChange = myStory.changes.item(0);</div>
<div class="line">    myChange.reject() ;</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_js_information_about_tracked_changes"></a>
Information about tracked changes</h3>
<p>Change information includes include date and time. The following script shows the information of a tracked change (for the complete script, refer to GetChangeInfo): </p>
<div class="fragment"><div class="line">    var myDocument = app.documents.item(0);</div>
<div class="line">    var myStory = myDocument.stories.item(0);</div>
<div class="line">    var myChange = myStory.changes.item(0);</div>
<div class="line">    <span class="comment">//ChangeTypes.DELETED_TEXT (Read Only) Deleted text.</span></div>
<div class="line">    <span class="comment">//ChangeTypes.DELETED_TEXT (Read Only) Deleted text.</span></div>
<div class="line">    <span class="comment">//ChangeTypes.MOVED_TEXT (Read Only) Moved text.</span></div>
<div class="line">    var myChangeTypes = myChange.changeType;</div>
<div class="line">    <span class="comment">//Characters  A collection of characters.</span></div>
<div class="line">    var myCharacters = myChange.characters;</div>
<div class="line">    var myDate = myChange.date;</div>
<div class="line">    <span class="comment">//InsertionPoints A collection of insertion points.</span></div>
<div class="line">    var myInsertionPoints = myChange.insertionPoints;</div>
<div class="line">    <span class="comment">//Change.lines (Read Only) A collection of lines.</span></div>
<div class="line">    var myLines = myChange.lines;</div>
<div class="line">    <span class="comment">//Change.paragraphs (Read Only) A collection of paragraphs.</span></div>
<div class="line">    var myParagraphs = myChange.paragraphs;</div>
<div class="line">    var myStoryOffset = myChange.storyOffset;</div>
<div class="line">    <span class="comment">//Change.textColumns (Read Only) A collection of text columns.</span></div>
<div class="line">    var myTextColumns = myChange.textColumns;</div>
<div class="line">    <span class="comment">//Change.textStyleRanges (Read Only) A collection of text style ranges.</span></div>
<div class="line">    var myTextStyleRanges = myChange.textStyleRanges;</div>
<div class="line">    <span class="comment">//Change.textVariableInstances (Read Only) A collection of text variable instances.</span></div>
<div class="line">    var myTextVariableInstances = myChange.textVariableInstances;</div>
<div class="line">    <span class="comment">//Change.texts (Read Only) A collection of text objects.</span></div>
<div class="line">    var myTexts = myChange.texts;</div>
<div class="line">    var myUserName = myChange.userName;</div>
<div class="line">    var myWords = myChange.words;</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_js_preferences_for_tracking_changes"></a>
Preferences for Tracking Changes</h2>
<p>Track-changes preferences are user settings for tracking changes. For example, you can define which changes are tracked (adding, deleting, or moving text). You can specify the appearance of each type of tracked change, and you can have changes identified with colored change bars in the margins. The following script shows how to set and get these preferences (for the complete script, refer to GetChangePreference):; </p>
<div class="fragment"><div class="line">    var myTrackChangesPreference = app.trackChangesPreferences;</div>
<div class="line">    with(myTrackChangesPreference)</div>
<div class="line">    {</div>
<div class="line">        addedBackgroundColorChoice = ChangeBackgroundColorChoices.CHANGE_BACKGROUND_USES_CHANGE_PREF_COLOR;   </div>
<div class="line">        addedTextColorChoice = ChangeTextColorChoices.CHANGE_USES_CHANGE_PREF_COLOR;</div>
<div class="line">        backgroundColorForAddedText = UIColors.gray;</div>
<div class="line">        var myColor = backgroundColorForDeletedText;</div>
<div class="line">        backgroundColorForDeletedText = UIColors.red;</div>
<div class="line">        backgroundColorForMovedText = UIColors.pink;</div>
<div class="line">        changeBarColor = UIColors.charcoal;</div>
<div class="line">        deletedBackgroundColorChoice = ChangeBackgroundColorChoices.CHANGE_BACKGROUND_USES_CHANGE_PREF_COLOR;   </div>
<div class="line">        deletedTextColorChoice =ChangeTextColorChoices.CHANGE_USES_CHANGE_PREF_COLOR;</div>
<div class="line">        <span class="comment">//ChangebarLocations.LEFT_ALIGN (Read Only) Change bars are in the left margin.</span></div>
<div class="line">        <span class="comment">//ChangebarLocations.RIGHT_ALIGN (Read Only) Change bars are in the right margin</span></div>
<div class="line">        locationForChangeBar = ChangebarLocations.LEFT_ALIGN;  </div>
<div class="line">        <span class="comment">//ChangeMarkings.OUTLINE (Read Only)   Outlines changed text.</span></div>
<div class="line">        <span class="comment">//ChangeMarkings.NONE (Read Only) Does not mark changed text.</span></div>
<div class="line">        <span class="comment">//ChangeMarkings.STRIKETHROUGH (Read Only) Uses a strikethrough to mark changed text.</span></div>
<div class="line">        <span class="comment">//ChangeMarkings.UNDERLINE_SINGLE (Read Only) Underlines changed text.</span></div>
<div class="line">        markingForAddedText = ChangeMarkings.OUTLINE;</div>
<div class="line">        markingForDeletedText = ChangeMarkings.STRIKETHROUGH;</div>
<div class="line">        markingForMovedText = ChangeMarkings.UNDERLINE_SINGLE;</div>
<div class="line">        movedBackgroundColorChoice = ChangeBackgroundColorChoices.CHANGE_BACKGROUND_USES_CHANGE_PREF_COLOR;   </div>
<div class="line">        movedTextColorChoice = ChangeTextColorChoices.CHANGE_USES_CHANGE_PREF_COLOR;</div>
<div class="line">        showAddedText = <span class="keyword">true</span>;</div>
<div class="line">        shhowDeletedText = <span class="keyword">true</span>;</div>
<div class="line">        showMovedText = <span class="keyword">true</span>;</div>
<div class="line">        spellCheckDeletedtext = <span class="keyword">true</span>;</div>
<div class="line">        showChangeBar = <span class="keyword">true</span>;</div>
<div class="line">        textColorForAddedText = UIColors.blue;</div>
<div class="line">        textColorForDeletedText = UIColors.yellow;</div>
<div class="line">        textColorForMovedText = UIColors.green;</div>
<div class="line">    }</div>
</div><!-- fragment --></div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sun Mar 3 2024 02:53:06 for InDesign Scripting SDK by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.3.1 </li>
  </ul>
</div>
</body>
</html>
