<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>InDesign Scripting SDK: VBScript Guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="adobe_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">InDesign Scripting SDK
   &#160;<span id="projectnumber">19.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('id_vb_adobe_indesign_cc_scripting_guide_vbscript.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">VBScript Guide </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="id_vb_introduction"></a>
Introduction</h1>
<p>This document shows how to do the following:</p>
<ul>
<li>Work with the InDesigN scripting environment.</li>
<li>Use advanced scripting features.</li>
<li>Perform basic document tasks like setting up master spreads, printing, and exporting.</li>
<li>Work with page items (rectangles, ellipses, graphic lines, polygons, text frames, and groups).</li>
<li>Work with text and type in an InDesign document, including finding and changing text.</li>
<li>Create dialog boxes and other user-interface items.</li>
<li>Customize and add menus and create menu actions.</li>
<li>Respond to user-interface events.</li>
<li>Work with XML, from creating XML elements and importing XML to adding XML elements to a layout.</li>
<li>Apply XML rules, a new scripting feature that makes working with XML in InDesign faster and easier.</li>
</ul>
<p>We assume that you have already read the Adobe InDesign Scripting Tutorial and know how to create, install, and run scripts. If you need to know how to connect with your scripting environment or view the InDesign scripting object model from your script editor, that information can be found in the Adobe InDesign Scripting Tutorial.</p>
<h2><a class="anchor" id="id_vb_how_to_use_the_scripts_in_this_document"></a>
How to Use the Scripts in this Document</h2>
<p>For the most part, the scripts shown in this document are not complete scripts. They are only fragments of scripts, and are intended to show only the specific part of a script relevant to the point being discussed in the text. You can copy the script lines shown in this document and paste them into your script editor, but you should not expect them to run without further editing. Note, in addition, that scripts copied out of this document may contain line breaks and other characters (due to the document layout) that will prevent them from executing properly.</p>
<p>All of the scripts shown in this document are available in the scripts folder. Move the folders corresponding to the scripting language(s) of your choice into the Scripts Panel folder inside the Scripts folder in your InDesign folder. At that point, you can run the scripts from the Scripts panel inside InDesign.</p>
<h2><a class="anchor" id="id_vb_about_the_structure_of_the_scripts"></a>
About the Structure of the Scripts</h2>
<p>The script examples are all written using a common template that includes the functions "main," "mySetup," "mySnippet," and "myTeardown." We did this to simplify automated testing and publication-there is no reason for you to construct your scripts this way. Most of the time, the part of the script you will be interested in will be inside the "mySnippet" function.</p>
<h2><a class="anchor" id="id_vb_for_more_information"></a>
For More Information</h2>
<p>For more information on InDesign scripting, you also can visit the InDesign Scripting User to User forum, at <a href="http://www.adobeforums.com">http://www.adobeforums.com </a>. In the forum, script writers can ask questions, post answers, and share their newest scripts. The forum contains hundreds of sample scripts.</p>
<h1><a class="anchor" id="id_vb_scripting_features"></a>
Scripting Features</h1>
<p>This section covers scripting techniques related to InDesign's scripting environment. Almost every other object in the InDesign scripting model controls a feature that can change a document or the application defaults. By contrast, the features in this section control how scripts operate.</p>
<p>This document discusses the following:</p>
<ul>
<li>The ScriptPreferences object and its properties.</li>
<li>Getting a reference to the executing script.</li>
<li>Running scripts in prior versions of the scripting object model.</li>
<li>Using the DoScript method to run scripts.</li>
<li>Working with script labels.</li>
<li>Running scripts at InDesign start-up.</li>
</ul>
<p>We assume that you have already read Adobe InDesign Scripting Tutorial and know how to write, install, and run InDesign scripts in the scripting language of your choice.</p>
<h2><a class="anchor" id="id_vb_script_preferences"></a>
Script Preferences</h2>
<p>The ScriptPreferences object provides objects and properties related to the way InDesign runs scripts. The following table provides more detail on each property of the ScriptPreferences object:</p>
<table class="doxtable">
<tr>
<th>Property </th><th>Description </th></tr>
<tr>
<td>EnableRedraw </td><td>Turns screen redraw on or off while a script is running from the Scripts panel. </td></tr>
<tr>
<td>ScriptsFolder </td><td>The path to the scripts folder. </td></tr>
<tr>
<td>ScriptsList </td><td>A list of the available scripts. This property is an array of arrays, in the following form: [[fileName, filePath], ...] Where fileName is the name of the script file and filePath is the full path to the script. You can use this feature to check for the existence of a script in the installed set of scripts. </td></tr>
<tr>
<td>UserInteractionLevel </td><td>This property controls the alerts and dialogs InDesign presents to the user. When you set this property to </td></tr>
</table>
<p>idUserInteractionLevels.idNeverInteract, InDesign does not display any alerts or dialogs. Set it to idUserInteractionLevels.idInteractWithAlerts to enable alerts but disable dialogs. Set it to idUserInteractionLevels.idInteractWithAll to restore the normal display of alerts and dialogs. The ability to turn off alert displays is very useful when you are opening documents via script; often, InDesign displays an alert for missing fonts or linked graphics files. To avoid this alert, set the user-interaction level to idUserInteractionLevels.idNeverInteract before opening the document, then restore user interaction (set the property to idUserInteractionLevels.idInteractWithAll) before completing script execution. Version | The version of the scripting environment in use. For more information, see <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_script_versioning">Script Versioning</a>. Note this property is not the same as the version of the application.</p>
<h2><a class="anchor" id="id_vb_getting_the_current_script"></a>
Getting the Current Script</h2>
<p>You can get a reference to the current script using the ActiveScript property of the application object. You can use this property to help you locate files and folders relative to the script, as shown in the following example (from the ActiveScript tutorial script): </p>
<div class="fragment"><div class="line">    myActiveScript = myInDesign.ActiveScript</div>
<div class="line">    MsgBox (<span class="stringliteral">&quot;The current script is: &quot;</span> &amp; myActiveScript)</div>
<div class="line">    Set myFileSystemObject = CreateObject(&quot;Scripting.FileSystemObject&quot;)</div>
<div class="line">    myParentFolder = myFileSystemObject.GetFile(myActiveScript).ParentFolder</div>
<div class="line">    MsgBox (&quot;The folder containing the active script is: &quot; &amp; myParentFolder)</div>
</div><!-- fragment --><p> When you debug scripts using a script editor, the ActiveScript property returns an error. Only scripts run from the Scripts palette appear in the ActiveScript property.</p>
<h2><a class="anchor" id="id_vb_script_versioning"></a>
Script Versioning</h2>
<p>InDesign can run scripts using earlier versions of the InDesign scripting object model. To run an older script in a newer version of InDesign, you must consider the following:</p>
<ul>
<li><b>Targeting</b> - Scripts must be targeted to the version of InDesign in which they are being run (i.e., the current version). The mechanics of targeting are language specific as described in <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_targeting">Targeting</a>.</li>
<li><b>Compilation</b> - This involves mapping the names in the script to the underlying script IDs, which are what InDesign understands. The mechanics of compilation are language specific as described in <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_compilation">Compilation</a>.</li>
<li><b>Interpretation</b> - This involves matching the IDs to the appropriate request handler within InDesign so that InDesign correctly interprets a script written for an earlier version of the scripting object model. To do this, either explicitly set the application's script preferences to the old object model within the script (as shown in <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_interpretation">Interpretation</a>) or run the script from a folder in the Scripts panel folder as follows:</li>
</ul>
<table class="doxtable">
<tr>
<th>Folder </th><th>For InDesign version of scripts </th></tr>
<tr>
<td>Version 19.0 Scripts </td><td>2024 </td></tr>
<tr>
<td>Version 18.0 Scripts </td><td>2023 </td></tr>
<tr>
<td>Version 17.0 Scripts </td><td>2022 </td></tr>
<tr>
<td>Version 16.0 Scripts </td><td>2021 </td></tr>
<tr>
<td>Version 15.0 Scripts </td><td>2020 </td></tr>
<tr>
<td>Version 14.0 Scripts </td><td>CC 2019 </td></tr>
<tr>
<td>Version 13.0 Scripts </td><td>CC 2018 </td></tr>
<tr>
<td>Version 12.0 Scripts </td><td>CC 2017 </td></tr>
<tr>
<td>Version 11.0 Scripts </td><td>CC 2015 </td></tr>
<tr>
<td>Version 10.0 Scripts </td><td>CC 2014 </td></tr>
<tr>
<td>Version 9.0 Scripts </td><td>CC </td></tr>
<tr>
<td>Version 8.0 Scripts </td><td>CS6 </td></tr>
<tr>
<td>Version 7.0 Scripts </td><td>CS5 and CS5.5 </td></tr>
<tr>
<td>Version 6.0 Scripts </td><td>CS4 </td></tr>
<tr>
<td>Version 5.0 Scripts </td><td>CS3 </td></tr>
<tr>
<td>Version 2.0 Scripts </td><td>CS2 </td></tr>
</table>
<h3><a class="anchor" id="id_vb_targeting"></a>
Targeting</h3>
<p>A script must always target the version of InDesign under which it is running (the current version), either explicitly or implicitly. Targeting is implicit when the script is launched from the Scripts panel.</p>
<p>Otherwise, explicit targeting for Visual Basic applications and VBScripts is done using the CreateObject method: </p>
<div class="fragment"><div class="line">Rem Target InDesign 2024:</div>
<div class="line">Set myApp = CreateObject(<span class="stringliteral">&quot;InDesign.Application.2024&quot;</span>)</div>
<div class="line">Rem Target the last version of InDesign that was launched with admin privileges:</div>
<div class="line">Set myApp = CreateObject(&quot;InDesign.Application&quot;)</div>
</div><!-- fragment --><h3><a class="anchor" id="id_vb_compilation"></a>
Compilation</h3>
<p>Compilation of Visual Basic applications may be versioned by referencing an earlier version of the type library. To generate an earlier version of the type library, use the PublishTerminology method, which is exposed on the Application object. The type library is generated into a folder (named with the version of the DOM) that is in the Scripting Support folder in your application's preferences folder. For example, to generate the CC 2017 dictionary into the C:\Users\&lt;username&gt;\Application Data\Adobe\InDesign\Version 13.0\&lt;locale&gt;\Scripting Support\12.0 folder:</p>
<div class="fragment"><div class="line">Set myApp = CreateObject(<span class="stringliteral">&quot;InDesign.Application.2024&quot;</span>)</div>
<div class="line">Rem Publish the InDesign CC 2017 type library (version 12.0 DOM)</div>
<div class="line">myApp.PublishTerminology(12.0)</div>
</div><!-- fragment --><p>VBScripts are not precompiled. For compilation, InDesign generates and references the appropriate type library automatically, based on the version of the DOM set for interpretation.</p>
<h3><a class="anchor" id="id_vb_interpretation"></a>
Interpretation</h3>
<p>The InDesign application object contains a ScriptPreferences object, which allows a script to get/set the version of the scripting object model to use for interpreting scripts. The version defaults to the current version of the application and persists.</p>
<p>For example, to change the version of the scripting object model to CC 2017 (12.0):</p>
<div class="fragment"><div class="line">Set myInDesign = CreateObject(<span class="stringliteral">&quot;InDesign.Application.2024&quot;</span>)</div>
<div class="line">Rem Set to 12.0 DOM</div>
<div class="line">myInDesign.ScriptPreferences.Version = 12.0</div>
</div><!-- fragment --><h2><a class="anchor" id="id_vb_using_the_doscript_method"></a>
Using the DoScript Method</h2>
<p>The DoScript method gives a script a way to execute another script. The script can be a string of valid scripting code or a file on disk. The script can be in the same scripting language as the current script or another scripting language. The available languages vary by platform: on Mac, you can run AppleScript or JavaScript; on Windows, VBScript or JavaScript.</p>
<p>The DoScript method has many possible uses:</p>
<ul>
<li>Running a script in another language that provides a feature missing in your main scripting language. For example, VBScript lacks the ability to display a file or folder browser, which JavaScript has. AppleScript can be very slow to compute trigonometric functions (sine and cosine), but JavaScript performs these calculations rapidly. JavaScript does not have a way to query Microsoft&reg; Excel for the contents of a specific spreadsheet cell, but both AppleScript and VBScript have this capability. In all these examples, the DoScript method can execute a snippet of scripting code in another language, to overcome a limitation of the language used for the body of the script.</li>
<li>Creating a script "on the fly." Your script can create a script (as a string) during its execution, which it can then execute using the DoScript method. This is a great way to create a custom dialog or panel based on the contents of the selection or the attributes of objects the script creates.</li>
<li>Embedding scripts in objects. Scripts can use the DoScript method to run scripts that were saved as strings in the label property of objects. Using this technique, an object can contain a script that controls its layout properties or updates its content according to certain parameters. Scripts also can be embedded in XML elements as an attribute of the element or as the contents of an element. See <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_running_scripts_at_startup">Running Scripts at Startup</a>.</li>
</ul>
<h3><a class="anchor" id="id_vb_sending_parameters_to_doscript"></a>
Sending parameters to DoScript</h3>
<p>To send a parameter to a script executed by DoScript, use the following form (from the DoScriptParameters tutorial script): </p>
<div class="fragment"><div class="line">    myParameters = Array(<span class="stringliteral">&quot;Hello from DoScript&quot;</span>, <span class="stringliteral">&quot;Your message here.&quot;</span>)</div>
<div class="line">    myJavaScript = &quot;alert(&quot;&quot;First argument: &quot;&quot; + arguments[0] +&quot;</div>
<div class="line">    myJavaScript = myJavaScript &amp; &quot; &quot;&quot;\rSecond argument: &quot;&quot; + arguments[1]);&quot;</div>
<div class="line">    myInDesign.DoScript myJavaScript, idScriptLanguage.idJavascript, myParameters</div>
<div class="line">    myVBScript = &quot;msgbox &quot;&quot;First argument: &quot;&quot; &amp; arguments(0) &amp; vbcr &amp; &quot;&quot;Second argument: &quot;&quot; &amp; arguments(1), vbOKOnly,&quot;&quot;DoScript Parameters&quot;&quot;&quot;</div>
<div class="line">    myInDesign.DoScript myVBScript, idScriptLanguage.idVisualBasic, myParameters</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_returning_values_from_doscript"></a>
Returning values from DoScript</h3>
<p>The following script fragment shows how to return a value from a script executed by DoScript. This example uses a JavaScript that is executed as a string, but the same method works for script files. This example returns a single value, but you can return multiple values by returning an array (for the complete script, refer to the DoScriptReturnValues script). </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    Set myTextFrame = myPage.TextFrames.Item(1)</div>
<div class="line">    Set myDestinationPage = myDocument.Pages.Add(idLocationOptions.idAfter, myPage)</div>
<div class="line">    myPageIndex = myDestinationPage.Name</div>
<div class="line">    myID = myTextFrame.Id</div>
<div class="line">    myJavaScript = <span class="stringliteral">&quot;var myDestinationPage = arguments[1];&quot;</span> &amp; vbCr</div>
<div class="line">    myJavaScript = myJavaScript &amp; <span class="stringliteral">&quot;myID = arguments[0];&quot;</span> &amp; vbCr</div>
<div class="line">    myJavaScript = myJavaScript &amp; <span class="stringliteral">&quot;var myX = arguments[2];&quot;</span> &amp; vbCr</div>
<div class="line">    myJavaScript = myJavaScript &amp; <span class="stringliteral">&quot;var myY = arguments[3];&quot;</span> &amp; vbCr</div>
<div class="line">    myJavaScript = myJavaScript &amp; <span class="stringliteral">&quot;var myPageItem = app.documents.item(0).pages.item(0).pageItems.itemByID(myID);&quot;</span> &amp; vbCr</div>
<div class="line">    myJavaScript = myJavaScript &amp; <span class="stringliteral">&quot;myPageItem.duplicate(app.documents.item(0).pages.item(myDestinationPage));&quot;</span> &amp; vbCr</div>
<div class="line">    Rem Create an array <span class="keywordflow">for</span> the parameters we want to pass to the JavaScript.</div>
<div class="line">    myArguments = Array(myID, myPageIndex, 0, 0)</div>
<div class="line">    Set myDuplicate = myInDesign.DoScript(myJavaScript, idScriptLanguage.idJavascript, myArguments)</div>
<div class="line">    Rem myDuplicate now contains a reference to the duplicated text frame.</div>
<div class="line">    Rem Change the text in the duplicated text frame.</div>
<div class="line">    myDuplicate.contents = &quot;Duplicated text frame.&quot;</div>
</div><!-- fragment --><p> Another way to get values from another script is to use the ScriptArgs (short for "script arguments") object of the application. The following script fragment shows how to do this (for the complete script, see DoScriptScriptArgs): </p>
<div class="fragment"><div class="line">    nameA = <span class="stringliteral">&quot;ScriptArgumentA&quot;</span></div>
<div class="line">    nameB = <span class="stringliteral">&quot;ScriptArgumentB&quot;</span></div>
<div class="line">    Rem Create a <span class="keywordtype">string</span> to be run as a JavaScript.</div>
<div class="line">    myJavaScript = <span class="stringliteral">&quot;app.scriptArgs.setValue(&quot;</span><span class="stringliteral">&quot;&quot;</span> &amp; nameA &amp; <span class="stringliteral">&quot;&quot;</span><span class="stringliteral">&quot;,&quot;</span></div>
<div class="line">    myJavaScript = myJavaScript &amp; <span class="stringliteral">&quot;&quot;</span><span class="stringliteral">&quot;This is the first script argument value.&quot;</span><span class="stringliteral">&quot;);&quot;</span> &amp; vbCr</div>
<div class="line">    myJavaScript = myJavaScript &amp; <span class="stringliteral">&quot;app.scriptArgs.setValue(&quot;</span><span class="stringliteral">&quot;&quot;</span> &amp; nameB &amp; <span class="stringliteral">&quot;&quot;</span><span class="stringliteral">&quot;,&quot;</span></div>
<div class="line">    myJavaScript = myJavaScript &amp; <span class="stringliteral">&quot;&quot;</span><span class="stringliteral">&quot;This is the second script argument value.&quot;</span><span class="stringliteral">&quot;);&quot;</span> &amp; vbCr</div>
<div class="line">    myInDesign.DoScript myJavaScript, idScriptLanguage.idJavascript</div>
<div class="line">    myScriptArgumentA = myInDesign.ScriptArgs.GetValue(nameA)</div>
<div class="line">    myScriptArgumentB = myInDesign.ScriptArgs.GetValue(nameB)</div>
<div class="line">    MsgBox <span class="stringliteral">&quot;JavaScript&quot;</span> &amp; vbcr &amp; <span class="stringliteral">&quot;Script argument A: &quot;</span> &amp; myScriptArgumentA &amp; vbCr &amp; <span class="stringliteral">&quot;Script argument B: &quot;</span> &amp; myScriptArgumentB</div>
<div class="line">    Rem Create a <span class="keywordtype">string</span> to be run as a VBScript.</div>
<div class="line">    myVBScript = <span class="stringliteral">&quot;Set myInDesign = CreateObject(&quot;</span><span class="stringliteral">&quot;InDesign.Application.2024&quot;</span><span class="stringliteral">&quot;)&quot;</span> &amp; vbCr</div>
<div class="line">    myVBScript = myVBScript &amp; <span class="stringliteral">&quot;myInDesign.ScriptArgs.SetValue &quot;</span><span class="stringliteral">&quot;&quot;</span> &amp; nameA &amp; <span class="stringliteral">&quot;&quot;</span><span class="stringliteral">&quot;,&quot;</span></div>
<div class="line">    myVBScript = myVBScript &amp; <span class="stringliteral">&quot; &quot;</span><span class="stringliteral">&quot;This is the first script argument value.&quot;</span><span class="stringliteral">&quot;&quot;</span> &amp; vbCr</div>
<div class="line">    myVBScript = myVBScript &amp; <span class="stringliteral">&quot;myInDesign.ScriptArgs.SetValue &quot;</span><span class="stringliteral">&quot;&quot;</span> &amp; nameB &amp; <span class="stringliteral">&quot;&quot;</span><span class="stringliteral">&quot;,&quot;</span></div>
<div class="line">    myVBScript = myVBScript &amp; <span class="stringliteral">&quot; &quot;</span><span class="stringliteral">&quot;This is the second script argument value.&quot;</span><span class="stringliteral">&quot;&quot;</span></div>
<div class="line">    myInDesign.DoScript myVBScript, idScriptLanguage.idVisualBasic</div>
<div class="line">    myScriptArgumentA = myInDesign.ScriptArgs.GetValue(nameA)</div>
<div class="line">    myScriptArgumentB = myInDesign.ScriptArgs.GetValue(nameB)</div>
<div class="line">    MsgBox <span class="stringliteral">&quot;VBScript&quot;</span> &amp; vbcr &amp; <span class="stringliteral">&quot;Script argument A: &quot;</span> &amp; myScriptArgumentA &amp; vbCr &amp; <span class="stringliteral">&quot;Script argument B: &quot;</span> &amp; myScriptArgumentB</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_controlling_undo_with_doscript"></a>
Controlling Undo with DoScript</h2>
<p>InDesign gives you the ability to undo almost every action, but this comes at a price: for almost every action you make, InDesign writes to disk. For normal work you using the tools presented by the user interface, this does not present any problem. For scripts, which can perform thousands of actions in the time a human being can blink, the constant disk access can be a serious drag on performance.</p>
<p>The DoScript method offers a way around this performance bottleneck by providing two parameters that control the way that scripts are executed relative to InDesign's Undo behavior. These parameters are shown in the following examples: </p>
<div class="fragment"><div class="line">Rem Given a script <span class="stringliteral">&quot;myVBScript&quot;</span> and an array of parameters <span class="stringliteral">&quot;myParameters&quot;</span>...</div>
<div class="line">myInDesign.DoScript myVBScript, idScriptLanguage.idVisualBasic, myParameters, idUndoModes.idFastEntireScript, <span class="stringliteral">&quot;Script Action&quot;</span></div>
<div class="line">Rem idUndoModes can be:</div>
<div class="line">Rem idUndoModes.idAutoUnto: Add no events to the Undo queue.</div>
<div class="line">Rem idUndoModes.idEntireScript: Put a single <span class="keyword">event</span> in the Undo queue.</div>
<div class="line">Rem idUndoModes.idFastEntireScript: Put a single <span class="keyword">event</span> in the Undo queue.</div>
<div class="line">Rem idUndoModes.idScriptRequest: Undo each script action as a separate <span class="keyword">event</span>.</div>
<div class="line">Rem The last parameter is the text that appears in the Undo menu item.</div>
</div><!-- fragment --><h2><a class="anchor" id="id_vb_working_with_script_labels"></a>
Working with Script Labels</h2>
<p>Many objects in InDesign scripting have a label property, including page items (rectangles, ovals, groups, polygons, text frames, and graphic lines), table cells, documents, stories, and pages. This property can store a very large amount of text.</p>
<p>The label of page items can be viewed, entered, or edited using the Script Label panel (choose Window &gt; Utilities &gt; Script Label to display this panel), shown below. You also can add a label to an object using scripting, and you can read the script label via scripting. For many objects, like stories, pages, and paragraph styles, you cannot set or view the label using the Script Label panel. </p>
<div class="image">
<img src="InDesign_ScriptingGuide-1.gif" alt="InDesign_ScriptingGuide-1.gif"/>
</div>
<p>The label property can contain any form of text data, such as tab- or comma-delimited text, HTML, or XML. Because scripts also are text, they can be stored in the label property.</p>
<p>Page items can be referred to by their label, just like named items (such as paragraph styles, colors, or layers) can be referred to by their name. The following script fragment demonstrates this special case of the label property (for the complete script, see ScriptLabel): </p>
<div class="fragment"><div class="line">   Set myDocument = myInDesign.Documents.Add</div>
<div class="line">   Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">   myPageWidth = myDocument.DocumentPreferences.PageWidth</div>
<div class="line">   myPageHeight = myDocument.DocumentPreferences.PageHeight</div>
<div class="line">   Rem Create 10 random page items.</div>
<div class="line">   For i = 1 To 10</div>
<div class="line">       myX1 = myGetRandom(0, myPageWidth, False)</div>
<div class="line">       myY1 = myGetRandom(0, myPageHeight, False)</div>
<div class="line">       myX2 = myGetRandom(0, myPageWidth, False)</div>
<div class="line">       myY2 = myGetRandom(0, myPageHeight, False)</div>
<div class="line">       Set myRectangle = myPage.Rectangles.Add</div>
<div class="line">       myRectangle.GeometricBounds = Array(myY1, myX1, myY2, myX2)</div>
<div class="line">       If myGetRandom(0, 1, True) &gt; 0 Then</div>
<div class="line">           myRectangle.Label = &quot;myScriptLabel&quot;</div>
<div class="line">       End If</div>
<div class="line">   Next</div>
<div class="line">   Count = 0</div>
<div class="line">   For i = 1 To myPage.PageItems.Count</div>
<div class="line">       If myPage.PageItems.Item(i).Label = &quot;myScriptLabel&quot; Then</div>
<div class="line">           Count = Count + 1</div>
<div class="line">       End If</div>
<div class="line">   Next</div>
<div class="line">   MsgBox (&quot;Found &quot; &amp; CStr(Count) &amp; &quot; page items with the label.&quot;)</div>
</div><!-- fragment --><div class="fragment"><div class="line">Rem This <span class="keyword">function</span> gets a random number in the range myStart to myEnd.</div>
<div class="line">Function myGetRandom(myStart, myEnd, myInteger)</div>
<div class="line">    Rem Here&#39;s how to generate a random number from a given range:</div>
<div class="line">    Rem Int((upperbound - lowerbound + 1) * Rnd + lowerbound)</div>
<div class="line">    If myInteger = True Then</div>
<div class="line">        myGetRandom = Int(((myEnd - myStart + 1) * Rnd) + myStart)</div>
<div class="line">    Else</div>
<div class="line">        myGetRandom = ((myEnd - myStart + 1) * Rnd) + myStart</div>
<div class="line">    End If</div>
<div class="line">End Function</div>
</div><!-- fragment --><p> In addition, all objects that support the label property also support custom labels. A script can set a custom label using the InsertLabel method, and extract the custom label using the ExtractLabel method, as shown in the following script fragment (from the CustomLabel tutorial script): </p>
<div class="fragment"><div class="line">Function mySetup(myInDesign)</div>
<div class="line">    Set myDocument = myInDesign.Documents.Add</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    myDocument.ViewPreferences.HorizontalMeasurementUnits = idMeasurementUnits.idPoints</div>
<div class="line">    myDocument.ViewPreferences.VerticalMeasurementUnits = idMeasurementUnits.idPoints</div>
<div class="line">    Set myRectangle = myPage.Rectangles.Add</div>
<div class="line">    myRectangle.GeometricBounds = Array(72, 72, 144, 144)</div>
<div class="line">End Function</div>
<div class="line">Function mySnippet(myInDesign)</div>
<div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    Set myRectangle = myPage.Rectangles.Item(1)</div>
<div class="line">    Rem Insert a custom label using insertLabel. The first parameter is the</div>
<div class="line">    Rem name of the label, the second is the text to add to the label.</div>
<div class="line">    myRectangle.InsertLabel &quot;CustomLabel&quot;, &quot;This is some text stored in a custom label.&quot;</div>
<div class="line">    Rem Extract the text from the label and display it in an message box.</div>
<div class="line">    myString = myRectangle.ExtractLabel(&quot;CustomLabel&quot;)</div>
<div class="line">    MsgBox (&quot;Custom label contained: &quot; + myString)</div>
<div class="line">End Function</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_running_scripts_at_startup"></a>
Running Scripts at Startup</h2>
<p>To run a script when InDesign starts, put the script in the Startup Scripts folder in the Scripts folder (for more information, see <a class="el" href="id_scripting_tutorial.html#id_installing_scripts">Installing Scripts</a> in Adobe InDesign Scripting Tutorial).</p>
<h1><a class="anchor" id="id_vb_documents"></a>
Documents</h1>
<p>The work you do in InDesign revolves around documents-creating them, saving them, printing or exporting them, and populating them with page items, colors, styles, and text. Almost every document-related task can be automated using InDesign scripting.</p>
<p>We assume that you have already read Adobe InDesign Scripting Tutorial and know how to create, install, and run a script.</p>
<h2><a class="anchor" id="id_vb_basic_document_operations"></a>
Basic Document Operations</h2>
<p>Opening, closing, and saving documents are some of the most basic document tasks. This section shows how to do them using scripting.</p>
<h3><a class="anchor" id="id_vb_creating_a_new_document"></a>
Creating a new document</h3>
<p>The following script shows how to make a new document using scripting. (For the complete script, see MakeDocument.) </p>
<div class="fragment"><div class="line">   Set myDocument = myInDesign.Documents.Add</div>
</div><!-- fragment --><p> To create a document using a document preset, the Add method includes an optional parameter you can use to specify a document preset, as shown in the following script. (For the complete script, see MakeDocumentWithPreset.) </p>
<div class="fragment"><div class="line">   Rem Creates a <span class="keyword">new</span> document <span class="keyword">using</span> the specified document preset.</div>
<div class="line">   Set myInDesign = CreateObject(<span class="stringliteral">&quot;InDesign.Application.2024&quot;</span>)</div>
<div class="line">   Rem Replace &quot;myDocumentPreset&quot; in the following line with the name</div>
<div class="line">   Rem of the document preset you want to use.</div>
<div class="line">   Set myDocumentPreset = myInDesign.DocumentPresets.Item(&quot;myDocumentPreset&quot;)</div>
<div class="line">   Set myDocument = myInDesign.Documents.Add(True, myDocumentPreset)</div>
</div><!-- fragment --><p> You can create a document without displaying it in a window, as shown in the following script fragment (from the MakeDocumentWithParameters tutorial script): </p>
<div class="fragment"><div class="line">    Rem Creates a <span class="keyword">new</span> document without showing the document window.</div>
<div class="line">    Rem The first parameter (ShowingWindow) controls the visibility of the document.</div>
<div class="line">    Rem Hidden documents are not minimized, and will not appear until you</div>
<div class="line">    Rem create a new window.</div>
<div class="line">    Set myDocument = myInDesign.Documents.Add(False)</div>
<div class="line">    Rem If you set the ShowingWindow parameter to False, you can</div>
<div class="line">    Rem show the document by creating a new window.</div>
<div class="line">    Set myLayoutWindow = myDocument.Windows.Add</div>
</div><!-- fragment --><p> Some script operations are much faster when the document window is hidden.</p>
<h3><a class="anchor" id="id_vb_opening_a_document"></a>
Opening a document</h3>
<p>The following script shows how to open an existing document. (For the complete script, see OpenDocument.) </p>
<div class="fragment"><div class="line">    Rem You<span class="stringliteral">&#39;ll have to fill in your own file path.</span></div>
<div class="line"><span class="stringliteral">    Set myDocument = myInDesign.Open(&quot;C:\OpenDocument.indd&quot;)</span></div>
</div><!-- fragment --><p> You can choose to prevent the document from displaying (that is, hide it) by setting the showing window parameter of the Open method to false (the default is true). You might want to do this to improve performance of a script. To show a hidden document, create a new window, as shown in the following script fragment (from the OpenDocumentInBackground tutorial script): </p>
<div class="fragment"><div class="line">    Rem You<span class="stringliteral">&#39;ll have to fill in your own file path.</span></div>
<div class="line"><span class="stringliteral">    Set myDocument = myInDesign.Open(&quot;C:\OpenDocInBackground.indd&quot;, False)</span></div>
<div class="line"><span class="stringliteral">    Rem At this point, you can do things with the document without </span></div>
<div class="line"><span class="stringliteral">    Rem showing the document window. This can speed up many scripting</span></div>
<div class="line"><span class="stringliteral">    Rem operations, and makes it possible for a script to operate</span></div>
<div class="line"><span class="stringliteral">    Rem on a file in the background.</span></div>
<div class="line"><span class="stringliteral">    MsgBox (&quot;Document is open but not visible&quot;)</span></div>
<div class="line"><span class="stringliteral">    Rem When you want to show the hidden document, create a new window.</span></div>
<div class="line"><span class="stringliteral">    Set myLayoutWindow = myDocument.Windows.Add</span></div>
<div class="line"><span class="stringliteral">    MsgBox (&quot;Document is now visible&quot;)</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_saving_a_document"></a>
Saving a document</h3>
<p>In the InDesign user interface, you save a file by choosing File &gt; Save, and you save a file to another file name by choosing File &gt; Save As. In InDesign scripting, the Save method can do either operation, as shown in the following script fragment (from the SaveDocument tutorial script): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Rem If the document has been changed since it was last saved, save it.</div>
<div class="line">    Rem If the file is untitled, InDesign will display the Save dialog box.</div>
<div class="line">    If myDocumentSaved = False Then</div>
<div class="line">        myDocument.Save</div>
<div class="line">    End If</div>
</div><!-- fragment --><p> The Save method has two optional parameters: The first (to) specifies the file to save to; the second (stationery) can be set to true to save the document as a template, as shown in the following script fragment (from the SaveDocumentAs tutorial script): </p>
<div class="fragment"><div class="line">   <span class="keyword">set</span> myDocument = myIndesign.Documents.Item(1)</div>
<div class="line">   <span class="keywordflow">if</span> myDocument.Saved = False Then</div>
<div class="line">       Rem If you <span class="keywordflow">do</span> not provide a file name, </div>
<div class="line">       Rem InDesign will display the Save dialog box.</div>
<div class="line">       Rem You<span class="stringliteral">&#39;ll have to fill in your own file path.</span></div>
<div class="line"><span class="stringliteral">       myDocument.Save &quot;C:\SaveDocumentAs.indd&quot;</span></div>
<div class="line"><span class="stringliteral">   End If</span></div>
</div><!-- fragment --><p> You can save a document as a template, as shown in the following script fragment (from the SaveAsTemplate tutorial script): </p>
<div class="fragment"><div class="line">    <span class="keyword">set</span> myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    If myDocument.Saved = True Then</div>
<div class="line">        Rem Convert the file name to a <span class="keywordtype">string</span>.</div>
<div class="line">        myFileName = myDocument.FullName</div>
<div class="line">        Rem If the file name contains the extension <span class="stringliteral">&quot;.indd&quot;</span>, change it to <span class="stringliteral">&quot;.indt&quot;</span>.</div>
<div class="line">        If InStr(1, myFileName, <span class="stringliteral">&quot;.indd&quot;</span>) &lt;&gt; 0 Then</div>
<div class="line">            myFileName = Replace(myFileName, <span class="stringliteral">&quot;.indd&quot;</span>, <span class="stringliteral">&quot;.indt&quot;</span>)</div>
<div class="line">        End If</div>
<div class="line">    Else</div>
<div class="line">        Rem If the document has not been saved, then give it a</div>
<div class="line">        Rem default file name/file path.</div>
<div class="line">        myFileName = &quot;C:\SaveAsTemplate.indt&quot;</div>
<div class="line">    End If</div>
<div class="line">    myDocument.Save myFileName, True</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_closing_a_document"></a>
Closing a document</h3>
<p>The Close method closes a document, as shown in the following script fragment (from the CloseDocument tutorial script): </p>
<div class="fragment"><div class="line">   myInDesign.Documents.Item(1).Close</div>
</div><!-- fragment --><p> The Close method can take up to two optional parameters, as shown in the following script fragment (from the CloseWithParameters tutorial script): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Rem Close the active document with parameters:</div>
<div class="line">    Rem Use idSaveOptions.idYes to save the document</div>
<div class="line">    Rem or idSaveOptions.idNo to close the document without saving</div>
<div class="line">    Rem or idSaveOptions.idAsk to display a prompt.</div>
<div class="line">    Rem If you use idSaveOptions.idYes, you<span class="stringliteral">&#39;ll need to provide a reference</span></div>
<div class="line"><span class="stringliteral">    Rem to a file to save to in the second parameter.</span></div>
<div class="line"><span class="stringliteral">    Rem If the file has not been saved, display a prompt.</span></div>
<div class="line"><span class="stringliteral">    If myDocument.Saved &lt;&gt; True Then</span></div>
<div class="line"><span class="stringliteral">        Rem myDocument.Close idSaveOptions.idAsk</span></div>
<div class="line"><span class="stringliteral">        Rem Or, to save to a specific file name (you&#39;</span>ll have</div>
<div class="line">        Rem to fill in your own file path.</div>
<div class="line">        myFile = <span class="stringliteral">&quot;c:\CloseWithParameters.indd&quot;</span></div>
<div class="line">        myDocument.Close idSaveOptions.idYes, myFile</div>
<div class="line">    Else</div>
<div class="line">        Rem If the file has already been saved, save it.</div>
<div class="line">        myDocument.Close idSaveOptions.idYes</div>
<div class="line">    End If</div>
</div><!-- fragment --><p> You can close all open documents without saving them, as shown in the following script fragment (from the CloseAll tutorial script): </p>
<div class="fragment"><div class="line">    For myCounter = myInDesign.Documents.Count To 1 Step -1</div>
<div class="line">        myInDesign.Documents.Item(myCounter).Close idSaveOptions.idNo</div>
<div class="line">    Next</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_basic_page_layout"></a>
Basic Page Layout</h2>
<p>Each document has a default page size, assigned number of pages, bleed and slug working areas, and columns and margins to define the area into which material is placed. Again, all these parameters are accessible to scripting, as shown in the examples in this section.</p>
<h3><a class="anchor" id="id_vb_defining_page_size_and_document_length"></a>
Defining page size and document length</h3>
<p>When you create a new document using the InDesign user interface, you can specify the default page size, number of pages, page orientation, and whether the document uses facing pages. To create a document using InDesign scripting, use the Documents.Add method, which does not specify these settings. After creating a document, you can use the DocumentPreferences object to control the settings, as shown in the following script fragment (from the DocumentPreferences tutorial script): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    With myDocument.DocumentPreferences</div>
<div class="line">        .PageHeight = <span class="stringliteral">&quot;800pt&quot;</span></div>
<div class="line">        .PageWidth = <span class="stringliteral">&quot;600pt&quot;</span></div>
<div class="line">        .PageOrientation = idPageOrientation.idLandscape</div>
<div class="line">        .PagesPerDocument = 16</div>
<div class="line">    End With</div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>The Application object also has a DocumentPreferences object. You can set the application defaults for page height, page width, and other properties by changing the properties of this object. You can also set individual page sizes; see <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_adjusting_page_sizes_and_layout">Adjusting Page Sizes and Layout</a>.</dd></dl>
<h3><a class="anchor" id="id_vb_defining_bleed_and_slug_areas"></a>
Defining bleed and slug areas</h3>
<p>Within InDesign, a bleed or a slug is an area outside the page margins that can be printed or included in an exported PDF. Typically, these areas are used for objects that extend beyond the page edges (bleed) and job/document information (slug). The two areas can be printed and exported independently; for example, you might want to omit slug information for the final printing of a document. The following script shows how to set up the bleed and slug for a new document. (For the complete script, see BleedAndSlug.) </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Rem The bleed and slug properties belong to the documentPreferences <span class="keywordtype">object</span>.</div>
<div class="line">    With myDocument.DocumentPreferences</div>
<div class="line">    Rem Bleed</div>
<div class="line">        .DocumentBleedBottomOffset = <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">        .DocumentBleedTopOffset = <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">        .DocumentBleedInsideOrLeftOffset = <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">        .DocumentBleedOutsideOrRightOffset = <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">        Rem Slug</div>
<div class="line">        .SlugBottomOffset = <span class="stringliteral">&quot;18p&quot;</span></div>
<div class="line">        .SlugTopOffset = <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">        .SlugInsideOrLeftOffset = <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">        .SlugRightOrOutsideOffset = <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">    End With</div>
</div><!-- fragment --><p> Alternately, if all the bleed distances are equal, as in the preceding example, you can use the DocumentBleedUniformSize property, as shown in the following script fragment (from the UniformBleed tutorial script): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Rem The bleed properties belong to the DocumentPreferences <span class="keywordtype">object</span>.</div>
<div class="line">    With myDocument.DocumentPreferences</div>
<div class="line">    Rem Bleed</div>
<div class="line">        .DocumentBleedTopOffset = <span class="stringliteral">&quot;2p&quot;</span></div>
<div class="line">        .DocumentBleedUniformSize = True</div>
<div class="line">    End With</div>
</div><!-- fragment --><p> If all the slug distances are equal, you can use the DocumentSlugUniformSize property, as shown in the following script fragment (from the UniformSlug tutorial script): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Rem The slug properties belong to the DocumentPreferences <span class="keywordtype">object</span>.</div>
<div class="line">    With myDocument.DocumentPreferences</div>
<div class="line">    Rem Slug:</div>
<div class="line">        .SlugTopOffset = <span class="stringliteral">&quot;4p&quot;</span></div>
<div class="line">        .DocumentSlugUniformSize = True</div>
<div class="line">    End With</div>
</div><!-- fragment --><p> In addition to setting the bleed and slug widths and heights, you can control the color used to draw the guides defining the bleed and slug. This property is not in the DocumentPreferences object; instead, it is in the PasteboardPreferences object, as shown in the following script fragment (from the BleedSlugGuideColors tutorial script): </p>
<div class="fragment"><div class="line">   Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">   With myDocument.PasteboardPreferences</div>
<div class="line">       Rem Any of InDesign<span class="stringliteral">&#39;s guides can use the UIColors constants...</span></div>
<div class="line"><span class="stringliteral">       .BleedGuideColor = idUIColors.idCuteTeal</span></div>
<div class="line"><span class="stringliteral">       .SlugGuideColor = idUIColors.idCharcoal</span></div>
<div class="line"><span class="stringliteral">       Rem ...or you can specify an array of RGB values (with values from 0 to 255)</span></div>
<div class="line"><span class="stringliteral">       .BleedGuideColor = Array(0, 198, 192)</span></div>
<div class="line"><span class="stringliteral">       .SlugGuideColor = Array(192, 192, 192)</span></div>
<div class="line"><span class="stringliteral">   End With</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_setting_page_margins_and_columns"></a>
Setting page margins and columns</h3>
<p>Each page in a document can have its own margin and column settings. With InDesign scripting, these properties are part of the MarginPreferences object for each page. This following sample script creates a new document, then sets the margins and columns for all pages in the master spread. (For the complete script, see PageMargins.) </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    With myDocument.marginPreferences</div>
<div class="line">        .Top = 56</div>
<div class="line">        .Bottom = 24</div>
<div class="line">        .Left = 48</div>
<div class="line">        .Right = 10</div>
<div class="line">    End With</div>
<div class="line">    With myPage.marginPreferences</div>
<div class="line">        .Top = 56</div>
<div class="line">        .Bottom = 24</div>
<div class="line">        Rem When document.DocumentPreferences.FacingPages = <span class="keyword">true</span>,</div>
<div class="line">        Rem <span class="stringliteral">&quot;Left&quot;</span> means inside and <span class="stringliteral">&quot;Right&quot;</span> means outside.</div>
<div class="line">        .Left = 48</div>
<div class="line">        .Right = 10</div>
<div class="line">    End With</div>
</div><!-- fragment --><p> To set the page margins for an individual page, use the margin preferences for that page, as shown in the following script fragment (from the PageMarginsForOnePage tutorial script): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    <span class="keyword">set</span> myPage = myDocument.Pages.Item(1)</div>
<div class="line">    With myPage.MarginPreferences</div>
<div class="line">        .ColumnCount = 3</div>
<div class="line">        Rem columnGutter can be a number or a measurement <span class="keywordtype">string</span>.</div>
<div class="line">        .ColumnGutter = <span class="stringliteral">&quot;1p&quot;</span></div>
<div class="line">        .Top = <span class="stringliteral">&quot;4p&quot;</span></div>
<div class="line">        .Bottom = <span class="stringliteral">&quot;6p&quot;</span></div>
<div class="line">        Rem When document.documentPreferences.facingPages = <span class="keyword">true</span>,</div>
<div class="line">        Rem <span class="stringliteral">&quot;left&quot;</span> means inside <span class="stringliteral">&quot;right&quot;</span> means outside.</div>
<div class="line">        .Left = <span class="stringliteral">&quot;6p&quot;</span></div>
<div class="line">        .Right = <span class="stringliteral">&quot;4p&quot;</span></div>
<div class="line">    End With</div>
</div><!-- fragment --><p> InDesign does not allow you to create a page that is smaller than the sum of the relevant margins; that is, the width of the page must be greater than the sum of the left and right page margins, and the height of the page must be greater than the sum of the top and bottom margins. If you are creating very small pages (for example, for individual newspaper advertisements) using the InDesign user interface, you can easily set the correct margin sizes as you create the document, by entering new values in the document default page Margin fields in the New Document dialog box.</p>
<p>From scripting, however, the solution is not as clear: when you create a document, it uses the application's default-margin preferences. These margins are applied to all pages of the document, including master pages. Setting the document margin preferences affects only new pages and has no effect on existing pages. If you try to set the page height and page width to values smaller than the sum of the corresponding margins on any existing pages, InDesign does not change the page size.</p>
<p>There are two solutions. The first is to set the margins of the existing pages before you try to change the page size, as shown in the following script fragment (from the PageMarginsForSmallPages tutorial script): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    With myPage.MarginPreferences</div>
<div class="line">        .Top = 0</div>
<div class="line">        .Bottom = 0</div>
<div class="line">        .Left = 0</div>
<div class="line">        .Right = 0</div>
<div class="line">        .ColumnCount = 1</div>
<div class="line">        .ColumnGutter = 0</div>
<div class="line">    End With</div>
<div class="line">    Rem The following prevents errors when <span class="keyword">new</span> pages are added.</div>
<div class="line">    With myDocument.MarginPreferences</div>
<div class="line">        .Top = 0</div>
<div class="line">        .Bottom = 0</div>
<div class="line">        .Left = 0</div>
<div class="line">        .Right = 0</div>
<div class="line">        .ColumnCount = 1</div>
<div class="line">        .ColumnGutter = 0</div>
<div class="line">    End With</div>
<div class="line">    Rem The following assumes that your <span class="keywordflow">default</span> master spread contains two pages.</div>
<div class="line">    With myDocument.MasterSpreads.Item(1).Pages</div>
<div class="line">        With .Item(1).MarginPreferences</div>
<div class="line">            .Top = 0</div>
<div class="line">            .Bottom = 0</div>
<div class="line">            .Left = 0</div>
<div class="line">            .Right = 0</div>
<div class="line">            .ColumnCount = 1</div>
<div class="line">            .ColumnGutter = 0</div>
<div class="line">        End With</div>
<div class="line">        With .Item(2).MarginPreferences</div>
<div class="line">            .Top = 0</div>
<div class="line">            .Bottom = 0</div>
<div class="line">            .Left = 0</div>
<div class="line">            .Right = 0</div>
<div class="line">            .ColumnCount = 1</div>
<div class="line">            .ColumnGutter = 0</div>
<div class="line">        End With</div>
<div class="line">    End With</div>
<div class="line">    Rem At <span class="keyword">this</span> point, you can <span class="keyword">set</span> your page size to a small width and height</div>
<div class="line">    Rem (1x1 picas minimum).</div>
<div class="line">    myDocument.DocumentPreferences.PageHeight = <span class="stringliteral">&quot;1p&quot;</span></div>
<div class="line">    myDocument.DocumentPreferences.PageWidth = <span class="stringliteral">&quot;6p&quot;</span></div>
</div><!-- fragment --><p> Alternately, you can change the application's default-margin preferences before you create the document, as shown in the following script fragment (from the ApplicationPageMargins tutorial script): </p>
<div class="fragment"><div class="line">    With myInDesign.MarginPreferences</div>
<div class="line">        Rem Save the current application <span class="keywordflow">default</span> margin preferences.</div>
<div class="line">        myY1 = .Top</div>
<div class="line">        myX1 = .Left</div>
<div class="line">        myY2 = .Bottom</div>
<div class="line">        myX2 = .Right</div>
<div class="line">        Rem Set the application <span class="keywordflow">default</span> margin preferences.</div>
<div class="line">        .Top = 0</div>
<div class="line">        .Left = 0</div>
<div class="line">        .Bottom = 0</div>
<div class="line">        .Right = 0</div>
<div class="line">    End With</div>
<div class="line">    Rem Create a <span class="keyword">new</span> example document to demonstrate the change.</div>
<div class="line">    Set myDocument = myInDesign.Documents.Add</div>
<div class="line">    Rem At <span class="keyword">this</span> point, you can <span class="keyword">set</span> your page size to a small width and</div>
<div class="line">    Rem height (1x1 picas minimum).</div>
<div class="line">    myDocument.DocumentPreferences.PageHeight = <span class="stringliteral">&quot;1p&quot;</span></div>
<div class="line">    myDocument.DocumentPreferences.PageWidth = <span class="stringliteral">&quot;1p&quot;</span></div>
<div class="line">    Rem Reset the application <span class="keywordflow">default</span> margin preferences to their former state.</div>
<div class="line">    With myInDesign.MarginPreferences</div>
<div class="line">        .Top = myY1</div>
<div class="line">        .Left = myX1</div>
<div class="line">        .Bottom = myY2</div>
<div class="line">        .Right = myX2</div>
<div class="line">    End With</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_changing_the_appearance_of_the_pasteboard"></a>
Changing the appearance of the pasteboard</h3>
<p>The pasteboard is the area that surrounds InDesign pages and spreads. You can use it for temporary storage of page items or for job-tracking information. You can change the size of the pasteboard and its color using scripting. The PreviewBackgroundColor property sets the color of the pasteboard in Preview mode, as shown in the following script fragment (from the PasteboardPreferences tutorial script): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    With myDocument.PasteboardPreferences</div>
<div class="line">        Rem You can use either a number or a measurement <span class="keywordtype">string</span></div>
<div class="line">        Rem to <span class="keyword">set</span> the minimum horizontal and vertical pasteboard margins</div>
<div class="line">        .PasteboardMargins = Array(<span class="stringliteral">&quot;12p&quot;</span>,<span class="stringliteral">&quot;15p&quot;</span>)</div>
<div class="line">        Rem You can set the preview background color (which you&#39;ll only see</div>
<div class="line">        Rem in Preview mode) to any of the predefined UIColor constants...</div>
<div class="line">        .PreviewBackgroundColor = idUIColors.idGrassGreen</div>
<div class="line">        Rem ...or you can specify an array of RGB values.</div>
<div class="line">        .PreviewBackgroundColor = Array(192, 192, 192)</div>
<div class="line">    End With</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_guides_and_grids"></a>
Guides and grids</h3>
<p>Guides and grids make it easy to position objects on your document pages. These are very useful items to add when you are creating templates for others to use.</p>
<p><b>Defining guides</b></p>
<p>Guides in InDesign give you an easy way to position objects on the pages of your document. The following script fragment shows how to use guides. (For the complete script, see Guides.) </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    myPageWidth = myDocument.DocumentPreferences.PageWidth</div>
<div class="line">    myPageHeight = myDocument.DocumentPreferences.PageHeight</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    With myPage</div>
<div class="line">        Set myMarginPreferences = .MarginPreferences</div>
<div class="line">        Rem Place guides at the margins of the page.</div>
<div class="line">        With .Guides.Add</div>
<div class="line">            .Orientation = idHorizontalOrVertical.idVertical</div>
<div class="line">            .Location = myMarginPreferences.Left</div>
<div class="line">        End With</div>
<div class="line">        With .Guides.Add</div>
<div class="line">            .Orientation = idHorizontalOrVertical.idVertical</div>
<div class="line">            .Location = (myPageWidth - myMarginPreferences.Right)</div>
<div class="line">        End With</div>
<div class="line">        With .Guides.Add</div>
<div class="line">            .Orientation = idHorizontalOrVertical.idHorizontal</div>
<div class="line">            .Location = myMarginPreferences.Top</div>
<div class="line">        End With</div>
<div class="line">        With .Guides.Add</div>
<div class="line">            .Orientation = idHorizontalOrVertical.idHorizontal</div>
<div class="line">            .Location = (myPageHeight - myMarginPreferences.Bottom)</div>
<div class="line">        End With</div>
<div class="line">        Rem Place a guide at the vertical center of the page.</div>
<div class="line">        With .Guides.Add</div>
<div class="line">            .Orientation = idHorizontalOrVertical.idVertical</div>
<div class="line">            .Location = (myPageWidth / 2)</div>
<div class="line">        End With</div>
<div class="line">        Rem Place a guide at the horizontal center of the page.</div>
<div class="line">        With .Guides.Add</div>
<div class="line">            .Orientation = idHorizontalOrVertical.idHorizontal</div>
<div class="line">            .Location = (myPageHeight / 2)</div>
<div class="line">        End With</div>
<div class="line">    End With</div>
</div><!-- fragment --><p> Horizontal guides can be limited to a given page or extend across all pages in a spread. From InDesign scripting, you can control this using the FitToPage property. This property is ignored by vertical guides.</p>
<p>You can use scripting to change the layer, color, and visibility of guides, just as you can from the user interface, as shown in the following script fragment (from the GuideOptions tutorial script): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    Rem Create a layer named <span class="stringliteral">&quot;guide layer&quot;</span>.</div>
<div class="line">    Set myLayer = myDocument.Layers.Add</div>
<div class="line">    myLayer.Name = <span class="stringliteral">&quot;guide layer&quot;</span></div>
<div class="line">    Rem Add a series of guides to page 1.</div>
<div class="line">    With myPage</div>
<div class="line">        Rem Create a guide on the layer we created above.</div>
<div class="line">        With .Guides.Add(myLayer)</div>
<div class="line">            .Orientation = idHorizontalOrVertical.idHorizontal</div>
<div class="line">            .Location = <span class="stringliteral">&quot;12p&quot;</span></div>
<div class="line">        End With</div>
<div class="line">        Rem Another way to make a guide on a specific layer.</div>
<div class="line">        With .Guides.Add()</div>
<div class="line">            .ItemLayer = myLayer</div>
<div class="line">            .Orientation = idHorizontalOrVertical.idHorizontal</div>
<div class="line">            .Location = <span class="stringliteral">&quot;14p&quot;</span></div>
<div class="line">        End With</div>
<div class="line">            Rem Make a locked guide.</div>
<div class="line">            With .Guides.Add()</div>
<div class="line">            .ItemLayer = myLayer</div>
<div class="line">            .Orientation = idHorizontalOrVertical.idHorizontal</div>
<div class="line">            .Location = <span class="stringliteral">&quot;16p&quot;</span></div>
<div class="line">            .Locked = True</div>
<div class="line">        End With</div>
<div class="line">        Rem Set the view threshold of a guide.</div>
<div class="line">        With .Guides.Add()</div>
<div class="line">            .ItemLayer = myLayer</div>
<div class="line">            .Orientation = idHorizontalOrVertical.idHorizontal</div>
<div class="line">            .Location = <span class="stringliteral">&quot;18p&quot;</span></div>
<div class="line">            .ViewThreshold = 100</div>
<div class="line">        End With</div>
<div class="line">        Rem Set the guide color of a guide <span class="keyword">using</span> a UIColors constant.</div>
<div class="line">        With .Guides.Add()</div>
<div class="line">            .ItemLayer = myLayer</div>
<div class="line">            .Orientation = idHorizontalOrVertical.idHorizontal</div>
<div class="line">            .Location = <span class="stringliteral">&quot;20p&quot;</span></div>
<div class="line">            .GuideColor = idUIColors.idGray</div>
<div class="line">        End With</div>
<div class="line">        Rem Set the guide color of a guide <span class="keyword">using</span> an RGB array.</div>
<div class="line">        With .Guides.Add()</div>
<div class="line">            .ItemLayer = myLayer</div>
<div class="line">            .Orientation = idHorizontalOrVertical.idHorizontal</div>
<div class="line">            .Location = <span class="stringliteral">&quot;22p&quot;</span></div>
<div class="line">            .GuideColor = Array(192, 192, 192)</div>
<div class="line">        End With</div>
<div class="line">    End With</div>
</div><!-- fragment --><p> You also can create guides using the CreateGuides method on spreads and master spreads, as shown in the following script fragment (from the CreateGuides tutorial script): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myLayer = myDocument.Layers.Item(1)</div>
<div class="line">    With myDocument.Spreads.Item(1)</div>
<div class="line">        Rem Parameters (all optional): row count, column count, row gutter,</div>
<div class="line">        Rem column gutter,guide color, fit margins, remove existing, layer.</div>
<div class="line">        Rem Note that the createGuides method does not take an RGB array</div>
<div class="line">        Rem for the guide color parameter.</div>
<div class="line">        .CreateGuides 4, 4, <span class="stringliteral">&quot;1p&quot;</span>, <span class="stringliteral">&quot;1p&quot;</span>, idUIColors.idGray, True, True, myLayer</div>
<div class="line">    End With</div>
</div><!-- fragment --><p> <b>Setting grid preferences</b></p>
<p>To control the properties of the document and baseline grid, you set the properties of the GridPreferences object, as shown in the following script fragment (from the DocumentAndBaselineGrid tutorial script): </p>
<div class="fragment"><div class="line">    Rem Set the document measurement units to points.</div>
<div class="line">    Set myDocument = myInDesign.Documents.Item(1)   </div>
<div class="line">    myDocument.ViewPreferences.HorizontalMeasurementUnits = idMeasurementUnits.idPoints</div>
<div class="line">    myDocument.ViewPreferences.VerticalMeasurementUnits = idMeasurementUnits.idPoints</div>
<div class="line">    Rem Set up grid preferences.</div>
<div class="line">    With myDocument.GridPreferences</div>
<div class="line">        .BaselineStart = 56</div>
<div class="line">        .BaselineDivision = 14</div>
<div class="line">        .BaselineGridShown = True</div>
<div class="line">        .HorizontalGridlineDivision = 14</div>
<div class="line">        .HorizontalGridSubdivision = 5</div>
<div class="line">        .VerticalGridlineDivision = 14</div>
<div class="line">        .VerticalGridSubdivision = 5</div>
<div class="line">        .DocumentGridShown = True</div>
<div class="line">    End With</div>
</div><!-- fragment --><p> <b>Snapping to guides and grids</b></p>
<p>All snap settings for a document's grids and guides are in the properties of the GuidePreferences and GridPreferences objects. The following script fragment shows how to set guide and grid snap properties. (For the complete script, see GuideGridPreferences.) </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    With myDocument.GuidePreferences</div>
<div class="line">        .GuidesInBack = True</div>
<div class="line">        .GuidesLocked = False</div>
<div class="line">        .GuidesShown = True</div>
<div class="line">        .GuidesSnapto = True</div>
<div class="line">        Rem Colors can be an idUIColors enumeration ...</div>
<div class="line">        .RulerGuidesColor = idUIColors.idCuteTeal</div>
<div class="line">        Rem ... or an array of RGB values.</div>
<div class="line">        .RulerGuidesColor = Array(0, 198, 192)</div>
<div class="line">        .RulerGuidesViewThreshold = 50 </div>
<div class="line">    End With</div>
<div class="line">    Dim myBaselineGridRelativeOption </div>
<div class="line">    myBaselineGridRelativeOption = idBaselineGridRelativeOption.idTopOfMarginOfBaselineGridRelativeOption</div>
<div class="line">    Rem Set BaselineGridRelativeOption = idBaselineGridRelativeOption.idTopOfPageOfBaselineGridRelativeOption</div>
<div class="line">    With myDocument.gridPreferences</div>
<div class="line">        .BaselineStart = 88</div>
<div class="line">        .BaselineGridRelativeOption = myBaselineGridRelativeOption</div>
<div class="line">        .BaselineColor = idUIColors.idLightBlue</div>
<div class="line">        .BaselineDivision = 22</div>
<div class="line">        .BaselineGridShown = True</div>
<div class="line">        .BaselineViewThreshold = 75</div>
<div class="line">        .DocumentGridSnapTo = True</div>
<div class="line">        .DocumentGridShown = False</div>
<div class="line">        .GridColor = idUIColors.idCharcoal</div>
<div class="line">        .HorizontalGridlineDivision = 1</div>
<div class="line">        .HorizontalGridSubdivision = 4</div>
<div class="line">        .VerticalGridlineDivision = 1</div>
<div class="line">        .VerticalGridSubdivision = 4</div>
<div class="line">    End With</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_changing_measurement_units_and_ruler"></a>
Changing measurement units and ruler</h3>
<p>Thus far, the sample scripts used measurement strings, strings that force InDesign to use a specific measurement unit (for example, "8.5i" for 8.5 inches). They do this because you might be using a different measurement system when you run the script.</p>
<p>To specify the measurement system used in a script, use the document's ViewPreferences object, as shown in the following script fragment (from the ViewPreferences tutorial script): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    With myDocument.ViewPreferences</div>
<div class="line">        Rem Measurement unit choices are:</div>
<div class="line">        Rem * idMeasurementUnits.idPicas</div>
<div class="line">        Rem * idMeasurementUnits.idPoints</div>
<div class="line">        Rem * idMeasurementUnits.idInches</div>
<div class="line">        Rem * idMeasurementUnits.idInchesDecimal</div>
<div class="line">        Rem * idMeasurementUnits.idMillimeters</div>
<div class="line">        Rem * idMeasurementUnits.idCentimeters</div>
<div class="line">        Rem * idMeasurementUnits.idCiceros</div>
<div class="line">        Rem * idMeasurementUnits.idCustom</div>
<div class="line">        Rem * idMeasurementUnits.idAgates</div>
<div class="line">        Rem If you <span class="keyword">set</span> the the vertical or horizontal measurement units</div>
<div class="line">        Rem to idMeasurementUnits.idCustom, you can also <span class="keyword">set</span> a custom</div>
<div class="line">        Rem ruler increment (in points) <span class="keyword">using</span>:</div>
<div class="line">        Rem .HorizontalCustomPoints = 15</div>
<div class="line">        Rem .VerticalCustomPoints = 15</div>
<div class="line">        Rem Set horizontal and vertical measurement units to points.</div>
<div class="line">        .HorizontalMeasurementUnits = idMeasurementUnits.idPoints</div>
<div class="line">        .VerticalMeasurementUnits = idMeasurementUnits.idPoints</div>
<div class="line">    End With</div>
</div><!-- fragment --><p> If you are writing a script that needs to use a specific measurement system, you can change the measurement units at the beginning of the script, then restore the original measurement units at the end of the script. This is shown in the following script fragment (from the ResetMeasurementUnits tutorial script): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    With myDocument.ViewPreferences</div>
<div class="line">        myOldXUnits = .HorizontalMeasurementUnits</div>
<div class="line">        myOldYUnits = .VerticalMeasurementUnits</div>
<div class="line">        .HorizontalMeasurementUnits = idMeasurementUnits.idPoints</div>
<div class="line">        .VerticalMeasurementUnits = idMeasurementUnits.idPoints</div>
<div class="line">    End With</div>
<div class="line">    Rem At <span class="keyword">this</span> point, you can perform any series of script actions that </div>
<div class="line">    Rem depend on the measurement units you<span class="stringliteral">&#39;ve set. At the end of the </span></div>
<div class="line"><span class="stringliteral">    Rem script, reset the units to their original state.</span></div>
<div class="line"><span class="stringliteral">    With myDocument.ViewPreferences</span></div>
<div class="line"><span class="stringliteral">        .HorizontalMeasurementUnits = myOldXUnits</span></div>
<div class="line"><span class="stringliteral">        .VerticalMeasurementUnits = myOldYUnits</span></div>
<div class="line"><span class="stringliteral">    End With</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_defining_and_applying_document_presets"></a>
Defining and applying document presets</h3>
<p>InDesign document presets enable you to store and apply common document set-up information (page size, page margins, columns, and bleed and slug areas). When you create a new document, you can base the document on a document preset.</p>
<p><b>Creating a preset by copying values</b></p>
<p>To create a document preset using an existing document's settings as an example, open a document that has the document set-up properties you want to use in the document preset, then run the following script (from the DocumentPresetByExample tutorial script): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Rem If the document preset <span class="stringliteral">&quot;myDocumentPreset&quot;</span> does </div>
<div class="line">    Rem not already exist, create it.</div>
<div class="line">    Rem Disable normal error handling.</div>
<div class="line">    Err.Clear</div>
<div class="line">    On Error Resume Next</div>
<div class="line">    Set myDocumentPreset = myInDesign.DocumentPresets.Item(<span class="stringliteral">&quot;myDocumentPreset&quot;</span>)</div>
<div class="line">    Rem If the document preset did not exist, the above line</div>
<div class="line">    Rem generates an error. Handle the error.</div>
<div class="line">    If (Err.Number &lt;&gt; 0) Then</div>
<div class="line">        Set myDocumentPreset = myInDesign.DocumentPresets.Add</div>
<div class="line">        myDocumentPreset.Name = &quot;myDocumentPreset&quot;</div>
<div class="line">        Err.Clear</div>
<div class="line">    End If</div>
<div class="line">    Rem Restore normal error handling.</div>
<div class="line">    On Error GoTo 0</div>
<div class="line">    Rem Fill in the properties of the document preset with the corresponding</div>
<div class="line">    Rem properties of the active document.</div>
<div class="line">    With myDocumentPreset</div>
<div class="line">        Rem Note that the following gets the page margins from the margin</div>
<div class="line">        Rem preferences of the document to get the margin preferences from the</div>
<div class="line">        Rem active page, replace &quot;myDocument&quot; with</div>
<div class="line">        Rem &quot;myInDesign.activeWindow.activePage&quot; in the following six lines</div>
<div class="line">        Rem (assuming the active window is a layout window).</div>
<div class="line">        .Left = myDocument.MarginPreferences.Left</div>
<div class="line">        .Right = myDocument.MarginPreferences.Right</div>
<div class="line">        .Top = myDocument.MarginPreferences.Top</div>
<div class="line">        .Bottom = myDocument.MarginPreferences.Bottom</div>
<div class="line">        .ColumnCount = myDocument.MarginPreferences.ColumnCount</div>
<div class="line">        .ColumnGutter = myDocument.MarginPreferences.ColumnGutter</div>
<div class="line">        .DocumentBleedBottomOffset _</div>
<div class="line">        = myDocument.DocumentPreferences.DocumentBleedBottomOffset</div>
<div class="line">        .DocumentBleedTopOffset _</div>
<div class="line">        = myDocument.DocumentPreferences.DocumentBleedTopOffset</div>
<div class="line">        .DocumentBleedInsideOrLeftOffset _</div>
<div class="line">        = myDocument.DocumentPreferences.DocumentBleedInsideOrLeftOffset</div>
<div class="line">        .DocumentBleedOutsideOrRightOffset _</div>
<div class="line">        = myDocument.DocumentPreferences.DocumentBleedOutsideOrRightOffset</div>
<div class="line">        .FacingPages = myDocument.DocumentPreferences.FacingPages</div>
<div class="line">        .PageHeight = myDocument.DocumentPreferences.PageHeight</div>
<div class="line">        .PageWidth = myDocument.DocumentPreferences.PageWidth</div>
<div class="line">        .PageOrientation = myDocument.DocumentPreferences.PageOrientation</div>
<div class="line">        .PagesPerDocument = myDocument.DocumentPreferences.PagesPerDocument</div>
<div class="line">        .SlugBottomOffset = myDocument.DocumentPreferences.SlugBottomOffset</div>
<div class="line">        .SlugTopOffset = myDocument.DocumentPreferences.SlugTopOffset</div>
<div class="line">        .SlugInsideOrLeftOffset _</div>
<div class="line">        = myDocument.DocumentPreferences.SlugInsideOrLeftOffset</div>
<div class="line">        .SlugRightOrOutsideOffset _</div>
<div class="line">        = myDocument.DocumentPreferences.SlugRightOrOutsideOffset</div>
<div class="line">    End With</div>
</div><!-- fragment --><p> <b>Creating a document preset</b></p>
<p>To create a document preset using explicit values, run the following script (from the DocumentPreset tutorial script): </p>
<div class="fragment"><div class="line">    Rem If the document preset <span class="stringliteral">&quot;myDocumentPreset&quot;</span> does not already exist, create it.</div>
<div class="line">    Err.Clear</div>
<div class="line">    On Error Resume Next</div>
<div class="line">    Set myDocumentPreset = myInDesign.DocumentPresets.Item(<span class="stringliteral">&quot;myDocumentPreset&quot;</span>)</div>
<div class="line">    If Err.Number &lt;&gt; 0 Then</div>
<div class="line">        Set myDocumentPreset = myInDesign.DocumentPresets.Add</div>
<div class="line">        myDocumentPreset.Name = <span class="stringliteral">&quot;myDocumentPreset&quot;</span></div>
<div class="line">        Err.Clear</div>
<div class="line">    End If</div>
<div class="line">    On Error GoTo 0</div>
<div class="line">    Rem Fill in the properties of the document preset.</div>
<div class="line">    With myDocumentPreset</div>
<div class="line">        .PageHeight = <span class="stringliteral">&quot;9i&quot;</span></div>
<div class="line">        .PageWidth = <span class="stringliteral">&quot;7i&quot;</span></div>
<div class="line">        .Left = <span class="stringliteral">&quot;4p&quot;</span></div>
<div class="line">        .Right = <span class="stringliteral">&quot;6p&quot;</span></div>
<div class="line">        .Top = <span class="stringliteral">&quot;4p&quot;</span></div>
<div class="line">        .Bottom = <span class="stringliteral">&quot;9p&quot;</span></div>
<div class="line">        .ColumnCount = 1</div>
<div class="line">        .DocumentBleedBottomOffset = <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">        .DocumentBleedTopOffset = <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">        .DocumentBleedInsideOrLeftOffset = <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">        .DocumentBleedOutsideOrRightOffset = <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">        .FacingPages = True</div>
<div class="line">        .PageOrientation = idPageOrientation.idPortrait</div>
<div class="line">        .PagesPerDocument = 1</div>
<div class="line">        .SlugBottomOffset = <span class="stringliteral">&quot;18p&quot;</span></div>
<div class="line">        .SlugTopOffset = <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">        .SlugInsideOrLeftOffset = <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">        .SlugRightOrOutsideOffset = <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">    End With</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_setting_up_master_spreads"></a>
Setting up master spreads</h3>
<p>After setting up the basic document page size, slug, and bleed, you probably will want to define the document's master spreads. The following script shows how to do that. (For the complete script, see MasterSpread.) </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Rem Set the document<span class="stringliteral">&#39;s ruler origin to page origin.</span></div>
<div class="line"><span class="stringliteral">    myDocument.ViewPreferences.RulerOrigin = idRulerOrigin.idPageOrigin</span></div>
<div class="line"><span class="stringliteral">    With myDocument.MasterSpreads.Item(1)</span></div>
<div class="line"><span class="stringliteral">        mySectionMarker = idSpecialCharacters.idSectionMarker</span></div>
<div class="line"><span class="stringliteral">        myEmSpace = idSpecialCharacters.idEmSpace</span></div>
<div class="line"><span class="stringliteral">        myAutoPageNumber = idSpecialCharacters.idAutoPageNumber</span></div>
<div class="line"><span class="stringliteral">        Rem Set up the left page (verso).</span></div>
<div class="line"><span class="stringliteral">        With .Pages.Item(1)</span></div>
<div class="line"><span class="stringliteral">            With .MarginPreferences</span></div>
<div class="line"><span class="stringliteral">                .ColumnCount = 3</span></div>
<div class="line"><span class="stringliteral">                .ColumnGutter = &quot;1p&quot;</span></div>
<div class="line"><span class="stringliteral">                .Bottom = &quot;6p&quot;</span></div>
<div class="line"><span class="stringliteral">                Rem &quot;left&quot; means inside &quot;right&quot; means outside.</span></div>
<div class="line"><span class="stringliteral">                .Left = &quot;6p&quot;</span></div>
<div class="line"><span class="stringliteral">                .Right = &quot;4p&quot;</span></div>
<div class="line"><span class="stringliteral">                .Top = &quot;4p&quot;</span></div>
<div class="line"><span class="stringliteral">            End With</span></div>
<div class="line"><span class="stringliteral">            Rem Add a simple footer with a section number and page number.</span></div>
<div class="line"><span class="stringliteral">            With .TextFrames.Add</span></div>
<div class="line"><span class="stringliteral">                .GeometricBounds = Array(&quot;61p&quot;, &quot;4p&quot;, &quot;62p&quot;, &quot;45p&quot;)</span></div>
<div class="line"><span class="stringliteral">                .InsertionPoints.Item(1).Contents = mySectionMarker</span></div>
<div class="line"><span class="stringliteral">                .InsertionPoints.Item(1).Contents = myEmSpace</span></div>
<div class="line"><span class="stringliteral">                .InsertionPoints.Item(1).Contents = myAutoPageNumber</span></div>
<div class="line"><span class="stringliteral">                .Paragraphs.Item(1).Justification = idJustification.idLeftAlign</span></div>
<div class="line"><span class="stringliteral">            End With</span></div>
<div class="line"><span class="stringliteral">        End With</span></div>
<div class="line"><span class="stringliteral">        Rem Set up the right page (recto).</span></div>
<div class="line"><span class="stringliteral">        With .Pages.Item(2)</span></div>
<div class="line"><span class="stringliteral">            With .MarginPreferences</span></div>
<div class="line"><span class="stringliteral">                .ColumnCount = 3</span></div>
<div class="line"><span class="stringliteral">                .ColumnGutter = &quot;1p&quot;</span></div>
<div class="line"><span class="stringliteral">                .Bottom = &quot;6p&quot;</span></div>
<div class="line"><span class="stringliteral">                Rem &quot;left&quot; means inside &quot;right&quot; means outside.</span></div>
<div class="line"><span class="stringliteral">                .Left = &quot;6p&quot;</span></div>
<div class="line"><span class="stringliteral">                .Right = &quot;4p&quot;</span></div>
<div class="line"><span class="stringliteral">                .Top = &quot;4p&quot;</span></div>
<div class="line"><span class="stringliteral">            End With</span></div>
<div class="line"><span class="stringliteral">            Rem Add a simple footer with a section number and page number.</span></div>
<div class="line"><span class="stringliteral">            With .TextFrames.Add</span></div>
<div class="line"><span class="stringliteral">                .GeometricBounds = Array(&quot;61p&quot;, &quot;6p&quot;, &quot;62p&quot;, &quot;47p&quot;)</span></div>
<div class="line"><span class="stringliteral">                .InsertionPoints.Item(1).Contents = myAutoPageNumber</span></div>
<div class="line"><span class="stringliteral">                .InsertionPoints.Item(1).Contents = myEmSpace</span></div>
<div class="line"><span class="stringliteral">                .InsertionPoints.Item(1).Contents = mySectionMarker</span></div>
<div class="line"><span class="stringliteral">                .Paragraphs.Item(1).Justification = idJustification.idRightAlign</span></div>
<div class="line"><span class="stringliteral">            End With</span></div>
<div class="line"><span class="stringliteral">        End With</span></div>
<div class="line"><span class="stringliteral">    End With</span></div>
</div><!-- fragment --><p> To apply a master spread to a document page, use the AppliedMaster property of the document page, as shown in the following script fragment (from the ApplyMaster tutorial script): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myPage = myDocument.Pages.Add</div>
<div class="line">    Set myPage.appliedMaster = myDocument.MasterSpreads.Item(<span class="stringliteral">&quot;B-Master&quot;</span>)</div>
</div><!-- fragment --><p> Use the same property to apply a master spread to a master spread page, as shown in the following script fragment (from the ApplyMasterToMaster tutorial script): </p>
<div class="fragment"><div class="line">    Rem Create a <span class="keyword">new</span> master spread.</div>
<div class="line">    On Error Resume Next</div>
<div class="line">    Set myMasterSpread = myDocument.MasterSpreads.Item(<span class="stringliteral">&quot;B-Master&quot;</span>)</div>
<div class="line">    Rem If the master spread did not exist, handle the error</div>
<div class="line">    Rem and create the master spread.</div>
<div class="line">    If(Err&lt;&gt;0) Then</div>
<div class="line">        Set myMasterSpread = myDocument.MasterSpreads.Add</div>
<div class="line">        myMasterSpread.Name = &quot;B-Master&quot;</div>
<div class="line">        Err.Clear</div>
<div class="line">    End If</div>
<div class="line">    Rem Restore normal error handling.</div>
<div class="line">    On Error Goto 0</div>
<div class="line">    Set myMasterPage = myMasterSpread.Pages.Item(1)</div>
<div class="line">    Set myMasterPage.AppliedMaster = myDocument.MasterSpreads.Item(1)</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_adding_xmp_metadata"></a>
Adding XMP metadata</h3>
<p>Metadata is information that describes the content, origin, or other attributes of a file. In the InDesign user interface, you enter, edit, and view metadata using the File Info dialog (choose File &gt; File Info). This metadata includes the document's creation and modification dates, author, copyright status, and other information. All this information is stored using XMP (Adobe Extensible Metadata Platform), an open standard for embedding metadata in a document.</p>
<p>To learn more about XMP, see the XMP specification at <a href="http://partners.adobe.com/asn/developer/pdf/MetadataFramework.pdf">http://partners.adobe.com/asn/developer/pdf/MetadataFramework.pdf </a>.</p>
<p>You also can add XMP information to a document using InDesign scripting. All XMP properties for a document are in the document's metadataPreferences object. The example below fills in the standard XMP data for a document.</p>
<p>This example also shows that XMP information is extensible. If you need to attach metadata to a document and the data does not fall into a category provided by the metadata preferences object, you can create your own metadata container (email, in this example). (For the complete script, see MetadataExample.) </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    With myDocument.MetadataPreferences</div>
<div class="line">        .Author = <span class="stringliteral">&quot;Adobe Systems&quot;</span></div>
<div class="line">        .CopyrightInfoURL = <span class="stringliteral">&quot;http://www.adobe.com&quot;</span></div>
<div class="line">        .CopyrightNotice = <span class="stringliteral">&quot;This document is copyrighted.&quot;</span></div>
<div class="line">        .CopyrightStatus = idCopyrightStatus.idYes</div>
<div class="line">        .Description = <span class="stringliteral">&quot;Example of xmp metadata scripting in Adobe InDesign CC.&quot;</span></div>
<div class="line">        .DocumentTitle = <span class="stringliteral">&quot;XMP Example&quot;</span></div>
<div class="line">        .JobName = <span class="stringliteral">&quot;XMP_Example_2008&quot;</span></div>
<div class="line">        .Keywords = Array(<span class="stringliteral">&quot;animal&quot;</span>, <span class="stringliteral">&quot;mineral&quot;</span>, <span class="stringliteral">&quot;vegetable&quot;</span>)</div>
<div class="line">        Rem The metadata preferences <span class="keywordtype">object</span> also includes the read-only</div>
<div class="line">        Rem creator, format, creationDate, modificationDate, and serverURL properties</div>
<div class="line">        Rem that are automatically entered and maintained by InDesign.</div>
<div class="line">        Rem Create a custom XMP container, &quot;email&quot;</div>
<div class="line">        myURL = &quot;http:<span class="comment">//ns.adobe.com/xap/1.0/&quot;</span></div>
<div class="line">        .CreateContainerItem myURL, &quot;email&quot;</div>
<div class="line">        .SetProperty myURL, &quot;email<span class="comment">/*[1]&quot;, &quot;someone@adobe.com&quot;</span></div>
<div class="line"><span class="comment">    End With</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_creating_a_document_template"></a>
Creating a document template</h3>
<p>This example creates a new document, defines slug and bleed areas, adds information to the document's XMP metadata, sets up master pages, adds page footers, and adds job information to a table in the slug area. (For the complete script, see DocumentTemplate.) </p>
<div class="fragment"><div class="line">    myInDesign.ViewPreferences.HorizontalMeasurementUnits _</div>
<div class="line">    = idMeasurementUnits.idPoints</div>
<div class="line">    myInDesign.ViewPreferences.VerticalMeasurementUnits _</div>
<div class="line">    = idMeasurementUnits.idPoints</div>
<div class="line">    Rem Set the application <span class="keywordflow">default</span> margin preferences.</div>
<div class="line">    With myInDesign.MarginPreferences</div>
<div class="line">        Rem Save the current application <span class="keywordflow">default</span> margin preferences.</div>
<div class="line">        myY1 = .Top</div>
<div class="line">        myX1 = .Left</div>
<div class="line">        myY2 = .Bottom</div>
<div class="line">        myX2 = .Right</div>
<div class="line">        Rem Set the application <span class="keywordflow">default</span> margin preferences.</div>
<div class="line">        Rem Document baseline grid will be based on 14 points, and</div>
<div class="line">        Rem all margins are <span class="keyword">set</span> in increments of 14 points.</div>
<div class="line">        .Top = 14 * 4</div>
<div class="line">        .Left = 14 * 4</div>
<div class="line">        .Bottom = 74</div>
<div class="line">        .Right = 14 * 5</div>
<div class="line">    End With</div>
<div class="line">    Rem Make a <span class="keyword">new</span> document.</div>
<div class="line">    Set myDocument = myInDesign.Documents.Add</div>
<div class="line">    myDocument.DocumentPreferences.PageWidth = <span class="stringliteral">&quot;7i&quot;</span></div>
<div class="line">    myDocument.DocumentPreferences.PageHeight = <span class="stringliteral">&quot;9i&quot;</span></div>
<div class="line">    myDocument.DocumentPreferences.PageOrientation = idPageOrientation.idPortrait</div>
<div class="line">    Rem At <span class="keyword">this</span> point, we can reset the application <span class="keywordflow">default</span> margins</div>
<div class="line">    Rem to their original state.</div>
<div class="line">    With myInDesign.MarginPreferences</div>
<div class="line">        .Top = myY1</div>
<div class="line">        .Left = myX1</div>
<div class="line">        .Bottom = myY2</div>
<div class="line">        .Right = myX2</div>
<div class="line">    End With</div>
<div class="line">    Rem Set up the bleed and slug areas.</div>
<div class="line">    With myDocument.DocumentPreferences</div>
<div class="line">        Rem Bleed</div>
<div class="line">        .DocumentBleedBottomOffset = <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">        .DocumentBleedTopOffset = <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">        .DocumentBleedInsideOrLeftOffset = <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">        .DocumentBleedOutsideOrRightOffset = <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">        Rem Slug</div>
<div class="line">        .SlugBottomOffset = <span class="stringliteral">&quot;18p&quot;</span></div>
<div class="line">        .SlugTopOffset = <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">        .SlugInsideOrLeftOffset = <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">        .SlugRightOrOutsideOffset = <span class="stringliteral">&quot;3p&quot;</span></div>
<div class="line">    End With</div>
<div class="line">    Rem Create a color.</div>
<div class="line">    Err.Clear</div>
<div class="line">    On Error Resume Next</div>
<div class="line">    Rem If the color does not already exist, InDesign will generate an error.</div>
<div class="line">    Set myColor = myDocument.Colors.Item(<span class="stringliteral">&quot;PageNumberRed&quot;</span>)</div>
<div class="line">    If Err.Number &lt;&gt; 0 Then</div>
<div class="line">        Set myColor = myDocument.Colors.Add</div>
<div class="line">        myColor.Name = <span class="stringliteral">&quot;PageNumberRed&quot;</span></div>
<div class="line">        myColor.colorModel = idColorModel.idProcess</div>
<div class="line">        myColor.ColorValue = Array(20, 100, 80, 10)</div>
<div class="line">        Err.Clear</div>
<div class="line">    End If</div>
<div class="line">    Rem restore normal error handling</div>
<div class="line">    On Error GoTo 0</div>
<div class="line">    Rem Next, set up some default styles.</div>
<div class="line">    Rem Create up a character style for the page numbers.</div>
<div class="line">    Err.Clear</div>
<div class="line">    On Error Resume Next</div>
<div class="line">    Rem If the character style does not already exist, </div>
<div class="line">    Rem InDesign will generate an error.</div>
<div class="line">    Set myCharacterStyle = myDocument.CharacterStyles.Item(&quot;page_number&quot;)</div>
<div class="line">    If Err.Number &lt;&gt; 0 Then</div>
<div class="line">        Set myCharacterStyle = myDocument.CharacterStyles.Add</div>
<div class="line">        myCharacterStyle.Name = &quot;page_number&quot;</div>
<div class="line">        Err.Clear</div>
<div class="line">    End If</div>
<div class="line">    Rem restore normal error handling</div>
<div class="line">    On Error GoTo 0</div>
<div class="line">    myDocument.CharacterStyles.Item(&quot;page_number&quot;).FillColor _</div>
<div class="line">    = myDocument.Colors.Item(&quot;PageNumberRed&quot;)</div>
<div class="line">    Rem Create up a pair of paragraph styles for the page footer text.</div>
<div class="line">    Rem These styles have only basic formatting.</div>
<div class="line">    Err.Clear</div>
<div class="line">    On Error Resume Next</div>
<div class="line">    Rem If the paragraph style does not already exist, </div>
<div class="line">    Rem InDesign will generate an error.</div>
<div class="line">    Set myParagraphStyle = myDocument.ParagraphStyles.Item(&quot;footer_left&quot;)</div>
<div class="line">    If Err.Number &lt;&gt; 0 Then</div>
<div class="line">        Set myParagraphStyle = myDocument.ParagraphStyles.Add</div>
<div class="line">        myParagraphStyle.Name = &quot;footer_left&quot;</div>
<div class="line">        myParagraphStyle.PointSize = 11</div>
<div class="line">        myParagraphStyle.Leading = 14</div>
<div class="line">        Err.Clear</div>
<div class="line">    End If</div>
<div class="line">    Rem restore normal error handling</div>
<div class="line">    On Error GoTo 0</div>
<div class="line">    Err.Clear</div>
<div class="line">    On Error Resume Next</div>
<div class="line">    Rem If the paragraph style does not already exist, </div>
<div class="line">    Rem InDesign will generate an error.</div>
<div class="line">    Set myParagraphStyle = myDocument.ParagraphStyles.Item(&quot;footer_right&quot;)</div>
<div class="line">    If Err.Number &lt;&gt; 0 Then</div>
<div class="line">        Set myParagraphStyle = myDocument.ParagraphStyles.Add</div>
<div class="line">        myParagraphStyle.Name = &quot;footer_right&quot;</div>
<div class="line">        myParagraphStyle.BasedOn = myDocument.ParagraphStyles.Item(&quot;footer_left&quot;)</div>
<div class="line">        myParagraphStyle.Justification = idJustification.idRightAlign</div>
<div class="line">        myParagraphStyle.PointSize = 11</div>
<div class="line">        myParagraphStyle.Leading = 14</div>
<div class="line">        Err.Clear</div>
<div class="line">    End If</div>
<div class="line">    Rem restore normal error handling</div>
<div class="line">    On Error GoTo 0</div>
<div class="line">    Rem Create a layer for guides.</div>
<div class="line">    Err.Clear</div>
<div class="line">    On Error Resume Next</div>
<div class="line">    Set myLayer = myDocument.Layers.Item(&quot;GuideLayer&quot;)</div>
<div class="line">    If Err.Number &lt;&gt; 0 Then</div>
<div class="line">        Set myLayer = myDocument.Layers.Add</div>
<div class="line">        myLayer.Name = &quot;GuideLayer&quot;</div>
<div class="line">        Err.Clear</div>
<div class="line">    End If</div>
<div class="line">    Rem restore normal error handling</div>
<div class="line">    On Error GoTo 0</div>
<div class="line">    Rem Create a layer for the footer items.</div>
<div class="line">    Err.Clear</div>
<div class="line">    On Error Resume Next</div>
<div class="line">    Set myLayer = myDocument.Layers.Item(&quot;Footer&quot;)</div>
<div class="line">    If Err.Number &lt;&gt; 0 Then</div>
<div class="line">        Set myLayer = myDocument.Layers.Add</div>
<div class="line">        myLayer.Name = &quot;Footer&quot;</div>
<div class="line">        Err.Clear</div>
<div class="line">    End If</div>
<div class="line">    Rem restore normal error handling</div>
<div class="line">    On Error GoTo 0</div>
<div class="line">    Rem Create a layer for the slug items.</div>
<div class="line">    Err.Clear</div>
<div class="line">    On Error Resume Next</div>
<div class="line">    Set myLayer = myDocument.Layers.Item(&quot;Slug&quot;)</div>
<div class="line">    If Err.Number &lt;&gt; 0 Then</div>
<div class="line">        Set myLayer = myDocument.Layers.Add</div>
<div class="line">        myLayer.Name = &quot;Slug&quot;</div>
<div class="line">        Err.Clear</div>
<div class="line">    End If</div>
<div class="line">    Rem restore normal error handling</div>
<div class="line">    On Error GoTo 0</div>
<div class="line">    Rem Create a layer for the body text.</div>
<div class="line">    Err.Clear</div>
<div class="line">    On Error Resume Next</div>
<div class="line">    Set myLayer = myDocument.Layers.Item(&quot;BodyText&quot;)</div>
<div class="line">        If Err.Number &lt;&gt; 0 Then</div>
<div class="line">        Set myLayer = myDocument.Layers.Add</div>
<div class="line">        myLayer.Name = &quot;BodyText&quot;</div>
<div class="line">        Err.Clear</div>
<div class="line">    End If</div>
<div class="line">    Rem restore normal error handling</div>
<div class="line">    On Error GoTo 0</div>
<div class="line">    With myDocument.ViewPreferences</div>
<div class="line">        .RulerOrigin = idRulerOrigin.idPageOrigin</div>
<div class="line">        .HorizontalMeasurementUnits = idMeasurementUnits.idPoints</div>
<div class="line">        .VerticalMeasurementUnits = idMeasurementUnits.idPoints</div>
<div class="line">    End With</div>
<div class="line">    Rem Document baseline grid and document grid</div>
<div class="line">    With myDocument.GridPreferences</div>
<div class="line">        .BaselineStart = 56</div>
<div class="line">        .BaselineDivision = 14</div>
<div class="line">        .BaselineGridShown = False</div>
<div class="line">        .HorizontalGridlineDivision = 14</div>
<div class="line">        .HorizontalGridSubdivision = 5</div>
<div class="line">        .VerticalGridlineDivision = 14</div>
<div class="line">        .VerticalGridSubdivision = 5</div>
<div class="line">        .DocumentGridShown = False</div>
<div class="line">    End With</div>
<div class="line">    Rem Document XMP information.</div>
<div class="line">    With myDocument.MetadataPreferences</div>
<div class="line">        .Author = &quot;Adobe Systems&quot;</div>
<div class="line">        .CopyrightInfoURL = &quot;http:rem www.adobe.com&quot;</div>
<div class="line">        .CopyrightNotice = &quot;This document is not copyrighted.&quot;</div>
<div class="line">        .CopyrightStatus = idCopyrightStatus.idNo</div>
<div class="line">        .Description = &quot;Example 7 x 9 book layout&quot;</div>
<div class="line">        .DocumentTitle = &quot;Example&quot;</div>
<div class="line">        .JobName = &quot;7 x 9 book layout template&quot;</div>
<div class="line">        .Keywords = Array(&quot;7 x 9&quot;, &quot;book&quot;, &quot;template&quot;)</div>
<div class="line">        .CreateContainerItem &quot;http:<span class="comment">//ns.adobe.com/xap/1.0/&quot;, &quot;email&quot;</span></div>
<div class="line">        .SetProperty &quot;http:<span class="comment">//ns.adobe.com/xap/1.0/&quot;, &quot;email/*[1]&quot;, _</span></div>
<div class="line">        &quot;someone@adobe.com&quot;</div>
<div class="line">    End With</div>
<div class="line">    Rem Set up the master spread.</div>
<div class="line">    With myDocument.MasterSpreads.Item(1)</div>
<div class="line">        With .Pages.Item(1)</div>
<div class="line">            Rem Left and right are reversed for left-hand pages (becoming</div>
<div class="line">            Rem &quot;inside&quot; and &quot;outside&quot;--this is also true in the InDesign</div>
<div class="line">            Rem user interface).</div>
<div class="line">            myTopMargin = .MarginPreferences.Top</div>
<div class="line">            myBottomMargin = myDocument.DocumentPreferences.PageHeight _</div>
<div class="line">            - .MarginPreferences.Bottom</div>
<div class="line">            myRightMargin = myDocument.DocumentPreferences.PageWidth _</div>
<div class="line">            - .MarginPreferences.Left</div>
<div class="line">            myLeftMargin = .MarginPreferences.Right</div>
<div class="line">            With .Guides.Add</div>
<div class="line">                .ItemLayer = myDocument.Layers.Item(&quot;GuideLayer&quot;)</div>
<div class="line">                .Orientation = idHorizontalOrVertical.idVertical</div>
<div class="line">                .Location = myLeftMargin</div>
<div class="line">            End With</div>
<div class="line">            With .Guides.Add</div>
<div class="line">                .ItemLayer = myDocument.Layers.Item(&quot;GuideLayer&quot;)</div>
<div class="line">                .Orientation = idHorizontalOrVertical.idVertical</div>
<div class="line">                .Location = myRightMargin</div>
<div class="line">            End With</div>
<div class="line">            With .Guides.Add</div>
<div class="line">                .ItemLayer = myDocument.Layers.Item(&quot;GuideLayer&quot;)</div>
<div class="line">                .Orientation = idHorizontalOrVertical.idHorizontal</div>
<div class="line">                .Location = myTopMargin</div>
<div class="line">                .FitToPage = False</div>
<div class="line">            End With</div>
<div class="line">            With .Guides.Add</div>
<div class="line">                .ItemLayer = myDocument.Layers.Item(&quot;GuideLayer&quot;)</div>
<div class="line">                .Orientation = idHorizontalOrVertical.idHorizontal</div>
<div class="line">                .Location = myBottomMargin</div>
<div class="line">                .FitToPage = False</div>
<div class="line">            End With</div>
<div class="line">            With .Guides.Add</div>
<div class="line">                .ItemLayer = myDocument.Layers.Item(&quot;GuideLayer&quot;)</div>
<div class="line">                .Orientation = idHorizontalOrVertical.idHorizontal</div>
<div class="line">                .Location = myBottomMargin + 14</div>
<div class="line">                .FitToPage = False</div>
<div class="line">            End With</div>
<div class="line">            With .Guides.Add</div>
<div class="line">                .ItemLayer = myDocument.Layers.Item(&quot;GuideLayer&quot;)</div>
<div class="line">                .Orientation = idHorizontalOrVertical.idHorizontal</div>
<div class="line">                .Location = myBottomMargin + 28</div>
<div class="line">            .FitToPage = False</div>
<div class="line">            End With</div>
<div class="line">            Set myLeftFooter = .TextFrames.Add</div>
<div class="line">            myLeftFooter.ItemLayer = myDocument.Layers.Item(&quot;Footer&quot;)</div>
<div class="line">            myLeftFooter.GeometricBounds = Array(myBottomMargin + 14, _</div>
<div class="line">            .MarginPreferences.Right, _</div>
<div class="line">            myBottomMargin + 28, _</div>
<div class="line">            myRightMargin)</div>
<div class="line">            With myLeftFooter.ParentStory.InsertionPoints.Item(1)</div>
<div class="line">                .Contents = idSpecialCharacters.idSectionMarker</div>
<div class="line">                .Contents = idSpecialCharacters.idEmSpace</div>
<div class="line">                .Contents = idSpecialCharacters.idAutoPageNumber</div>
<div class="line">            End With</div>
<div class="line">            With myLeftFooter.ParentStory.Characters.Item(1)</div>
<div class="line">                .AppliedCharacterStyle = myDocument.CharacterStyles.Item(&quot;page_number&quot;)</div>
<div class="line">            End With</div>
<div class="line">            With myLeftFooter.ParentStory.Paragraphs.Item(1)</div>
<div class="line">                .AppliedParagraphStyle = myDocument.ParagraphStyles.Item(&quot;footer_left&quot;)</div>
<div class="line">            End With</div>
<div class="line">            Rem Slug information.</div>
<div class="line">            myDate = Date</div>
<div class="line">            With myDocument.MetadataPreferences</div>
<div class="line">                p1 = &quot;Author:&quot; &amp; vbTab &amp; .Author &amp; vbTab</div>
<div class="line">                p2 = &quot;Description:&quot; &amp; vbTab &amp; .Description &amp; vbCrLf</div>
<div class="line">                p3 = &quot;Creation Date:&quot; &amp; vbTab &amp; myDate &amp; vbTab</div>
<div class="line">                p4 = &quot;Email Contact&quot; &amp; vbTab </div>
<div class="line">                p5 = .GetProperty(&quot;http:<span class="comment">//ns.adobe.com/xap/1.0/&quot;, &quot;email/*[1]&quot;)</span></div>
<div class="line">                myString = p1 &amp; p2 &amp; p3 &amp; p4 &amp; p5</div>
<div class="line">            End With</div>
<div class="line">            Set myLeftSlug = .TextFrames.Add</div>
<div class="line">            myLeftSlug.ItemLayer = myDocument.Layers.Item(&quot;Slug&quot;)</div>
<div class="line">            myLeftSlug.GeometricBounds _</div>
<div class="line">            = Array(myDocument.DocumentPreferences.PageHeight + 36, _</div>
<div class="line">            .MarginPreferences.Right, _</div>
<div class="line">            myDocument.DocumentPreferences.PageHeight + 144, _</div>
<div class="line">            myRightMargin)</div>
<div class="line">            myLeftSlug.Contents = myString</div>
<div class="line">            myLeftSlug.ParentStory.Texts.Item(1).ConvertToTable</div>
<div class="line">            Rem Body text master text frame.</div>
<div class="line">            Set myLeftFrame = .TextFrames.Add</div>
<div class="line">            myLeftFrame.ItemLayer = myDocument.Layers.Item(&quot;BodyText&quot;)</div>
<div class="line">            myLeftFrame.GeometricBounds = Array(.MarginPreferences.Top, _</div>
<div class="line">            .MarginPreferences.Right, myBottomMargin, myRightMargin)</div>
<div class="line">        End With</div>
<div class="line">        With .Pages.Item(2)</div>
<div class="line">            myTopMargin = .MarginPreferences.Top</div>
<div class="line">            myBottomMargin = myDocument.DocumentPreferences.PageHeight _</div>
<div class="line">            - .MarginPreferences.Bottom</div>
<div class="line">            myRightMargin = myDocument.DocumentPreferences.PageWidth _</div>
<div class="line">            - .MarginPreferences.Right</div>
<div class="line">            myLeftMargin = .MarginPreferences.Left</div>
<div class="line">            With .Guides.Add</div>
<div class="line">                .ItemLayer = myDocument.Layers.Item(&quot;GuideLayer&quot;)</div>
<div class="line">                .Orientation = idHorizontalOrVertical.idVertical</div>
<div class="line">                .Location = myLeftMargin</div>
<div class="line">            End With</div>
<div class="line">            With .Guides.Add</div>
<div class="line">                .ItemLayer = myDocument.Layers.Item(&quot;GuideLayer&quot;)</div>
<div class="line">                .Orientation = idHorizontalOrVertical.idVertical</div>
<div class="line">                .Location = myRightMargin</div>
<div class="line">            End With</div>
<div class="line">            Set myRightFooter = .TextFrames.Add</div>
<div class="line">            myRightFooter.ItemLayer = myDocument.Layers.Item(&quot;Footer&quot;)</div>
<div class="line">            myRightFooter.GeometricBounds = Array(myBottomMargin + 14, _</div>
<div class="line">            .MarginPreferences.Left, myBottomMargin + 28, myRightMargin)</div>
<div class="line">            With myRightFooter.ParentStory.InsertionPoints.Item(1)</div>
<div class="line">                .Contents = idSpecialCharacters.idAutoPageNumber</div>
<div class="line">                .Contents = idSpecialCharacters.idEmSpace</div>
<div class="line">                .Contents = idSpecialCharacters.idSectionMarker</div>
<div class="line">            End With</div>
<div class="line">            With myRightFooter.ParentStory.Characters.Item(-1)</div>
<div class="line">            .AppliedCharacterStyle _</div>
<div class="line">            = myDocument.CharacterStyles.Item(&quot;page_number&quot;)</div>
<div class="line">            End With</div>
<div class="line">            With myRightFooter.ParentStory.Paragraphs.Item(1)</div>
<div class="line">                .ApplyParagraphStyle _</div>
<div class="line">                myDocument.ParagraphStyles.Item(&quot;footer_right&quot;), _</div>
<div class="line">                False</div>
<div class="line">            End With</div>
<div class="line">            Rem Slug information.</div>
<div class="line">            Set myRightSlug = .TextFrames.Add</div>
<div class="line">            myRightSlug.ItemLayer = myDocument.Layers.Item(&quot;Slug&quot;)</div>
<div class="line">            myRightSlug.GeometricBounds _</div>
<div class="line">            = Array(myDocument.DocumentPreferences.PageHeight + 36, _</div>
<div class="line">            myLeftMargin, _</div>
<div class="line">            myDocument.DocumentPreferences.PageHeight + 144, _</div>
<div class="line">            myRightMargin)</div>
<div class="line">            myRightSlug.Contents = myString</div>
<div class="line">            myRightSlug.ParentStory.Texts.Item(1).ConvertToTable</div>
<div class="line">            Rem Body text master text frame.</div>
<div class="line">            Set myRightFrame = .TextFrames.Add</div>
<div class="line">            myRightFrame.ItemLayer = myDocument.Layers.Item(&quot;BodyText&quot;)</div>
<div class="line">            myRightFrame.GeometricBounds = Array(.MarginPreferences.Top, _</div>
<div class="line">            .MarginPreferences.Left, _</div>
<div class="line">            myBottomMargin, _</div>
<div class="line">            myRightMargin)</div>
<div class="line">            myRightFrame.PreviousTextFrame = myLeftFrame</div>
<div class="line">        End With</div>
<div class="line">    End With</div>
<div class="line">    Rem Add section marker text--this text will appear in the footer.</div>
<div class="line">    myDocument.Sections.Item(1).Marker = &quot;Section 1&quot;</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_creating_watermarks"></a>
Creating watermarks</h3>
<p>You can apply watermarks to documents in InDesign or InDesign Server using scripting. Currently, no user interface component exists in InDesign for managing watermarks.</p>
<p>A document's watermark preferences can be set in two ways using scripting:</p>
<ul>
<li>Application-level watermark preferences, if any are set, are applied to the document watermark preferences for each new document created by InDesign. This setting has no effect on existing documents.</li>
<li>Document-level watermark preferences apply only to that document. Setting or changing a document's watermark preferences replaces any previous watermark settings for the document.</li>
</ul>
<p>Both the document and application watermark preference settings persist after the document or application is closed until a script changes them.</p>
<p>The same group of watermark preferences exist for both the document and the application objects.</p>
<p><b>Setting watermark preferences</b></p>
<p>The following script fragment shows how to set watermarks at the application level. A watermark will be applied to all documents created after this code finishes. (For the complete script for setting application preferences, see ApplicationWatermark.) </p>
<div class="fragment"><div class="line">    myInDesign.watermarkPreferences.watermarkVisibility = <span class="keyword">true</span></div>
<div class="line">    myInDesign.watermarkPreferences.watermarkDoPrint = <span class="keyword">true</span></div>
<div class="line">    myInDesign.watermarkPreferences.watermarkDrawInBack = <span class="keyword">true</span></div>
<div class="line">    myInDesign.watermarkPreferences.watermarkText = <span class="stringliteral">&quot;Confidential&quot;</span></div>
<div class="line">    myInDesign.watermarkPreferences.watermarkFontFamily = <span class="stringliteral">&quot;Arial&quot;</span></div>
<div class="line">    myInDesign.watermarkPreferences.watermarkFontStyle = <span class="stringliteral">&quot;Bold&quot;</span></div>
<div class="line">    myInDesign.watermarkPreferences.watermarkFontPointSize = 72</div>
<div class="line">    myInDesign.watermarkPreferences.watermarkFontColor = idUIColors.idRed</div>
<div class="line">    myInDesign.watermarkPreferences.watermarkOpacity = 60</div>
<div class="line">    myInDesign.watermarkPreferences.watermarkRotation = -45</div>
<div class="line">    myInDesign.watermarkPreferences.watermarkHorizontalPosition = idWatermarkHorizontalPositionEnum.idWatermarkHCenter</div>
<div class="line">    myInDesign.watermarkPreferences.watermarkHorizontalOffset = 0</div>
<div class="line">    myInDesign.watermarkPreferences.watermarkVerticalPosition = idWatermarkVerticalPositionEnum.idWatermarkVCenter</div>
<div class="line">    myInDesign.watermarkPreferences.watermarkVerticalOffset = 0</div>
</div><!-- fragment --><p> The same preferences can be applied to a document object by referring to a document, rather than to the application. (For the complete script for setting document preferences, see DocumentWatermark.) </p>
<div class="fragment"><div class="line">    myInDesign.Documents.Item(1).WatermarkPreferences.watermarkVisibility = <span class="keyword">true</span></div>
<div class="line">    myInDesign.Documents.Item(1).WatermarkPreferences.watermarkDoPrint = <span class="keyword">true</span></div>
<div class="line">    myInDesign.Documents.Item(1).WatermarkPreferences.watermarkDrawInBack = <span class="keyword">true</span></div>
<div class="line">    myInDesign.Documents.Item(1).WatermarkPreferences.watermarkText = <span class="stringliteral">&quot;Confidential&quot;</span></div>
<div class="line">    myInDesign.Documents.Item(1).WatermarkPreferences.watermarkFontFamily = <span class="stringliteral">&quot;Arial&quot;</span></div>
<div class="line">    myInDesign.Documents.Item(1).WatermarkPreferences.watermarkFontStyle = <span class="stringliteral">&quot;Bold&quot;</span></div>
<div class="line">    myInDesign.Documents.Item(1).WatermarkPreferences.watermarkFontPointSize = 72</div>
<div class="line">    myInDesign.Documents.Item(1).WatermarkPreferences.watermarkFontColor = idUIColors.idRed </div>
<div class="line">    myInDesign.Documents.Item(1).WatermarkPreferences.watermarkOpacity = 60</div>
<div class="line">    myInDesign.Documents.Item(1).WatermarkPreferences.watermarkRotation = -45</div>
<div class="line">    myInDesign.Documents.Item(1).WatermarkPreferences.watermarkHorizontalPosition = idWatermarkHorizontalPositionEnum.idWatermarkHCenter</div>
<div class="line">    myInDesign.Documents.Item(1).WatermarkPreferences.watermarkHorizontalOffset = 0</div>
<div class="line">    myInDesign.Documents.Item(1).WatermarkPreferences.watermarkVerticalPosition = idWatermarkVerticalPositionEnum.idWatermarkVCenter</div>
<div class="line">    myInDesign.Documents.Item(1).WatermarkPreferences.watermarkVerticalOffset = 0</div>
</div><!-- fragment --><p> <b>Disabling watermarks</b></p>
<p>After turning off the application setting for watermarks, InDesign no longer turns on the watermark settings for new documents by default. However, you can still set watermarks for individual documents. The following script fragment shows how to turn off application-level watermarks. </p>
<div class="fragment"><div class="line">Rem Given a reference to the InDesign application <span class="keywordtype">object</span> <span class="stringliteral">&quot;myInDesign&quot;</span>...</div>
<div class="line">myInDesign.WatermarkVisibility = False</div>
</div><!-- fragment --><p>You can turn off watermarks in an individual document at any time, as shown in the following script fragment. </p>
<div class="fragment"><div class="line">Rem Given a reference to the InDesign application <span class="keywordtype">object</span> <span class="stringliteral">&quot;myInDesign&quot;</span>...</div>
<div class="line">myInDesign.Documents.Item(1).WatermarkVisibility = False</div>
</div><!-- fragment --><h2><a class="anchor" id="id_vb_adjusting_page_sizes_and_layout"></a>
Adjusting Page Sizes and Layout</h2>
<p>InDesign allows different page sizes within a single InDesign document. For information on setting the default page size, see <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_defining_page_size_and_document_length">Defining page size and document length</a>.</p>
<p>You can also apply geometric transformations to individual pages.</p>
<h3><a class="anchor" id="id_vb_selecting_pages"></a>
Selecting pages</h3>
<p>Before changing a page's size or applying a transformation to the page, you must select the page. In the InDesign user interface, you do this using the Page Tool on the Tools Panel. You can also select a page using scripting. The following script shows how. (For the complete script, see PageSelect.) </p>
<div class="fragment"><div class="line">    Rem Given a document with four pages (1, 2, 3, 4)...</div>
<div class="line">    Set myDocument = myInDesign.ActiveDocument</div>
<div class="line">    Set myPages = myDocument.Pages</div>
<div class="line">    Rem Select page 2 and 3.</div>
<div class="line">    myPages.Item(2).Select()</div>
<div class="line">    myPages.Item(3).select(idSelectionOptions.idAddTo)</div>
<div class="line">    Rem Select last page.</div>
<div class="line">    Call myDocument.Select(myPages.Item(-1), idSelectionOptions.idAddTo)</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_resizing_and_reframing_pages"></a>
Resizing and reframing pages</h3>
<p>You can resize or reframe page items on a page by scripting. You can also apply the resize and reframe operations to pages to change their sizes.</p>
<dl class="section note"><dt>Note</dt><dd>Your minimum page size is determined by the page's margins. See <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_setting_page_margins_and_columns">Setting page margins and columns</a> for more information.</dd></dl>
<p>The following script shows how to change a page's size using the resize method. (For the complete script, see PageResize.) </p>
<div class="fragment"><div class="line">    Rem Given a document with four pages (1, 2, 3, 4)...</div>
<div class="line">    Set myDocument = myInDesign.ActiveDocument</div>
<div class="line">    Set myPages = myDocument.Pages</div>
<div class="line">    Rem Resize page to two times bigger</div>
<div class="line">    Call myPages.Item(2).Resize(idCoordinateSpaces.idInnerCoordinates, _</div>
<div class="line">                                idAnchorPoint.idCenterAnchor, _</div>
<div class="line">                                idResizeMethods.idMultiplyingCurrentDimensionsBy, _</div>
<div class="line">                                Array(2, 2))</div>
<div class="line">    Rem Resize page to 400 points width and 600 points height.</div>
<div class="line">    Call myPages.item(3).Resize(idCoordinateSpaces.idInnerCoordinates, _</div>
<div class="line">                                idAnchorPoint.idCenterAnchor, _</div>
<div class="line">                                idResizeMethods.idReplacingCurrentDimensionsWith, _</div>
<div class="line">                                Array(400, 600))</div>
</div><!-- fragment --><p> Reframing changes the bounding box of a page, so reframing can be used to change a page's size by making the bounding box larger or smaller. The following script shows how to change a page's size using the reframe method. (For the complete script, see PageReframe.) </p>
<div class="fragment"><div class="line">    Rem Given a document with four pages (1, 2, 3, 4)...</div>
<div class="line">    Set myDocument = myInDesign.ActiveDocument</div>
<div class="line">    Set myPages = myDocument.Pages</div>
<div class="line">    Rem Make the page one inch wider and one inch higher.</div>
<div class="line">    Set myPage = myPages.Item(2)</div>
<div class="line">    myBounds = myPage.Bounds</div>
<div class="line">    myY1 = myBounds(0)</div>
<div class="line">    myX1 = myBounds(1)</div>
<div class="line">    myY2 = myBounds(2)+72</div>
<div class="line">    myX2 = myBounds(3)+72</div>
<div class="line">    Call myPage.Reframe(idCoordinateSpaces.idInnerCoordinates, _</div>
<div class="line">                        Array(Array(myX1, myY1), _</div>
<div class="line">                        Array(myX2, myY2)))</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_transforming_pages"></a>
Transforming pages</h3>
<p>Operations that change the geometry of objects are called transformations. The transform method can rotate, scale, shear, and move (translate) page items on a page and can also be used on pages. For technical details about transformation architecture, refer to <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_transforming_page_items">Transforming Page Items</a>.</p>
<p>To transform a page:</p>
<ol type="1">
<li>Create a transformation matrix.</li>
<li>Apply the transformation matrix to the page using the transform method.</li>
</ol>
<p>The following script shows how to transform a page with scripting. (For the complete script, see PageTransform.) </p>
<div class="fragment"><div class="line">    Rem Given a document with four pages (1, 2, 3, 4)...</div>
<div class="line">    Set myDocument = myInDesign.ActiveDocument</div>
<div class="line">    Set myPages = myDocument.Pages</div>
<div class="line"></div>
<div class="line">    Rem Rotate a page around its center point.</div>
<div class="line">    Set myRotateMatrix = myInDesign.TransformationMatrices.Add(, , , 27)</div>
<div class="line">    myTransform myPages.Item(1), myRotateMatrix</div>
<div class="line"></div>
<div class="line">    Rem Scale a page around its center point.</div>
<div class="line">    Set myScaleMatrix = myInDesign.TransformationMatrices.Add(0.8, 0.8)</div>
<div class="line">    myTransform myPages.Item(2), myScaleMatrix</div>
<div class="line">    </div>
<div class="line">    Rem Shear a page around its center point.</div>
<div class="line">    Set myShearMatrix = myInDesign.TransformationMatrices.Add(, , 30)</div>
<div class="line">    myTransform myPages.Item(3), myShearMatrix</div>
</div><!-- fragment --><div class="fragment"><div class="line">Function myTransform(myPage, myTransformationMatrix)</div>
<div class="line">    myPage.Transform idCoordinateSpaces.idPasteboardCoordinates, _</div>
<div class="line">                    idAnchorPoint.idCenterAnchor, _</div>
<div class="line">                    myTransformationMatrix</div>
<div class="line">End Function</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_master_page_overlay"></a>
Master page overlay</h3>
<p>Because pages can have multiple sizes, it is possible for a page and its master page to be different sizes. In addition to tracking which master is applied, pages also maintain a matrix that determines how the master page draws on the page. This is called the Master Page Overlay. When you select a page using the Page Tool on the Tools Panel, you can see how the master page is positioned by checking the Show Master Page Overlay checkbox on the control panel. You can move the overlay around with the mouse. InDesign achieves this by applying a transform to the master overlay matrix. Although the user interface allows only translation (moving x and y), you can do more by scripting. The following script shows how to transform a master page overlay. (For the complete script, see MasterPageTransform.) </p>
<div class="fragment"><div class="line">    Rem Given a document with four pages (1, 2, 3, 4)...</div>
<div class="line">    Set myDocument = myInDesign.ActiveDocument</div>
<div class="line">    Set myPages = myDocument.Pages</div>
<div class="line"></div>
<div class="line">    Rem Rotate master page overlay around its top-left corner.</div>
<div class="line">    Set myRotateMatrix = myInDesign.TransformationMatrices.Add(, , , 27)</div>
<div class="line">    myPages.Item(1).MasterPageTransform = myRotateMatrix</div>
<div class="line">    </div>
<div class="line">    Rem Scale master page overlay around its top-left corner.</div>
<div class="line">    Set myScaleMatrix = myInDesign.TransformationMatrices.Add(0.5, 0.5)</div>
<div class="line">    myPages.Item(2).MasterPageTransform = myScaleMatrix</div>
<div class="line">    </div>
<div class="line">    Rem Shear master page overlay around its top-left corner.</div>
<div class="line">    Set myShearMatrix = myInDesign.TransformationMatrices.Add(, , 30)</div>
<div class="line">    myPages.Item(3).MasterPageTransform = myShearMatrix</div>
<div class="line">    </div>
<div class="line">    Rem Translate master page overlay 1 inch right and 2 inches down.</div>
<div class="line">    Set myTranslateMatrix = myInDesign.TransformationMatrices.Add(, , , , 72, 144)</div>
<div class="line">    myPages.Item(4).MasterPageTransform = myTranslateMatrix</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_making_an_adaptive_layout"></a>
Making an Adaptive Layout</h2>
<p>Using InDesign's layout adaptation workflow, you create your primary layout the same way that you would create it for a document that will be printed, but then you can quickly adapt that layout to another orientation, to another dimension or aspect ratio, or to a completely different device class. This workflow mainly involves two features: Liquid Layout makes the layout flexible, and Create Alternate Layout creates alternative layouts for different orientations and device classes.</p>
<h3><a class="anchor" id="id_vb_making_a_flexible_layout"></a>
Making a flexible layout</h3>
<p>Using layout rules, a designer can create one InDesign file with one set of physical pages that can display their content suitably on different devices with different sizes and orientations. You can optionally control the pages' appearance for each size and orientation. The following example script shows how to do this. (For the complete script, see LiquidLayout.) </p>
<div class="fragment"><div class="line">  Set doc = myInDesign.Documents.Add</div>
<div class="line">  Set myPage = doc.Pages.item(1)</div>
<div class="line">  REM Set layout policy to LayoutRuleOptions.OBJECT_BASED</div>
<div class="line">  myPage.LayoutRule = idLayoutRuleOptions.idOBJECTBASED </div>
<div class="line">  REM Create a text frame on the first page.</div>
<div class="line">  Set myTextFrame = myPage.TextFrames.Add</div>
<div class="line">  myTextFrame.GeometricBounds=myGetBounds(doc, myPage)</div>
<div class="line">  myTextFrame.Contents=&quot;This is <span class="keywordtype">object</span>-based LayoutRule sample doc.&quot;</div>
<div class="line">  REM Create a rectangle</div>
<div class="line">  Set myItem = myPage.Rectangles.Add</div>
<div class="line">  myItem.GeometricBounds=Array(20,20,70,70)</div>
<div class="line">  myItem.VerticalLayoutConstraints = _</div>
<div class="line">          Array(idDimensionsConstraints.idFlexibleDimension, _</div>
<div class="line">                idDimensionsConstraints.idFlexibleDimension, _</div>
<div class="line">                idDimensionsConstraints.idFlexibleDimension)</div>
<div class="line">  myItem.HorizontalLayoutConstraints = _</div>
<div class="line">          Array(idDimensionsConstraints.idFixedDimension, _</div>
<div class="line">                idDimensionsConstraints.idflexibleDimension, _</div>
<div class="line">                idDimensionsConstraints.idFlexibleDimension)</div>
<div class="line">  </div>
<div class="line">  Set doc2 = myInDesign.Documents.Add()</div>
<div class="line">  Set myPage2 = doc2.Pages.item(1)</div>
<div class="line">  REM Set layout policy to LayoutRuleOptions.SCALE</div>
<div class="line">  myPage2.LayoutRule = idLayoutRuleOptions.idSCALE  </div>
<div class="line">  REM Create a text frame on the first page.</div>
<div class="line">  Set myTextFrame2 = myPage2.TextFrames.Add</div>
<div class="line">  myTextFrame2.GeometricBounds=myGetBounds(doc2, myPage2)</div>
<div class="line">  myTextFrame2.Contents=&quot;This is scale LayoutRule sample doc.&quot;</div>
<div class="line">  Set myItem2 = myPage2.Rectangles.Add</div>
<div class="line">  myItem2.GeometricBounds=Array(20,20,70,70)</div>
<div class="line">  </div>
<div class="line">  Set doc3 = myInDesign.Documents.Add</div>
<div class="line">  Set myPage3 = doc3.Pages.item(1)</div>
<div class="line">  REM Set layout policy to LayoutRuleOptions.RECENTER</div>
<div class="line">  myPage3.LayoutRule = idLayoutRuleOptions.idRECENTER  </div>
<div class="line">  REM Create a text frame on the first page.</div>
<div class="line">  Set myTextFrame3 = myPage3.TextFrames.Add</div>
<div class="line">  myTextFrame3.GeometricBounds=myGetBounds(doc3, myPage3)</div>
<div class="line">  myTextFrame3.Contents=&quot;This is recenter LayoutRule sample doc.&quot;</div>
<div class="line">  Set myItem3 = myPage3.Rectangles.Add</div>
<div class="line">  myItem3.GeometricBounds=Array(20,20,70,70)</div>
<div class="line">   </div>
<div class="line">  Set doc4 = myInDesign.Documents.Add</div>
<div class="line">  Set myPage4 = doc4.Pages.item(1)</div>
<div class="line">  REM Set layout policy to LayoutRuleOptions.GUIDE_BASED</div>
<div class="line">  myPage4.LayoutRule = idLayoutRuleOptions.idGUIDEBASED </div>
<div class="line">  REM Create a text frame on the first page.</div>
<div class="line">  Set myTextFrame4 = myPage4.TextFrames.Add</div>
<div class="line">  myTextFrame4.GeometricBounds=myGetBounds(doc4, myPage4)</div>
<div class="line">  myTextFrame4.Contents=&quot;This is guide-based LayoutRule sample doc.&quot;</div>
<div class="line">  Set myItem4 = myPage4.Rectangles.Add</div>
<div class="line">  myItem4.GeometricBounds=Array(20,20,70,70)</div>
<div class="line">  with doc4</div>
<div class="line">      With .Guides.Add</div>
<div class="line">      .GuideType=idGuideTypeOptions.idLIQUID</div>
<div class="line">      .Location=&quot;40&quot;</div>
<div class="line">      .Orientation=idHorizontalOrVertical.idHorizontal</div>
<div class="line">      End With</div>
<div class="line">  End With</div>
<div class="line">  </div>
<div class="line">  Set doc5 = myInDesign.Documents.Add</div>
<div class="line">  Set myPage5 = doc5.Pages.item(1)</div>
<div class="line">  REM Set layout policy to LayoutRuleOptions.USE_MASTER</div>
<div class="line">  myPage5.LayoutRule = idLayoutRuleOptions.idUSEMASTER</div>
<div class="line">  REM Create a text frame on the first page.</div>
<div class="line">  Set myTextFrame5 = myPage5.TextFrames.Add</div>
<div class="line">  myTextFrame5.GeometricBounds=myGetBounds(doc5, myPage5)</div>
<div class="line">  myTextFrame5.Contents=&quot;This is master page LayoutRule sample doc.&quot;</div>
<div class="line">  Set myItem5 = myPage5.Rectangles.Add</div>
<div class="line">  myItem5.GeometricBounds=Array(20,20,70,70)</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_adding_guides_for_a_guide-based_layout"></a>
Adding guides for a guide-based layout</h3>
<p>The following example script shows how to add guide slices for guide-based layout rules. (For the complete script, see AddGuides.) </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Add</div>
<div class="line">    Rem Create a text frame on the current page.</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    Rem Set layout policy </div>
<div class="line">    Rem Use guide slicing to resize objects on the page as it resizes.</div>
<div class="line">    myPage.LayoutRule = idLayoutRuleOptions.idGUIDEBASED</div>
<div class="line">    Set myTextFrame = myPage.TextFrames.Add</div>
<div class="line">    myTextFrame.GeometricBounds = myGetBounds(myDocument, myPage)</div>
<div class="line">    myTextFrame.Contents = &quot;This is guide-based LayoutRule sample doc.&quot;</div>
<div class="line">    Set myItem = myPage.Rectangles.Add</div>
<div class="line">    myItem.GeometricBounds = Array(20, 20, 70, 70)</div>
<div class="line"></div>
<div class="line">    With myDocument</div>
<div class="line">        Set myGuide = .Guides.Add</div>
<div class="line">        myGuide.GuideType = idGuideTypeOptions.idLIQUID</div>
<div class="line">        myGuide.Location = 20</div>
<div class="line">        myGuide.orientation = idHorizontalOrVertical.idHorizontal</div>
<div class="line">    End With</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_setting_constraints_for_an_object-based_layout"></a>
Setting constraints for an object-based layout</h3>
<p>The following example script shows how to set constraints for object-based layout rules. (For the complete script, see SetConstraints.) </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Add</div>
<div class="line">    Rem Create a text frame on the current page.</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    Rem Set layout policy </div>
<div class="line">    Rem Use guide slicing to resize objects on the page as it resizes.</div>
<div class="line">    myPage.LayoutRule = idLayoutRuleOptions.idOBJECTBASED</div>
<div class="line">    Set myTextFrame = myPage.TextFrames.Add</div>
<div class="line">    myTextFrame.GeometricBounds = myGetBounds(myDocument, myPage)</div>
<div class="line">    myTextFrame.Contents = &quot;This is <span class="keywordtype">object</span>-based layoutRule sample doc.&quot;</div>
<div class="line">    Set myItem = myPage.Rectangles.Add</div>
<div class="line">    myItem.GeometricBounds = Array(20, 20, 70, 70)</div>
<div class="line">    myItem.VerticalLayoutConstraints = _</div>
<div class="line">        Array(idDimensionsConstraints.idFlexibleDimension, _</div>
<div class="line">            idDimensionsConstraints.idFlexibleDimension, _</div>
<div class="line">            idDimensionsConstraints.idFlexibleDimension)</div>
<div class="line">    myItem.HorizontalLayoutConstraints = _</div>
<div class="line">        Array(idDimensionsConstraints.idFlexibleDimension, _</div>
<div class="line">            idDimensionsConstraints.idFlexibleDimension, _</div>
<div class="line">            idDimensionsConstraints.idFlexibleDimension)</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_creating_alternative_layouts"></a>
Creating alternative layouts</h3>
<p>Create Alternate Layout takes a range of existing pages with content and automatically creates linked copies of the content on a set of new pages within the same document. Use this when you need to create unique layouts for different orientations and device classes. (For the complete script, see CreateAlternateLayout.) </p>
<div class="fragment"><div class="line">    Set myDoc = myInDesign.Documents.Add</div>
<div class="line">    With myDoc.DocumentPreferences</div>
<div class="line">        .facingPages=<span class="keyword">false</span></div>
<div class="line">        .pagesPerDocument=1</div>
<div class="line">        .pageWidth=1024</div>
<div class="line">        .pageHeight=768</div>
<div class="line">    End With</div>
<div class="line">    REM Reposition and resize objects on the page as it resizes.</div>
<div class="line">    myDoc.Pages.item(1).LayoutRule = idLayoutRuleOptions.idOBJECTBASED </div>
<div class="line">     With myDoc</div>
<div class="line">        Set myItem = .Pages.Item(1).Rectangles.Add</div>
<div class="line">        myItem.GeometricBounds=Array(50,50,100,100)  </div>
<div class="line">    End With</div>
<div class="line">    REM create alternate layout </div>
<div class="line">    myDoc.CreateAlternateLayout myDoc.Spreads, &quot;new layout&quot;, _</div>
<div class="line">                                myDoc.DocumentPreferences.PageHeight, _</div>
<div class="line">                                myDoc.DocumentPreferences.PageWidth, _</div>
<div class="line">                                true, true, _</div>
<div class="line">                                idLayoutRuleOptions.idPRESERVEEXISTING</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_collecting_and_dropping_content"></a>
Collecting and Dropping Content</h2>
<p>With Content Dropper, you can copy the content from a file designed for printing and paste it into another document.</p>
<p>The following script shows how to collect content in a document using scripting. (For the complete script, see ContentCollectorAndPlacer.) </p>
<div class="fragment"><div class="line">    REM Invoke Page.contentPlace with <span class="keywordflow">default</span> parameters</div>
<div class="line">    myPage1.ContentPlace(myPage.TextFrames)</div>
</div><!-- fragment --><p> The following script shows how to place collected content into another document. (For the complete script, see ContentCollectorAndPlacer.) </p>
<div class="fragment"><div class="line">    REM Invoke Page.contentPlace with full parameters</div>
<div class="line">    myPage1.ContentPlace myPage.checkBoxes, _</div>
<div class="line">                                      <span class="keyword">true</span>, _</div>
<div class="line">                                      <span class="keyword">true</span>, _</div>
<div class="line">                                      <span class="keyword">true</span>, _</div>
<div class="line">                                      Array(0, 0, 40, 40), _</div>
<div class="line">                                      myDocument1.ActiveLayer, _</div>
<div class="line">                                      <span class="keyword">true</span></div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_printing_a_document"></a>
Printing a Document</h2>
<p>The following script prints the active document using the current print preferences. (For the complete script, see PrintDocument.) </p>
<div class="fragment"><div class="line">    <span class="keyword">set</span> myDocument = myInDesign.Documents.Add</div>
<div class="line">    Rem The document is blank. So have to <span class="keyword">set</span> the print</div>
<div class="line">    Rem preferences</div>
<div class="line">    With myDocument.PrintPreferences</div>
<div class="line">        .PrintBlankPages = True</div>
<div class="line">    End With</div>
<div class="line">    Rem The PrintOut method has two optional parameters:</div>
<div class="line">    Rem PrintDialog -- <span class="keywordflow">if</span> <span class="keyword">true</span>, display the Print dialog box</div>
<div class="line">    Rem Using -- <span class="keywordflow">if</span> specified, use a named printer preset.</div>
<div class="line">    Rem The following line prints the document <span class="keyword">using</span> the <span class="keywordflow">default</span></div>
<div class="line">    Rem settings without displaying the Print dialog box.</div>
<div class="line">    myDocument.PrintOut False</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_printing_using_page_ranges"></a>
Printing using page ranges</h3>
<p>To specify a page range to print, set the PageRange property of the document's print preferences object before printing, as shown in the following script fragment (from the PrintPageRange tutorial script): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Rem The page range can be either idPageRange.idAllPages or a page range <span class="keywordtype">string</span>.</div>
<div class="line">    Rem A page number entered in the page range must correspond to a page</div>
<div class="line">    Rem name in the document (i.e., not the page index). If the page name is</div>
<div class="line">    Rem not found, InDesign will display an error message.</div>
<div class="line">    myDocument.PrintPreferences.PageRange = <span class="stringliteral">&quot;1-3, 6&quot;</span></div>
<div class="line">    myDocument.PrintOut <span class="keyword">false</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_setting_print_preferences"></a>
Setting print preferences</h3>
<p>The print preferences object contains properties corresponding to the options in the panels of the Print dialog. The following script shows how to set print preferences using scripting. (For the complete script, see PrintPreferences.) </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    With myDocument.PrintPreferences</div>
<div class="line">        Rem Properties corresponding to the controls in the General panel of the</div>
<div class="line">        Rem Print dialog box. ActivePrinterPreset is ignored in <span class="keyword">this</span> example--we<span class="stringliteral">&#39;ll</span></div>
<div class="line"><span class="stringliteral">        Rem set our own print preferences.</span></div>
<div class="line"><span class="stringliteral">        Rem</span></div>
<div class="line"><span class="stringliteral">        Rem Printer can be either a string (the name of the printer) or</span></div>
<div class="line"><span class="stringliteral">        Rem idPrinter.idPostscriptFile.</span></div>
<div class="line"><span class="stringliteral">        .Printer = idPrinter.idPostscriptFile</span></div>
<div class="line"><span class="stringliteral">        Rem</span></div>
<div class="line"><span class="stringliteral">        Rem If the Printer property is the name of a printer, then the ppd property</span></div>
<div class="line"><span class="stringliteral">        Rem is locked (and will return an error if you try to set it).</span></div>
<div class="line"><span class="stringliteral">        On Error Resume Next</span></div>
<div class="line"><span class="stringliteral">        .ppd = &quot;AGFA-SelectSet5000SF&quot;</span></div>
<div class="line"><span class="stringliteral">        If Err.Number &lt;&gt; 0 Then</span></div>
<div class="line"><span class="stringliteral">            Err.Clear</span></div>
<div class="line"><span class="stringliteral">        End If</span></div>
<div class="line"><span class="stringliteral">        Rem If the Printer property is set to Printer.postscript file, the copies</span></div>
<div class="line"><span class="stringliteral">        Rem property is unavailable. Attempting to set it will generate an error.</span></div>
<div class="line"><span class="stringliteral">        Rem .Copies = 1</span></div>
<div class="line"><span class="stringliteral">        Rem</span></div>
<div class="line"><span class="stringliteral">        Rem If the Printer property is set to Printer.postscript file, or if the</span></div>
<div class="line"><span class="stringliteral">        Rem selected printer does not support collation, then the Collating</span></div>
<div class="line"><span class="stringliteral">        Rem property is unavailable. Attempting to set it will generate an error.</span></div>
<div class="line"><span class="stringliteral">        Rem .Collating = false</span></div>
<div class="line"><span class="stringliteral">        Rem</span></div>
<div class="line"><span class="stringliteral">        .ReverseOrder = False</span></div>
<div class="line"><span class="stringliteral">        Rem</span></div>
<div class="line"><span class="stringliteral">        Rem PageRange can be either idPageRange.idAllPages or a page range string.</span></div>
<div class="line"><span class="stringliteral">        .PageRange = idPageRange.idAllPages</span></div>
<div class="line"><span class="stringliteral">        Rem</span></div>
<div class="line"><span class="stringliteral">        .PrintSpreads = False</span></div>
<div class="line"><span class="stringliteral">        .PrintMasterPages = False</span></div>
<div class="line"><span class="stringliteral">        Rem If the Printer property is set to Printer.postScript file, then</span></div>
<div class="line"><span class="stringliteral">        Rem the printFile property contains the file path to the output file.</span></div>
<div class="line"><span class="stringliteral">        .PrintFile = &quot;c:\test.ps&quot;</span></div>
<div class="line"><span class="stringliteral">        .Sequence = idSequences.idAll</span></div>
<div class="line"><span class="stringliteral">        Rem If trapping is set to either idTrapping.idApplicationBuiltIn or</span></div>
<div class="line"><span class="stringliteral">        Rem idTrapping.idAdobeInRIP, then setting the following properties </span></div>
<div class="line"><span class="stringliteral">        Rem will produce an error.</span></div>
<div class="line"><span class="stringliteral">        If (.ColorOutput = idColorOutputModes.idInRIPSeparations) Or _</span></div>
<div class="line"><span class="stringliteral">        (.ColorOutput = idColorOutputModes.idSeparations) Then</span></div>
<div class="line"><span class="stringliteral">            If .Trapping = idTrapping.idOff Then</span></div>
<div class="line"><span class="stringliteral">                .PrintBlankPages = False</span></div>
<div class="line"><span class="stringliteral">                .PrintGuidesGrids = False</span></div>
<div class="line"><span class="stringliteral">                .PrintNonprinting = False</span></div>
<div class="line"><span class="stringliteral">            End If</span></div>
<div class="line"><span class="stringliteral">        End If</span></div>
<div class="line"><span class="stringliteral">        Rem Properties corresponding to the controls in the </span></div>
<div class="line"><span class="stringliteral">        Rem Setup panel of the Print dialog box.</span></div>
<div class="line"><span class="stringliteral">        On Error Resume Next</span></div>
<div class="line"><span class="stringliteral">        .PaperSize = idPaperSizes.idCustom        </span></div>
<div class="line"><span class="stringliteral">        .PaperHeight = 1200</span></div>
<div class="line"><span class="stringliteral">        .PaperWidth = 1200</span></div>
<div class="line"><span class="stringliteral">        .PrintPageOrientation = idPrintPageOrientation.idPortrait</span></div>
<div class="line"><span class="stringliteral">        .PagePosition = idPagePositions.idCentered</span></div>
<div class="line"><span class="stringliteral">        .PaperGap = 0</span></div>
<div class="line"><span class="stringliteral">        .PaperOffset = 0</span></div>
<div class="line"><span class="stringliteral">        .PaperTransverse = False</span></div>
<div class="line"><span class="stringliteral">        If Err.Number &lt;&gt; 0 Then</span></div>
<div class="line"><span class="stringliteral">            Err.Clear</span></div>
<div class="line"><span class="stringliteral">        End If</span></div>
<div class="line"><span class="stringliteral">        On Error Resume Next</span></div>
<div class="line"><span class="stringliteral">        .ScaleHeight = 100</span></div>
<div class="line"><span class="stringliteral">        .ScaleWidth = 100</span></div>
<div class="line"><span class="stringliteral">        .ScaleMode = idScaleModes.idScaleWidthHeight</span></div>
<div class="line"><span class="stringliteral">        .ScaleProportional = True</span></div>
<div class="line"><span class="stringliteral">        Rem If trapping is set to either idTrapping.idApplicationBuiltIn or</span></div>
<div class="line"><span class="stringliteral">        Rem idTrapping.idAdobeInRIP, then setting the following properties will</span></div>
<div class="line"><span class="stringliteral">        Rem produce an error.</span></div>
<div class="line"><span class="stringliteral">        If (.ColorOutput = idColorOutputModes.idInRIPSeparations) Or _</span></div>
<div class="line"><span class="stringliteral">        (.ColorOutput = idColorOutputModes.idSeparations) Then</span></div>
<div class="line"><span class="stringliteral">            If .Trapping = idTrapping.idOff Then</span></div>
<div class="line"><span class="stringliteral">                .TextAsBlack = False</span></div>
<div class="line"><span class="stringliteral">                .Thumbnails = False</span></div>
<div class="line"><span class="stringliteral">                Rem The following properties is not needed because thumbnails is set</span></div>
<div class="line"><span class="stringliteral">                Rem to false.</span></div>
<div class="line"><span class="stringliteral">                Rem thumbnailsPerPage = 4</span></div>
<div class="line"><span class="stringliteral">                .Tile = False</span></div>
<div class="line"><span class="stringliteral">                Rem The following properties are not needed because tile is set to</span></div>
<div class="line"><span class="stringliteral">                Rem false.</span></div>
<div class="line"><span class="stringliteral">                Rem .TilingOverlap = 12</span></div>
<div class="line"><span class="stringliteral">                Rem .TilingType = TilingTypes.auto</span></div>
<div class="line"><span class="stringliteral">            End If</span></div>
<div class="line"><span class="stringliteral">        End If</span></div>
<div class="line"><span class="stringliteral">        Rem</span></div>
<div class="line"><span class="stringliteral">        Rem Properties corresponding to the controls in the Marks and Bleed panel of</span></div>
<div class="line"><span class="stringliteral">        Rem the Print dialog box.</span></div>
<div class="line"><span class="stringliteral">        Rem</span></div>
<div class="line"><span class="stringliteral">        Rem Set the following property to true to print all printer&#39;</span>s marks.</div>
<div class="line">        Rem .AllPrinterMarks = <span class="keyword">true</span></div>
<div class="line">        .UseDocumentBleedToPrint = False</div>
<div class="line">        Rem If useDocumentBleedToPrint = <span class="keyword">false</span> then setting any of the  bleed</div>
<div class="line">        Rem properties will result in an error.</div>
<div class="line">        Rem Get the bleed amounts from the document<span class="stringliteral">&#39;s bleed and add a bit.</span></div>
<div class="line"><span class="stringliteral">        Set myDocumentPreferences = myDocument.DocumentPreferences</span></div>
<div class="line"><span class="stringliteral">        .BleedBottom = myDocumentPreferences.DocumentBleedBottomOffset + 3</span></div>
<div class="line"><span class="stringliteral">        .BleedTop = myDocumentPreferences.DocumentBleedTopOffset + 3</span></div>
<div class="line"><span class="stringliteral">        .BleedInside = myDocumentPreferences.DocumentBleedInsideOrLeftOffset + 3</span></div>
<div class="line"><span class="stringliteral">        .BleedOutside = myDocumentPreferences.DocumentBleedOutsideOrRightOffset + 3</span></div>
<div class="line"><span class="stringliteral">        Rem If any bleed area is greater than zero, then print the bleed marks.</span></div>
<div class="line"><span class="stringliteral">        if (.BleedBottom or .BleedTop or .BleedInside or .BleedOutside) Then</span></div>
<div class="line"><span class="stringliteral">            .BleedMarks = True</span></div>
<div class="line"><span class="stringliteral">        Else</span></div>
<div class="line"><span class="stringliteral">            .BleedMarks = False</span></div>
<div class="line"><span class="stringliteral">        End If</span></div>
<div class="line"><span class="stringliteral">        .ColorBars = True</span></div>
<div class="line"><span class="stringliteral">        .CropMarks = True</span></div>
<div class="line"><span class="stringliteral">        .IncludeSlugToPrint = False</span></div>
<div class="line"><span class="stringliteral">        .MarkLineWeight = idMarkLineWeight.idP125pt</span></div>
<div class="line"><span class="stringliteral">        .MarkOffset = 6</span></div>
<div class="line"><span class="stringliteral">        Rem .MarkType = MarkTypes.default</span></div>
<div class="line"><span class="stringliteral">        .PageInformationMarks = True</span></div>
<div class="line"><span class="stringliteral">        .RegistrationMarks = True</span></div>
<div class="line"><span class="stringliteral">        Rem</span></div>
<div class="line"><span class="stringliteral">        Rem Properties corresponding to the controls in the </span></div>
<div class="line"><span class="stringliteral">        Rem Output panel of the Print dialog box.</span></div>
<div class="line"><span class="stringliteral">        Rem</span></div>
<div class="line"><span class="stringliteral">        .Negative = True</span></div>
<div class="line"><span class="stringliteral">        .ColorOutput = idColorOutputModes.idSeparations</span></div>
<div class="line"><span class="stringliteral">        Rem Note the lowercase &quot;i&quot; in &quot;Builtin&quot;</span></div>
<div class="line"><span class="stringliteral">        .Trapping = idTrapping.idApplicationBuiltin</span></div>
<div class="line"><span class="stringliteral">        .Screening = &quot;175 lpi/2400 dpi&quot;</span></div>
<div class="line"><span class="stringliteral">        .Flip = idFlip.idNone</span></div>
<div class="line"><span class="stringliteral">        Rem The following options are only applicable if trapping is set to</span></div>
<div class="line"><span class="stringliteral">        Rem idTrapping.idAdobeInRIP.</span></div>
<div class="line"><span class="stringliteral">        If .Trapping = idTrapping.idAdobeInRIP Then</span></div>
<div class="line"><span class="stringliteral">            .PrintBlack = True</span></div>
<div class="line"><span class="stringliteral">            .PrintCyan = True</span></div>
<div class="line"><span class="stringliteral">            .PrintMagenta = True</span></div>
<div class="line"><span class="stringliteral">            .PrintYellow = True</span></div>
<div class="line"><span class="stringliteral">        End If</span></div>
<div class="line"><span class="stringliteral">        Rem Only change the ink angle and frequency when you want to override the</span></div>
<div class="line"><span class="stringliteral">        Rem screening set by the screening specified by the screening property.</span></div>
<div class="line"><span class="stringliteral">        Rem .BlackAngle = 45</span></div>
<div class="line"><span class="stringliteral">        Rem .BlackFrequency = 175</span></div>
<div class="line"><span class="stringliteral">        Rem .CyanAngle = 15</span></div>
<div class="line"><span class="stringliteral">        Rem .CyanFrequency = 175</span></div>
<div class="line"><span class="stringliteral">        Rem .MagentaAngle = 75</span></div>
<div class="line"><span class="stringliteral">        Rem .MagentaFreqency = 175</span></div>
<div class="line"><span class="stringliteral">        Rem .YellowAngle = 0</span></div>
<div class="line"><span class="stringliteral">        Rem .YellowFrequency = 175</span></div>
<div class="line"><span class="stringliteral">        Rem The following properties are not needed (because colorOutput is set to</span></div>
<div class="line"><span class="stringliteral">        Rem separations).</span></div>
<div class="line"><span class="stringliteral">        Rem .CompositeAngle = 45</span></div>
<div class="line"><span class="stringliteral">        Rem .CompositeFrequency = 175</span></div>
<div class="line"><span class="stringliteral">        Rem .SimulateOverprint = false</span></div>
<div class="line"><span class="stringliteral">        Rem</span></div>
<div class="line"><span class="stringliteral">        Rem Properties corresponding to the controls in </span></div>
<div class="line"><span class="stringliteral">        Rem the Graphics panel of the Print dialog box.</span></div>
<div class="line"><span class="stringliteral">        Rem</span></div>
<div class="line"><span class="stringliteral">        .SendImageData = idImageDataTypes.idAllImageData</span></div>
<div class="line"><span class="stringliteral">        .FontDownloading = idFontDownloading.idComplete</span></div>
<div class="line"><span class="stringliteral">        Err.Clear</span></div>
<div class="line"><span class="stringliteral">        On Error Resume Next</span></div>
<div class="line"><span class="stringliteral">            .DownloadPPDFonts = True</span></div>
<div class="line"><span class="stringliteral">            .DataFormat = idDataFormat.idBinary</span></div>
<div class="line"><span class="stringliteral">            .PostScriptLevel = idPostScriptLevels.idLevel3</span></div>
<div class="line"><span class="stringliteral">            If Err.Number &lt;&gt; 0 Then</span></div>
<div class="line"><span class="stringliteral">                Err.Clear</span></div>
<div class="line"><span class="stringliteral">            End If</span></div>
<div class="line"><span class="stringliteral">        On Error GoTo 0</span></div>
<div class="line"><span class="stringliteral">        Rem</span></div>
<div class="line"><span class="stringliteral">        Rem Properties corresponding to the controls in </span></div>
<div class="line"><span class="stringliteral">        Rem the Color Management panel of the Print dialog box.</span></div>
<div class="line"><span class="stringliteral">        Rem</span></div>
<div class="line"><span class="stringliteral">        Rem If the UseColorManagement property of myInDesign.ColorSettings is false,</span></div>
<div class="line"><span class="stringliteral">        Rem attempting to set the following properties will return an error.</span></div>
<div class="line"><span class="stringliteral">        Err.Clear</span></div>
<div class="line"><span class="stringliteral">        On Error Resume Next</span></div>
<div class="line"><span class="stringliteral">        .SourceSpace = SourceSpaces.useDocument</span></div>
<div class="line"><span class="stringliteral">        .Intent = RenderingIntent.useColorSettings</span></div>
<div class="line"><span class="stringliteral">        .CRD = ColorRenderingDictionary.useDocument</span></div>
<div class="line"><span class="stringliteral">        .Profile = Profile.postscriptCMS</span></div>
<div class="line"><span class="stringliteral">        If Err.Number &lt;&gt; 0 Then</span></div>
<div class="line"><span class="stringliteral">            Err.Clear</span></div>
<div class="line"><span class="stringliteral">        End If</span></div>
<div class="line"><span class="stringliteral">        On Error GoTo 0</span></div>
<div class="line"><span class="stringliteral">        Rem</span></div>
<div class="line"><span class="stringliteral">        Rem Properties corresponding to the controls in </span></div>
<div class="line"><span class="stringliteral">        Rem the Advanced panel of the Print dialog box.</span></div>
<div class="line"><span class="stringliteral">        Rem</span></div>
<div class="line"><span class="stringliteral">        .OPIImageReplacement = False</span></div>
<div class="line"><span class="stringliteral">        .OmitBitmaps = False</span></div>
<div class="line"><span class="stringliteral">        .OmitEPS = False</span></div>
<div class="line"><span class="stringliteral">        .OmitPDF = False</span></div>
<div class="line"><span class="stringliteral">        Err.Clear</span></div>
<div class="line"><span class="stringliteral">        On Error Resume Next</span></div>
<div class="line"><span class="stringliteral">        .FlattenerPresetName = &quot;high quality flattener&quot;</span></div>
<div class="line"><span class="stringliteral">        If Err.Number &lt;&gt; 0 Then</span></div>
<div class="line"><span class="stringliteral">            Err.Clear</span></div>
<div class="line"><span class="stringliteral">        End If</span></div>
<div class="line"><span class="stringliteral">        On Error GoTo 0</span></div>
<div class="line"><span class="stringliteral">        .IgnoreSpreadOverrides = False</span></div>
<div class="line"><span class="stringliteral">    End With</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_printing_with_printer_presets"></a>
Printing with printer presets</h3>
<p>To print a document using a printer preset, include the printer preset in the print command. </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myPrinterPreset = myInDesign.PrinterPresets.Item(<span class="stringliteral">&quot;myPrinterPreset&quot;</span>)</div>
<div class="line">    myDocument.PrintOut False, myPrinterPreset</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_exporting_a_document_as_pdf"></a>
Exporting a Document as PDF</h2>
<p>InDesign scripting offers full control over the creation of PDF files from your page-layout documents.</p>
<h3><a class="anchor" id="id_vb_exporting_to_pdf"></a>
Exporting to PDF</h3>
<p>The following script exports the current document as PDF, using the current PDF export options. (For the complete script, see ExportPDF.) </p>
<div class="fragment"><div class="line">    myDocument.Export idExportFormat.idPDFType, <span class="stringliteral">&quot;C:\ExportPDF.pdf&quot;</span>, False</div>
</div><!-- fragment --><p> The following script fragment shows how to export to PDF using a PDF export preset. (For the complete script, see ExportPDFWithPreset.) </p>
<div class="fragment"><div class="line">    myFile = <span class="stringliteral">&quot;C:\ExportPDFWithPreset.pdf&quot;</span></div>
<div class="line">    myDocument.Export idExportFormat.idPDFType, myFile, False, myInDesign.PDFExportPresets.Item(<span class="stringliteral">&quot;[Smallest File Size]&quot;</span>)</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_setting_pdf_export_options"></a>
Setting PDF export options</h3>
<p>The following script sets the PDF export options before exporting. (For the complete script, see ExportPDFWithOptions.) </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    With myInDesign.PDFExportPreferences</div>
<div class="line">        Rem Basic PDF output options.</div>
<div class="line">        .PageRange = idPageRange.idAllPages</div>
<div class="line">        .AcrobatCompatibility = idAcrobatCompatibility.idAcrobat6</div>
<div class="line">        .ExportGuidesAndGrids = False</div>
<div class="line">        .ExportLayers = False</div>
<div class="line">        .ExportNonprintingObjects = False</div>
<div class="line">        .ExportReaderSpreads = False</div>
<div class="line">        .GenerateThumbnails = False</div>
<div class="line">        On Error Resume Next</div>
<div class="line">        .IgnoreSpreadOverrides = False</div>
<div class="line">        .IncludeICCProfiles = True</div>
<div class="line">        On Error GoTo 0</div>
<div class="line">        .IncludeBookmarks = True</div>
<div class="line">        .IncludeHyperlinks = True</div>
<div class="line">        .IncludeSlugWithPDF = False</div>
<div class="line">        .IncludeStructure = False</div>
<div class="line">        .InteractiveElementsOption = idInteractiveElementsOptions.idDoNotInclude</div>
<div class="line">        Rem Setting subsetFontsBelow to zero disallows font subsetting</div>
<div class="line">        Rem <span class="keyword">set</span> subsetFontsBelow to some other value to use font subsetting.</div>
<div class="line">        .SubsetFontsBelow = 0</div>
<div class="line">        Rem Bitmap compression/sampling/quality options.</div>
<div class="line">        .ColorBitmapCompression = idBitmapCompression.idZip</div>
<div class="line">        .ColorBitmapQuality = idCompressionQuality.idEightBit</div>
<div class="line">        .ColorBitmapSampling = idSampling.idNone</div>
<div class="line">        Rem ThresholdToCompressColor is not needed in <span class="keyword">this</span> example.</div>
<div class="line">        Rem ColorBitmapSamplingDPI is not needed when ColorBitmapSampling is <span class="keyword">set</span></div>
<div class="line">        Rem to none.</div>
<div class="line">        .GrayscaleBitmapCompression = idBitmapCompression.idZip</div>
<div class="line">        .GrayscaleBitmapQuality = idCompressionQuality.idEightBit</div>
<div class="line">        .GrayscaleBitmapSampling = idSampling.idNone</div>
<div class="line">        Rem ThresholdToCompressGray is not needed in <span class="keyword">this</span> example.</div>
<div class="line">        Rem GrayscaleBitmapSamplingDPI is not needed when GrayscaleBitmapSampling</div>
<div class="line">        Rem is <span class="keyword">set</span> to none.</div>
<div class="line">        .MonochromeBitmapCompression = idBitmapCompression.idZip</div>
<div class="line">        .MonochromeBitmapSampling = idSampling.idNone</div>
<div class="line">        Rem ThresholdToCompressMonochrome is not needed in <span class="keyword">this</span> example.</div>
<div class="line">        Rem MonochromeBitmapSamplingDPI is not needed when MonochromeBitmapSampling</div>
<div class="line">        Rem is <span class="keyword">set</span> to none.</div>
<div class="line">        Rem Other compression options.</div>
<div class="line">        .CompressionType = idPDFCompressionType.idCompressNone</div>
<div class="line">        .CompressTextAndLineArt = True</div>
<div class="line">        .CropImagesToFrames = True</div>
<div class="line">        .OptimizePDF = True</div>
<div class="line">        Rem Printers marks and prepress options.</div>
<div class="line">        Rem Get the bleed amounts from the document<span class="stringliteral">&#39;s bleed.</span></div>
<div class="line"><span class="stringliteral">        set myDocumentPreferences = myDocument.DocumentPreferences</span></div>
<div class="line"><span class="stringliteral">        .BleedBottom = myDocumentPreferences.DocumentBleedBottomOffset</span></div>
<div class="line"><span class="stringliteral">        .BleedTop = myDocumentPreferences.DocumentBleedTopOffset</span></div>
<div class="line"><span class="stringliteral">        .BleedInside = myDocumentPreferences.DocumentBleedInsideOrLeftOffset</span></div>
<div class="line"><span class="stringliteral">        .BleedOutside = myDocumentPreferences.DocumentBleedOutsideOrRightOffset</span></div>
<div class="line"><span class="stringliteral">        Rem If any bleed area is greater than zero, then print the bleed marks.</span></div>
<div class="line"><span class="stringliteral">        If (.BleedBottom or .BleedTop or .BleedInside or .BleedOutside) Then</span></div>
<div class="line"><span class="stringliteral">            .BleedMarks = True</span></div>
<div class="line"><span class="stringliteral">        Else</span></div>
<div class="line"><span class="stringliteral">            .BleedMarks = False</span></div>
<div class="line"><span class="stringliteral">        End If</span></div>
<div class="line"><span class="stringliteral">        .ColorBars = True</span></div>
<div class="line"><span class="stringliteral">        Rem ColorTileSize and GrayTileSize are only used when</span></div>
<div class="line"><span class="stringliteral">        Rem the export format is set to JPEG2000.</span></div>
<div class="line"><span class="stringliteral">        Rem .ColorTileSize = 256</span></div>
<div class="line"><span class="stringliteral">        Rem .GrayTileSize = 256</span></div>
<div class="line"><span class="stringliteral">        .CropMarks = True</span></div>
<div class="line"><span class="stringliteral">        .OmitBitmaps = False</span></div>
<div class="line"><span class="stringliteral">        .OmitEPS = False</span></div>
<div class="line"><span class="stringliteral">        .OmitPDF = False</span></div>
<div class="line"><span class="stringliteral">        .PageInformationMarks = True</span></div>
<div class="line"><span class="stringliteral">        .PageMarksOffset = &quot;12 pt&quot;</span></div>
<div class="line"><span class="stringliteral">        .PDFColorSpace = idPDFColorSpace.idUnchangedColorSpace</span></div>
<div class="line"><span class="stringliteral">        .PDFMarkType = idMarkTypes.idDefault</span></div>
<div class="line"><span class="stringliteral">        .PrinterMarkWeight = idPDFMarkWeight.idP125pt</span></div>
<div class="line"><span class="stringliteral">        .RegistrationMarks = True</span></div>
<div class="line"><span class="stringliteral">        On Error Resume Next</span></div>
<div class="line"><span class="stringliteral">        .SimulateOverprint = False</span></div>
<div class="line"><span class="stringliteral">        On Error GoTo 0</span></div>
<div class="line"><span class="stringliteral">        .UseDocumentBleedWithPDF = True</span></div>
<div class="line"><span class="stringliteral">        Rem Set viewPDF to true to open the PDF in Acrobat or Adobe Reader.</span></div>
<div class="line"><span class="stringliteral">        .ViewPDF = False</span></div>
<div class="line"><span class="stringliteral">    End With</span></div>
<div class="line"><span class="stringliteral">    Rem Now export the document. You&#39;</span>ll have to fill in your own file path.</div>
<div class="line">    myDocument.Export idExportFormat.idPDFType, <span class="stringliteral">&quot;C:\ExportPDFWithOptions.pdf&quot;</span>, False</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_exporting_to_grayscale_pdf"></a>
Exporting to grayscale PDF</h3>
<p>An InDesign document that contains colors can be exported to a color PDF or to a grayscale PDF. You can modify the script in the preceding <a class="el" href="id_js_adobe_indesign_cc_scripting_guide_javascript.html#id_js_setting_pdf_export_options">Setting PDF export options</a> section to export in grayscale by changing the idPDFColorSpace option from idUnchangedColorSpace to gray. For example: </p>
<div class="fragment"><div class="line">With app.pdfExportPreferences</div>
<div class="line">    .PDFColorSpace = idPDFColorSpace.idGRAY</div>
<div class="line">End With</div>
</div><!-- fragment --><p>(For a different script that creates a small document containing color and exports it to PDF in grayscale, see GreyscalePDFforIDS.)</p>
<h3><a class="anchor" id="id_vb_exporting_a_range_of_pages_to_pdf"></a>
Exporting a range of pages to PDF</h3>
<p>The following script shows how to export a specified page range as PDF. (For the complete script, see ExportPageRangeAsPDF.) </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Rem Enter the names of the pages you want to export in the following line.</div>
<div class="line">    Rem Note that the page name is not necessarily the index of the page in the</div>
<div class="line">    Rem document (e.g., the first page of a document whose page numbering starts</div>
<div class="line">    Rem with page 21 will be <span class="stringliteral">&quot;21&quot;</span>, not 1).</div>
<div class="line">    myInDesign.PDFExportPreferences.PageRange = <span class="stringliteral">&quot;1-3,6&quot;</span></div>
<div class="line">    Rem Fill in your own file path.</div>
<div class="line">    myFile = <span class="stringliteral">&quot;C:\ExportPageRangeAsPDF.pdf&quot;</span></div>
<div class="line">    myDocument.Export idExportFormat.idPDFType, myFile, False</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_exporting_individual_pages_to_pdf"></a>
Exporting individual pages to PDF</h3>
<p>The following script exports each page from a document as an individual PDF file. (For the complete script, see ExportEachPageAsPDF.) </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myFileSystemObject = CreateObject(<span class="stringliteral">&quot;Scripting.FileSystemObject&quot;</span>)</div>
<div class="line">    Rem VBScript doesn&#39;t have a native &quot;get folder&quot; statement, so we&#39;ll use</div>
<div class="line">    Rem InDesign&#39;s JavaScript to display a folder browser.</div>
<div class="line">    myJavaScript = &quot;myFolder = Folder.selectDialog(&quot;&quot;Choose a Folder&quot;&quot;);&quot;</div>
<div class="line">    myJavaScript = myJavaScript &amp; &quot;myFolderName = myFolder.fsName;&quot;</div>
<div class="line">    myLanguage = idScriptLanguage.idJavascript</div>
<div class="line">    Rem Run the <span class="keywordtype">string</span> &quot;myJavaScript&quot; as a JavaScript</div>
<div class="line">    myFolderName = myInDesign.DoScript(myJavaScript, myLanguage)</div>
<div class="line">    If myFileSystemObject.FolderExists(myFolderName) Then</div>
<div class="line">        myExportPDFPages myInDesign, myDocument, myFolderName</div>
<div class="line">    End If</div>
</div><!-- fragment --><div class="fragment"><div class="line">Function myExportPDFPages(myInDesign, myDocument, myFolderName)</div>
<div class="line">    myDocumentName = myDocument.Name</div>
<div class="line">    Set myDialog = myInDesign.Dialogs.Add</div>
<div class="line">    With myDialog</div>
<div class="line">        .Name = &quot;ExportPages&quot;</div>
<div class="line">        With .DialogColumns.Add</div>
<div class="line">            With .DialogRows.Add</div>
<div class="line">                With .StaticTexts.Add</div>
<div class="line">                    .StaticLabel = &quot;Base Name:&quot;</div>
<div class="line">                End With</div>
<div class="line">                Set myBaseNameField = .TextEditboxes.Add</div>
<div class="line">                myBaseNameField.EditContents = myDocumentName</div>
<div class="line">                myBaseNameField.MinWidth = 160</div>
<div class="line">            End With</div>
<div class="line">        End With</div>
<div class="line">    End With</div>
<div class="line">    myResult = myDialog.Show</div>
<div class="line">    If myResult = True Then</div>
<div class="line">        myBaseName = myBaseNameField.EditContents</div>
<div class="line">        Rem Remove the dialog box from memory.</div>
<div class="line">        myDialog.Destroy</div>
<div class="line">        For myCounter = 1 To myDocument.Pages.Count</div>
<div class="line">            myPageName = myDocument.Pages.Item(myCounter).Name</div>
<div class="line">            myInDesign.PDFExportPreferences.PageRange = myPageName</div>
<div class="line">            Rem Generate a file path from the folder name, the base document name,</div>
<div class="line">            Rem and the page name. Replace the colons in the page name (e.g.,</div>
<div class="line">            Rem &quot;Sec1:1&quot;) with underscores.</div>
<div class="line">            myPageName = Replace(myPageName, &quot;:&quot;, &quot;_&quot;)</div>
<div class="line">            myFilePath = myFolderName &amp; &quot;\&quot; &amp; myBaseName &amp; &quot;_&quot; _</div>
<div class="line">            &amp; myPageName &amp; &quot;.pdf&quot;</div>
<div class="line">            myDocument.Export idExportFormat.idPDFType, myFilePath, False</div>
<div class="line">        Next</div>
<div class="line">    Else</div>
<div class="line">        myDialog.Destroy</div>
<div class="line">    End If</div>
<div class="line">End Function</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_exporting_pdf_with_interactive_features"></a>
Exporting PDF with interactive features</h3>
<p>The following script exports a document with interactive features as a PDF. (For the complete script, see ExportInteractivePDF.) </p>
<div class="fragment"><div class="line">    Rem Given a document <span class="stringliteral">&quot;myDocument,&quot;</span> add page transitions...</div>
<div class="line">    For myCounter = 1 To myDocument.Spreads.Count</div>
<div class="line">        myDocument.Spreads.Item(myCounter).PageTransitionType = idPageTransitionTypeOptions.idWipeTransition</div>
<div class="line">        myDocument.Spreads.Item(myCounter).PageTransitionDirection = idPageTransitionDirectionOptions.idDown</div>
<div class="line">        myDocument.Spreads.Item(myCounter).PageTransitionDuration = idPageTransitionDurationOptions.idMedium</div>
<div class="line">    Next</div>
<div class="line">    myInDesign.InteractivePDFExportPreferences.FlipPages = True</div>
<div class="line">    myInDesign.InteractivePDFExportPreferences.FlipPagesSpeed = 5</div>
<div class="line">    myInDesign.InteractivePDFExportPreferences.OpenInFullScreen = True</div>
<div class="line">    myInDesign.InteractivePDFExportPreferences.InteractivePDFInteractiveElementsOption = idInteractivePDFInteractiveElementsOptions.idIncludeAllMedia</div>
<div class="line">    Rem Export the document to PDF.</div>
<div class="line">    Rem You<span class="stringliteral">&#39;ll have to fill in your own file path.</span></div>
<div class="line"><span class="stringliteral">    myDocument.Export idExportFormat.idInteractivePDF, &quot;C:\InteractivePDF.pdf&quot;, False</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_exporting_as_a_pdf_form"></a>
Exporting as a PDF form</h3>
<p>To create a PDF that contains form fields, you can either save the InDesign document as PDF, then open it in Acrobat and apply form fields, or apply text fields, radio buttons, signature fields, and so on directly in InDesign and export the document to PDF as a form with no additional Acrobat editing required.</p>
<p>The following script applies form elements to an InDesign document and exports the document as a PDF form. (For the complete script, see ExportInteractivePDFForm.) </p>
<div class="fragment"><div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    REM Create a textframe as firstname label</div>
<div class="line">    Set myTextFrame = myPage.TextFrames.Add</div>
<div class="line">    myTextFrame.GeometricBounds = Array(15, 15, 20, 35)</div>
<div class="line">    myTextFrame.Contents = &quot;FirstName: &quot;</div>
<div class="line">    REM Create a textbox as firstname input box</div>
<div class="line">    Set myTextBox = myPage.TextBoxes.Add</div>
<div class="line">    myTextBox.GeometricBounds = Array(15, 40, 20, 75)</div>
<div class="line">    REM Create another textframe as lastname label</div>
<div class="line">    Set myTextFrame1 = myPage.TextFrames.Add</div>
<div class="line">    myTextFrame1.GeometricBounds = Array(30, 15, 25, 35)</div>
<div class="line">    myTextFrame1.Contents = &quot;LastName: &quot;    </div>
<div class="line">    REM Create another textbox as lastname input box</div>
<div class="line">    Set myTextBox = myPage.TextBoxes.Add</div>
<div class="line">    myTextBox.GeometricBounds = Array(30, 40, 25, 75) </div>
<div class="line">    REM Create a TextFrame to introduce the following checkbox</div>
<div class="line">    Set myTextFrame2 = myPage.TextFrames.Add</div>
<div class="line">    myTextFrame2.GeometricBounds = Array(15, 80, 20, 95)</div>
<div class="line">    myTextFrame2.Contents = &quot;Hobby: &quot;</div>
<div class="line">    REM Create some CheckBoxes</div>
<div class="line">    Set myCheckBox = myPage.CheckBoxes.Add</div>
<div class="line">    myCheckBox.GeometricBounds = Array(15, 100, 20, 105)</div>
<div class="line">    myCheckBox.Name = &quot;Football &quot;</div>
<div class="line">    Set myTextFrame3 = myPage.TextFrames.Add</div>
<div class="line">    myTextFrame3.GeometricBounds = Array(15, 107, 20, 125)</div>
<div class="line">    myTextFrame3.Contents = &quot;Football &quot;</div>
<div class="line">    Set myCheckBox1 = myPage.CheckBoxes.Add</div>
<div class="line">    myCheckBox1.GeometricBounds = Array(15, 130, 20, 135)</div>
<div class="line">    myCheckBox1.Name = &quot;Basketball &quot;</div>
<div class="line">    Set myTextFrame4 = myPage.TextFrames.Add</div>
<div class="line">    myTextFrame4.GeometricBounds = Array(15, 137, 20, 160)</div>
<div class="line">    myTextFrame4.Contents = &quot;Basketball &quot;</div>
<div class="line">    Set myCheckBox2 = myPage.CheckBoxes.Add</div>
<div class="line">    myCheckBox2.GeometricBounds = Array(15, 165, 20, 170)</div>
<div class="line">    myCheckBox2.Name = &quot;Pingpong &quot;</div>
<div class="line">    Set myTextFrame5 = myPage.TextFrames.Add</div>
<div class="line">    myTextFrame5.GeometricBounds = Array(15, 172, 20, 193)</div>
<div class="line">    myTextFrame5.Contents = &quot;Pingpong &quot;    </div>
<div class="line">    REM Create a button for submit</div>
<div class="line">    Set submitButton = myPage.Buttons.Add</div>
<div class="line">    submitButton.GeometricBounds = Array(45, 15, 35, 35)</div>
<div class="line">    submitButton.Name = &quot;Submit&quot;</div>
<div class="line">    REM Fill contents to the button</div>
<div class="line">    Set myRightArrow1 = submitButton.States.Item(1).Polygons.Add</div>
<div class="line">    myRightArrow1.fillColor = myDocument.Colors.Item(&quot;Green&quot;)</div>
<div class="line">    myRightArrow1.Paths.Item(1).EntirePath = Array(Array(15, 35),Array(35,40),Array(15, 45))</div>
<div class="line">    REM Add the Rollover state.</div>
<div class="line">    Set myRolloverState1 = submitButton.States.Add</div>
<div class="line">    REM Add a shadow to the polygon in the Rollover state.</div>
<div class="line">    Set myRolloverArrow1 = myRolloverState1.Polygons.Add</div>
<div class="line">    myRolloverArrow1.fillColor = myDocument.Colors.Item(&quot;Green&quot;)</div>
<div class="line">    myRolloverArrow1.Paths.Item(1).EntirePath = Array(Array(15, 35),Array(35,40),Array(15, 45))</div>
<div class="line">    Set myFillTransparencySettings1 = myRolloverArrow1.FillTransparencySettings</div>
<div class="line">    myFillTransparencySettings1.DropShadowSettings.Mode = idShadowMode.idDrop</div>
<div class="line">    myFillTransparencySettings1.DropShadowSettings.Angle = 90</div>
<div class="line">    myFillTransparencySettings1.DropShadowSettings.XOffset = 0</div>
<div class="line">    myFillTransparencySettings1.DropShadowSettings.YOffset = 0</div>
<div class="line">    myFillTransparencySettings1.DropShadowSettings.Size = 6</div>
<div class="line">    REM Add a shadow to the polygon in the Click state.</div>
<div class="line">    Set myClickState1 = submitButton.States.Add</div>
<div class="line">    Set myClickArrow1 = myClickState1.Polygons.Add</div>
<div class="line">    myClickArrow1.FillColor = myDocument.Colors.Item(&quot;Blue&quot;)</div>
<div class="line">    myClickArrow1.Paths.Item(1).EntirePath = Array(Array(15, 35),Array(35,40),Array(15,45))</div>
<div class="line">    REM Set the behavior for the button.</div>
<div class="line">    Set SubmitForm = submitButton.SubmitFormBehaviors.Add</div>
<div class="line">    SubmitForm.BehaviorEvent = idBehaviorEvents.idMouseUp    </div>
<div class="line">    REM Create a button for print</div>
<div class="line">    Set printButton = myPage.Buttons.Add</div>
<div class="line">    printButton.GeometricBounds = Array(45, 40, 35, 60)</div>
<div class="line">    REM Fill contents to the button</div>
<div class="line">    Set myRightArrow2 = printButton.States.Item(1).Polygons.Add</div>
<div class="line">    myRightArrow2.fillColor = myDocument.Colors.Item(&quot;Red&quot;)</div>
<div class="line">    myRightArrow2.Paths.Item(1).EntirePath = Array(Array(40, 35),Array(60,40),Array(40, 45))</div>
<div class="line">    REM Add the Rollover state.</div>
<div class="line">    Set myRolloverState2 = printButton.States.Add</div>
<div class="line">    REM Add a shadow to the polygon in the Rollover state.</div>
<div class="line">    Set myRolloverArrow2 = myRolloverState2.Polygons.Add</div>
<div class="line">    myRolloverArrow2.FillColor = myDocument.Colors.Item(&quot;Red&quot;)</div>
<div class="line">    myRolloverArrow2.Paths.Item(1).EntirePath = Array(Array(40, 35),Array(60,40),Array(40, 45))</div>
<div class="line">    Set myFillTransparencySettings2 = myRolloverArrow2.FillTransparencySettings</div>
<div class="line">    myFillTransparencySettings2.DropShadowSettings.Mode = idShadowMode.idDrop</div>
<div class="line">    myFillTransparencySettings2.DropShadowSettings.Angle = 90</div>
<div class="line">    myFillTransparencySettings2.DropShadowSettings.XOffset = 0</div>
<div class="line">    myFillTransparencySettings2.DropShadowSettings.YOffset = 0</div>
<div class="line">    myFillTransparencySettings2.DropShadowSettings.Size = 6</div>
<div class="line">    REM Add a shadow to the polygon in the Click state.</div>
<div class="line">    Set myClickState2 = printButton.States.Add</div>
<div class="line">    Set myClickArrow2 = myClickState2.Polygons.Add</div>
<div class="line">    myClickArrow2.FillColor = myDocument.Colors.Item(&quot;Blue&quot;)</div>
<div class="line">    myClickArrow2.Paths.Item(1).EntirePath = Array(Array(40, 35),Array(60,40),Array(40,45))</div>
<div class="line">    REM Set the behavior for the button.</div>
<div class="line">    Set PrintForm = printButton.PrintFormBehaviors.Add</div>
<div class="line">    PrintForm.BehaviorEvent = idBehaviorEvents.idMouseUp    </div>
<div class="line">    REM Export the document to PDF.</div>
<div class="line">    myDocument.Export idExportFormat.idInteractivePDF, &quot;C:\SubmitForm.pdf&quot;, False</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_exporting_pages_as_eps"></a>
Exporting Pages as EPS</h2>
<p>When you export a document as EPS, InDesign saves each page of the file as a separate EPS graphic (an EPS, by definition, can contain only a single page). If you export more than a single page, InDesign appends the index of the page to the filename. The index of the page in the document is not necessarily the name of the page (as defined by the section options for the section containing the page).</p>
<h3><a class="anchor" id="id_vb_exporting_all_pages_to_eps"></a>
Exporting all pages to EPS</h3>
<p>The following script exports the pages of the active document to one or more EPS files. (For the complete script, see ExportAsEPS.) </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Rem You<span class="stringliteral">&#39;ll have to fill in your own file path.</span></div>
<div class="line"><span class="stringliteral">    myFile = &quot;C:\ExportAsEPS.eps&quot;</span></div>
<div class="line"><span class="stringliteral">    myDocument.Export idExportFormat.idEPSType, myFile, False</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_exporting_a_range_of_pages_to_eps"></a>
Exporting a range of pages to EPS</h3>
<p>To control which pages are exported as EPS, set the page range property of the EPS export preferences to a page-range string containing the page or pages you want to export, before exporting. (For the complete script, see ExportPageRangeAsEPS.) </p>
<div class="fragment"><div class="line">    Rem Enter the names of the pages you want to export in the following line.</div>
<div class="line">    Rem Note that the page name is not necessarily the index of the page in the</div>
<div class="line">    Rem document (e.g., the first page of a document whose page numbering starts</div>
<div class="line">    Rem with page 21 will be <span class="stringliteral">&quot;21&quot;</span>, not 1).</div>
<div class="line">    myInDesign.EPSExportPreferences.PageRange = <span class="stringliteral">&quot;1-3,6&quot;</span></div>
<div class="line">    Rem Fill in your own file path.</div>
<div class="line">    myFile = <span class="stringliteral">&quot;C:\ExportPageRangeAsEPS.eps&quot;</span></div>
<div class="line">    myDocument.Export idExportFormat.idEPSType, myFile, False</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_exporting_as_eps_with_file_naming"></a>
Exporting as EPS with file naming</h3>
<p>The following script exports each page as an EPS, but it offers more control over file naming than the earlier example. (For the complete script, see ExportEachPageAsEPS.) </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myFileSystemObject = CreateObject(<span class="stringliteral">&quot;Scripting.FileSystemObject&quot;</span>)</div>
<div class="line">    Rem VBScript doesn&#39;t have a native &quot;get folder&quot; statement, so we&#39;ll use</div>
<div class="line">    Rem InDesign&#39;s JavaScript to display a folder browser.</div>
<div class="line">    myJavaScript = &quot;myFolder = Folder.selectDialog(&quot;&quot;Choose a Folder&quot;&quot;);&quot;</div>
<div class="line">    myJavaScript = myJavaScript &amp; &quot;myFolderName = myFolder.fsName;&quot;</div>
<div class="line">    myLanguage = idScriptLanguage.idJavascript</div>
<div class="line">    Rem Run the <span class="keywordtype">string</span> &quot;myJavaScript&quot; as a JavaScript</div>
<div class="line">    myFolderName = myInDesign.DoScript(myJavaScript, myLanguage)</div>
<div class="line">    If myFileSystemObject.FolderExists(myFolderName) Then</div>
<div class="line">        myExportEPSPages myInDesign, myDocument, myFolderName</div>
<div class="line">    End If</div>
</div><!-- fragment --><div class="fragment"><div class="line">Function myExportEPSPages(myInDesign, myDocument, myFolderName)</div>
<div class="line">    myDocumentName = myDocument.Name</div>
<div class="line">    Set myDialog = myInDesign.Dialogs.Add</div>
<div class="line">    With myDialog</div>
<div class="line">        .Name = &quot;ExportPages&quot;</div>
<div class="line">        With .DialogColumns.Add</div>
<div class="line">            With .DialogRows.Add</div>
<div class="line">                With .StaticTexts.Add</div>
<div class="line">                    .StaticLabel = &quot;Base Name:&quot;</div>
<div class="line">                End With</div>
<div class="line">                Set myBaseNameField = .TextEditboxes.Add</div>
<div class="line">                myBaseNameField.EditContents = myDocumentName</div>
<div class="line">                myBaseNameField.MinWidth = 160</div>
<div class="line">            End With</div>
<div class="line">        End With</div>
<div class="line">    End With</div>
<div class="line">    myResult = myDialog.Show</div>
<div class="line">    If myResult = True Then</div>
<div class="line">        myBaseName = myBaseNameField.EditContents</div>
<div class="line">        Rem Remove the dialog box from memory.</div>
<div class="line">        myDialog.Destroy</div>
<div class="line">        For myCounter = 1 To myDocument.Pages.Count</div>
<div class="line">            myPageName = myDocument.Pages.Item(myCounter).Name</div>
<div class="line">            myInDesign.EPSExportPreferences.PageRange = myPageName</div>
<div class="line">            Rem Generate a file path from the folder name, the base document name,</div>
<div class="line">            Rem and the page name. Replace the colons in the page name (e.g.,</div>
<div class="line">            Rem &quot;Sec1:1&quot;) with underscores.</div>
<div class="line">            myPageName = Replace(myPageName, &quot;:&quot;, &quot;_&quot;)</div>
<div class="line">            myFilePath = myFolderName &amp; &quot;\&quot; &amp; myBaseName &amp; &quot;_&quot; _</div>
<div class="line">            &amp; myPageName &amp; &quot;.eps&quot;</div>
<div class="line">            myDocument.Export idExportFormat.idEPSType, myFilePath, False</div>
<div class="line">        Next</div>
<div class="line">    Else</div>
<div class="line">        myDialog.Destroy</div>
<div class="line">    End If</div>
<div class="line">End Function</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_exporting_to_epub"></a>
Exporting to EPub</h2>
<p>InDesign scripting offers full control over the creation of EPub files from your page-layout documents.</p>
<h3><a class="anchor" id="id_vb_exporting_the_current_document"></a>
Exporting the current document</h3>
<p>The following script exports the current document as EPub, using default options. (For the complete script, see ExportEPub.) </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Rem The document export parameters are:</div>
<div class="line">    Rem Format: use idExportFormat.idEPub</div>
<div class="line">    Rem To: a file path as a <span class="keywordtype">string</span></div>
<div class="line">    Rem ShowingOptions: boolean (setting <span class="keyword">this</span> option to</div>
<div class="line">    Rem <span class="keyword">true</span> displays the EPub Export dialog box)</div>
<div class="line">    myDocument.Export idExportFormat.idEPUB, <span class="stringliteral">&quot;C:\test\ExportEPub.epub&quot;</span>, False</div>
</div><!-- fragment --><p> To give the user more control over the creation of EPub files, specify true for the third parameter. This opens the EPub export options dialog.</p>
<h3><a class="anchor" id="id_vb_setting_epub_export_options"></a>
Setting EPub export options</h3>
<p>The following script sets the EPub export options before exporting. (For the complete script, see ExportEPubWithOptions.) </p>
<div class="fragment"><div class="line">    Rem Sets EPub export options, then exports the active document as EPub.</div>
<div class="line">    With myDocument.EPubExportPreferences</div>
<div class="line">        Rem Apply image alignment to anchored <span class="keywordtype">object</span> settings.</div>
<div class="line">        .ApplyImageAlignmentToAnchoredObjectSettings = False</div>
<div class="line">        </div>
<div class="line">        Rem Bottom margin of the epub.</div>
<div class="line">        .BottomMargin = 5</div>
<div class="line">        Rem Left margin of the epub.</div>
<div class="line">        .LeftMargin = 5</div>
<div class="line">        Rem Right margin of the epub.</div>
<div class="line">        .RightMargin = 5</div>
<div class="line">        Rem Top margin of the epub.</div>
<div class="line">        .TopMargin = 5</div>
<div class="line">        </div>
<div class="line">        Rem If <span class="keyword">true</span>, <span class="keywordflow">break</span> InDesign document into smaller pieces when generating epub.</div>
<div class="line">        .BreakDocument = False</div>
<div class="line">        </div>
<div class="line">        Rem The bullet export option.</div>
<div class="line">        .BulletExportOption = idBulletListExportOption.idAsText</div>
<div class="line">                </div>
<div class="line">        .CustomImageSizeOption = idImageSizeOption.idSizeRelativeToPageWidth</div>
<div class="line">        </div>
<div class="line">        .EmbedFont = True</div>
<div class="line">        </div>
<div class="line">        .EpubCover = idEpubCover.idFirstPage</div>
<div class="line">        Rem This will take effect only when EpubCover is <span class="keyword">set</span> to idExternalImage.</div>
<div class="line">        Rem .CoverImageFile = <span class="stringliteral">&quot;C:\conver.jpg&quot;</span></div>
<div class="line">        </div>
<div class="line">        .EpubPublisher = <span class="stringliteral">&quot;Adobe Devtech&quot;</span></div>
<div class="line">        </div>
<div class="line">        Rem The export order.</div>
<div class="line">        .ExportOrder = idExportOrder.idLayoutOrder</div>
<div class="line">        </div>
<div class="line">        Rem If <span class="keyword">true</span>, output foornoteimmediately after its paragraph.</div>
<div class="line">        .FootnoteFollowParagraph = False</div>
<div class="line">        </div>
<div class="line">        .GIFOptionsInterlaced = True</div>
<div class="line">        .GIFOptionsPalette = idGIFOptionsPalette.idWindowsPalette</div>
<div class="line">        </div>
<div class="line">        Rem The epub unique identifier, like ISBN.</div>
<div class="line">        .Id = <span class="stringliteral">&quot;123&quot;</span></div>
<div class="line">        </div>
<div class="line">        Rem Ignore <span class="keywordtype">object</span> level image conversion settings.</div>
<div class="line">        .IgnoreObjectConversionSettings = True</div>
<div class="line">        Rem Alignment applied to images.</div>
<div class="line">        .ImageAlignment = idImageAlignmentType.idAlignCenter</div>
<div class="line">        Rem The file format to use <span class="keywordflow">for</span> converted images.</div>
<div class="line">        Rem Valid only when copy optimized images and/or copy formatted images is <span class="keyword">true</span>.</div>
<div class="line">        .ImageConversion = idImageConversion.idAutomatic</div>
<div class="line">        .ImageExportResolution = idImageResolution.idPpi150</div>
<div class="line">        Rem Image page <span class="keywordflow">break</span> settings to be used with objects.</div>
<div class="line">        .ImagePageBreak = idImagePageBreakType.idPageBreakAfter</div>
<div class="line">        Rem Space After applied to images.</div>
<div class="line">        .ImageSpaceAfter = 2</div>
<div class="line">        Rem Space Before applied to images.</div>
<div class="line">        .ImageSpaceBefore = 2</div>
<div class="line">        </div>
<div class="line">        Rem If <span class="keyword">true</span>, output document metadata into epub.</div>
<div class="line">        .IncludeDocumentMetadata = True</div>
<div class="line">        </div>
<div class="line">        .JPEGOptionsFormat = idJPEGOptionsFormat.idBaselineEncoding</div>
<div class="line">        .JPEGOptionsQuality = idJPEGOptionsQuality.idHigh</div>
<div class="line">        </div>
<div class="line">        Rem The PNG compression level.</div>
<div class="line">        .Level = 5</div>
<div class="line">        </div>
<div class="line">        .NumberedListExportOption = idNumberedListExportOption.idAsText</div>
<div class="line">        </div>
<div class="line">        Rem If <span class="keyword">true</span>, format image based on layout appearence.</div>
<div class="line">        .PreserveLayoutAppearence = True</div>
<div class="line">        Rem If <span class="keyword">true</span>, output local style <span class="keyword">override</span>.</div>
<div class="line">        .PreserveLocalOverride = True</div>
<div class="line">        </div>
<div class="line">        .StripSoftReturn = True</div>
<div class="line">        </div>
<div class="line">        Rem If <span class="keyword">true</span>, image page <span class="keywordflow">break</span> settings will be used in objects.</div>
<div class="line">        .UseImagePageBreak = True</div>
<div class="line">        </div>
<div class="line">        Rem Use a defined TOC style to generate epub TOC.</div>
<div class="line">        Rem .TocStyleName = <span class="stringliteral">&quot;MyTOCStyle&quot;</span></div>
<div class="line">        </div>
<div class="line">        .ViewDocumentAfterExport = False                        </div>
<div class="line">    End With</div>
<div class="line">    myDocument.Export idExportFormat.idEPUB, <span class="stringliteral">&quot;C:\test\ExportEPubWithOptions.epub&quot;</span>, False</div>
</div><!-- fragment --> <h1><a class="anchor" id="id_vb_working_with_layers"></a>
Working with Layers</h1>
<p>InDesign's layers are the key to controlling the stacking order of objects in your layout. You can think of layers as transparent planes stacked on top of each other. You also can use layers as an organizational tool, putting one type of content on a given layer or set of layers.</p>
<p>A document can contain one or more layers, and each document includes at least one layer. Layers are document wide, not bound to specific pages or spreads.</p>
<p>This section covers scripting techniques related to layers in an InDesign layout and discusses common operations involving layers.</p>
<h2><a class="anchor" id="id_vb_understanding_the_layer_object_model"></a>
Understanding the Layer Object Model</h2>
<p>The following figure shows the layer object model. Note the following about the diagram:</p>
<ul>
<li>It focuses on the location of a layer and its contents in the context of the object hierarchy of a document; it does not attempt to show all the other ways a script might work with the content of a layer (e.g., you can get a reference to a text-frame object from a story, text object, page, or spread, in addition to finding it inside a layer object).</li>
<li>It uses the JavaScript form of the object names; however, the object hierarchy is the same in all scripting languages.</li>
<li>The basic properties of a layer are shown in the column at the left of the figure; the objects that may be contained by the layer object, at the right.</li>
</ul>
<p>It is important to note the distinction between the page-items collection and the AllPageItems collection. The former is a collection containing only the top-level page items in a layer. If a page item is inside a group, for example, it will not appear in the PageItems collection. In contrast, the AllPageItems collection is a flattened collection of all page items assigned to the layer, regardless of their location in the object hierarchy. A page item inside a group on the layer would appear in the AllPageItems collection.</p>
<p>Similarly, the AllGraphics property contains all graphics stored in page items assigned to the layer, regardless of their location in the object hierarchy.</p>
<div class="image">
<img src="InDesign_ScriptingGuide-2.gif" alt="InDesign_ScriptingGuide-2.gif"/>
</div>
<h2><a class="anchor" id="id_vb_scripting_layers"></a>
Scripting Layers</h2>
<p>In InDesign's user interface, you add, delete, rearrange, duplicate, and merge layers using the Layers panel. You also can change the layer to which a selected page item is assigned by dragging and dropping the layer proxy in the Layers panel. (For more on assigning objects to a layer, see the InDesign online help.) This section shows how to accomplish these tasks using InDesign scripting.</p>
<h3><a class="anchor" id="id_vb_creating_layers"></a>
Creating layers</h3>
<p>The following script fragment shows how to create a new layer. (For the complete script, see AddLayer.) </p>
<div class="fragment"><div class="line">    Rem Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myLayer = myDocument.layers.Add()</div>
</div><!-- fragment --><p> When you create a new layer, the layer appears above all other layers in the document.</p>
<h3><a class="anchor" id="id_vb_referring_to_layers"></a>
Referring to layers</h3>
<p>InDesign scripting offers several ways to refer to a layer object. This section describes the most common ways to refer to layers.</p>
<p><b>Getting the active layer</b></p>
<p>The active layer is the layer on which new objects are created. You can get the active layer using scripting, as shown in the following script fragment. (For the complete script, see ActiveLayer.) </p>
<div class="fragment"><div class="line">    Rem Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">    Set myLayer = myDocument.ActiveLayer</div>
</div><!-- fragment --><p> <b>Referring to layers by layer index</b></p>
<p>You can get a reference to a layer using the index of the layer in the layers collection of a document. The script fragment below uses the layer index to iterate through layers. (For the complete script, see HideOtherLayers.)</p>
<div class="fragment"><div class="line">Rem Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">Set myTargetLayer = myDocument.ActiveLayer</div>
<div class="line">For myCounter = 1 to myDocument.Layers.Count</div>
<div class="line">    Rem If the layer is not the target layer, hide it.</div>
<div class="line">    If myDocument.Layers.Item(myCounter).Name &lt;&gt; myTargetLayer.Name Then</div>
<div class="line">        myDocument.Layers.Item(myCounter).Visible = False</div>
<div class="line">    End If</div>
<div class="line">Next</div>
</div><!-- fragment --><p>Note that you can use negative numbers to refer to the layers in the layers collection of a document. Layer -1 refers to the last (bottom) layer in the collection.</p>
<p><b>Referring to layers by layer name</b></p>
<p>You also can get a reference to a layer using the name of the layer, as shown in the following script fragment. (For the complete script, see LayerName.) </p>
<div class="fragment"><div class="line">    Rem Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">    Set myLayer = myDocument.Layers.Item(<span class="stringliteral">&quot;Text Layer&quot;</span>)</div>
</div><!-- fragment --><p> <b>Using relative references</b></p>
<p>Given a layer, you can refer to the layer above using the PreviousItem method, or refer to the layer below using the NextItem method, as shown in the following script fragment. (For the complete script, see RelativeLayerReferences.) Both methods take a reference layer as a parameter. </p>
<div class="fragment"><div class="line">    Rem Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">    Set myLayer = myDocument.Layers.Item(5)</div>
<div class="line">    myDocument.ActiveLayer = myLayer</div>
<div class="line">    Set myNextLayer = myDocument.Layers.NextItem(myLayer)</div>
<div class="line">    Set myPreviousLayer = myDocument.Layers.PreviousItem(myLayer)</div>
<div class="line">    myString = <span class="stringliteral">&quot;The layer below the target layer is &quot;</span> &amp; myNextLayer.name &amp; vbCr</div>
<div class="line">    myString = myString &amp; <span class="stringliteral">&quot;The layer above the target layer is &quot;</span> &amp; myPreviousLayer.name</div>
<div class="line">    MsgBox myString</div>
</div><!-- fragment --><p> The PreviousItem and NextItem methods return an invalid layer reference if the specified (next or previous) layer does not exist, rather than generating an error.</p>
<p><b>Referring to ranges of layers</b></p>
<p>To refer to a series of layers, you can use the ItemByRange method. The following script fragment shows how to get a reference to a range of layers, then set a property on all layers in the range. (For the complete script, see HideLayersAbove.) </p>
<div class="fragment"><div class="line">    Rem Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">    Set myTargetLayer = myDocument.ActiveLayer</div>
<div class="line">    Set myLayers = myDocument.Layers.ItemByRange(1, myTargetLayer.Index - 1)</div>
<div class="line">    For myCounter = 1 To myLayers.Count</div>
<div class="line">        myLayers.Item(myCounter).Visible = False</div>
<div class="line">    Next</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_deleting_layers"></a>
Deleting layers</h3>
<p>Use the Delete method to delete a layer from a specific document, as shown in the following script fragment. (For the complete script, see DeleteLayer.) You cannot delete the last remaining layer in a document. </p>
<div class="fragment"><div class="line">    Rem Given a document <span class="stringliteral">&quot;myDocument&quot;</span> containing at least two layers...</div>
<div class="line">    Set myLayer = myDocument.Layers.Item(1)</div>
<div class="line">    myLayer.Delete()</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_moving_layers"></a>
Moving layers</h3>
<p>Use the move method to change the stacking order of layers in a document, as shown in the following script fragment. (For the complete script, see MoveLayer.) </p>
<div class="fragment"><div class="line">    Rem Given a layer <span class="stringliteral">&quot;myLayer&quot;</span>, move the layer behind</div>
<div class="line">    Rem the <span class="keywordflow">default</span> layer (the lowest layer in the document </div>
<div class="line">    Rem is Layers.Item(-1).</div>
<div class="line">    myLayer.Move idLocationOptions.idAfter, myInDesign.Documents.Item(1).Layers.Item(-1)</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_duplicating_layers"></a>
Duplicating layers</h3>
<p>Use the duplicate method to create a copy of a layer, as shown in the following script fragment. (For the complete script, see DuplicateLayer.) </p>
<div class="fragment"><div class="line">    Rem Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">    Set myLayer = myDocument.Layers.Item(1)</div>
<div class="line">    Set myLayer1 = myLayer.Duplicate()</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_merging_layers"></a>
Merging layers</h3>
<p>The following script fragment shows how to merge two or more layers, including the page items assigned to them, into a single layer. (For the complete script, see MergeLayers.) </p>
<div class="fragment"><div class="line">    Rem Given a document <span class="stringliteral">&quot;myDocument&quot;</span> containing at least two layers...</div>
<div class="line">    Set myLayerA = myDocument.Layers.Item(1)</div>
<div class="line">    Set myLayerB = myDocument.Layers.Item(2)</div>
<div class="line">    myLayerA.Merge(myLayerB)</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_assigning_page_items_to_layers"></a>
Assigning page items to layers</h3>
<p>You can assign a page item to a layer by either referring to the layer when you create the page item (the add method of all page items can take a layer as a parameter) or setting the ItemLayer property of an existing page item. The following script fragment shows how to assign a page item to a layer using both techniques. (For the complete script, see AssignPageItemsToLayers.) </p>
<div class="fragment"><div class="line">    Rem Given a reference to a page <span class="stringliteral">&quot;myPage,&quot;</span> and a document <span class="stringliteral">&quot;myDocument,&quot;</span></div>
<div class="line">    Rem create a text frame on a layer named <span class="stringliteral">&quot;TextFrames&quot;</span></div>
<div class="line">    Set myTextFrame = myPage.TextFrames.Add(myDocument.Layers.Item(<span class="stringliteral">&quot;TextFrames&quot;</span>))</div>
<div class="line">    myTextFrame.geometricBounds = Array(72, 72, 144, 144)</div>
<div class="line">    Rem Create a rectangle on the current target layer.</div>
<div class="line">    Set myRectangle = myPage.Rectangles.Add</div>
<div class="line">    myRectangle.geometricBounds = Array(72, 144, 144, 216)</div>
<div class="line">    Rem Move the rectangle to a specific layer.</div>
<div class="line">    myRectangle.ItemLayer = myDocument.Layers.Item(&quot;Rectangles&quot;)</div>
<div class="line">    Rem Create a series of ovals.</div>
<div class="line">    For myCounter = 72 To 172 Step 10</div>
<div class="line">        Set myOval = myPage.Ovals.Add</div>
<div class="line">        myOval.geometricBounds = Array(216, myCounter, 226, myCounter + 10)</div>
<div class="line">    Next</div>
<div class="line">    Rem Move all of the ovals on the page to a specific layer.</div>
<div class="line">    For myCounter = 1 To myPage.Ovals.Count</div>
<div class="line">        myPage.Ovals.Item(myCounter).ItemLayer = myDocument.Layers.Item(&quot;Ovals&quot;)</div>
<div class="line">    Next</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_setting_layer_properties"></a>
Setting layer properties</h3>
<p>Layer properties control the layer name, color, visibility, and other attributes of a layer. This section shows how to work with layer properties.</p>
<p><b>Setting basic layer properties</b></p>
<p>Basic layer properties include the name of the layer, the highlight color of the layer, the visibility of the layer, and whether text objects on the layer ignore text-wrap settings. The following script fragment shows how to set these basic properties of a layer. (For the complete script, see BasicLayerProperties.) </p>
<div class="fragment"><div class="line">    Rem Given a document <span class="stringliteral">&quot;myDocument&quot;</span> with at least two layers...</div>
<div class="line">    Set myLayer = myDocument.Layers.Add</div>
<div class="line">    myLayer.Name = <span class="stringliteral">&quot;myLayer&quot;</span></div>
<div class="line">    myLayer.LayerColor = idUIColors.idCharcoal</div>
<div class="line">    myLayer.IgnoreWrap = False</div>
<div class="line">    myLayer.Visible = True</div>
</div><!-- fragment --><p> <b>Working with layer guides</b></p>
<p>Guides can be assigned to a specific layer, just like page items. You can choose to show or hide the guides for a layer, and you can lock or unlock the guides on a layer. The following script fragment shows how to work with the guides on a layer. (For the complete script, see LayerGuides.) </p>
<div class="fragment"><div class="line">    Rem Given a document <span class="stringliteral">&quot;myDocument&quot;</span> and a page <span class="stringliteral">&quot;myPage&quot;</span> containing at least one guide...</div>
<div class="line">    Set myLayer = myDocument.Layers.Add</div>
<div class="line">    Rem Move all of the guides on the page to the <span class="keyword">new</span> layer.</div>
<div class="line">    For myCounter = 1 To myPage.Guides.Count</div>
<div class="line">        myPage.Guides.Item(myCounter).ItemLayer = myLayer</div>
<div class="line">    Next</div>
<div class="line">    myLayer.LockGuides = True</div>
<div class="line">    myLayer.ShowGuides = True</div>
</div><!-- fragment --><p> <b>Controlling layer printing and visibility</b></p>
<p>You can control the printing and visibility of objects on a layer, as shown in the following script fragment. (For the complete script, see LayerControl.) </p>
<div class="fragment"><div class="line">    Rem Given a document <span class="stringliteral">&quot;myDocument&quot;</span> containing layers named <span class="stringliteral">&quot;Background,&quot;</span></div>
<div class="line">    Rem <span class="stringliteral">&quot;Language A,&quot;</span>, <span class="stringliteral">&quot;Language B,&quot;</span> and <span class="stringliteral">&quot;Language C,&quot;</span> export the <span class="stringliteral">&quot;Background&quot;</span></div>
<div class="line">    Rem layer and each <span class="stringliteral">&quot;Language&quot;</span> layer to PDF as separate PDF files...</div>
<div class="line">    Set myFileSystemObject = New FileSystemObject</div>
<div class="line">    Set myFolder = myFileSystemObject.GetSpecialFolder(TemporaryFolder)</div>
<div class="line">    myPath = myFolder.ParentFolder.ParentFolder.Path &amp; <span class="stringliteral">&quot;\Desktop\&quot;</span></div>
<div class="line"><span class="stringliteral">    For myCounter = 1 To 3</span></div>
<div class="line"><span class="stringliteral">        Select Case myCounter</span></div>
<div class="line"><span class="stringliteral">            Case 1:</span></div>
<div class="line"><span class="stringliteral">                myVersion = &quot;</span>Language A<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">            Case 2:</span></div>
<div class="line"><span class="stringliteral">                myVersion = &quot;</span>Language B<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">            Case 3:</span></div>
<div class="line"><span class="stringliteral">                myVersion = &quot;</span>Language C<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">        End Select</span></div>
<div class="line"><span class="stringliteral">        For myLanguageCounter = 1 To myDocument.Layers.Count</span></div>
<div class="line"><span class="stringliteral">            If myDocument.Layers.Item(myLanguageCounter).name = myVersion Or myDocument.Layers.Item(myLanguageCounter).name = &quot;</span>Background<span class="stringliteral">&quot; Then</span></div>
<div class="line"><span class="stringliteral">                myDocument.Layers.Item(myLanguageCounter).Visible = True</span></div>
<div class="line"><span class="stringliteral">                myDocument.Layers.Item(myLanguageCounter).Printable = True</span></div>
<div class="line"><span class="stringliteral">            Else</span></div>
<div class="line"><span class="stringliteral">                myDocument.Layers.Item(myLanguageCounter).Visible = False</span></div>
<div class="line"><span class="stringliteral">                myDocument.Layers.Item(myLanguageCounter).Printable = False</span></div>
<div class="line"><span class="stringliteral">            End If</span></div>
<div class="line"><span class="stringliteral">        Next</span></div>
<div class="line"><span class="stringliteral">        myFilePath = myPath &amp; myVersion &amp; &quot;</span>.pdf<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">        myDocument.Export idExportFormat.idPDFType, myFilePath</span></div>
<div class="line"><span class="stringliteral">    Next</span></div>
</div><!-- fragment --><p> <b>Locking layers</b></p>
<p>Layers can be locked, which means the page items on the layers cannot be edited. The following script fragment shows how to lock and unlock layers. (For the complete script, see LockLayersBelow.) </p>
<div class="fragment"><div class="line">    Rem Given a document <span class="stringliteral">&quot;myDocument&quot;</span>...</div>
<div class="line">    Set myTargetLayer = myDocument.ActiveLayer</div>
<div class="line">    Set myLayers = myDocument.Layers.ItemByRange(myDocument.Layers.Count, myTargetLayer.Index + 1)</div>
<div class="line">    For myCounter = 1 To myLayers.Count</div>
<div class="line">        myLayers.Item(myCounter).Locked = True</div>
<div class="line">    Next</div>
</div><!-- fragment --> <h1><a class="anchor" id="id_vb_text_and_type"></a>
Text and Type</h1>
<p>Entering, editing, and formatting text are the tasks that make up the bulk of the time spent working on most InDesign documents. Because of this, automating text and type operations can result in large productivity gains.</p>
<p>This section shows how to script the most common operations involving text and type. The sample scripts in this section are presented in order of complexity, starting with very simple scripts and building toward more complex operations.</p>
<p>We assume that you have already read Adobe InDesign Scripting Tutorial and know how to create, install, and run a script. We also assume that you have some knowledge of working with text in InDesign and understand basic typesetting terms.</p>
<h2><a class="anchor" id="id_vb_entering_and_importing_text"></a>
Entering and Importing Text</h2>
<p>This section covers the process of getting text into your InDesign documents. Just as you can type text into text frames and place text files using the InDesign user interface, you can create text frames, insert text into a story, or place text files on pages using scripting.</p>
<h3><a class="anchor" id="id_vb_creating_a_text_frame"></a>
Creating a text frame</h3>
<p>The following script creates a text frame, sets the bounds (size) of the frame, then enters text in the frame (for the complete script, see the MakeTextFrame tutorial script): </p>
<div class="fragment"><div class="line">   Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">   Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">   Set myTextFrame = myPage.TextFrames.Add</div>
<div class="line">   Rem Set the bounds of the text frame.</div>
<div class="line">   myTextFrame.GeometricBounds = Array(72, 72, 288, 288)</div>
<div class="line">   Rem Enter text in the text frame.</div>
<div class="line">   myTextFrame.Contents = &quot;This is some example text.&quot;</div>
</div><!-- fragment --><p> The following script shows how to create a text frame that is the size of the area defined by the page margins. myGetBounds is a useful function that you can add to your own scripts, and it appears in many other examples in this section. (For the complete script, see MakeTextFrameWithinMargins.) </p>
<div class="fragment"><div class="line">   Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">   Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">   Rem Create a text frame on the current page.</div>
<div class="line">   Set myTextFrame = myPage.TextFrames.Add</div>
<div class="line">   Rem Set the bounds of the text frame.</div>
<div class="line">   myTextFrame.GeometricBounds = myGetBounds(myDocument, myDocument.Pages.Item(1))</div>
<div class="line">   Rem Enter text in the text frame.</div>
<div class="line">   myTextFrame.Contents = <span class="stringliteral">&quot;This is some example text.&quot;</span></div>
</div><!-- fragment --><p> The following script fragment shows the myGetBounds function. </p>
<div class="fragment"><div class="line">Function myGetBounds(myDocument, myPage)</div>
<div class="line">    myPageWidth = myDocument.DocumentPreferences.PageWidth</div>
<div class="line">    myPageHeight = myDocument.DocumentPreferences.PageHeight</div>
<div class="line">    If myPage.Side = idPageSideOptions.idLeftHand Then</div>
<div class="line">        myX2 = myPage.MarginPreferences.Left</div>
<div class="line">        myX1 = myPage.MarginPreferences.Right</div>
<div class="line">    Else</div>
<div class="line">        myX1 = myPage.MarginPreferences.Left</div>
<div class="line">        myX2 = myPage.MarginPreferences.Right</div>
<div class="line">    End If</div>
<div class="line">    myY1 = myPage.marginPreferences.Top</div>
<div class="line">    myX2 = myPageWidth - myX2</div>
<div class="line">    myY2 = myPageHeight - myPage.MarginPreferences.Bottom</div>
<div class="line">    myGetBounds = Array(myY1, myX1, myY2, myX2)</div>
<div class="line">End Function</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_adding_text"></a>
Adding text</h3>
<p>To add text to a story, use the contents property of the insertion point at the location where you want to insert the text. The following sample script uses this technique to add text at the end of a story (for the complete script, see AddText): </p>
<div class="fragment"><div class="line">    <span class="keyword">set</span> myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myTextFrame = myDocument.TextFrames.Item(1)</div>
<div class="line">    Rem Add text at the end of the text in the text frame.</div>
<div class="line">    Rem To <span class="keywordflow">do</span> <span class="keyword">this</span>, we<span class="stringliteral">&#39;ll use the last insertion point in the story.</span></div>
<div class="line"><span class="stringliteral">    Rem (vbCr is a return character, &quot;&amp;&quot; concatenates two strings.)</span></div>
<div class="line"><span class="stringliteral">    myNewText = &quot;This is a new paragraph of example text.&quot;</span></div>
<div class="line"><span class="stringliteral">    myTextFrame.ParentStory.InsertionPoints.Item(-1).Contents = vbCr &amp; myNewText</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_stories_and_text_frames"></a>
Stories and text frames</h3>
<p>All text in an InDesign layout is part of a story, and every story can contain one or more text frames. Creating a text frame creates a story, and stories can contain multiple text frames.</p>
<p>In the preceding script, we added text at the end of the parent story rather than at the end of the text frame. This is because the end of the text frame might not be the end of the story; that depends on the length and formatting of the text. By adding the text to the end of the parent story, we can guarantee that the text is added, regardless of the composition of the text in the text frame.</p>
<p>You always can get a reference to the story using the ParentTextFrame property of a text frame. It can be useful to work with the text of a story instead of the text of a text frame; the following script demonstrates the difference. The alerts shows that the text frame does not contain the overset text, but the story does (for the complete script, see StoryAndTextFrame). </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    Set myTextFrame = myPage.TextFrames.Item(1)</div>
<div class="line">    Rem Now add text beyond the end of the text frame.</div>
<div class="line">    myTextFrame.InsertionPoints.Item(-1).Contents = vbCr &amp; <span class="stringliteral">&quot;This is some overset text&quot;</span></div>
<div class="line">    myString = myTextFrame.Contents</div>
<div class="line">    MsgBox (<span class="stringliteral">&quot;The last paragraph in this alert should be &quot;</span><span class="stringliteral">&quot;This is some overset text&quot;</span><span class="stringliteral">&quot;. Is it?&quot;</span> &amp; vbCr &amp; myString)</div>
<div class="line">    myString = myTextFrame.ParentStory.Contents</div>
<div class="line">    MsgBox (<span class="stringliteral">&quot;The last paragraph in this alert should be &quot;</span><span class="stringliteral">&quot;This is some overset text&quot;</span><span class="stringliteral">&quot;. Is it?&quot;</span> &amp; vbCr &amp; myString)</div>
</div><!-- fragment --><p> For more on understanding the relationships between text objects in an InDesign document, see <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_understanding_text_objects">Understanding Text Objects</a>.</p>
<h3><a class="anchor" id="id_vb_replacing_text"></a>
Replacing text</h3>
<p>The following script replaces a word with a phrase by changing the contents of the appropriate object (for the complete script, see ReplaceWord): </p>
<div class="fragment"><div class="line">   Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">   Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">   Set myTextFrame = myPage.TextFrames.Item(1)</div>
<div class="line">   Rem Replace the third word with the phrase</div>
<div class="line">   Rem <span class="stringliteral">&quot;a little bit of&quot;</span>.</div>
<div class="line">   myTextFrame.ParentStory.Words.Item(3).contents = <span class="stringliteral">&quot;a little bit of&quot;</span></div>
</div><!-- fragment --><p> The following script replaces the text in a paragraph (for the complete script, see ReplaceText): </p>
<div class="fragment"><div class="line">    Rem Replace the text in the second paragraph without replacing</div>
<div class="line">    Rem the <span class="keywordflow">return</span> character at the end of the paragraph. To <span class="keywordflow">do</span> <span class="keyword">this</span>,</div>
<div class="line">    Rem we<span class="stringliteral">&#39;ll use the ItemByRange method.</span></div>
<div class="line"><span class="stringliteral">    Set myDocument = myInDesign.Documents.Item(1)</span></div>
<div class="line"><span class="stringliteral">    Set myPage = myDocument.Pages.Item(1)</span></div>
<div class="line"><span class="stringliteral">    Set myTextFrame = myPage.TextFrames.Item(1)</span></div>
<div class="line"><span class="stringliteral">    Set myStartCharacter = myTextFrame.ParentStory.Paragraphs.Item(2).Characters.Item(1)</span></div>
<div class="line"><span class="stringliteral">    Set myEndCharacter = myTextFrame.ParentStory.Paragraphs.Item(2).Characters.Item(-2)</span></div>
<div class="line"><span class="stringliteral">    myTextFrame.Texts.ItemByRange(myStartCharacter, myEndCharacter).Item(1).Contents = &quot;This text replaces the text in paragraph 2.&quot;</span></div>
</div><!-- fragment --><p> In the preceding script, we used the ItemByRange method to get a reference to the text of the paragraph (excluding the return character at the end of the paragraph), as a single text object. We excluded the return character because deleting the return might change the paragraph style applied to the paragraph. To use the ItemByRangemethod, we used the texts collection of the story, but we supplied two characters-the starting and ending characters of the paragraph-as parameters. If we used myTextFrame.ParentStory.Characters.ItemByRange, InDesign would return a collection of Character objects. We wanted one Text object, so we could replace the contents in one action.</p>
<h3><a class="anchor" id="id_vb_inserting_special_characters"></a>
Inserting special characters</h3>
<p>Because most VBScript editors support Unicode, you can simply enter Unicode characters in text strings that you send to InDesign. The following script shows several ways to enter special characters. (We omitted the myGetBounds function from this listing; you can find it in <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_creating_a_text_frame">Creating a text frame</a> " or in the SpecialCharacters tutorial script.) </p>
<div class="fragment"><div class="line">Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">Set myTextFrame = myPage.TextFrames.Item(1)</div>
<div class="line">Rem Entering special characters directly.</div>
<div class="line">myTextFrame.contents = <span class="stringliteral">&quot;Registered trademark: &quot;</span> &amp; vbCr &amp; <span class="stringliteral">&quot;Copyright: &amp;copy;&quot;</span> &amp; vbCr &amp; <span class="stringliteral">&quot;Trademark: ?&quot;</span> &amp; vbCr &amp; <span class="stringliteral">&quot;&quot;</span></div>
<div class="line">Rem Entering special characters by their Unicode glyph ID </div>
<div class="line">Rem value (<span class="stringliteral">&quot;&amp;H&quot;</span> indicates a hexadecimal number):</div>
<div class="line">myTextFrame.ParentStory.InsertionPoints.Item(-1).contents = <span class="stringliteral">&quot;Not equal to: &quot;</span> &amp; ChrW(&amp;H2260) &amp; vbCr &amp; <span class="stringliteral">&quot;Square root: &quot;</span> &amp; ChrW(&amp;H221A) &amp; vbCr &amp; <span class="stringliteral">&quot;Paragraph: &quot;</span> &amp; ChrW(&amp;HB6) &amp; vbCr</div>
<div class="line">Rem Entering InDesign special characters by their enumerations:</div>
<div class="line">myTextFrame.ParentStory.InsertionPoints.Item(-1).contents = <span class="stringliteral">&quot;Page number marker:&quot;</span></div>
<div class="line">myTextFrame.ParentStory.InsertionPoints.Item(-1).contents = idSpecialCharacters.idAutoPageNumber</div>
<div class="line">myTextFrame.ParentStory.InsertionPoints.Item(-1).contents = vbCr</div>
<div class="line">myTextFrame.ParentStory.InsertionPoints.Item(-1).contents = <span class="stringliteral">&quot;Section symbol:&quot;</span></div>
<div class="line">myTextFrame.ParentStory.InsertionPoints.Item(-1).contents = idSpecialCharacters.idSectionSymbol</div>
<div class="line">myTextFrame.ParentStory.InsertionPoints.Item(-1).contents = vbCr</div>
<div class="line">myTextFrame.ParentStory.InsertionPoints.Item(-1).contents = <span class="stringliteral">&quot;En dash:&quot;</span></div>
<div class="line">myTextFrame.ParentStory.InsertionPoints.Item(-1).contents = idSpecialCharacters.idEnDash</div>
<div class="line">myTextFrame.ParentStory.InsertionPoints.Item(-1).contents = vbCr</div>
</div><!-- fragment --><p>The easiest way to find the Unicode ID for a character is to use InDesign's Glyphs palette: move the cursor over a character in the palette, and InDesign displays its Unicode value. To learn more about Unicode, visit <a href="http://www.unicode.org">http://www.unicode.org </a> .</p>
<h2><a class="anchor" id="id_vb_placing_text_and_setting_text-import_preferences"></a>
Placing Text and Setting Text-Import Preferences</h2>
<p>In addition to entering text strings, you can place text files created using word processors and text editors. The following script shows how to place a text file on a document page (for the complete script, see PlaceTextFile): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    myX = myPage.MarginPreferences.Left</div>
<div class="line">    myY = myPage.MarginPreferences.Top</div>
<div class="line">    Rem Autoflow a text file on the current page.</div>
<div class="line">    Rem Parameters <span class="keywordflow">for</span> Page.place():</div>
<div class="line">    Rem File as File object,</div>
<div class="line">    Rem [PlacePoint as Array [x, y]]</div>
<div class="line">    Rem [DestinationLayer as Layer object]</div>
<div class="line">    Rem [ShowingOptions as Boolean = False]</div>
<div class="line">    Rem [Autoflowing as Boolean = False]</div>
<div class="line">    Rem You<span class="stringliteral">&#39;ll have to fill in your own file path.</span></div>
<div class="line"><span class="stringliteral">    Set myTextFrame = myPage.Place(&quot;c:\test.txt&quot;, Array(myX, myY), , False, True)</span></div>
<div class="line"><span class="stringliteral">    Rem Note that if the PlacePoint parameter is inside a file, only the vertical (y)</span></div>
<div class="line"><span class="stringliteral">    Rem coordinate will be honored--the text frame will expand horizontally to fit the column.</span></div>
</div><!-- fragment --><p> The following script shows how to place a text file in an existing text frame. (We omitted the myGetBounds function from this listing; you can find it in <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_creating_a_text_frame">Creating a text frame</a>, or see the PlaceTextFileInFrame tutorial script.) </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    Set myTextFrame = myPage.TextFrames.Item(1)</div>
<div class="line">    Rem Place a text file in the text frame.</div>
<div class="line">    Rem Parameters <span class="keywordflow">for</span> TextFrame.place():</div>
<div class="line">    Rem File as string,</div>
<div class="line">    Rem [ShowingOptions as Boolean = False]</div>
<div class="line">    Rem You<span class="stringliteral">&#39;ll have to fill in your own file path.</span></div>
<div class="line"><span class="stringliteral">    myTextFrame.Place &quot;c:\test.txt&quot;</span></div>
</div><!-- fragment --><p> The following script shows how to insert a text file at a specific location in text. (We omitted the myGetBounds function from this listing; you can find it in <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_creating_a_text_frame">Creating a text frame</a>, or see the InsertTextFile tutorial script.) </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    Rem Create a text frame.</div>
<div class="line">    Set myTextFrame = myPage.TextFrames.Add</div>
<div class="line">    myTextFrame.geometricBounds = myGetBounds(myDocument, myPage)</div>
<div class="line">    myTextFrame.Contents = &quot;Inserted text file follows:&quot; &amp; vbCr</div>
<div class="line">    Rem Place a text file at the end of the text.</div>
<div class="line">    Rem Parameters for InsertionPoint.place():</div>
<div class="line">    Rem File as <span class="keywordtype">string</span> (file path),</div>
<div class="line">    Rem [ShowingOptions as Boolean = False]</div>
<div class="line">    Rem You&#39;ll have to fill in your own file path.</div>
<div class="line">    myTextFrame.ParentStory.InsertionPoints.Item(-1).Place &quot;c:\test.txt&quot;</div>
</div><!-- fragment --><p> To specify the import options for the specific type of text file you are placing, use the corresponding import-preferences object. The following script shows how to set text-import preferences (for the complete script, see TextImportPreferences). The comments in the script show the possible values for each property. </p>
<div class="fragment"><div class="line">    With myInDesign.TextImportPreferences</div>
<div class="line">        Rem Options <span class="keywordflow">for</span> characterSet: idTextImportCharacterSet</div>
<div class="line">        .CharacterSet = idTextImportCharacterSet.idUTF8</div>
<div class="line">        .ConvertSpacesIntoTabs = True</div>
<div class="line">        .SpacesIntoTabsCount = 3</div>
<div class="line">        Rem Dictionary can take many values, such as French, Italian.</div>
<div class="line">        .Dictionary = <span class="stringliteral">&quot;English: USA&quot;</span></div>
<div class="line">        Rem platform options: idImportPlatform</div>
<div class="line">        .Platform = idImportPlatform.idPC</div>
<div class="line">        .StripReturnsBetweenLines = True</div>
<div class="line">        .StripReturnsBetweenParagraphs = True</div>
<div class="line">        .UseTypographersQuotes = True</div>
<div class="line">    End With</div>
</div><!-- fragment --><p> The following script shows how to set tagged text import preferences (for the complete script, see TaggedTextImportPreferences): </p>
<div class="fragment"><div class="line">    With myInDesign.TaggedTextImportPreferences</div>
<div class="line">        .RemoveTextFormatting = False</div>
<div class="line">        Rem .styleConflict <span class="keyword">property</span> can be:</div>
<div class="line">        Rem idStyleConflict.idPublicationDefinition</div>
<div class="line">        Rem idStyleConflict.idTagFileDefinition</div>
<div class="line">        .StyleConflict = idStyleConflict.idPublicationDefinition</div>
<div class="line">        .UseTypographersQuotes = True</div>
<div class="line">    End With</div>
</div><!-- fragment --><p> The following script shows how to set Word and RTF import preferences (for the complete script, see WordRTFImportPreferences): </p>
<div class="fragment"><div class="line">    With myInDesign.WordRTFImportPreferences</div>
<div class="line">        Rem convertPageBreaks <span class="keyword">property</span> can be:</div>
<div class="line">        Rem idConvertPageBreaks.idColumnBreak</div>
<div class="line">        Rem idConvertPageBreaks.idNone</div>
<div class="line">        Rem idConvertPageBreaks.idPageBreak</div>
<div class="line">        .ConvertPageBreaks = idConvertPageBreaks.idNone</div>
<div class="line">        Rem convertTablesTo <span class="keyword">property</span> can be:</div>
<div class="line">        Rem idConvertTablesOptions.idUnformattedTabbedText</div>
<div class="line">        Rem idConvertTablesOptions.idUnformattedTable</div>
<div class="line">        .ConvertTablesTo = idConvertTablesOptions.idUnformattedTable</div>
<div class="line">        .ImportEndnotes = True</div>
<div class="line">        .ImportFootnotes = True</div>
<div class="line">        .ImportIndex = True</div>
<div class="line">        .ImportTOC = True</div>
<div class="line">        .ImportUnusedStyles = False</div>
<div class="line">        .PreserveGraphics = False</div>
<div class="line">        .PreserveLocalOverrides = False</div>
<div class="line">        .PreserveTrackChanges = False</div>
<div class="line">        .RemoveFormatting = False</div>
<div class="line">        Rem resolveCharacterStyleClash and resolveParagraphStyleClash properties can be:</div>
<div class="line">        Rem idResolveStyleClash.idResolveClashAutoRename</div>
<div class="line">        Rem idResolveStyleClash.iduseExisting</div>
<div class="line">        Rem idResolveStyleClash.iduseNew</div>
<div class="line">        .ResolveCharacterStyleClash = idResolveStyleClash.idResolveClashUseExisting </div>
<div class="line">        .ResolveParagraphStyleClash = idResolveStyleClash.idResolveClashUseExisting </div>
<div class="line">        .UseTypographersQuotes = True</div>
<div class="line">    End With</div>
</div><!-- fragment --><p> The following script shows how to set Excel import preferences (for the complete script, see ExcelImportPreferences): </p>
<div class="fragment"><div class="line">    With myInDesign.ExcelImportPreferences</div>
<div class="line">        Rem alignmentStyle <span class="keyword">property</span> can be:</div>
<div class="line">        Rem AlignmentStyleOptions.centerAlign</div>
<div class="line">        Rem AlignmentStyleOptions.leftAlign</div>
<div class="line">        Rem AlignmentStyleOptions.rightAlign</div>
<div class="line">        Rem AlignmentStyleOptions.spreadsheet</div>
<div class="line">        .AlignmentStyle = idAlignmentStyleOptions.idSpreadsheet</div>
<div class="line">        .DecimalPlaces = 4</div>
<div class="line">        .PreserveGraphics = False</div>
<div class="line">        Rem Enter the range you want to <span class="keyword">import</span> as <span class="stringliteral">&quot;start cell:end cell&quot;</span>.</div>
<div class="line">        .RangeName = <span class="stringliteral">&quot;A1:B16&quot;</span></div>
<div class="line">        .SheetIndex = 1</div>
<div class="line">        .SheetName = <span class="stringliteral">&quot;pathpoints&quot;</span></div>
<div class="line">        .ShowHiddenCells = False</div>
<div class="line">        Rem tableFormatting <span class="keyword">property</span> can be:</div>
<div class="line">        Rem idTableFormattingOptions.idExcelFormattedTable</div>
<div class="line">        Rem idTableFormattingOptions.idExcelUnformattedTabbedText</div>
<div class="line">        Rem idTableFormattingOptions.idExcelUnformattedTable</div>
<div class="line">        .TableFormatting = idTableFormattingOptions.idExcelFormattedTable</div>
<div class="line">        .UseTypographersQuotes = True</div>
<div class="line">        .ViewName = <span class="stringliteral">&quot;&quot;</span></div>
<div class="line">    End With</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_exporting_text_and_setting_text-export_preferences"></a>
Exporting Text and Setting Text-Export Preferences</h2>
<p>The following script shows how to export text from an InDesign document. Note that you must use text or story objects to export into text file formats; you cannot export all text in a document in one operation. (We omitted the myGetBounds function from this listing; you can find it in <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_creating_a_text_frame">Creating a text frame</a>, or see the ExportTextFile tutorial script.) </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    Set myTextFrame = myPage.TextFrames.Item(1)</div>
<div class="line">    Rem Text export method parameters:</div>
<div class="line">    Rem Format as idExportFormat</div>
<div class="line">    Rem To As File</div>
<div class="line">    Rem [ShowingOptions As Boolean = False]</div>
<div class="line">    Rem</div>
<div class="line">    Rem Format parameter can be:</div>
<div class="line">    Rem idExportFormat.idInCopyMarkup</div>
<div class="line">    Rem idExportFormat.idHTML</div>
<div class="line">    Rem idExportFormat.idRTF</div>
<div class="line">    Rem idExportFormat.idTaggedText</div>
<div class="line">    Rem idExportFormat.idTextType</div>
<div class="line">    Rem</div>
<div class="line">    Rem Export the story as text. You<span class="stringliteral">&#39;ll have to fill in a valid file path on your system.</span></div>
<div class="line"><span class="stringliteral">    myTextFrame.ParentStory.Export idExportFormat.idRTF, &quot;C:\test.txt&quot;</span></div>
</div><!-- fragment --><p> The following example shows how to export a specific range of text. (We omitted the myGetBounds function from this listing; you can find it in <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_creating_a_text_frame">Creating a text frame</a>, or see the ExportTextRange tutorial script.) </p>
<div class="fragment"><div class="line">   Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">   Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">   Set myTextFrame = myPage.TextFrames.Item(1)</div>
<div class="line">   Set myStory = myTextFrame.ParentStory</div>
<div class="line">   Set myStartCharacter = myStory.Paragraphs.Item(1).Characters.Item(1)</div>
<div class="line">   Set myEndCharacter = myStory.Paragraphs.Item(1).Characters.Item(-1)</div>
<div class="line">   Set myText = myTextFrame.ParentStory.Texts.ItemByRange(myStartCharacter, myEndCharacter).Item(1)</div>
<div class="line">   Rem Text export method parameters:</div>
<div class="line">   Rem Format as idExportFormat</div>
<div class="line">   Rem To As File</div>
<div class="line">   Rem [ShowingOptions As Boolean = False]</div>
<div class="line">   Rem</div>
<div class="line">   Rem Format parameter can be:</div>
<div class="line">   Rem idExportFormat.idInCopy</div>
<div class="line">   Rem idExportFormat.idInCopyCS2Story</div>
<div class="line">   Rem idExportFormat.idRTF</div>
<div class="line">   Rem idExportFormat.idTaggedText</div>
<div class="line">   Rem idExportFormat.idTextType</div>
<div class="line">   Rem</div>
<div class="line">   Rem Export the text range. You<span class="stringliteral">&#39;ll have to fill in a valid file path on your system.</span></div>
<div class="line"><span class="stringliteral">   myText.Export idExportFormat.idTextType, &quot;C:\test.txt&quot;</span></div>
</div><!-- fragment --><p> To specify the export options for the specific type of text file you're exporting, use the corresponding export preferences object. The following script sets text-export preferences (for the complete script, see TextExportPreferences): </p>
<div class="fragment"><div class="line">    With myInDesign.TextExportPreferences</div>
<div class="line">        Rem Options <span class="keywordflow">for</span> characterSet: idTextExportCharacterSet</div>
<div class="line">        .CharacterSet = idTextExportCharacterSet.idUTF8</div>
<div class="line">        Rem platform options: idImportPlatform</div>
<div class="line">        .Platform = idImportPlatform.idPC</div>
<div class="line">    End With</div>
</div><!-- fragment --><p> The following script sets tagged text export preferences (for the complete script, see TaggedTextExportPreferences): </p>
<div class="fragment"><div class="line">    Set myInDesign = CreateObject(<span class="stringliteral">&quot;InDesign.Application.2024&quot;</span>)</div>
<div class="line">    With myInDesign.TaggedTextExportPreferences</div>
<div class="line">        Rem Options for characterSet:</div>
<div class="line">        Rem idTagTextExportCharacterSet.idAnsi</div>
<div class="line">        Rem idTagTextExportCharacterSet.idASCII</div>
<div class="line">        Rem idTagTextExportCharacterSet.idGB18030</div>
<div class="line">        Rem idTagTextExportCharacterSet.idKSC5601</div>
<div class="line">        Rem idTagTextExportCharacterSet.idShiftJIS</div>
<div class="line">        Rem idTagTextExportCharacterSet.idUnicode</div>
<div class="line">        .CharacterSet = idTagTextExportCharacterSet.idUnicode</div>
<div class="line">        Rem tagForm options:</div>
<div class="line">        Rem idTagTextForm.idAbbreviated</div>
<div class="line">        Rem idTagTextForm.idVerbose</div>
<div class="line">        .TagForm = idTagTextForm.idVerbose</div>
<div class="line">    End With</div>
</div><!-- fragment --><p> You cannot export all text in a document in one step. Instead, you need to either combine the text in the document into a single story and then export that story, or combine the text files by reading and writing files via scripting. The following script demonstrates the former approach. (We omitted the myGetBounds function from this listing; you can find it in <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_creating_a_text_frame">Creating a text frame</a>, or see the ExportAllText tutorial script.) For any format other than text only, the latter method can become quite complex. </p>
<div class="fragment"><div class="line">    If myInDesign.Documents.Count &lt;&gt; 0 Then</div>
<div class="line">        If myInDesign.Documents.Item(1).Stories.Count &lt;&gt; 0 Then</div>
<div class="line">            myExportAllText myInDesign, myInDesign.Documents.Item(1).Name</div>
<div class="line">        End If</div>
<div class="line">    End If</div>
</div><!-- fragment --><p> Here is the ExportAllText function referred to in the preceding fragment: </p>
<div class="fragment"><div class="line">Function myExportAllText(myInDesign, myDocumentName)</div>
<div class="line">   mySeparatorString = &quot;----------------------------------------&quot; &amp; vbCr</div>
<div class="line">   Rem If you want to add a separator line between stories, </div>
<div class="line">   Rem set myAddSeparator to true.</div>
<div class="line">   myAddSeparator = True</div>
<div class="line">   Set myNewDocument = myInDesign.Documents.Add</div>
<div class="line">   Set myDocument = myInDesign.Documents.Item(myDocumentName)</div>
<div class="line">   Set myTextFrame = myNewDocument.Pages.Item(1).TextFrames.Add</div>
<div class="line">   myTextFrame.geometricBounds = myGetBounds(myNewDocument, myNewDocument.Pages.Item(1))</div>
<div class="line">   Set myNewStory = myTextFrame.ParentStory</div>
<div class="line">   For myCounter = 1 To myDocument.Stories.Count</div>
<div class="line">     Set myStory = myDocument.Stories.Item(myCounter)</div>
<div class="line">     myStory.texts.item(1).duplicate idLocationOptions.idAfter, myNewStory.InsertionPoints.Item(1)</div>
<div class="line">     Rem If the text did not end with a return, enter a return</div>
<div class="line">     Rem to keep the stories from running together.</div>
<div class="line">     If myCounter &lt;&gt; myDocument.Stories.Count Then</div>
<div class="line">         If myNewStory.Characters.Item(-1).Contents &lt;&gt; vbCr Then</div>
<div class="line">             myNewStory.InsertionPoints.Item(-1).Contents = vbCr</div>
<div class="line">         End If</div>
<div class="line">         If myAddSeparator = True Then</div>
<div class="line">             myNewStory.InsertionPoints.Item(-1).Contents = mySeparatorString</div>
<div class="line">         End If</div>
<div class="line">     End If</div>
<div class="line">   Next</div>
<div class="line">   myNewStory.Export idExportFormat.idTaggedText, &quot;c:\test.txt&quot;</div>
<div class="line">   myNewDocument.Close idSaveOptions.idNo</div>
<div class="line">End Function</div>
</div><!-- fragment --><p> Do not assume that you are limited to exporting text using existing export filters. Because VBScript can write text files to disk, you can have your script traverse the text in a document and export it in any order you like, using whatever text mark-up scheme you prefer. Here is a very simple example that shows how to export InDesign text as HTML. (We omitted the myGetBounds function from this listing; you can find it in <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_creating_a_text_frame">Creating a text frame</a>, or see the ExportHTML tutorial script.) </p>
<div class="fragment"><div class="line">   Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">   Rem Use the myStyleToTagMapping dictionary to <span class="keyword">set</span> up your paragraph style to tag mapping.</div>
<div class="line">   Set myStyleToTagMapping = CreateObject(<span class="stringliteral">&quot;Scripting.Dictionary&quot;</span>)</div>
<div class="line">   Rem For each style to tag mapping, add a new item to the dictionary.</div>
<div class="line">   myStyleToTagMapping.Add &quot;body_text&quot;, &quot;p&quot;</div>
<div class="line">   myStyleToTagMapping.Add &quot;heading1&quot;, &quot;h1&quot;</div>
<div class="line">   myStyleToTagMapping.Add &quot;heading2&quot;, &quot;h2&quot;</div>
<div class="line">   myStyleToTagMapping.Add &quot;heading3&quot;, &quot;h3&quot;</div>
<div class="line">   Rem End of style to tag mapping.</div>
<div class="line">   If myDocument.Stories.Count &lt;&gt; 0 Then</div>
<div class="line">     Rem Open a new text file.</div>
<div class="line">    myJavaScript = &quot;myFilePath = File.saveDialog(&quot;&quot;Save HTML as &quot;&quot;, &quot;&quot;HTML files:*.html,All Files:*.*&quot;&quot;);&quot;</div>
<div class="line">    myResult = myInDesign.doScript(myJavaScript, idScriptLanguage.idJavascript)</div>
<div class="line">     Rem If the user clicked the Cancel button, the result is null.</div>
<div class="line">     If myResult = True Then</div>
<div class="line">         myTextFileName = myDialog.FileName</div>
<div class="line">         Set myFileSystemObject = CreateObject(&quot;Scripting.FileSystemObject&quot;)</div>
<div class="line">         Set myTextFile = myFileSystemObject.CreateTextFile(myTextFileName)</div>
<div class="line">         For myCounter = 1 To myInDesign.Documents.Item(1).Stories.Count</div>
<div class="line">             Set myStory = myDocument.Stories.Item(myCounter)</div>
<div class="line">             For myParagraphCounter = 1 To myStory.Paragraphs.Count</div>
<div class="line">                 Set myParagraph = myStory.Paragraphs.Item(myParagraphCounter)</div>
<div class="line">                 If myParagraph.Tables.Count = 0 Then</div>
<div class="line">                     If myParagraph.TextStyleRanges.Count = 1 Then</div>
<div class="line">                         Rem If the paragraph is a simple paragraph--no tables, no local formatting--then</div>
<div class="line">                         Rem simply export the text of the pararaph with the appropriate tag.</div>
<div class="line">                         myTag = myStyleToTagMapping.Item(myParagraph.AppliedParagraphStyle.Name)</div>
<div class="line">                         Rem If the tag comes back empty, map it to the basic paragraph tag.</div>
<div class="line">                         If myTag = &quot;&quot; Then</div>
<div class="line">                             myTag = &quot;p&quot;</div>
<div class="line">                         End If</div>
<div class="line">                         myStartTag = &quot;&lt;&quot; &amp; myTag &amp; &quot;&gt;&quot;</div>
<div class="line">                         myEndTag = &quot;&lt;/&quot; &amp; myTag &amp; &quot;&gt;&quot;</div>
<div class="line">                         Rem If the paragraph is not the last paragraph in the story,</div>
<div class="line">                         Rem omit the return character.</div>
<div class="line">                         If myParagraph.Characters.Item(-1).Contents = vbCr Then</div>
<div class="line">                             myString = myParagraph.Texts.ItemByRange(myParagraph.Characters.Item(1), myParagraph.Characters.Item(-2)).Item(1).Contents</div>
<div class="line">                         Else</div>
<div class="line">                             myString = myParagraph.Contents</div>
<div class="line">                         End If</div>
<div class="line">                         Rem Write the paragraphs&#39; text to the text file.</div>
<div class="line">                         myTextFile.WriteLine myStartTag &amp; myString &amp; myEndTag</div>
<div class="line">                     Else</div>
<div class="line">                         Rem Handle text style range export by iterating through the text style ranges in the paragraph..</div>
<div class="line">                         For myRangeCounter = 1 To myParagraph.TextStyleRanges.Length</div>
<div class="line">                             myTextStyleRange = myParagraph.TextStyleRanges.Item(myRangeCounter)</div>
<div class="line">                             If myTextStyleRange.Characters.Item(-1) = vbCr Then</div>
<div class="line">                                 myString = myTextStyleRange.Texts.ItemByRange(myTextStyleRange.Characters.Item(1), myTextStyleRange.Characters.Item(-2)).Item(1).Contents</div>
<div class="line">                             Else</div>
<div class="line">                                 myString = myTextStyleRange.Contents</div>
<div class="line">                             End If</div>
<div class="line">                             Select Case myTextStyleRange.FontStyle</div>
<div class="line">                                 Case &quot;Bold&quot;:</div>
<div class="line">                                     myString = &quot;&lt;b&gt;&quot; &amp; myString &amp; &quot;&lt;/b&gt;&quot;</div>
<div class="line">                                 Case &quot;Italic&quot;:</div>
<div class="line">                                     myString = &quot;&lt;i&gt;&quot; &amp; myString &amp; &quot;&lt;/i&gt;&quot;</div>
<div class="line">                             End Select</div>
<div class="line">                             myTextFile.write myString</div>
<div class="line">                         Next</div>
<div class="line">                         myTextFile.write vbCr</div>
<div class="line">                     End If</div>
<div class="line">                 Else</div>
<div class="line">                     Rem Handle table export (assumes that there is only one table per paragraph,</div>
<div class="line">                     Rem and that the table is in the paragraph by itself).</div>
<div class="line">                     Set myTable = myParagraph.Tables.Item(1)</div>
<div class="line">                     myTextFile.write &quot;&lt;table border = 1&gt;&quot;</div>
<div class="line">                     For myRowCounter = 1 To myTable.Rows.Count</div>
<div class="line">                         myTextFile.write &quot;&lt;tr&gt;&quot;</div>
<div class="line">                         For myColumnCounter = 1 To myTable.Columns.Count</div>
<div class="line">                             If myRowCounter = 1 Then</div>
<div class="line">                                 myString = &quot;&lt;th&gt;&quot; &amp; myTable.Rows.Item(myRowCounter).Cells.Item(myColumnCounter).Texts.Item(1).Contents &amp; &quot;&lt;/th&gt;&quot;</div>
<div class="line">                             Else</div>
<div class="line">                                 myString = &quot;&lt;td&gt;&quot; &amp; myTable.Rows.Item(myRowCounter).Cells.Item(myColumnCounter).Texts.Item(1).Contents &amp; &quot;&lt;/td&gt;&quot;</div>
<div class="line">                             End If</div>
<div class="line">                             myTextFile.write myString</div>
<div class="line">                         Next</div>
<div class="line">                         myTextFile.WriteLine &quot;&lt;/tr&gt;&quot;</div>
<div class="line">                     Next</div>
<div class="line">                     myTextFile.WriteLine &quot;&lt;/table&gt;&quot;</div>
<div class="line">                 End If</div>
<div class="line">             Next</div>
<div class="line">             Rem Close the text file.</div>
<div class="line">             myTextFile.Close</div>
<div class="line">         Next</div>
<div class="line">     End If</div>
<div class="line">   End If</div>
</div><!-- fragment --><div class="fragment"><div class="line">Function myMakeParagraphStyle(myDocument, myStyleName)</div>
<div class="line">   On Error Resume Next</div>
<div class="line">   Set myStyle = myDocument.ParagraphStyles.Item(myStyleName)</div>
<div class="line">      If Err.Number &lt;&gt; 0 Then</div>
<div class="line">         Set myStyle = myDocument.ParagraphStyles.Add</div>
<div class="line">         myStyle.Name = myStyleName</div>
<div class="line">      End If</div>
<div class="line">      Err.Clear</div>
<div class="line">      On Error GoTo 0</div>
<div class="line">   Set myMakeParagraphStyle = myStyle</div>
<div class="line">End Function</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_understanding_text_objects"></a>
Understanding Text Objects</h2>
<p>The following diagram shows a view of InDesign's text object model. As you can see, there are two main types of text object: layout objects (text frames) and text-stream objects (for example, stories, insertion points, characters, and words): </p>
<div class="image">
<img src="InDesign_ScriptingGuide-3.gif" alt="InDesign_ScriptingGuide-3.gif"/>
</div>
<p>There are many ways to get a reference to a given text object. The following diagram shows a few ways to refer to the first character in the first text frame of the first page of a new document: </p>
<div class="image">
<img src="InDesign_ScriptingGuide-4.gif" alt="InDesign_ScriptingGuide-4.gif"/>
</div>
<p>For any text stream object, the parent of the object is the story containing the object. To get a reference to the text frame (or text frames) containing the text object, use the ParentTextFrames property.</p>
<p>For a text frame, the parent of the text frame usually is the page or spread containing the text frame. If the text frame is inside a group or was pasted inside another page item, the parent of the text frame is the containing page item. If the text frame was converted to an anchored frame, the parent of the text frame is the character containing the anchored frame.</p>
<h3><a class="anchor" id="id_vb_working_with_text_selections"></a>
Working with text selections</h3>
<p>Text-related scripts often act on a text selection. The following script demonstrates a way to determine whether the current selection is a text selection. Unlike many of the other sample scripts, this script does not actually do anything; it simply presents a selection-filtering routine that you can use in your own scripts (for the complete script, see TextSelection). </p>
<div class="fragment"><div class="line">    Set myInDesign = CreateObject(<span class="stringliteral">&quot;InDesign.Application.2024&quot;</span>)</div>
<div class="line">    If myInDesign.Documents.Count &lt;&gt; 0 Then</div>
<div class="line">        Rem If the selection contains more than one item, the selection</div>
<div class="line">        Rem is not text selected with the Type tool.</div>
<div class="line">        If myInDesign.Selection.Count = 1 Then</div>
<div class="line">            Select Case TypeName(myInDesign.Selection.Item(1))</div>
<div class="line">                Case &quot;InsertionPoint&quot;, &quot;Character&quot;, &quot;Word&quot;, &quot;TextStyleRange&quot;, &quot;Line&quot;, &quot;Paragraph&quot;, &quot;TextColumn&quot;, &quot;Text&quot;</div>
<div class="line">                    MsgBox &quot;The selection is a text <span class="keywordtype">object</span>.&quot;</div>
<div class="line">                    Rem A real script would now act on the text <span class="keywordtype">object</span></div>
<div class="line">                    Rem or pass it on to a function.</div>
<div class="line">                Case &quot;TextFrame&quot;</div>
<div class="line">                    Rem In addition to checking for the above text objects, we can</div>
<div class="line">                    Rem also continue if the selection is a text frame selected with</div>
<div class="line">                    Rem the Selection tool or the Direct Selection tool.</div>
<div class="line">                    Rem If the selection is a text frame, you get a reference to the</div>
<div class="line">                    Rem text in the text frame and then pass it along to a function.</div>
<div class="line">                    Rem Set myText = myInDesign.Selection.Item(1).Texts.Item(1)</div>
<div class="line">                    MsgBox &quot;The selected <span class="keywordtype">object</span> is a text frame.&quot;</div>
<div class="line">                Case Else</div>
<div class="line">                    MsgBox &quot;The selected <span class="keywordtype">object</span> is not a text <span class="keywordtype">object</span>. Select some text and try again.&quot;</div>
<div class="line">            End Select</div>
<div class="line">        Else</div>
<div class="line">            MsgBox &quot;Please select some text and try again.&quot;</div>
<div class="line">        End If</div>
<div class="line">    Else</div>
<div class="line">        MsgBox &quot;No documents are open. Please open a document, select some text, and try again.&quot;</div>
<div class="line">    End If</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_moving_and_copying_text"></a>
Moving and copying text</h3>
<p>You can move a text object to another location in text using the move method. To copy the text, use the duplicate method (whose arguments are identical to the move method). The following script fragment shows how it works (for the complete script, see MoveText): </p>
<div class="fragment"><div class="line">    Set myInDesign = CreateObject(<span class="stringliteral">&quot;InDesign.Application.2024&quot;</span>)</div>
<div class="line">    Rem Access the active document and page</div>
<div class="line">    Set myDocument = myInDesign.ActiveDocument</div>
<div class="line">    Set myPage = myInDesign.ActiveWindow.ActivePage</div>
<div class="line">    Rem Set the bounds live area of the page.</div>
<div class="line">    myBounds = myGetBounds(myDocument, myDocument.Pages.Item(1))</div>
<div class="line">    myX1 = myBounds(1)</div>
<div class="line">    myY1 = myBounds(0)</div>
<div class="line">    myX2 = myBounds(3)</div>
<div class="line">    myY2 = myBounds(2)</div>
<div class="line">    myWidth = myX2 - myX1</div>
<div class="line">    myHeight = myY2 - myY1</div>
<div class="line">    Rem Create a series of text frames.</div>
<div class="line">    Set myTextFrameA = myPage.TextFrames.Add</div>
<div class="line">    myTextFrameA.geometricBounds = Array(myY1, myX1, myY1 + (myHeight / 2), myX1 + (myWidth / 2))</div>
<div class="line">    myTextFrameA.Contents = &quot;Before.&quot; &amp; vbCr</div>
<div class="line">    Set myTextFrameB = myPage.TextFrames.Add</div>
<div class="line">    myTextFrameB.geometricBounds = Array(myY1, myX1 + (myWidth / 2), myY1 + (myHeight / 2), myX2)</div>
<div class="line">    myTextFrameB.Contents = &quot;After.&quot; &amp; vbCr</div>
<div class="line">    Set myTextFrameC = myPage.TextFrames.Add</div>
<div class="line">    myTextFrameC.geometricBounds = Array(myY1 + (myHeight / 2), myX1, myY2, myX1 + (myWidth / 2))</div>
<div class="line">    myTextFrameC.Contents = &quot;Between words.&quot; &amp; vbCr</div>
<div class="line">    Set myTextFrameD = myPage.TextFrames.Add</div>
<div class="line">    myTextFrameD.geometricBounds = Array(myY1 + (myHeight / 2), myX1 + (myWidth / 2), myY2, myX2)</div>
<div class="line">    myTextFrameD.Contents = &quot;Text to move:&quot; &amp; vbCr &amp; &quot;WordA&quot; &amp; vbCr &amp; &quot;WordB&quot; &amp; vbCr &amp; &quot;WordC&quot; &amp; vbCr</div>
<div class="line">    Rem Move WordC between the words in TextFrameC.</div>
<div class="line">    myTextFrameD.ParentStory.Paragraphs.Item(-1).Words.Item(1).Move idLocationOptions.idBefore, myTextFrameC.ParentStory.Paragraphs.Item(1).Words.Item(2)</div>
<div class="line">    Rem Move WordB after the word in TextFrameB.</div>
<div class="line">    myTextFrameD.ParentStory.Paragraphs.Item(-2).Words.Item(1).Move idLocationOptions.idAfter, myTextFrameB.ParentStory.Paragraphs.Item(1).Words.Item(1)</div>
<div class="line">    Rem Move WordA to before the word in TextFrameA.</div>
<div class="line">    myTextFrameD.ParentStory.Paragraphs.Item(-3).Words.Item(1).Move idLocationOptions.idBefore, myTextFrameA.ParentStory.Paragraphs.Item(1).Words.Item(1)</div>
<div class="line">    Rem Note that moving text removes it from its original location.</div>
</div><!-- fragment --><p> When you want to transfer formatted text from one document to another, you also can use the move method. Using the move or duplicate method is better than using copy and paste; to use copy and paste, you must make the document visible and select the text you want to copy. Using move or duplicate is much faster and more robust. The following script shows how to move text from one document to another using move and duplicate. (We omitted the myGetBounds function from this listing; you can find it in <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_creating_a_text_frame">Creating a text frame</a>, or see the MoveTextBetweenDocuments tutorial script.) </p>
<div class="fragment"><div class="line">    Rem Create the source document</div>
<div class="line">    Set mySourceDocument = myInDesign.Documents.Add</div>
<div class="line">    Set mySourcePage = mySourceDocument.Pages.Item(1)</div>
<div class="line">    Set mySourceTextFrame = mySourcePage.TextFrames.Add</div>
<div class="line">    mySourceTextFrame.geometricBounds = myGetBounds(mySourceDocument, mySourcePage)</div>
<div class="line">    mySourceTextFrame.Contents = &quot;This is the source text.&quot; &amp; vbCr &amp; &quot;This text is not the source text.&quot;</div>
<div class="line">    Set mySourceParagraph = mySourceTextFrame.ParentStory.Paragraphs.Item(1)</div>
<div class="line">    mySourceParagraph.PointSize = 24    </div>
<div class="line">    </div>
<div class="line">    Rem Create the target document.</div>
<div class="line">    Set myTargetDocument = myInDesign.Documents.Add</div>
<div class="line">    Set myTargetPage = myTargetDocument.Pages.Item(1)</div>
<div class="line">    Set myTargetTextFrame = myTargetPage.TextFrames.Add</div>
<div class="line">    myTargetTextFrame.GeometricBounds = myGetBounds(myTargetDocument, myTargetPage)</div>
<div class="line">    myTargetTextFrame.Contents = &quot;This is the target text. Insert the source text before this paragraph.&quot; &amp; vbCr</div>
<div class="line"></div>
<div class="line">    Rem Move the text from the source document to the target document.</div>
<div class="line">    Rem This deletes the text from the source document.</div>
<div class="line">    mySourceParagraph.Move idLocationOptions.idBefore, myTargetTextFrame.InsertionPoints.Item(1)</div>
<div class="line">    </div>
<div class="line">    Rem To duplicate (rather than move) the text, use the following:</div>
<div class="line">    Rem mySourceParagraph.Duplicate idLocationOptions.idBefore, myTargetTextFrame.InsertionPoints.Item(1)</div>
</div><!-- fragment --><p> When you need to copy and paste text, you can use the copybmethod of the application. You will need to select the text before you copy. Again, you should use copy and paste only as a last resort; other approaches are faster, less fragile, and do not depend on the document being visible. (We omitted the myGetBounds function from this listing; you can find it in <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_creating_a_text_frame">Creating a text frame</a>, or see the CopyPasteText tutorial script.) </p>
<div class="fragment"><div class="line">    Set myDocumentA = myInDesign.Documents.Add</div>
<div class="line">    Set myPageA = myDocumentA.Pages.Item(1)</div>
<div class="line">    Set myTextFrameA = myPageA.TextFrames.Add</div>
<div class="line">    myTextFrameA.GeometricBounds = myGetBounds(myDocumentA, myPageA)</div>
<div class="line">    myTextFrameA.Contents = &quot;Example text.&quot; &amp; vbCr</div>
<div class="line"></div>
<div class="line">    Set myDocumentB = myInDesign.Documents.Add</div>
<div class="line">    Set myPageB = myDocumentB.Pages.Item(1)</div>
<div class="line">    Set myTextFrameB = myPageB.TextFrames.Add</div>
<div class="line">    myTextFrameB.GeometricBounds = myGetBounds(myDocumentB, myPageB)</div>
<div class="line"></div>
<div class="line">    Rem Make document A the active document.</div>
<div class="line">    myInDesign.ActiveDocument = myDocumentA</div>
<div class="line">    Rem Select the text.</div>
<div class="line">    myInDesign.Select myTextFrameA.ParentStory.Texts.Item(1)</div>
<div class="line">    myInDesign.Copy</div>
<div class="line"></div>
<div class="line">    Rem Make document B the active document.</div>
<div class="line">    myInDesign.ActiveDocument = myDocumentB</div>
<div class="line">    Rem Select the insertion point at which you want to paste the text.</div>
<div class="line">    myInDesign.Select myTextFrameB.ParentStory.InsertionPoints.Item(1)</div>
<div class="line">    myInDesign.Paste</div>
</div><!-- fragment --><p> One way to copy unformatted text from one text object to another is to get the contents property of a text object, then use that string to set the contents property of another text object. The following script shows how to do this (for the complete script, see CopyUnformattedText): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    Set myTextFrameA = myPage.TextFrames.Add</div>
<div class="line">    myTextFrameA.geometricBounds = Array(72, 72, 144, 288)</div>
<div class="line">    myTextFrameA.Contents = &quot;This is a formatted <span class="keywordtype">string</span>.&quot;</div>
<div class="line">    myTextFrameA.ParentStory.Texts.Item(1).FontStyle = &quot;Bold&quot;</div>
<div class="line">    Set myTextFrameB = myPage.TextFrames.Add</div>
<div class="line">    myTextFrameB.geometricBounds = Array(228, 72, 300, 288)</div>
<div class="line">    myTextFrameB.Contents = &quot;This is the destination text frame. Text pasted here will retain its formatting.&quot;</div>
<div class="line">    myTextFrameB.ParentStory.Texts.Item(1).FontStyle = &quot;Italic&quot;</div>
<div class="line">    Rem Copy from one frame to another using a simple copy.</div>
<div class="line">    myInDesign.Select myTextFrameA.Texts.Item(1)</div>
<div class="line">    myInDesign.Copy</div>
<div class="line">    myInDesign.Select myTextFrameB.ParentStory.InsertionPoints.Item(-1)</div>
<div class="line">    myInDesign.Paste</div>
<div class="line">    Rem Create another text frame on the active page.</div>
<div class="line">    Set myTextFrameC = myPage.TextFrames.Add</div>
<div class="line">    myTextFrameC.geometricBounds = Array(312, 72, 444, 288)</div>
<div class="line">    myTextFrameC.Contents = &quot;Text copied here will take on the formatting of the existing text.&quot;</div>
<div class="line">    myTextFrameC.ParentStory.Texts.Item(1).FontStyle = &quot;Italic&quot;</div>
<div class="line">    Rem Copy the unformatted <span class="keywordtype">string</span> from text frame A to the end of text frame C (note</div>
<div class="line">    Rem that this doesn&#39;t really copy the text it replicates the text <span class="keywordtype">string</span> from one</div>
<div class="line">    Rem text frame in another text frame):</div>
<div class="line">    myTextFrameC.ParentStory.InsertionPoints.Item(-1).Contents = myTextFrameA.ParentStory.Texts.Item(1).Contents</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_text_objects_and_iteration"></a>
Text objects and iteration</h3>
<p>When your script moves, deletes, or adds text while iterating through a series of text objects, you can easily end up with invalid text references. The following script demonstrates this problem. (We omitted the myGetBounds function from this listing; you can find it in <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_creating_a_text_frame">Creating a text frame</a>, or see the TextIterationWrong tutorial script.) </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myStory = myDocument.Stories.Item(1)</div>
<div class="line">    Rem The following <span class="keywordflow">for</span> loop cause an error.</div>
<div class="line">    For myParagraphCounter = 1 to myStory.Paragraphs.Count</div>
<div class="line">        If myStory.Paragraphs.Item(myParagraphCounter).Words.Item(1).contents = <span class="stringliteral">&quot;Delete&quot;</span> Then</div>
<div class="line">            myStory.Paragraphs.Item(myParagraphCounter).Delete</div>
<div class="line">        Else</div>
<div class="line">            myStory.Paragraphs.Item(myParagraphCounter).PointSize = 24</div>
<div class="line">        End If</div>
<div class="line">    Next</div>
</div><!-- fragment --><p> In the preceding example, some of the paragraphs are left unformatted. How does this happen? The loop in the script iterates through the paragraphs from the first paragraph in the story to the last. As it does so, it deletes paragraphs that begin with the word "Delete." When the script deletes the second paragraph, the third paragraph moves up to take its place. When the loop counter reaches 3, the script processes the paragraph that had been the fourth paragraph in the story; the original third paragraph is now the second paragraph and is skipped.</p>
<p>To avoid this problem, iterate backward through the text objects, as shown in the following script. (We omitted the myGetBounds function from this listing; you can find it in <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_creating_a_text_frame">Creating a text frame</a>, or see the TextIterationRight tutorial script.) </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myStory = myDocument.Stories.Item(1)</div>
<div class="line">    Rem The following <span class="keywordflow">for</span> loop will format all of the paragraphs by iterating</div>
<div class="line">    Rem backwards through the paragraphs in the story.</div>
<div class="line">    For myCounter = myStory.Paragraphs.Count To 1 Step -1</div>
<div class="line">        If myStory.Paragraphs.Item(myCounter).Words.Item(1).contents = <span class="stringliteral">&quot;Delete&quot;</span> Then</div>
<div class="line">            myStory.Paragraphs.Item(myCounter).Delete</div>
<div class="line">        Else</div>
<div class="line">            myStory.Paragraphs.Item(myCounter).PointSize = 24</div>
<div class="line">        End If</div>
<div class="line">    Next</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_working_with_text_frames"></a>
Working with Text Frames</h2>
<p>In the previous sections of this chapter, we concentrated on working with text stream objects; in this section, we focus on text frames, the page-layout items that contain text in an InDesign document.</p>
<h3><a class="anchor" id="id_vb_linking_text_frames"></a>
Linking text frames</h3>
<p>The nextTextFrame and previousTextFrame properties of a text frame are the keys to linking (or "threading") text frames in InDesign scripting. These properties correspond to the in port and out port on InDesign text frames, as shown in the following script fragment (for the complete script, see LinkTextFrames): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    Set myTextFrameA = myPage.TextFrames.Add</div>
<div class="line">    myTextFrameA.geometricBounds = Array(72, 72, 144, 144)</div>
<div class="line">    Set myTextFrameB = myPage.TextFrames.Add</div>
<div class="line">    myTextFrameB.geometricBounds = Array(228, 72, 300, 144)</div>
<div class="line">    Rem Add a page.</div>
<div class="line">    Set myNewPage = myDocument.Pages.Add</div>
<div class="line">    Rem Create another text frame on the new page.</div>
<div class="line">    Set myTextFrameC = myNewPage.TextFrames.Add</div>
<div class="line">    myTextFrameC.geometricBounds = Array(72, 72, 144, 144)</div>
<div class="line">    Rem Link TextFrameA to TextFrameB using the nextTextFrame property.</div>
<div class="line">    myTextFrameA.NextTextFrame = myTextFrameB</div>
<div class="line">    Rem Link TextFrameC to TextFrameB using the previousTextFrame property.</div>
<div class="line">    myTextFrameC.PreviousTextFrame = myTextFrameB</div>
<div class="line">    Rem Fill the text frames with placeholder text.</div>
<div class="line">    myTextFrameA.Contents = idTextFrameContents.idPlaceholderText</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_unlinking_text_frames"></a>
Unlinking text frames</h3>
<p>The following example script shows how to unlink text frames (for the complete script, see UnlinkTextFrames): </p>
<div class="fragment"><div class="line">    Rem Given two linked text frames on page 1...</div>
<div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    Set myTextFrameA = myPage.TextFrames.Item(-1)</div>
<div class="line">    Rem Unlink text frame A.</div>
<div class="line">    myTextFrameA.NextTextFrame = Nothing</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_removing_a_frame_from_a_story"></a>
Removing a frame from a story</h3>
<p>In InDesign, deleting a frame from a story does not delete the text in the frame, unless the frame is the only frame in the story. The following script fragment shows how to delete a frame and the text it contains from a story without disturbing the other frames in the story (for the complete script, see BreakFrame): </p>
<div class="fragment"><div class="line">    ReDim myObjectList(0)</div>
<div class="line">    Rem Script does nothing if no documents are open or if no objects are selected.</div>
<div class="line">    If myInDesign.Documents.Count &lt;&gt; 0 Then</div>
<div class="line">        If myInDesign.Selection.Count &lt;&gt; 0 Then</div>
<div class="line">            Rem Process the objects in the selection to create a list of</div>
<div class="line">            Rem qualifying objects (text frames).</div>
<div class="line">            For myCounter = 1 To myInDesign.Selection.Count</div>
<div class="line">                Select Case TypeName(myInDesign.Selection.Item(myCounter))</div>
<div class="line">                    Case &quot;TextFrame&quot;:</div>
<div class="line">                        If Not (IsEmpty(myObjectList(0))) Then</div>
<div class="line">                            ReDim Preserve myObjectList(UBound(myObjectList) + 1)</div>
<div class="line">                        End If</div>
<div class="line">                        Set myObjectList(UBound(myObjectList)) = myInDesign.Selection.Item(myCounter)</div>
<div class="line">                    Case &quot;InsertionPoint&quot;, &quot;Character&quot;, &quot;Word&quot;, &quot;TextStyleRange&quot;, &quot;Line&quot;, &quot;Paragraph&quot;, &quot;TextColumn&quot;, &quot;Text&quot;:</div>
<div class="line">                        If Not (IsEmpty(myObjectList(0))) Then</div>
<div class="line">                            ReDim Preserve myObjectList(UBound(myObjectList) + 1)</div>
<div class="line">                        End If</div>
<div class="line">                        Set myObjectList(UBound(myObjectList)) = myInDesign.Selection.Item(myCounter).ParentTextFrames.Item(1)</div>
<div class="line">                End Select</div>
<div class="line">            Next</div>
<div class="line">            Rem If the <span class="keywordtype">object</span> list is not empty, pass it on to the function</div>
<div class="line">            Rem that does the real work.</div>
<div class="line">            If Not (IsEmpty(myObjectList(0))) Then</div>
<div class="line">                myBreakFrames myObjectList</div>
<div class="line">            End If</div>
<div class="line">        End If</div>
<div class="line">    End If</div>
</div><!-- fragment --><p> Here is the myBreakFrames function referred to in the preceding script. </p>
<div class="fragment"><div class="line">Function myBreakFrames(myObjectList)</div>
<div class="line">    For myCounter = UBound(myObjectList) To 0 Step -1</div>
<div class="line">        myBreakOutFrame myObjectList(myCounter)</div>
<div class="line">    Next</div>
<div class="line">End Function</div>
<div class="line">Function myBreakFrame(myTextFrame)</div>
<div class="line">    myProcessFrame = vbYes</div>
<div class="line">    If (TypeName(myTextFrame.NextTextFrame) &lt;&gt; &quot;Nothing&quot;) Or (TypeName(myTextFrame.PreviousTextFrame) &lt;&gt; &quot;Nothing&quot;) Then</div>
<div class="line">        If myTextFrame.ParentStory.Tables.Count &lt;&gt; 0 Then</div>
<div class="line">            myProcessFrame = MsgBox(&quot;This story contains tables. If the text frame you are trying to remove from the story contains a table, the results might not be what you expect. Do you want to continue?&quot;, vbYesNo)</div>
<div class="line">        End If</div>
<div class="line">        If myProcessFrame = vbYes Then</div>
<div class="line">            Set myNewFrame = myTextFrame.Duplicate</div>
<div class="line">            If myTextFrame.Contents &lt;&gt; &quot;&quot; Then</div>
<div class="line">                myTextFrame.Texts.Item(1).Delete</div>
<div class="line">            End If</div>
<div class="line">            myTextFrame.Delete</div>
<div class="line">        End If</div>
<div class="line">    End If</div>
<div class="line">End Function</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_splitting_all_frames_in_a_story"></a>
Splitting all frames in a story</h3>
<p>The following script fragment shows how to split all frames in a story into separate, independent stories, each containing one unlinked text frame (for the complete script, see SplitStory): </p>
<div class="fragment"><div class="line">    Rem Get the first item in the selection.</div>
<div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    Set myTextFrame = myPage.TextFrames.Item(1)</div>
<div class="line">    Set myStory = myTextFrame.ParentStory</div>
<div class="line">    Rem If the text frame is the only text frame in the story, <span class="keywordflow">do</span> nothing.</div>
<div class="line">    If myStory.TextContainers.Count &gt; 1 Then</div>
<div class="line">        Rem Splitting the story is a two-step process: first, duplicate</div>
<div class="line">        Rem the text frames, second, <span class="keyword">delete</span> the original text frames.</div>
<div class="line">        mySplitStory myStory</div>
<div class="line">        myRemoveFrames myStory</div>
<div class="line">    End If</div>
</div><!-- fragment --><p> Here is the mySplitStory function referred to in the preceding script: </p>
<div class="fragment"><div class="line">Function mySplitStory(myStory)</div>
<div class="line">    Rem Duplicate each text frame in the story.</div>
<div class="line">    For myCounter = myStory.TextContainers.Count To 1 Step -1</div>
<div class="line">        Set myTextFrame = myStory.TextContainers.Item(myCounter)</div>
<div class="line">        myTextFrame.Duplicate</div>
<div class="line">    Next</div>
<div class="line">End Function</div>
<div class="line">Function myRemoveFrames(myStory)</div>
<div class="line">    Rem Remove each text frame in the story. Iterate backwards to avoid invalid references.</div>
<div class="line">    For myCounter = myStory.TextContainers.Count To 1 Step -1</div>
<div class="line">        myStory.TextContainers.Item(myCounter).Delete</div>
<div class="line">    Next</div>
<div class="line">End Function</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_creating_an_anchored_frame"></a>
Creating an anchored frame</h3>
<p>To create an anchored frame (also known as an inline frame), you can create a text frame (or rectangle, oval, polygon, or graphic line) at a specific location in text (usually an insertion point). The following script fragment shows an example (for the complete script, see AnchoredFrame): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    <span class="keyword">set</span> myTextFrame = myPage.TextFrames.Item(1)</div>
<div class="line">    Set myInsertionPoint = myTextFrame.Paragraphs.Item(1).InsertionPoints.Item(1)</div>
<div class="line">    Set myInlineFrame = myInsertionPoint.TextFrames.Add</div>
<div class="line">    Rem Recompose the text to make sure that getting the</div>
<div class="line">    Rem geometric bounds of the <span class="keyword">inline</span> graphic will work.</div>
<div class="line">    myTextFrame.Texts.Item(1).Recompose</div>
<div class="line">    Rem Get the geometric bounds of the <span class="keyword">inline</span> frame.</div>
<div class="line">    myBounds = myInlineFrame.GeometricBounds</div>
<div class="line">    Rem Set the width and height of the <span class="keyword">inline</span> frame. In <span class="keyword">this</span> example, we<span class="stringliteral">&#39;ll</span></div>
<div class="line"><span class="stringliteral">    Rem make the frame 24 points tall by 72 points wide.</span></div>
<div class="line"><span class="stringliteral">    myArray = Array(myBounds(0), myBounds(1), myBounds(0) + 24, myBounds(1) + 72)</span></div>
<div class="line"><span class="stringliteral">    myInlineFrame.GeometricBounds = myArray</span></div>
<div class="line"><span class="stringliteral">    myInlineFrame.Contents = &quot;This is an inline frame.&quot;</span></div>
<div class="line"><span class="stringliteral">    Set myInsertionPoint = myTextFrame.Paragraphs.Item(2).InsertionPoints.Item(1)</span></div>
<div class="line"><span class="stringliteral">    Set myAnchoredFrame = myInsertionPoint.TextFrames.Add</span></div>
<div class="line"><span class="stringliteral">    Rem Recompose the text to make sure that getting the</span></div>
<div class="line"><span class="stringliteral">    Rem geometric bounds of the inline graphic will work.</span></div>
<div class="line"><span class="stringliteral">    myTextFrame.Texts.Item(1).Recompose</span></div>
<div class="line"><span class="stringliteral">    Rem Get the geometric bounds of the inline frame.</span></div>
<div class="line"><span class="stringliteral">    myBounds = myAnchoredFrame.GeometricBounds</span></div>
<div class="line"><span class="stringliteral">    Rem Set the width and height of the inline frame. In this example, we&#39;</span>ll</div>
<div class="line">    Rem make the frame 24 points tall by 72 points wide.</div>
<div class="line">    myArray = Array(myBounds(0), myBounds(1), myBounds(0) + 24, myBounds(1) + 72)</div>
<div class="line">    myAnchoredFrame.GeometricBounds = myArray</div>
<div class="line">    myAnchoredFrame.Contents = &quot;This is an anchored frame.&quot;</div>
<div class="line">    With myAnchoredFrame.AnchoredObjectSettings</div>
<div class="line">        .AnchoredPosition = idAnchorPosition.idAnchored</div>
<div class="line">        .AnchorPoint = idAnchorPoint.idTopLeftAnchor</div>
<div class="line">        .HorizontalReferencePoint = idAnchoredRelativeTo.idAnchorLocation</div>
<div class="line">        .HorizontalAlignment = idHorizontalAlignment.idLeftAlign</div>
<div class="line">        .AnchorXoffset = 72</div>
<div class="line">        .VerticalReferencePoint = idVerticallyRelativeTo.idLineBaseline</div>
<div class="line">        .AnchorYoffset = 24</div>
<div class="line">        .AnchorSpaceAbove = 24</div>
<div class="line">    End With</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_fitting_text_frames_to_content"></a>
Fitting text frames to content</h3>
<p>The following example script shows how to set rules on a text frame to determine how it grows when the user inputs text (for the complete script, see PersistedTextFrameFill): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.item(1)</div>
<div class="line">    Set myTextFrame = myDocument.Pages.item(1).TextFrames.item(4)</div>
<div class="line">    REM Now add text at the end of the text frame.</div>
<div class="line">    myTextFrame.InsertionPoints.item(-1).Contents = vbCr&amp;<span class="stringliteral">&quot;This is some overset text&quot;</span></div>
<div class="line">    MsgBox(<span class="stringliteral">&quot;The last paragraph in this alert should be &quot;</span><span class="stringliteral">&quot;This is some overset text&quot;</span><span class="stringliteral">&quot;. Is it?&quot;</span> &amp; _</div>
<div class="line">        vbCr&amp;myTextFrame.Contents)</div>
<div class="line">    MsgBox(<span class="stringliteral">&quot;The last paragraph in this alert should be &quot;</span><span class="stringliteral">&quot;This is some overset text&quot;</span><span class="stringliteral">&quot;. Is it?&quot;</span> &amp; _</div>
<div class="line">        vbCr&amp;myTextFrame.ParentStory.Contents)</div>
<div class="line">    Set myTextFrame2 = myDocument.Pages.item(1).TextFrames.item(3)</div>
<div class="line">    REM Set <span class="keyword">auto</span> size type of the text frame</div>
<div class="line">    with myTextFrame2.TextFramePreferences</div>
<div class="line">        .AutoSizingType=idAutoSizingType.idHEIGHTANDWIDTHPROPORTIONALLY</div>
<div class="line">    End With</div>
<div class="line">    REM Now add text at the end of the text frame.</div>
<div class="line">    myTextFrame2.InsertionPoints.item(-1).Contents = vbCr&amp;<span class="stringliteral">&quot;This is some overset text&quot;</span></div>
<div class="line">    Set myTextFrame3 = myDocument.Pages.item(1).TextFrames.item(2)</div>
<div class="line">    REM Set <span class="keyword">auto</span> size type of the text frame </div>
<div class="line">    REM useMinimumHeightForAutoSizing and useNoLineBreaksForAutoSizing</div>
<div class="line">    with myTextFrame3.TextFramePreferences</div>
<div class="line">        .AutoSizingType=idAutoSizingType.idHEIGHTONLY</div>
<div class="line">        .UseMinimumHeightForAutoSizing=<span class="keyword">true</span></div>
<div class="line">        .UseNoLineBreaksForAutoSizing=<span class="keyword">true</span></div>
<div class="line">    End With</div>
<div class="line">    REM Now add text at the end of the text frame.</div>
<div class="line">    myTextFrame3.InsertionPoints.item(-1).Contents = vbCr&amp;<span class="stringliteral">&quot;This is some overset text&quot;</span>  </div>
<div class="line">    Set myTextFrame4 = myDocument.Pages.item(1).TextFrames.item(1)</div>
<div class="line">    REM Set <span class="keyword">auto</span> size type of the text frame and autoSizingReferencePoint</div>
<div class="line">    with myTextFrame4.TextFramePreferences</div>
<div class="line">        .AutoSizingType=idAutoSizingType.idWIDTHONLY</div>
<div class="line">        .AutoSizingReferencePoint=idAutoSizingReferencePoint.idTOPLEFTPOSITION</div>
<div class="line">    End With</div>
<div class="line">    REM Now add text at the end of the text frame.</div>
<div class="line">    myTextFrame4.InsertionPoints.item(-1).Contents = vbCr&amp;<span class="stringliteral">&quot;This is some overset text&quot;</span></div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_formatting_text"></a>
Formatting Text</h2>
<p>In the previous sections of this chapter, we added text to a document, linked text frames, and worked with stories and text objects. In this section, we apply formatting to text. All the typesetting capabilities of InDesign are available to scripting.</p>
<h3><a class="anchor" id="id_vb_setting_text_defaults"></a>
Setting text defaults</h3>
<p>You can set text defaults for both the application and each document. Text defaults for the application determine the text defaults in all new documents; text defaults for a document set the formatting of all new text objects in that document. (For the complete script, see TextDefaults.) </p>
<div class="fragment"><div class="line">    With myInDesign.TextDefaults</div>
<div class="line">        .AlignToBaseline = True</div>
<div class="line">        Rem Because the font might not be available, it<span class="stringliteral">&#39;s usually best</span></div>
<div class="line"><span class="stringliteral">        Rem to trap errors using &quot;On Error Resume Next&quot; error handling.</span></div>
<div class="line"><span class="stringliteral">        Rem Fill in the name of a font on your system.</span></div>
<div class="line"><span class="stringliteral">        Err.Clear</span></div>
<div class="line"><span class="stringliteral">        On Error Resume Next</span></div>
<div class="line"><span class="stringliteral">        .AppliedFont = myInDesign.Fonts.Item(&quot;Minion Pro&quot;)</span></div>
<div class="line"><span class="stringliteral">        If Err.Number &lt;&gt; 0 Then</span></div>
<div class="line"><span class="stringliteral">            Err.Clear</span></div>
<div class="line"><span class="stringliteral">        End If</span></div>
<div class="line"><span class="stringliteral">        On Error GoTo 0</span></div>
<div class="line"><span class="stringliteral">        Rem Because the font style might not be available, it&#39;</span>s usually best</div>
<div class="line">        Rem to trap errors <span class="keyword">using</span> <span class="stringliteral">&quot;On Error Resume Next&quot;</span> error handling.</div>
<div class="line">        Err.Clear</div>
<div class="line">        On Error Resume Next</div>
<div class="line">            .FontStyle = <span class="stringliteral">&quot;Regular&quot;</span></div>
<div class="line">        If Err.Number &lt;&gt; 0 Then</div>
<div class="line">            Err.Clear</div>
<div class="line">        End If</div>
<div class="line">        On Error GoTo 0 </div>
<div class="line">        Rem Because the language might not be available, it<span class="stringliteral">&#39;s usually best</span></div>
<div class="line"><span class="stringliteral">        Rem to trap errors using &quot;On Error Resume Next&quot; error handling.</span></div>
<div class="line"><span class="stringliteral">        Err.Clear</span></div>
<div class="line"><span class="stringliteral">        On Error Resume Next</span></div>
<div class="line"><span class="stringliteral">        .AppliedLanguage = &quot;English: USA&quot;</span></div>
<div class="line"><span class="stringliteral">        If Err.Number &lt;&gt; 0 Then</span></div>
<div class="line"><span class="stringliteral">            Err.Clear</span></div>
<div class="line"><span class="stringliteral">        End If</span></div>
<div class="line"><span class="stringliteral">        On Error GoTo 0</span></div>
<div class="line"><span class="stringliteral">        .AutoLeading = 100</span></div>
<div class="line"><span class="stringliteral">        .BalanceRaggedLines = False</span></div>
<div class="line"><span class="stringliteral">        .BaselineShift = 0</span></div>
<div class="line"><span class="stringliteral">        .Capitalization = idCapitalization.idNormal</span></div>
<div class="line"><span class="stringliteral">        .Composer = &quot;Adobe Paragraph Composer&quot;</span></div>
<div class="line"><span class="stringliteral">        .DesiredGlyphScaling = 100</span></div>
<div class="line"><span class="stringliteral">        .DesiredLetterSpacing = 0</span></div>
<div class="line"><span class="stringliteral">        .DesiredWordSpacing = 100</span></div>
<div class="line"><span class="stringliteral">        .DropCapCharacters = 0</span></div>
<div class="line"><span class="stringliteral">        If .DropCapCharacters &lt;&gt; 0 Then</span></div>
<div class="line"><span class="stringliteral">            .DropCapLines = 3</span></div>
<div class="line"><span class="stringliteral">            On Error Resume Next</span></div>
<div class="line"><span class="stringliteral">            .DropCapStyle = myInDesign.CharacterStyles.Item(&quot;myDropCap&quot;)</span></div>
<div class="line"><span class="stringliteral">            If Err.Number &lt;&gt; 0 Then</span></div>
<div class="line"><span class="stringliteral">                Err.Clear</span></div>
<div class="line"><span class="stringliteral">            End If</span></div>
<div class="line"><span class="stringliteral">            On Error GoTo 0         </span></div>
<div class="line"><span class="stringliteral">        End If</span></div>
<div class="line"><span class="stringliteral">        On Error Resume Next</span></div>
<div class="line"><span class="stringliteral">        .FillColor = myInDesign.Colors.Item(&quot;Black&quot;)</span></div>
<div class="line"><span class="stringliteral">        If Err.Number &lt;&gt; 0 Then</span></div>
<div class="line"><span class="stringliteral">            Err.Clear</span></div>
<div class="line"><span class="stringliteral">        End If</span></div>
<div class="line"><span class="stringliteral">        On Error GoTo 0     </span></div>
<div class="line"><span class="stringliteral">        .FillTint = 100</span></div>
<div class="line"><span class="stringliteral">        .FirstLineIndent = 14</span></div>
<div class="line"><span class="stringliteral">        .GridAlignFirstLineOnly = False</span></div>
<div class="line"><span class="stringliteral">        .HorizontalScale = 100</span></div>
<div class="line"><span class="stringliteral">        .HyphenateAfterFirst = 3</span></div>
<div class="line"><span class="stringliteral">        .HyphenateBeforeLast = 4</span></div>
<div class="line"><span class="stringliteral">        .HyphenateCapitalizedWords = False</span></div>
<div class="line"><span class="stringliteral">        .HyphenateLadderLimit = 1</span></div>
<div class="line"><span class="stringliteral">        .HyphenateWordsLongerThan = 5</span></div>
<div class="line"><span class="stringliteral">        .Hyphenation = True</span></div>
<div class="line"><span class="stringliteral">        .HyphenationZone = 36</span></div>
<div class="line"><span class="stringliteral">        .HyphenWeight = 9</span></div>
<div class="line"><span class="stringliteral">        .Justification = idJustification.idLeftAlign</span></div>
<div class="line"><span class="stringliteral">        .KeepAllLinesTogether = False</span></div>
<div class="line"><span class="stringliteral">        .KeepLinesTogether = True</span></div>
<div class="line"><span class="stringliteral">        .KeepFirstLines = 2</span></div>
<div class="line"><span class="stringliteral">        .KeepLastLines = 2</span></div>
<div class="line"><span class="stringliteral">        .KeepWithNext = 0</span></div>
<div class="line"><span class="stringliteral">        .KerningMethod = &quot;Optical&quot;</span></div>
<div class="line"><span class="stringliteral">        .Leading = 14</span></div>
<div class="line"><span class="stringliteral">        .LeftIndent = 0</span></div>
<div class="line"><span class="stringliteral">        .Ligatures = True</span></div>
<div class="line"><span class="stringliteral">        .MaximumGlyphScaling = 100</span></div>
<div class="line"><span class="stringliteral">        .MaximumLetterSpacing = 0</span></div>
<div class="line"><span class="stringliteral">        .MaximumWordSpacing = 160</span></div>
<div class="line"><span class="stringliteral">        .MinimumGlyphScaling = 100</span></div>
<div class="line"><span class="stringliteral">        .MinimumLetterSpacing = 0</span></div>
<div class="line"><span class="stringliteral">        .MinimumWordSpacing = 80</span></div>
<div class="line"><span class="stringliteral">        .NoBreak = False</span></div>
<div class="line"><span class="stringliteral">        .OTFContextualAlternate = True</span></div>
<div class="line"><span class="stringliteral">        .OTFDiscretionaryLigature = True</span></div>
<div class="line"><span class="stringliteral">        .OTFFigureStyle = idOTFFigureStyle.idProportionalOldstyle</span></div>
<div class="line"><span class="stringliteral">        .OTFFraction = True</span></div>
<div class="line"><span class="stringliteral">        .OTFHistorical = True</span></div>
<div class="line"><span class="stringliteral">        .OTFOrdinal = False</span></div>
<div class="line"><span class="stringliteral">        .OTFSlashedZero = True</span></div>
<div class="line"><span class="stringliteral">        .OTFSwash = False</span></div>
<div class="line"><span class="stringliteral">        .OTFTitling = False</span></div>
<div class="line"><span class="stringliteral">        .OverprintFill = False</span></div>
<div class="line"><span class="stringliteral">        .OverprintStroke = False</span></div>
<div class="line"><span class="stringliteral">        .PointSize = 11</span></div>
<div class="line"><span class="stringliteral">        .Position = idPosition.idNormal</span></div>
<div class="line"><span class="stringliteral">        .RightIndent = 0</span></div>
<div class="line"><span class="stringliteral">        .RuleAbove = False</span></div>
<div class="line"><span class="stringliteral">        If .RuleAbove = True Then</span></div>
<div class="line"><span class="stringliteral">            On Error Resume Next</span></div>
<div class="line"><span class="stringliteral">            .RuleAboveColor = myInDesign.Colors.Item(&quot;Black&quot;)</span></div>
<div class="line"><span class="stringliteral">            If Err.Number &lt;&gt; 0 Then</span></div>
<div class="line"><span class="stringliteral">                Err.Clear</span></div>
<div class="line"><span class="stringliteral">            End If</span></div>
<div class="line"><span class="stringliteral">            On Error GoTo 0</span></div>
<div class="line"><span class="stringliteral">            On Error Resume Next</span></div>
<div class="line"><span class="stringliteral">            .RuleAboveGapColor = myInDesign.Swatches.Item(&quot;None&quot;)</span></div>
<div class="line"><span class="stringliteral">            If Err.Number &lt;&gt; 0 Then</span></div>
<div class="line"><span class="stringliteral">                Err.Clear</span></div>
<div class="line"><span class="stringliteral">            End If</span></div>
<div class="line"><span class="stringliteral">            On Error GoTo 0         </span></div>
<div class="line"><span class="stringliteral">            .RuleAboveGapOverprint = False</span></div>
<div class="line"><span class="stringliteral">            .RuleAboveGapTint = 100</span></div>
<div class="line"><span class="stringliteral">            .RuleAboveLeftIndent = 0</span></div>
<div class="line"><span class="stringliteral">            .RuleAboveLineWeight = 0.25</span></div>
<div class="line"><span class="stringliteral">            .RuleAboveOffset = 14</span></div>
<div class="line"><span class="stringliteral">            .RuleAboveOverprint = False</span></div>
<div class="line"><span class="stringliteral">            .RuleAboveRightIndent = 0</span></div>
<div class="line"><span class="stringliteral">            .RuleAboveTint = 100</span></div>
<div class="line"><span class="stringliteral">            On Error Resume Next</span></div>
<div class="line"><span class="stringliteral">            .RuleAboveType = myInDesign.StrokeStyles.Item(&quot;Solid&quot;)</span></div>
<div class="line"><span class="stringliteral">            If Err.Number &lt;&gt; 0 Then</span></div>
<div class="line"><span class="stringliteral">                Err.Clear</span></div>
<div class="line"><span class="stringliteral">            End If</span></div>
<div class="line"><span class="stringliteral">            On Error GoTo 0         </span></div>
<div class="line"><span class="stringliteral">            .RuleAboveWidth = idRuleWidth.idColumnWidth</span></div>
<div class="line"><span class="stringliteral">        End If</span></div>
<div class="line"><span class="stringliteral">        .RuleBelow = False</span></div>
<div class="line"><span class="stringliteral">        If .RuleBelow = True Then</span></div>
<div class="line"><span class="stringliteral">            On Error Resume Next</span></div>
<div class="line"><span class="stringliteral">            .RuleBelowColor = myInDesign.Colors.Item(&quot;Black&quot;)</span></div>
<div class="line"><span class="stringliteral">            If Err.Number &lt;&gt; 0 Then</span></div>
<div class="line"><span class="stringliteral">                Err.Clear</span></div>
<div class="line"><span class="stringliteral">            End If</span></div>
<div class="line"><span class="stringliteral">            On Error GoTo 0         </span></div>
<div class="line"><span class="stringliteral">            On Error Resume Next</span></div>
<div class="line"><span class="stringliteral">            .RuleBelowGapColor = myInDesign.Swatches.Item(&quot;None&quot;)</span></div>
<div class="line"><span class="stringliteral">            If Err.Number &lt;&gt; 0 Then</span></div>
<div class="line"><span class="stringliteral">                Err.Clear</span></div>
<div class="line"><span class="stringliteral">            End If</span></div>
<div class="line"><span class="stringliteral">            On Error GoTo 0         </span></div>
<div class="line"><span class="stringliteral">            .RuleBelowGapOverPrint = False</span></div>
<div class="line"><span class="stringliteral">            .RuleBelowGapTint = 100</span></div>
<div class="line"><span class="stringliteral">            .RuleBelowLeftIndent = 0</span></div>
<div class="line"><span class="stringliteral">            .RuleBelowLineWeight = 0.25</span></div>
<div class="line"><span class="stringliteral">            .RuleBelowOffset = 0</span></div>
<div class="line"><span class="stringliteral">            .RuleBelowOverPrint = False</span></div>
<div class="line"><span class="stringliteral">            .RuleBelowRightIndent = 0</span></div>
<div class="line"><span class="stringliteral">            .RuleBelowTint = 100</span></div>
<div class="line"><span class="stringliteral">            On Error Resume Next</span></div>
<div class="line"><span class="stringliteral">            .RuleBelowType = myInDesign.StrokeStyles.Item(&quot;Solid&quot;)</span></div>
<div class="line"><span class="stringliteral">            If Err.Number &lt;&gt; 0 Then</span></div>
<div class="line"><span class="stringliteral">                Err.Clear</span></div>
<div class="line"><span class="stringliteral">            End If</span></div>
<div class="line"><span class="stringliteral">            On Error GoTo 0         </span></div>
<div class="line"><span class="stringliteral">            .RuleBelowWidth = idRuleWidth.idColumnWidth</span></div>
<div class="line"><span class="stringliteral">        End If</span></div>
<div class="line"><span class="stringliteral">        .SingleWordJustification = idSingleWordJustification.idLeftAlign</span></div>
<div class="line"><span class="stringliteral">        .Skew = 0</span></div>
<div class="line"><span class="stringliteral">        .SpaceAfter = 0</span></div>
<div class="line"><span class="stringliteral">        .SpaceBefore = 0</span></div>
<div class="line"><span class="stringliteral">        .StartParagraph = idStartParagraph.idAnywhere</span></div>
<div class="line"><span class="stringliteral">        .StrikeThru = False</span></div>
<div class="line"><span class="stringliteral">        If .StrikeThru = True Then</span></div>
<div class="line"><span class="stringliteral">            On Error Resume Next</span></div>
<div class="line"><span class="stringliteral">            .StrikeThroughColor = myInDesign.Colors.Item(&quot;Black&quot;)</span></div>
<div class="line"><span class="stringliteral">            If Err.Number &lt;&gt; 0 Then</span></div>
<div class="line"><span class="stringliteral">                Err.Clear</span></div>
<div class="line"><span class="stringliteral">            End If</span></div>
<div class="line"><span class="stringliteral">            On Error GoTo 0         </span></div>
<div class="line"><span class="stringliteral">            On Error Resume Next</span></div>
<div class="line"><span class="stringliteral">            .StrikeThroughGapColor = myInDesign.Swatches.Item(&quot;None&quot;)</span></div>
<div class="line"><span class="stringliteral">            If Err.Number &lt;&gt; 0 Then</span></div>
<div class="line"><span class="stringliteral">                Err.Clear</span></div>
<div class="line"><span class="stringliteral">            End If</span></div>
<div class="line"><span class="stringliteral">            On Error GoTo 0         </span></div>
<div class="line"><span class="stringliteral">            .StrikeThroughGapOverprint = False</span></div>
<div class="line"><span class="stringliteral">            .StrikeThroughGapTint = 100</span></div>
<div class="line"><span class="stringliteral">            .StrikeThroughOffset = 3</span></div>
<div class="line"><span class="stringliteral">            .StrikeThroughOverprint = False</span></div>
<div class="line"><span class="stringliteral">            .StrikeThroughTint = 100</span></div>
<div class="line"><span class="stringliteral">            On Error Resume Next</span></div>
<div class="line"><span class="stringliteral">            .StrikeThroughType = myInDesign.StrokeStyles.Item(&quot;Solid&quot;)</span></div>
<div class="line"><span class="stringliteral">            If Err.Number &lt;&gt; 0 Then</span></div>
<div class="line"><span class="stringliteral">                Err.Clear</span></div>
<div class="line"><span class="stringliteral">            End If</span></div>
<div class="line"><span class="stringliteral">            On Error GoTo 0         </span></div>
<div class="line"><span class="stringliteral">            .StrikeThroughWeight = 0.25</span></div>
<div class="line"><span class="stringliteral">        End If</span></div>
<div class="line"><span class="stringliteral">        On Error Resume Next</span></div>
<div class="line"><span class="stringliteral">        .StrokeColor = myInDesign.Swatches.Item(&quot;None&quot;)</span></div>
<div class="line"><span class="stringliteral">        If Err.Number &lt;&gt; 0 Then</span></div>
<div class="line"><span class="stringliteral">            Err.Clear</span></div>
<div class="line"><span class="stringliteral">        End If</span></div>
<div class="line"><span class="stringliteral">        On Error GoTo 0         </span></div>
<div class="line"><span class="stringliteral">        .StrokeTint = 100</span></div>
<div class="line"><span class="stringliteral">        .StrokeWeight = 0</span></div>
<div class="line"><span class="stringliteral">        .Tracking = 0</span></div>
<div class="line"><span class="stringliteral">        .Underline = False</span></div>
<div class="line"><span class="stringliteral">        If .Underline = True Then</span></div>
<div class="line"><span class="stringliteral">            On Error Resume Next</span></div>
<div class="line"><span class="stringliteral">            .UnderlineColor = myInDesign.Colors.Item(&quot;Black&quot;)</span></div>
<div class="line"><span class="stringliteral">            If Err.Number &lt;&gt; 0 Then</span></div>
<div class="line"><span class="stringliteral">                Err.Clear</span></div>
<div class="line"><span class="stringliteral">            End If</span></div>
<div class="line"><span class="stringliteral">            On Error GoTo 0         </span></div>
<div class="line"><span class="stringliteral">            On Error Resume Next</span></div>
<div class="line"><span class="stringliteral">            .UnderlineGapColor = myInDesign.Swatches.Item(&quot;None&quot;)</span></div>
<div class="line"><span class="stringliteral">            If Err.Number &lt;&gt; 0 Then</span></div>
<div class="line"><span class="stringliteral">                Err.Clear</span></div>
<div class="line"><span class="stringliteral">            End If</span></div>
<div class="line"><span class="stringliteral">            On Error GoTo 0         </span></div>
<div class="line"><span class="stringliteral">            .UnderlineGapOverprint = False</span></div>
<div class="line"><span class="stringliteral">            .UnderlineGapTint = 100</span></div>
<div class="line"><span class="stringliteral">            .UnderlineOffset = 3</span></div>
<div class="line"><span class="stringliteral">            .UnderlineOverprint = False</span></div>
<div class="line"><span class="stringliteral">            .UnderlineTint = 100</span></div>
<div class="line"><span class="stringliteral">            On Error Resume Next</span></div>
<div class="line"><span class="stringliteral">            .UnderlineType = myInDesign.StrokeStyles.Item(&quot;Solid&quot;)</span></div>
<div class="line"><span class="stringliteral">            If Err.Number &lt;&gt; 0 Then</span></div>
<div class="line"><span class="stringliteral">                Err.Clear</span></div>
<div class="line"><span class="stringliteral">            End If</span></div>
<div class="line"><span class="stringliteral">            On Error GoTo 0         </span></div>
<div class="line"><span class="stringliteral">            .UnderlineWeight = 0.25</span></div>
<div class="line"><span class="stringliteral">        End If</span></div>
<div class="line"><span class="stringliteral">        .VerticalScale = 100</span></div>
<div class="line"><span class="stringliteral">    End With</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_working_with_fonts"></a>
Working with fonts</h3>
<p>The fonts collection of the InDesign application object contains all fonts accessible to InDesign. The fonts collection of a document, by contrast, contains only those fonts used in the document. The fonts collection of a document also contains any missing fonts-fonts used in the document that are not accessible to InDesign. The following script shows the difference between application fonts and document fonts. (We omitted the myGetBounds function here; for the complete script, see FontCollections.) </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    Set myApplicationFonts = myInDesign.Fonts</div>
<div class="line">    myString = <span class="stringliteral">&quot;Document Fonts:&quot;</span> &amp; vbCr</div>
<div class="line">    For myCounter = 1 To myDocument.Fonts.Count</div>
<div class="line">        myString = myString &amp; myDocument.Fonts.Item(myCounter).Name &amp; vbCr</div>
<div class="line">    Next</div>
<div class="line">    myString = myString &amp; vbCr &amp; <span class="stringliteral">&quot;Application Fonts:&quot;</span> &amp; vbCr</div>
<div class="line">    For myCounter = 1 To myInDesign.Fonts.Count</div>
<div class="line">        myString = myString &amp; myInDesign.Fonts.Item(myCounter) &amp; vbCr</div>
<div class="line">    Next</div>
<div class="line">    Set myTextFrame = myPage.TextFrames.Item(1)</div>
<div class="line">    Set myStory = myTextFrame.ParentStory</div>
<div class="line">    myStory.Contents = myString</div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>Font names typically are of the form familyName &lt;tab&gt; fontStyle, where familyName is the name of the font family,&lt;tab&gt; is a tab character, and fontStyle is the name of the font style. For example: "Adobe Caslon Pro \&lt;tab\&gt; Semibold Italic"</dd></dl>
<h3><a class="anchor" id="id_vb_applying_a_font"></a>
Applying a font</h3>
<p>To apply a local font change to a range of text, use the appliedFont property, as shown in the following script fragment (from the ApplyFont tutorial script): </p>
<div class="fragment"><div class="line">Rem Given a font name <span class="stringliteral">&quot;myFontName&quot;</span> and a text <span class="keywordtype">object</span> <span class="stringliteral">&quot;myText&quot;</span>...</div>
<div class="line">myText.AppliedFont = myInDesign.Fonts.Item(myFontName)</div>
</div><!-- fragment --><p>You also can apply a font by specifying the font family name and font style, as shown in the following script fragment: </p>
<div class="fragment"><div class="line">myText.AppliedFont = myInDesign.Fonts.Item(<span class="stringliteral">&quot;Adobe Caslon Pro&quot;</span>)</div>
<div class="line">myText.FontStyle = <span class="stringliteral">&quot;Semibold Italic&quot;</span></div>
</div><!-- fragment --><h3><a class="anchor" id="id_vb_changing_text_properties"></a>
Changing text properties</h3>
<p>Text objects in InDesign have literally dozens of properties corresponding to their formatting attributes. Even one insertion point features properties that affect the formatting of text-up to and including properties of the paragraph containing the insertion point. The SetTextProperties tutorial script shows how to set every property of a text object. A fragment of the script is shown below: </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    Set myStory = myDocument.Stories.Item(1)</div>
<div class="line">    Set myTextObject = myStory.Characters.Item(1)</div>
<div class="line">    myFontName = <span class="stringliteral">&quot;Minion Pro&quot;</span> &amp; vbTab &amp; <span class="stringliteral">&quot;Regular&quot;</span></div>
<div class="line">    With myTextObject</div>
<div class="line">        .AlignToBaseline = False</div>
<div class="line">        .AppliedCharacterStyle = myDocument.CharacterStyles.Item(<span class="stringliteral">&quot;[None]&quot;</span>)</div>
<div class="line">        On Error Resume Next</div>
<div class="line">        .AppliedFont = myInDesign.Fonts.Item(myFontName)</div>
<div class="line">        .FontStyle = <span class="stringliteral">&quot;Regular&quot;</span></div>
<div class="line">        If Err.Number &lt;&gt; 0 Then</div>
<div class="line">            Err.Clear</div>
<div class="line">        End If</div>
<div class="line">        On Error Goto 0</div>
<div class="line">        .AppliedLanguage = myInDesign.LanguagesWithVendors.Item(<span class="stringliteral">&quot;English: USA&quot;</span>)</div>
<div class="line">        .AppliedNumberingList = myDocument.NumberingLists.Item(<span class="stringliteral">&quot;[Default]&quot;</span>)</div>
<div class="line">        .AppliedParagraphStyle = myDocument.ParagraphStyles.Item(<span class="stringliteral">&quot;[No Paragraph Style]&quot;</span>)</div>
<div class="line">        .AutoLeading = 120</div>
<div class="line">        .BalanceRaggedLines = idBalanceLinesStyle.idNoBalancing</div>
<div class="line">        .BaselineShift = 0</div>
<div class="line">        .BulletsAlignment = idListAlignment.idLeftAlign</div>
<div class="line">        .BulletsAndNumberingListType = idListType.idNoList</div>
<div class="line">        .BulletsCharacterStyle = myDocument.CharacterStyles.Item(<span class="stringliteral">&quot;[None]&quot;</span>)</div>
<div class="line">        .BulletsTextAfter = <span class="stringliteral">&quot;^t&quot;</span></div>
<div class="line">        .Capitalization = idCapitalization.idNormal</div>
<div class="line">        .Composer = <span class="stringliteral">&quot;Adobe Paragraph Composer&quot;</span></div>
<div class="line">        .DesiredGlyphScaling = 100</div>
<div class="line">        .DesiredLetterSpacing = 0</div>
<div class="line">        .DesiredWordSpacing = 100</div>
<div class="line">        .DropCapCharacters = 0</div>
<div class="line">        .DropCapLines = 0</div>
<div class="line">        .DropCapStyle = myDocument.CharacterStyles.Item(<span class="stringliteral">&quot;[None]&quot;</span>)</div>
<div class="line">        .DropcapDetail = 0</div>
<div class="line">        .FillColor = myDocument.Colors.Item(<span class="stringliteral">&quot;Black&quot;</span>)</div>
<div class="line">        .FillTint = -1</div>
<div class="line">        .FirstLineIndent = 0</div>
<div class="line">        .GradientFillAngle = 0</div>
<div class="line">        .GradientFillLength = -1</div>
<div class="line">        .GradientFillStart = Array(0, 0)</div>
<div class="line">        .GradientStrokeAngle = 0</div>
<div class="line">        .GradientStrokeLength = -1</div>
<div class="line">        .GradientStrokeStart = Array(0, 0)</div>
<div class="line">        .GridAlignFirstLineOnly = False</div>
<div class="line">        .HorizontalScale = 100</div>
<div class="line">        .HyphenWeight = 5</div>
<div class="line">        .HyphenateAcrossColumns = True</div>
<div class="line">        .HyphenateAfterFirst = 2</div>
<div class="line">        .HyphenateBeforeLast = 2</div>
<div class="line">        .HyphenateCapitalizedWords = True</div>
<div class="line">        .HyphenateLadderLimit = 3</div>
<div class="line">        .HyphenateLastWord = True</div>
<div class="line">        .HyphenateWordsLongerThan = 5</div>
<div class="line">        .Hyphenation = True</div>
<div class="line">        .HyphenationZone = 3</div>
<div class="line">        .IgnoreEdgeAlignment = False</div>
<div class="line">        .Justification = idJustification.idLeftAlign</div>
<div class="line">        .KeepAllLinesTogether = False</div>
<div class="line">        .KeepFirstLines = 2</div>
<div class="line">        .KeepLastLines = 2</div>
<div class="line">        .KeepLinesTogether = False</div>
<div class="line">        .KeepRuleAboveInFrame = False</div>
<div class="line">        .KeepWithNext = 0</div>
<div class="line">        .KerningMethod = <span class="stringliteral">&quot;Optical&quot;</span></div>
<div class="line">        .LastLineIndent = 0</div>
<div class="line">        .Leading = 12</div>
<div class="line">        .LeftIndent = 0</div>
<div class="line">        .Ligatures = True</div>
<div class="line">        .MaximumGlyphScaling = 100</div>
<div class="line">        .MaximumLetterSpacing = 0</div>
<div class="line">        .MaximumWordSpacing = 133</div>
<div class="line">        .MinimumGlyphScaling = 100</div>
<div class="line">        .MinimumLetterSpacing = 0</div>
<div class="line">        .MinimumWordSpacing = 80</div>
<div class="line">        .NoBreak = False</div>
<div class="line">        .NumberingAlignment = idListAlignment.idLeftAlign</div>
<div class="line">        .NumberingApplyRestartPolicy = True</div>
<div class="line">        .NumberingCharacterStyle = myDocument.CharacterStyles.Item(<span class="stringliteral">&quot;[None]&quot;</span>)</div>
<div class="line">        .NumberingContinue = True</div>
<div class="line">        .NumberingExpression = <span class="stringliteral">&quot;^#.^t&quot;</span></div>
<div class="line">        .NumberingFormat = <span class="stringliteral">&quot;1, 2, 3, 4...&quot;</span></div>
<div class="line">        .NumberingLevel = 1</div>
<div class="line">        .NumberingStartAt = 1</div>
<div class="line">        .OTFContextualAlternate = True</div>
<div class="line">        .OTFDiscretionaryLigature = False</div>
<div class="line">        .OTFFigureStyle = idOTFFigureStyle.idProportionalLining</div>
<div class="line">        .OTFFraction = False</div>
<div class="line">        .OTFHistorical = False</div>
<div class="line">        .OTFLocale = True</div>
<div class="line">        .OTFMark = True</div>
<div class="line">        .OTFOrdinal = False</div>
<div class="line">        .OTFSlashedZero = False</div>
<div class="line">        .OTFStylisticSets = 0</div>
<div class="line">        .OTFSwash = False</div>
<div class="line">        .OTFTitling = False</div>
<div class="line">        .OverprintFill = False</div>
<div class="line">        .OverprintStroke = False</div>
<div class="line">        .PointSize = 12</div>
<div class="line">        .Position = idPosition.idNormal</div>
<div class="line">        .PositionalForm = idPositionalForms.idNone</div>
<div class="line">        .RightIndent = 0</div>
<div class="line">        .RuleAbove = False</div>
<div class="line">        .RuleAboveColor = <span class="stringliteral">&quot;Text Color&quot;</span></div>
<div class="line">        .RuleAboveGapColor = myDocument.Swatches.Item(<span class="stringliteral">&quot;None&quot;</span>)</div>
<div class="line">        .RuleAboveGapOverprint = False</div>
<div class="line">        .RuleAboveGapTint = -1</div>
<div class="line">        .RuleAboveLeftIndent = 0</div>
<div class="line">        .RuleAboveLineWeight = 1</div>
<div class="line">        .RuleAboveOffset = 0</div>
<div class="line">        .RuleAboveOverprint = False</div>
<div class="line">        .RuleAboveRightIndent = 0</div>
<div class="line">        .RuleAboveTint = -1</div>
<div class="line">        .RuleAboveType = myDocument.StrokeStyles.Item(<span class="stringliteral">&quot;Solid&quot;</span>)</div>
<div class="line">        .RuleAboveWidth = idRuleWidth.idColumnWidth</div>
<div class="line">        .RuleBelow = False</div>
<div class="line">        .RuleBelowColor = <span class="stringliteral">&quot;Text Color&quot;</span></div>
<div class="line">        .RuleBelowGapColor = myDocument.Swatches.Item(<span class="stringliteral">&quot;None&quot;</span>)</div>
<div class="line">        .RuleBelowGapOverprint = False</div>
<div class="line">        .RuleBelowGapTint = -1</div>
<div class="line">        .RuleBelowLeftIndent = 0</div>
<div class="line">        .RuleBelowLineWeight = 1</div>
<div class="line">        .RuleBelowOffset = 0</div>
<div class="line">        .RuleBelowOverprint = False</div>
<div class="line">        .RuleBelowRightIndent = 0</div>
<div class="line">        .RuleBelowTint = -1</div>
<div class="line">        .RuleBelowType = myDocument.StrokeStyles.Item(<span class="stringliteral">&quot;Solid&quot;</span>)</div>
<div class="line">        .RuleBelowWidth = idRuleWidth.idColumnWidth</div>
<div class="line">        .SingleWordJustification = idSingleWordJustification.idLeftAlign</div>
<div class="line">        .Skew = 0</div>
<div class="line">        .SpaceAfter = 0</div>
<div class="line">        .SpaceBefore = 0</div>
<div class="line">        .StartParagraph = idStartParagraph.idAnywhere</div>
<div class="line">        .StrikeThroughColor = <span class="stringliteral">&quot;Text Color&quot;</span></div>
<div class="line">        .StrikeThroughGapColor = myDocument.Swatches.Item(<span class="stringliteral">&quot;None&quot;</span>)</div>
<div class="line">        .StrikeThroughGapOverprint = False</div>
<div class="line">        .StrikeThroughGapTint = -1</div>
<div class="line">        .StrikeThroughOffset = -9999</div>
<div class="line">        .StrikeThroughOverprint = False</div>
<div class="line">        .StrikeThroughTint = -1</div>
<div class="line">        .StrikeThroughType = myDocument.StrokeStyles.Item(<span class="stringliteral">&quot;Solid&quot;</span>)</div>
<div class="line">        .StrikeThroughWeight = -9999</div>
<div class="line">        .StrikeThru = False</div>
<div class="line">        .StrokeColor = myDocument.Swatches.Item(<span class="stringliteral">&quot;None&quot;</span>)</div>
<div class="line">        .StrokeTint = -1</div>
<div class="line">        .StrokeWeight = 1</div>
<div class="line">        .Tracking = 0</div>
<div class="line">        .Underline = False</div>
<div class="line">        .UnderlineColor = <span class="stringliteral">&quot;Text Color&quot;</span></div>
<div class="line">        .UnderlineGapColor = myDocument.Swatches.Item(<span class="stringliteral">&quot;None&quot;</span>)</div>
<div class="line">        .UnderlineGapOverprint = False</div>
<div class="line">        .UnderlineGapTint = -1</div>
<div class="line">        .UnderlineOffset = -9999</div>
<div class="line">        .UnderlineOverprint = False</div>
<div class="line">        .UnderlineTint = -1</div>
<div class="line">        .UnderlineType = myDocument.StrokeStyles.Item(<span class="stringliteral">&quot;Solid&quot;</span>)</div>
<div class="line">        .UnderlineWeight = -9999</div>
<div class="line">        .VerticalScale = 100</div>
<div class="line">    End With</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_changing_text_color"></a>
Changing text color</h3>
<p>You can apply colors to the fill and stroke of text characters, as shown in the following script fragment (from the TextColors tutorial script): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myStory = myDocument.Stories.Item(1)</div>
<div class="line">    Rem Apply a color to the fill of the text.</div>
<div class="line">    Set myText = myStory.Paragraphs.Item(1)</div>
<div class="line">    myText.FillColor = myDocument.Colors.Item(<span class="stringliteral">&quot;DGC1_446a&quot;</span>)</div>
<div class="line">    Rem Use the itemByRange method to apply the color to the stroke of the text.</div>
<div class="line">    myText.StrokeColor = myDocument.Swatches.Item(<span class="stringliteral">&quot;DGC1_446b&quot;</span>)</div>
<div class="line">    Set myText = myStory.Paragraphs.Item(2)</div>
<div class="line">    myText.FillColor = myDocument.Swatches.Item(<span class="stringliteral">&quot;DGC1_446b&quot;</span>)</div>
<div class="line">    myText.StrokeColor = myDocument.Swatches.Item(<span class="stringliteral">&quot;DGC1_446a&quot;</span>)</div>
<div class="line">    myText.StrokeWeight = 3</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_creating_and_applying_styles"></a>
Creating and applying styles</h3>
<p>While you can use scripting to apply local formatting-as in some of the examples earlier in this section-you probably will want to use character and paragraph styles to format your text. Using styles creates a link between the formatted text and the style, which makes it easier to redefine the style, collect the text formatted with a given style, or find and/or change the text. Paragraph and character styles are the keys to text formatting productivity and should be a central part of any script that applies text formatting.</p>
<p>The following example script fragment shows how to create and apply paragraph and character styles (for the complete script, see CreateStyles): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    Set myTextFrame = myPage.TextFrames.Item(1)</div>
<div class="line">    Rem Create a color <span class="keywordflow">for</span> use by one of the paragraph styles we<span class="stringliteral">&#39;ll create.</span></div>
<div class="line"><span class="stringliteral">    Set myColor = myAddColor(myDocument, &quot;Red&quot;, idColorModel.idProcess, Array(0, 100, 100, 0))</span></div>
<div class="line"><span class="stringliteral">    Rem Create a character style named &quot;myCharacterStyle&quot; if</span></div>
<div class="line"><span class="stringliteral">    Rem no style by that name already exists.</span></div>
<div class="line"><span class="stringliteral">    Set myCharacterStyle = myAddStyle(myDocument, &quot;myCharacterStyle&quot;, 1)</span></div>
<div class="line"><span class="stringliteral">    Rem At this point, the variable myCharacterStyle contains a reference to a character</span></div>
<div class="line"><span class="stringliteral">    Rem style object, which you can now use to specify formatting.</span></div>
<div class="line"><span class="stringliteral">    myCharacterStyle.FillColor = myColor</span></div>
<div class="line"><span class="stringliteral">    Rem Create a paragraph style named &quot;myParagraphStyle&quot; if</span></div>
<div class="line"><span class="stringliteral">    Rem no style by that name already exists.</span></div>
<div class="line"><span class="stringliteral">    Set myParagraphStyle = myAddStyle(myDocument, &quot;myParagraphStyle&quot;, 2)</span></div>
<div class="line"><span class="stringliteral">    Rem At this point, the variable myParagraphStyle contains a reference to a paragraph</span></div>
<div class="line"><span class="stringliteral">    Rem style object, which you can now use to specify formatting.</span></div>
<div class="line"><span class="stringliteral">    myTextFrame.ParentStory.Texts.Item(1).ApplyParagraphStyle myParagraphStyle, True</span></div>
<div class="line"><span class="stringliteral">    Set myStartCharacter = myTextFrame.ParentStory.Characters.Item(14)</span></div>
<div class="line"><span class="stringliteral">    Set myEndCharacter = myTextFrame.ParentStory.Characters.Item(55)</span></div>
<div class="line"><span class="stringliteral">    Set myText = myTextFrame.ParentStory.Texts.ItemByRange(myStartCharacter, myEndCharacter)</span></div>
<div class="line"><span class="stringliteral">    myText.Item(1).ApplyCharacterStyle myCharacterStyle, True</span></div>
</div><!-- fragment --><p> Why use the applyParagraphStyle method instead of setting the appliedParagraphStyle property of the text object? The applyParagraphStyle method gives the ability to override existing formatting; setting the property to a style retains local formatting.</p>
<p>Why check for the existence of a style when creating a new document? It always is possible that the style exists as an application default style. If it does, trying to create a new style with the same name results in an error.</p>
<p>Nested styles apply character-style formatting to a paragraph according to a pattern. The following script fragment shows how to create a paragraph style containing nested styles (for the complete script, see NestedStyles): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    Set myParagraphStyle = myDocument.ParagraphStyles.Item(<span class="stringliteral">&quot;myParagraphStyle&quot;</span>)</div>
<div class="line">    Rem At <span class="keyword">this</span> point, the variable myParagraphStyle contains a reference to a paragraph</div>
<div class="line">    Rem style object, which you can now use to specify formatting.</div>
<div class="line">    Set myNestedStyle = myParagraphStyle.NestedStyles.Add</div>
<div class="line">    myNestedStyle.AppliedCharacterStyle = myDocument.CharacterStyles.Item(<span class="stringliteral">&quot;myCharacterStyle&quot;</span>)</div>
<div class="line">    myNestedStyle.Delimiter = <span class="stringliteral">&quot;.&quot;</span></div>
<div class="line">    myNestedStyle.Inclusive = True</div>
<div class="line">    myNestedStyle.Repetition = 1</div>
<div class="line">    Rem Note that the story <span class="keywordtype">object</span> does not have the ApplyParagraphStyle method.)</div>
<div class="line">    Set myText = myPage.TextFrames.Item(1).ParentStory.Texts.Item(1)</div>
<div class="line">    myText.ApplyParagraphStyle myParagraphStyle, True</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_deleting_a_style"></a>
Deleting a style</h3>
<p>When you delete a style using the user interface, you can choose the way you want to format any text tagged with that style. InDesign scripting works the same way, as shown in the following script fragment (from the RemoveStyle tutorial script): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)   </div>
<div class="line">    Set myParagraphStyleA = myDocument.ParagraphStyles.Item(<span class="stringliteral">&quot;myParagraphStyleA&quot;</span>)</div>
<div class="line">    Rem Delete the paragraph style myParagraphStyleA and replace with myParagraphStyleB.</div>
<div class="line">    myParagraphStyleA.Delete myDocument.ParagraphStyles.Item(<span class="stringliteral">&quot;myParagraphStyleB&quot;</span>)</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_importing_paragraph_and_character_styles"></a>
Importing paragraph and character styles</h3>
<p>You can import character and paragraph styles from other InDesign documents, as shown in the following script fragment (from the ImportTextStyles tutorial script): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    Set myNewDocument = myInDesign.Documents.Add</div>
<div class="line">    Rem Import the styles from the saved document.</div>
<div class="line">    Rem ImportStyles parameters:</div>
<div class="line">    Rem Format as idImportFormat enumeration. Options <span class="keywordflow">for</span> text styles are:</div>
<div class="line">    Rem idImportFormat.idParagraphStylesFormat</div>
<div class="line">    Rem idImportFormat.idCharacterStylesFormat</div>
<div class="line">    Rem idImportFormat.idTextStylesFormat</div>
<div class="line">    Rem From as string (file path)</div>
<div class="line">    Rem GlobalStrategy as idGlobalClashResolutionStrategy enumeration. Options are:</div>
<div class="line">    Rem idGlobalClashResolutionStrategy.idDoNotLoadTheStyle</div>
<div class="line">    Rem idGlobalClashResolutionStrategy.idLoadAllWithOverwrite</div>
<div class="line">    Rem idGlobalClashResolutionStrategy.idLoadAllWithRename</div>
<div class="line">    myNewDocument.ImportStyles idImportFormat.idTextStylesFormat, <span class="stringliteral">&quot;c:\styles.indd&quot;</span>, idGlobalClashResolutionStrategy.idLoadAllWithOverwrite</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_finding_and_changing_text"></a>
Finding and Changing Text</h2>
<p>The find/change feature is one of the most powerful InDesign tools for working with text. It is fully supported by scripting, and scripts can use find/change to go far beyond what can be done using the InDesign user interface. InDesign has three ways of searching for text:</p>
<ul>
<li>You can find text and/or text formatting and change it to other text and/or text formatting. This type of find/change operation uses the findTextPreferences and changeTextPreferences objects to specify parameters for the findText and changeText methods.</li>
<li>You can find text using regular expressions, or "grep." This type of find/change operation uses the findGrepPreferences and changeGrepPreferences objects to specify parameters for the findGrep and changeGrep methods.</li>
<li>You can find specific glyphs (and their formatting) and replace them with other glyphs and formatting. This type of find/change operation uses the findGlyphPreferences and changeGlyphPreferences objects to specify parameters for the findGlyph and changeGlyph methods.</li>
</ul>
<p>All the find/change methods take one optional parameter, ReverseOrder, which specifies the order in which the results of the search are returned. If you are processing the results of a find or change operation in a way that adds or removes text from a story, you might face the problem of invalid text references, as discussed earlier in this section. In this case, you can either construct your loops to iterate backward through the collection of returned text objects, or you can have the search operation return the results in reverse order and then iterate through the collection normally.</p>
<h3><a class="anchor" id=""></a>
</h3>
<p>Before you search for text, you probably will want to clear find and change preferences, to make sure the settings from previous searches have no effect on your search. You also need to set some find/change preferences to specify the text, formatting, regular expression, or glyph you want to find and/or change. A typical find/change operation involves the following steps:</p>
<ol type="1">
<li>Clear the find/change preferences. Depending on the type of find/change operation, this can take one of the following three forms:</li>
</ol>
<ul>
<li><div class="fragment"><div class="line">Rem Find/Change text preferences</div>
<div class="line">Set myInDesign = CreateObject(<span class="stringliteral">&quot;InDesign.Application.2024&quot;</span>)</div>
<div class="line">myInDesign.FindTextPreferences = idNothingEnum.idNothing</div>
<div class="line">myInDesign.ChangeTextPreferences = idNothingEnum.idNothing </div>
</div><!-- fragment --></li>
<li><div class="fragment"><div class="line">Rem Find/Change grep preferences</div>
<div class="line">Set myInDesign = CreateObject(<span class="stringliteral">&quot;InDesign.Application.2024&quot;</span>)</div>
<div class="line">myInDesign.FindGrepPreferences = idNothingEnum.idNothing</div>
<div class="line">myInDesign.ChangeGrepPreferences = idNothingEnum.idNothing </div>
</div><!-- fragment --></li>
<li><div class="fragment"><div class="line">Rem Find/Change glyph preferences</div>
<div class="line">Set myInDesign = CreateObject(<span class="stringliteral">&quot;InDesign.Application.2024&quot;</span>)</div>
<div class="line">myInDesign.FindGlyphPreferences = idNothingEnum.idNothing</div>
<div class="line">myInDesign.ChangeGlyphPreferences = idNothingEnum.idNothing </div>
</div><!-- fragment --></li>
</ul>
<ol type="1">
<li>Set up search parameters.</li>
<li>Execute the find/change operation.</li>
<li>Clear find/change preferences again.</li>
</ol>
<h3><a class="anchor" id="id_vb_finding_and_changing_text2"></a>
Finding and changing text</h3>
<p>The following script fragment shows how to find a specified string of text. While the following script fragment searches the entire document, you also can search stories, text frames, paragraphs, text columns, or any other text object. The findText method and its parameters are the same for all text objects. (For the complete script, see FindText.) </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Rem Clear the find/change text preferences.</div>
<div class="line">    myInDesign.FindTextPreferences = idNothingEnum.idNothing</div>
<div class="line">    myInDesign.ChangeTextPreferences = idNothingEnum.idNothing</div>
<div class="line">    Rem Search the document <span class="keywordflow">for</span> the <span class="keywordtype">string</span> <span class="stringliteral">&quot;text&quot;</span>.</div>
<div class="line">    myInDesign.FindTextPreferences.FindWhat = <span class="stringliteral">&quot;text&quot;</span></div>
<div class="line">    Rem Set the find options.</div>
<div class="line">    myInDesign.FindChangeTextOptions.CaseSensitive = False</div>
<div class="line">    myInDesign.FindChangeTextOptions.IncludeFootnotes = False</div>
<div class="line">    myInDesign.FindChangeTextOptions.IncludeHiddenLayers = False</div>
<div class="line">    myInDesign.FindChangeTextOptions.IncludeLockedLayersForFind = False</div>
<div class="line">    myInDesign.FindChangeTextOptions.IncludeLockedStoriesForFind = False</div>
<div class="line">    myInDesign.FindChangeTextOptions.IncludeMasterPages = False</div>
<div class="line">    myInDesign.FindChangeTextOptions.WholeWord = False</div>
<div class="line">    Set myFoundItems = myInDesign.Documents.Item(1).FindText</div>
<div class="line">    MsgBox (<span class="stringliteral">&quot;Found &quot;</span> &amp; CStr(myFoundItems.Count) &amp; <span class="stringliteral">&quot; instances of the search string.&quot;</span>)</div>
<div class="line">    Rem Clear the find/change text preferences after the search.</div>
<div class="line">    myInDesign.FindTextPreferences = idNothingEnum.idNothing</div>
<div class="line">    myInDesign.ChangeTextPreferences = idNothingEnum.idNothing</div>
</div><!-- fragment --><p> The following script fragment shows how to find a specified string of text and replace it with a different string (for the complete script, see ChangeText): </p>
<div class="fragment"><div class="line">   Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">   Rem Clear the find/change text preferences.</div>
<div class="line">   myInDesign.FindTextPreferences = idNothingEnum.idNothing</div>
<div class="line">   myInDesign.ChangeTextPreferences = idNothingEnum.idNothing</div>
<div class="line">   Rem Search the document <span class="keywordflow">for</span> the <span class="keywordtype">string</span> <span class="stringliteral">&quot;copy&quot;</span> and replace with <span class="stringliteral">&quot;text&quot;</span>.</div>
<div class="line">   myInDesign.FindTextPreferences.FindWhat = <span class="stringliteral">&quot;copy&quot;</span></div>
<div class="line">   myInDesign.ChangeTextPreferences.ChangeTo = <span class="stringliteral">&quot;text&quot;</span></div>
<div class="line">   Rem Set the find options.</div>
<div class="line">   myInDesign.FindChangeTextOptions.CaseSensitive = False</div>
<div class="line">   myInDesign.FindChangeTextOptions.IncludeFootnotes = False</div>
<div class="line">   myInDesign.FindChangeTextOptions.IncludeHiddenLayers = False</div>
<div class="line">   myInDesign.FindChangeTextOptions.IncludeLockedLayersForFind = False</div>
<div class="line">   myInDesign.FindChangeTextOptions.IncludeLockedStoriesForFind = False</div>
<div class="line">   myInDesign.FindChangeTextOptions.IncludeMasterPages = False</div>
<div class="line">   myInDesign.FindChangeTextOptions.WholeWord = False</div>
<div class="line">   Set myFoundItems = myInDesign.Documents.Item(1).ChangeText</div>
<div class="line">   MsgBox (<span class="stringliteral">&quot;Changed &quot;</span> &amp; CStr(myFoundItems.Count) &amp; <span class="stringliteral">&quot; instances of the search string.&quot;</span>)</div>
<div class="line">   Rem Clear the find/change text preferences.</div>
<div class="line">   myInDesign.FindTextPreferences = idNothingEnum.idNothing</div>
<div class="line">   myInDesign.ChangeTextPreferences = idNothingEnum.idNothing</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_finding_and_changing_text_formatting"></a>
Finding and changing text formatting</h3>
<p>To find and change text formatting, you set other properties of the findTextPreferences and changeTextPreferences objects, as shown in the script fragment below (from the FindChangeFormatting tutorial script): </p>
<div class="fragment"><div class="line">    Rem Clear the find/change preferences.</div>
<div class="line">    myInDesign.FindTextPreferences = idNothingEnum.idNothing</div>
<div class="line">    myInDesign.ChangeTextPreferences = idNothingEnum.idNothing</div>
<div class="line">    Rem Set the find options.</div>
<div class="line">    myInDesign.FindChangeTextOptions.CaseSensitive = <span class="keyword">false</span></div>
<div class="line">    myInDesign.FindChangeTextOptions.IncludeFootnotes = <span class="keyword">false</span></div>
<div class="line">    myInDesign.FindChangeTextOptions.IncludeHiddenLayers = <span class="keyword">false</span></div>
<div class="line">    myInDesign.FindChangeTextOptions.IncludeLockedLayersForFind = <span class="keyword">false</span></div>
<div class="line">    myInDesign.FindChangeTextOptions.IncludeLockedStoriesForFind = <span class="keyword">false</span></div>
<div class="line">    myInDesign.FindChangeTextOptions.IncludeMasterPages = <span class="keyword">false</span></div>
<div class="line">    myInDesign.FindChangeTextOptions.WholeWord = <span class="keyword">false</span></div>
<div class="line">    Rem Search the document <span class="keywordflow">for</span> the 24 point text and change it to 10 point text.</div>
<div class="line">    myInDesign.findTextPreferences.pointSize = 24</div>
<div class="line">    myInDesign.changeTextPreferences.pointSize = 10</div>
<div class="line">    myInDesign.documents.item(1).changeText</div>
<div class="line">    Rem Clear the find/change preferences after the search.</div>
<div class="line">    myInDesign.FindTextPreferences = idNothingEnum.idNothing</div>
<div class="line">    myInDesign.ChangeTextPreferences = idNothingEnum.idNothing</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_using_grep"></a>
Using grep</h3>
<p>InDesign supports regular expression find/change through the findGrep and changeGrep methods. Regular-expression find/change also can find text with a specified format or replace the formatting of the text with formatting specified in the properties of the changeGrepPreferences object. The following script fragment shows how to use these methods and the related preferences objects (for the complete script, see FindGrep): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Rem Clear the find/change grep preferences.</div>
<div class="line">    myInDesign.FindGrepPreferences = idNothingEnum.idNothing</div>
<div class="line">    myInDesign.ChangeGrepPreferences = idNothingEnum.idNothing</div>
<div class="line">    Rem Set the find options.</div>
<div class="line">    myInDesign.FindChangeGrepOptions.IncludeFootnotes = False</div>
<div class="line">    myInDesign.FindChangeGrepOptions.IncludeHiddenLayers = False</div>
<div class="line">    myInDesign.FindChangeGrepOptions.IncludeLockedLayersForFind = False</div>
<div class="line">    myInDesign.FindChangeGrepOptions.IncludeLockedStoriesForFind = False</div>
<div class="line">    myInDesign.FindChangeGrepOptions.IncludeMasterPages = False</div>
<div class="line">    Rem Regular expression <span class="keywordflow">for</span> finding an email address.</div>
<div class="line">    myInDesign.FindGrepPreferences.FindWhat = <span class="stringliteral">&quot;(?i)[A-Z]*?@[A-Z]*?[.]...&quot;</span></div>
<div class="line">    Rem Apply the change to 24-point text only.</div>
<div class="line">    myInDesign.FindGrepPreferences.PointSize = 24</div>
<div class="line">    myInDesign.ChangeGrepPreferences.Underline = True</div>
<div class="line">    myDocument.ChangeGrep</div>
<div class="line">    Rem Clear the find/change grep preferences after the search.</div>
<div class="line">    myInDesign.FindGrepPreferences = idNothingEnum.idNothing</div>
<div class="line">    myInDesign.ChangeGrepPreferences = idNothingEnum.idNothing</div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>The findChangeGrepOptions object lacks two properties of the findChangeTextOptions object: wholeWord and caseSensitive. This is because you can set these options using the regular expression string itself. Use (?i) to turn case sensitivity on and (?-i) to turn case sensitivity off. Use \&gt; to match the beginning of a word and \&lt; to match the end of a word, or use \b to match a word boundary.</dd></dl>
<p>One handy use for grep find/change is to convert text mark-up (i.e., some form of tagging plain text with formatting instructions) into InDesign formatted text. PageMaker paragraph tags (which are not the same as PageMaker tagged-text format files) are an example of a simplified text mark-up scheme. In a text file marked up using this scheme, paragraph style names appear at the start of a paragraph, as shown below: </p>
<div class="fragment"><div class="line">&lt;heading1&gt;This is a heading.&lt;body_text&gt;This is body text.</div>
</div><!-- fragment --><p>We can create a script that uses grep find in conjunction with text find/change operations to apply formatting to the text and remove the mark-up tags, as shown in the following script fragment (from the ReadPMTags tutorial script): </p>
<div class="fragment"><div class="line">   Set myInDesign = CreateObject(<span class="stringliteral">&quot;InDesign.Application.2024&quot;</span>)</div>
<div class="line">   Rem Access the active document.</div>
<div class="line">   Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">   Set myStory = myDocument.Stories.Item(1)</div>
<div class="line">   myReadPMTags myInDesign, myStory</div>
</div><!-- fragment --><p> Here is the myReadPMTags function referred to in the above script. </p>
<div class="fragment"><div class="line">Function myReadPMTags(myInDesign, myStory)</div>
<div class="line">   Set myDocument = myStory.Parent</div>
<div class="line">   Rem Reset the findGrepPreferences to ensure that previous settings</div>
<div class="line">   Rem do not affect the search.</div>
<div class="line">   myInDesign.FindGrepPreferences = idNothingEnum.idNothing</div>
<div class="line">   myInDesign.ChangeGrepPreferences = idNothingEnum.idNothing</div>
<div class="line">   Rem Find the tags.</div>
<div class="line">   myInDesign.FindGrepPreferences.findWhat = &quot;(?i)^&lt;\s*\w+\s*&gt;&quot;</div>
<div class="line">   Set myFoundItems = myStory.findGrep</div>
<div class="line">   If myFoundItems.Count &lt;&gt; 0 Then</div>
<div class="line">     Set myFoundTags = CreateObject(&quot;Scripting.Dictionary&quot;)</div>
<div class="line">     For myCounter = 1 To myFoundItems.Count</div>
<div class="line">         If Not (myFoundTags.Exists(myFoundItems.Item(myCounter).Contents)) Then</div>
<div class="line">             myFoundTags.Add myFoundItems.Item(myCounter).Contents, myFoundItems.Item(myCounter).Contents</div>
<div class="line">         End If</div>
<div class="line">     Next</div>
<div class="line">     Rem At this point, we have a list of tags to search for.</div>
<div class="line">     For Each myFoundTag In myFoundTags</div>
<div class="line">         myString = myFoundTag</div>
<div class="line">         Rem Find the tag using findWhat.</div>
<div class="line">         myInDesign.FindTextPreferences.findWhat = myString</div>
<div class="line">         Rem Extract the style name from the tag.</div>
<div class="line">         myStyleName = Mid(myString, 2, Len(myString) - 2)</div>
<div class="line">         Rem Create the style if it does not already exist.</div>
<div class="line">         Set myStyle = myAddStyle(myDocument, myStyleName)</div>
<div class="line">         Rem Apply the style to each instance of the tag.</div>
<div class="line">         myInDesign.ChangeTextPreferences.AppliedParagraphStyle = myStyle</div>
<div class="line">         myStory.ChangeText</div>
<div class="line">         Rem Reset the changeTextPreferences.</div>
<div class="line">         myInDesign.ChangeTextPreferences = idNothingEnum.idNothing</div>
<div class="line">         Rem Set the changeTo to an empty <span class="keywordtype">string</span>.</div>
<div class="line">         myInDesign.ChangeTextPreferences.ChangeTo = &quot;&quot;</div>
<div class="line">         Rem Search to remove the tags.</div>
<div class="line">         myStory.ChangeText</div>
<div class="line">         Rem Reset the find/change preferences again.</div>
<div class="line">         myInDesign.ChangeTextPreferences = idNothingEnum.idNothing</div>
<div class="line">     Next</div>
<div class="line">   End If</div>
<div class="line">   myInDesign.FindGrepPreferences = idNothingEnum.idNothing</div>
<div class="line">   myInDesign.ChangeGrepPreferences = idNothingEnum.idNothing</div>
<div class="line">End Function</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_using_glyph_search"></a>
Using glyph search</h3>
<p>You can find and change individual characters in a specific font using the findGlyph and changeGlyph methods and the associated findGlyphPreferences and changeGlyphPreferences objects. The following scripts fragment shows how to find and change a glyph in an example document (for the complete script, see FindChangeGlyph): </p>
<div class="fragment"><div class="line">    Rem Clear the find/change glyph preferences.</div>
<div class="line">    myInDesign.FindGlyphPreferences = idNothingEnum.idNothing</div>
<div class="line">    myInDesign.ChangeGlyphPreferences = idNothingEnum.idNothing</div>
<div class="line">    Rem Set the find options.</div>
<div class="line">    myInDesign.FindChangeGrepOptions.IncludeFootnotes = False</div>
<div class="line">    myInDesign.FindChangeGrepOptions.IncludeHiddenLayers = False</div>
<div class="line">    myInDesign.FindChangeGrepOptions.IncludeLockedLayersForFind = False</div>
<div class="line">    myInDesign.FindChangeGrepOptions.IncludeLockedStoriesForFind = False</div>
<div class="line">    myInDesign.FindChangeGrepOptions.IncludeMasterPages = False</div>
<div class="line">    Rem You must provide a font that is used in the document <span class="keywordflow">for</span> the</div>
<div class="line">    Rem AppliedFont <span class="keyword">property</span> of the FindGlyphPreferences <span class="keywordtype">object</span>.</div>
<div class="line">    myInDesign.FindGlyphPreferences.AppliedFont = myInDesign.Fonts.Item(<span class="stringliteral">&quot;Minion Pro&quot;</span> &amp; vbTab &amp; <span class="stringliteral">&quot;Regular&quot;</span>)</div>
<div class="line">    Rem Provide the glyph ID, not the glyph Unicode value.</div>
<div class="line">    myInDesign.FindGlyphPreferences.GlyphID = 374</div>
<div class="line">    Rem The appliedFont of the changeGlyphPreferences <span class="keywordtype">object</span> can be</div>
<div class="line">    Rem any font available to the application.</div>
<div class="line">    myInDesign.changeGlyphPreferences.AppliedFont = myInDesign.Fonts.Item(<span class="stringliteral">&quot;Times New Roman&quot;</span> &amp; vbTab &amp; <span class="stringliteral">&quot;Bold&quot;</span>)</div>
<div class="line">    myInDesign.changeGlyphPreferences.GlyphID = 85</div>
<div class="line">    myInDesign.Documents.Item(1).ChangeGlyph</div>
<div class="line">    Rem Clear the find/change glyph preferences after the search.</div>
<div class="line">    myInDesign.FindGlyphPreferences = idNothingEnum.idNothing</div>
<div class="line">    myInDesign.ChangeGlyphPreferences = idNothingEnum.idNothing</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_working_with_tables"></a>
Working with Tables</h2>
<p>Tables can be created from existing text using the convertTextToTable method, or an empty table can be created at any insertion point in a story. The following script fragment shows three different ways to create a table (for the complete script, see MakeTable): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    Set myTextFrame = myPage.TextFrames.Add</div>
<div class="line">    Rem Set the bounds of the text frame.</div>
<div class="line">    myTextFrame.GeometricBounds = myGetBounds(myDocument, myPage)</div>
<div class="line">    Rem Fill the text frame with placeholder text.</div>
<div class="line">    myString = &quot;Table 1&quot; &amp; vbCr</div>
<div class="line">    myString = myString &amp; &quot;Column 1&quot; &amp; vbTab &amp; &quot;Column 2&quot; &amp; vbTab &amp; &quot;Column 3&quot; &amp; vbCr &amp; &quot;1a&quot; &amp; vbTab &amp; &quot;1b&quot; &amp; vbTab &amp; &quot;1c&quot; &amp; vbCr &amp; &quot;2a&quot; &amp; vbTab &amp; &quot;2b&quot; &amp; vbTab &amp; &quot;2c&quot; &amp; vbCr &amp; &quot;3a&quot; &amp; vbTab &amp; &quot;3b&quot; &amp; vbTab &amp; &quot;3c&quot; &amp; vbCr</div>
<div class="line">    myString = myString &amp; &quot;Table 2&quot; &amp; vbCr</div>
<div class="line">    myString = myString &amp; &quot;Column 1,Column 2,Column 3;1a,1b,1c;2a,2b,2c;3a,3b,3c&quot; &amp; vbCr</div>
<div class="line">    myString = myString &amp; &quot;Table 3&quot; &amp; vbCr</div>
<div class="line">    myTextFrame.Contents = myString</div>
<div class="line">    Set myStory = myTextFrame.ParentStory</div>
<div class="line">    Set myStartCharacter = myStory.Paragraphs.Item(7).Characters.Item(1)</div>
<div class="line">    Set myEndCharacter = myStory.Paragraphs.Item(7).Characters.Item(-2)</div>
<div class="line">    Set myText = myStory.Texts.ItemByRange(myStartCharacter, myEndCharacter).Item(1)</div>
<div class="line">    Rem The convertToTable method takes three parameters:</div>
<div class="line">    Rem [ColumnSeparator as <span class="keywordtype">string</span>]</div>
<div class="line">    Rem [RowSeparator as <span class="keywordtype">string</span>]</div>
<div class="line">    Rem [NumberOfColumns as integer] (only used if the ColumnSeparator</div>
<div class="line">    Rem and RowSeparator values are the same)</div>
<div class="line">    Rem In the last paragraph in the story, columns are separated by commas</div>
<div class="line">    Rem and rows are separated by semicolons, so we provide those characters</div>
<div class="line">    Rem to the method as parameters.</div>
<div class="line">    Set myTable = myText.ConvertToTable(&quot;,&quot;, &quot;;&quot;)</div>
<div class="line">    Set myStartCharacter = myStory.Paragraphs.Item(2).Characters.Item(1)</div>
<div class="line">    Set myEndCharacter = myStory.Paragraphs.Item(5).Characters.Item(-2)</div>
<div class="line">    Set myText = myStory.Texts.ItemByRange(myStartCharacter, myEndCharacter).Item(1)</div>
<div class="line">    Rem In the second through the fifth paragraphs, colums are separated by</div>
<div class="line">    Rem tabs and rows are separated by returns. These are the default delimiter</div>
<div class="line">    Rem parameters, so we don&#39;t need to provide them to the method.</div>
<div class="line">    Set myTable = myText.ConvertToTable</div>
<div class="line">    Rem You can also explicitly add a table--you don&#39;t have to convert text to a table.</div>
<div class="line">    Set myTable = myStory.InsertionPoints.Item(-1).Tables.Add</div>
<div class="line">    myTable.ColumnCount = 3</div>
<div class="line">    myTable.BodyRowCount = 3</div>
</div><!-- fragment --><p> The following script fragment shows how to merge table cells. (For the complete script, see MergeTableCells.) </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myStory = myDocument.Stories.Item(1)</div>
<div class="line">    Set myTable = myStory.Tables.Item(1)</div>
<div class="line">    Rem Merge all of the cells in the first column.</div>
<div class="line">    myTable.Cells.Item(1).Merge myTable.Columns.Item(1).Cells.Item(-1)</div>
<div class="line">    Rem Convert column 2 into 2 cells (rather than 4).</div>
<div class="line">    myTable.Columns.Item(2).Cells.Item(-1).Merge myTable.Columns.Item(2).Cells.Item(-2)</div>
<div class="line">    myTable.Columns.Item(2).Cells.Item(1).Merge myTable.Columns.Item(2).Cells.Item(2)</div>
<div class="line">    Rem Merge the last two cells in row 1.</div>
<div class="line">    myTable.Rows.Item(1).Cells.Item(-1).Merge myTable.Rows.Item(1).Cells.Item(-1)</div>
<div class="line">    Rem Merge the last two cells in row 3.</div>
<div class="line">    myTable.Rows.Item(3).Cells.Item(-2).Merge myTable.Rows.Item(3).Cells.Item(-1)</div>
</div><!-- fragment --><p> The following script fragment shows how to split table cells. (For the complete script, see SplitTableCells.) </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myStory = myDocument.Stories.Item(1)</div>
<div class="line">    Set myTable = myStory.InsertionPoints.Item(-1).Tables.Add</div>
<div class="line">    myTable.ColumnCount = 1</div>
<div class="line">    myTable.BodyRowCount = 1</div>
<div class="line">    myArray = myGetBounds(myDocument, myDocument.Pages.Item(1))</div>
<div class="line">    myWidth = myArray(3) - myArray(1)</div>
<div class="line">    myTable.Columns.Item(1).Width = myWidth</div>
<div class="line">    myTable.Cells.Item(1).Split idHorizontalOrVertical.idHorizontal</div>
<div class="line">    myTable.Columns.Item(1).Split idHorizontalOrVertical.idVertical</div>
<div class="line">    myTable.Cells.Item(1).Split idHorizontalOrVertical.idVertical</div>
<div class="line">    myTable.Rows.Item(-1).Split idHorizontalOrVertical.idHorizontal</div>
<div class="line">    myTable.Cells.Item(-1).Split idHorizontalOrVertical.idVertical</div>
<div class="line">    For myRowCounter = 1 To myTable.Rows.Count</div>
<div class="line">        Set myRow = myTable.Rows.Item(myRowCounter)</div>
<div class="line">        For myCellCounter = 1 To myRow.Cells.Count</div>
<div class="line">            myString = &quot;Row: &quot; &amp; myRowCounter &amp; &quot; Cell: &quot; &amp; myCellCounter</div>
<div class="line">            myRow.Cells.Item(myCellCounter).contents = myString</div>
<div class="line">        Next</div>
<div class="line">    Next</div>
</div><!-- fragment --><p> The following script fragment shows how to create header and footer rows in a table (for the complete script, see HeaderAndFooterRows): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    Rem Create a text frame on page 1.</div>
<div class="line">    Set myTable = myDocument.Stories.Item(1).Tables.Item(1)</div>
<div class="line">    Rem Convert the first row to a header row.</div>
<div class="line">    myTable.Rows.Item(1).RowType = idRowTypes.idHeaderRow</div>
<div class="line">    Rem Convert the last row to a footer row.</div>
<div class="line">    myTable.Rows.Item(-1).RowType = idRowTypes.idFooterRow</div>
</div><!-- fragment --><p> The following script fragment shows how to apply formatting to a table (for the complete script, see TableFormatting): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myStory = myDocument.Stories.Item(1)</div>
<div class="line">    Set myTable = myStory.Tables.Item(1)</div>
<div class="line">    Rem Convert the first row to a header row.</div>
<div class="line">    myTable.Rows.Item(1).RowType = idRowTypes.idHeaderRow</div>
<div class="line">    Rem Use a reference to a swatch, rather than to a color.</div>
<div class="line">    myTable.Rows.Item(1).FillColor = myDocument.Swatches.Item(<span class="stringliteral">&quot;DGC1_446b&quot;</span>)</div>
<div class="line">    myTable.Rows.Item(1).FillTint = 40</div>
<div class="line">    myTable.Rows.Item(2).FillColor = myDocument.Swatches.Item(<span class="stringliteral">&quot;DGC1_446a&quot;</span>)</div>
<div class="line">    myTable.Rows.Item(2).FillTint = 40</div>
<div class="line">    myTable.Rows.Item(3).FillColor = myDocument.Swatches.Item(<span class="stringliteral">&quot;DGC1_446a&quot;</span>)</div>
<div class="line">    myTable.Rows.Item(3).FillTint = 20</div>
<div class="line">    myTable.Rows.Item(4).FillColor = myDocument.Swatches.Item(<span class="stringliteral">&quot;DGC1_446a&quot;</span>)</div>
<div class="line">    myTable.Rows.Item(4).FillTint = 40</div>
<div class="line">    Rem Iterate through the cells to apply the cell stroke formatting.</div>
<div class="line">    For myCounter = 1 To myTable.Cells.Count</div>
<div class="line">        myTable.Cells.Item(myCounter).TopEdgeStrokeColor = myDocument.Swatches.Item(<span class="stringliteral">&quot;DGC1_446b&quot;</span>)</div>
<div class="line">        myTable.Cells.Item(myCounter).TopEdgeStrokeWeight = 1</div>
<div class="line">        myTable.Cells.Item(myCounter).BottomEdgeStrokeColor = myDocument.Swatches.Item(<span class="stringliteral">&quot;DGC1_446b&quot;</span>)</div>
<div class="line">        myTable.Cells.Item(myCounter).BottomEdgeStrokeWeight = 1</div>
<div class="line">        Rem When you <span class="keyword">set</span> a cell stroke to a swatch, make certain that you also <span class="keyword">set</span> the stroke weight.</div>
<div class="line">        myTable.Cells.Item(myCounter).LeftEdgeStrokeColor = myDocument.Swatches.Item(<span class="stringliteral">&quot;None&quot;</span>)</div>
<div class="line">        myTable.Cells.Item(myCounter).LeftEdgeStrokeWeight = 0</div>
<div class="line">        myTable.Cells.Item(myCounter).RightEdgeStrokeColor = myDocument.Swatches.Item(<span class="stringliteral">&quot;None&quot;</span>)</div>
<div class="line">        myTable.Cells.Item(myCounter).RightEdgeStrokeWeight = 0</div>
<div class="line">    Next</div>
</div><!-- fragment --><p> The following script fragment shows how to add alternating row formatting to a table (for the complete script, see AlternatingRows): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myTable = myDocument.stories.Item(1).tables.Item(1)</div>
<div class="line">    Rem Apply alternating fills to the table.</div>
<div class="line">    myTable.alternatingFills = idAlternatingFillsTypes.idAlternatingRows</div>
<div class="line">    myTable.startRowFillColor = myDocument.swatches.Item(<span class="stringliteral">&quot;DGC1_446a&quot;</span>)</div>
<div class="line">    myTable.startRowFillTint = 60</div>
<div class="line">    myTable.endRowFillColor = myDocument.swatches.Item(<span class="stringliteral">&quot;DGC1_446b&quot;</span>)</div>
<div class="line">    myTable.endRowFillTint = 50</div>
</div><!-- fragment --><p> The following script fragment shows how to process the selection when text or table cells are selected. In this example, the script displays an alert for each selection condition, but a real production script would then do something with the selected item(s). (For the complete script, see TableSelection.) </p>
<div class="fragment"><div class="line">    Set myInDesign = CreateObject(<span class="stringliteral">&quot;InDesign.Application.2024&quot;</span>)</div>
<div class="line">    If myInDesign.Documents.Count &lt;&gt; 0 Then</div>
<div class="line">        If myInDesign.Selection.Count &lt;&gt; 0 Then</div>
<div class="line">            Select Case TypeName(myInDesign.Selection.Item(1))</div>
<div class="line">                Rem When a row, a column, or a range of cells is selected, the type returned is &quot;Cell&quot;</div>
<div class="line">                Case &quot;Cell&quot;</div>
<div class="line">                    MsgBox (&quot;A cell is selected.&quot;)</div>
<div class="line">                Case &quot;Table&quot;</div>
<div class="line">                    MsgBox (&quot;A table is selected.&quot;)</div>
<div class="line">                Case &quot;InsertionPoint&quot;, &quot;Character&quot;, &quot;Word&quot;, &quot;TextStyleRange&quot;, &quot;Line&quot;, &quot;Paragraph&quot;, &quot;TextColumn&quot;, &quot;Text&quot;</div>
<div class="line">                    If TypeName(myInDesign.Selection.Item(1).Parent) = &quot;Cell&quot; Then</div>
<div class="line">                        MsgBox (&quot;The selection is inside a table cell.&quot;)</div>
<div class="line">                    End If</div>
<div class="line">                Case &quot;Rectangle&quot;, &quot;Oval&quot;, &quot;Polygon&quot;, &quot;GraphicLine&quot;</div>
<div class="line">                    If TypeName(myInDesign.Selection.Item(1).Parent.Parent) = &quot;Cell&quot; Then</div>
<div class="line">                        MsgBox (&quot;The selection is inside a table cell.&quot;)</div>
<div class="line">                    End If</div>
<div class="line">                Case &quot;Image&quot;, &quot;PDF&quot;, &quot;EPS&quot;</div>
<div class="line">                    If TypeName(myInDesign.Selection.Item(1).Parent.Parent.Parent) = &quot;Cell&quot; Then</div>
<div class="line">                        MsgBox (&quot;The selection is inside a table cell.&quot;)</div>
<div class="line">                    End If</div>
<div class="line">                Case Else</div>
<div class="line">                    MsgBox (&quot;The selection is not inside a table.&quot;)</div>
<div class="line">            End Select</div>
<div class="line">        End If</div>
<div class="line">    End If</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_adding_path_text"></a>
Adding Path Text</h2>
<p>You can add path text to any rectangle, oval, polygon, graphic line, or text frame. The following script fragment shows how to add path text to a page item (for the complete script, see PathText): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    Rem Create a rectangle on the first page.</div>
<div class="line">    Set myTextFrame = myPage.TextFrames.Add</div>
<div class="line">    myTextFrame.geometricBounds = Array(72, 72, 288, 288)</div>
<div class="line">    Set myTextPath = myTextFrame.TextPaths.Add</div>
<div class="line">    myTextPath.Contents = &quot;This is path text.&quot;</div>
</div><!-- fragment --><p> To link text paths to another text path or text frame, use the nextTextFrame and previousTextFrame properties, just as you would for a text frame (see <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_working_with_text_frames">Working with Text Frames</a>).</p>
<h2><a class="anchor" id="id_vb_using_autocorrect"></a>
Using Autocorrect</h2>
<p>The autocorrect feature can correct text as you type. The following script shows how to use it (for the complete script, see Autocorrect): </p>
<div class="fragment"><div class="line">    ReDim myNewWordPairList(0)</div>
<div class="line">    Rem Add a word pair to the autocorrect list. Each </div>
<div class="line">    Rem AutoCorrectTable is linked to a specific language.</div>
<div class="line">    Set myAutoCorrectTable = myInDesign.AutoCorrectTables.Item(&quot;English: USA&quot;)</div>
<div class="line">    Rem To safely add a word pair to the auto correct table, get the current</div>
<div class="line">    Rem word pair list, then add the new word pair to that array, and then</div>
<div class="line">    Rem set the autocorrect word pair list to the array.</div>
<div class="line">    myWordPairList = myAutoCorrectTable.AutoCorrectWordPairList</div>
<div class="line">    ReDim myNewWordPairList(UBound(myWordPairList)+1)</div>
<div class="line">    For myCounter = 0 To UBound(myWordPairList)</div>
<div class="line">        myNewWordPairList(myCounter) = myWordPairList(myCounter)</div>
<div class="line">    Next</div>
<div class="line">    Rem Add a new word pair to the array.</div>
<div class="line">    myNewWordPairList(UBound(myNewWordPairList)) = (Array(&quot;paragarph&quot;, &quot;paragraph&quot;))</div>
<div class="line">    Rem Update the word pair list.</div>
<div class="line">    myAutoCorrectTable.AutoCorrectWordPairList = myNewWordPairList</div>
<div class="line">    Rem To clear all autocorrect word pairs in the current dictionary:</div>
<div class="line">    Rem myAutoCorrectTable.autoCorrectWordPairList = array(())</div>
<div class="line">    Rem Turn autocorrect on if it&#39;s not on already.</div>
<div class="line">    If myInDesign.AutoCorrectPreferences.AutoCorrect = False Then</div>
<div class="line">        myInDesign.AutoCorrectPreferences.AutoCorrect = True</div>
<div class="line">    End If</div>
<div class="line">    myInDesign.AutoCorrectPreferences.AutoCorrectCapitalizationErrors = True</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_adding_footnotes"></a>
Adding Footnotes</h2>
<p>The following script fragment shows how to add footnotes to a story (for the complete script, including the myGetRandom function, see Footnotes): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    With myDocument.FootnoteOptions</div>
<div class="line">        .SeparatorText = vbTab</div>
<div class="line">        .MarkerPositioning = idFootnoteMarkerPositioning.idSuperscriptMarker</div>
<div class="line">    End With</div>
<div class="line">    Set myTextFrame = myDocument.Pages.Item(1).TextFrames.Item(1)</div>
<div class="line">    Rem Add four footnotes at random locations in the story.</div>
<div class="line">    For myCounter = 1 To 4</div>
<div class="line">        myRandomNumber = CLng(myGetRandom(1, myTextFrame.ParentStory.Words.Count))</div>
<div class="line">        Set myWord = myTextFrame.ParentStory.Words.Item(myRandomNumber)</div>
<div class="line">        Set myFootnote = myWord.InsertionPoints.Item(-1).Footnotes.Add</div>
<div class="line">        Rem Note: when you create a footnote, it contains text--the footnote marker</div>
<div class="line">        Rem and the separator text (if any). If you try to set the text of the footnote</div>
<div class="line">        Rem by setting the footnote contents, you will delete the marker. Instead, append</div>
<div class="line">        Rem the footnote text, as shown below.</div>
<div class="line">        myFootnote.InsertionPoints.Item(-1).Contents = &quot;This is a footnote.&quot;</div>
<div class="line">    Next</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_spanning_columns"></a>
Spanning Columns</h2>
<p>A paragraph layout can span multiple columns or split into subcolumns with the Span Columns attribute or Split Column attribute applied. The following script fragment shows how to set the Span Columns and Split Column style for a paragraph (for the complete script, see SpanColumns): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.ActiveDocument</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    Set myStory = myPage.TextFrames.Item(1).ParentStory</div>
<div class="line"></div>
<div class="line">    Rem Split Column</div>
<div class="line">    With myStory.Paragraphs.Item(1)</div>
<div class="line">        .SpanColumnType = idSpanColumnTypeOptions.idSplitColumns</div>
<div class="line">        .SpanSplitColumnCount = 2</div>
<div class="line">        .SplitColumnOutsideGutter = 0</div>
<div class="line">        .SplitColumnInsideGutter = 1</div>
<div class="line">    End With</div>
<div class="line"></div>
<div class="line">    Rem Span Columns</div>
<div class="line">    mySpanIndex = myStory.Paragraphs.Count \ 2 + 1</div>
<div class="line">    With myStory.Paragraphs.Item(mySpanIndex)</div>
<div class="line">        .SpanColumnType = idSpanColumnTypeOptions.idSpanColumns</div>
<div class="line">        .SpanSplitColumnCount = idSpanColumnCountOptions.idAll</div>
<div class="line">    End With</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_setting_text_preferences"></a>
Setting Text Preferences</h2>
<p>The following script shows how to set general text preferences (for the complete script, see TextPreferences): </p>
<div class="fragment"><div class="line">    With myInDesign.TextPreferences</div>
<div class="line">        .AbutTextToTextWrap = True</div>
<div class="line">        .AddPages = idAddPageOptions.idEndOfDocument </div>
<div class="line">        Rem baseline shift key increment can range from .001 to 200 points.</div>
<div class="line">        .BaselineShiftKeyIncrement = 1</div>
<div class="line">        .DeleteEmptyPages = False</div>
<div class="line">        .EnableStylePreviewMode = False</div>
<div class="line">        .HighlightCustomSpacing = False</div>
<div class="line">        .HighlightHjViolations = True</div>
<div class="line">        .HighlightKeeps = True</div>
<div class="line">        .HighlightSubstitutedFonts = True</div>
<div class="line">        .HighlightSubstitutedGlyphs = True</div>
<div class="line">        .JustifyTextWraps = True</div>
<div class="line">        Rem kerning key increment value is 1/1000 of an em.</div>
<div class="line">        .KerningKeyIncrement = 10</div>
<div class="line">        Rem leading key increment value can range from .001 to 200 points.</div>
<div class="line">        .LeadingKeyIncrement = 1</div>
<div class="line">        .LimitToMasterTextFrames = False</div>
<div class="line">        .LinkTextFilesWhenImporting = False</div>
<div class="line">        .PreserveFacingPageSpreads = False</div>
<div class="line">        .ShowInvisibles = True</div>
<div class="line">        .SmallCap = 60</div>
<div class="line">        .SmartTextReflow = False</div>
<div class="line">        .SubscriptPosition = 30</div>
<div class="line">        .SubscriptSize = 60</div>
<div class="line">        .SuperscriptPosition = 30</div>
<div class="line">        .SuperscriptSize = 60</div>
<div class="line">        .TypographersQuotes = False</div>
<div class="line">        .UseOpticalSize = False</div>
<div class="line">        .UseParagraphLeading = False</div>
<div class="line">        .ZOrderTextWrap = False</div>
<div class="line">    End With</div>
<div class="line">    Rem Text editing preferences are application-wide.</div>
<div class="line">    With myInDesign.TextEditingPreferences</div>
<div class="line">        .AllowDragAndDropTextInStory = True</div>
<div class="line">        .DragAndDropTextInLayout = True</div>
<div class="line">        .SingleClickConvertsFramesToTextFrames = True</div>
<div class="line">        .SmartCutAndPaste = True</div>
<div class="line">        .TripleClickSelectsLine = False</div>
<div class="line">    End With</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_working_with_linked_stories"></a>
Working with Linked Stories</h2>
<p>Linked stories make it easier to manager multiple versions of the same story or text content in the same document; it makes it easier to support emerging digital publishing workflows, where, for example, you need to design for vertical and horizontal layouts. Linked stories behave similarly to traditional links. You can designate a story as a parent, and then place the same story at other places in the document as child stories. Whenever the parent story is updated, the child stories are flagged in the Links panel and can be updated to synchronize with the parent story.</p>
<h3><a class="anchor" id="id_vb_creating_linked_stories"></a>
Creating linked stories</h3>
<p>There are several ways to create a linked story. It can be created by linking existing text frames with the parent story, or by telling the Page, Spread, Master or Document object to create the text frame at the specified location and link it with the parent story.</p>
<p>To link an existing text frame with the parent story, use the following script (for the complete script, see CreateLinkedStories). </p>
<div class="fragment"><div class="line">    childTextFrame1.PlaceAndLink myTextFrame.ParentStory, False</div>
</div><!-- fragment --><p> If you specify true for the second parameter, which is optional, the linked story options dialog opens; otherwise, the default options are used.</p>
<p>To tell the Page object to create a linked story for the parent story, the PlaceAndLink method includes two additional parameters that you can use to specify the layer and point at which to place the linked story, as shown in the following script fragment (for the complete script, see CreateLinkedStories). </p>
<div class="fragment"><div class="line">    Set newPage = myDocument.Pages.Add</div>
<div class="line">    newPage.PlaceAndLink myTextFrame.ParentStory, Array(originY, originX), myDocument.ActiveLayer, False</div>
</div><!-- fragment --><p> To tell the Spread object to create linked story for the parent story, the PlaceAndLink method takes the same parameters as the PlaceAndLink method for Page object, as shown in the following script fragment (for the complete script, see CreateLinkedStories). </p>
<div class="fragment"><div class="line">    Set newSpread = myDocument.Spreads.Add</div>
<div class="line">    newSpread.PlaceAndLink myTextFrame.ParentStory, Array(originY, originX), myDocument.ActiveLayer, False</div>
</div><!-- fragment --><p> You can also call the PlaceAndLink method for the Document object. The method takes the parent story as the only parameter. This method does not create the linked story; instead, it loads the place gun and lets the user decide where to place the linked story.</p>
<h3><a class="anchor" id="id_vb_changing_linked_story_options"></a>
Changing linked story options</h3>
<p>To change the linked story options, use the following script fragment (for the complete script, see CreateLinkedStories). </p>
<div class="fragment"><div class="line">    With myDocument.LinkedStoryOptions</div>
<div class="line">        .RemoveForcedLineBreaks = True</div>
<div class="line">        .UpdateWhileSaving = True</div>
<div class="line">        .WarnOnUpdateOfEditedStory = True</div>
<div class="line">    End With</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_frequently_asked_questions"></a>
Frequently asked questions</h3>
<p><b>How can I tell whether a given link is a link for a linked story?</b></p>
<p>Use Link.FilePath. If it is empty, then it is a link for a linked story.</p>
<p><b>Given a link for linked story, how can I get its link source?</b></p>
<p>Use this to select the link source: </p>
<div class="fragment"><div class="line">Link.EditOriginal</div>
</div><!-- fragment --><p>Then use this to find the active selection, which is the link source: </p>
<div class="fragment"><div class="line">Application.Selection</div>
</div><!-- fragment --><h1><a class="anchor" id="id_vb_working_with_page_items"></a>
Working with Page Items</h1>
<p>This section covers scripting techniques related to the page items (rectangles, ellipses, graphic lines, polygons, text frames, buttons, and groups) that can appear in an InDesign layout.</p>
<h2><a class="anchor" id="id_vb_creating_page_items"></a>
Creating Page Items</h2>
<p>Page items in an InDesign layout are arranged in a hierarchy, and appear within a container object of some sort. Spreads, pages, other page items, groups, and text characters are all examples of objects that can contain page items. This hierarchy of containers in the InDesign scripting object model is the same as in the InDesign user interface&ndash;when you create a rectangle by dragging the Rectangle tool on a page, you are specifying that the page is the container, or parent, of the rectangle. When you paste an ellipse into a polygon, you are specifying that the polygon is the parent of the ellipse, which, in turn, is a child object of its parent, a page.</p>
<p>In general, creating a new page item is as simple as telling the object you want to contain the page item to create the page item, as shown in the MakeRectangle script. </p>
<div class="fragment"><div class="line">    Rem Given a page <span class="stringliteral">&quot;myPage&quot;</span>, create a <span class="keyword">new</span> rectangle at the <span class="keywordflow">default</span> size and location...</div>
<div class="line">    Set myRectangle = myPage.Rectangles.Add</div>
</div><!-- fragment --><p> In the above script, a new rectangle is created on the first page of a new document. The rectangle appears at the default location (near the upper left corner of the page) and has a default size (around ten points square). Moving the rectangle and changing its dimensions are both accomplished by filling its geometric bounds property with new values, as shown in the MakeRectangleWithProperties script. </p>
<div class="fragment"><div class="line">    Rem Given a page <span class="stringliteral">&quot;myPage&quot;</span>, create a <span class="keyword">new</span> rectangle of a specific size...</div>
<div class="line">    Set myRectangle = myPage.Rectangles.Add</div>
<div class="line">    myRectangle.GeometricBounds = Array(72, 72, 144, 144)</div>
</div><!-- fragment --><p> <b>Page item types</b></p>
<p>It is important to note that you cannot create a "generic" page item&ndash;you have to create a page item of a specific type (a rectangle, oval, graphic line, polygon, text frame, or button). You will also notice that InDesign changes the type of a page item as the geometry of the page item changes. A rectangle, for example, is always made up of a single, closed path containing four path points and having 90 degree interior angles. Change the location of a single point, however, or add another path, and the type of the page item changes to a polygon. Open the path and remove two of the four points, and InDesign will change the type to a graphic line. The only things that define the type of a rectangle, ellipse, graphic line, or polygon are:</p>
<ul>
<li>The number of paths in the object. Any page item with more than one path is a polygon.</li>
<li>The number and location of points on the first path in the object.</li>
</ul>
<p>To determine the type of a page item, use this example: </p>
<div class="fragment"><div class="line">myPageItemType = TypeName(myPageItem)</div>
</div><!-- fragment --><p>The result of the above will be a string containing the type of the page item.</p>
<p><b>Getting the type of a page item</b></p>
<p>When you have a reference to a generic page item, and want to find out what type of a page item it is, use TypeName to get the specific type. </p>
<div class="fragment"><div class="line">Rem Given a <span class="keyword">generic</span> page item <span class="stringliteral">&quot;myPageItem&quot;</span>...</div>
<div class="line">myType = TypeName(myPageItem)</div>
<div class="line">MsgBox myType</div>
</div><!-- fragment --><p><b>Referring to page items</b></p>
<p>When you refer to page items inside a given container (a document, layer, page, spread, group, text frame, or page item), you use the PageItems collection of the container object. This gives you a collection of the top level page items inside the object. For example: </p>
<div class="fragment"><div class="line">Rem Given a reference to InDesign <span class="stringliteral">&quot;myInDesign&quot;</span>...</div>
<div class="line">Set myPageItems = myInDesign.Documents.Item(1).Pages.Item(1).PageItems</div>
</div><!-- fragment --><p>The resulting collection (myPageItems) does not include objects inside groups (though it does include the group), objects inside other page items (thought it does contain the parent page item), or page items in text frames. To get a reference to all of the items in a given container, including items nested inside other page items, use the AllPageItems property. </p>
<div class="fragment"><div class="line">Rem Given a reference to InDesign <span class="stringliteral">&quot;myInDesign&quot;</span>...</div>
<div class="line">Set myAllPageItems = myInDesign.Documents.Item(1).Pages.Item(1).AllPageItems</div>
</div><!-- fragment --><p>The resulting collection (myAllPageItems) includes all objects on the page, regardless of their position in the hierarchy.</p>
<p>Another way to refer to page items is to use their label property, much as you can use the name property of other objects (such as paragraph styles or layers). In the following examples, we will get an array of page items whose label has been set to myLabel. </p>
<div class="fragment"><div class="line">Rem Given a reference to InDesign <span class="stringliteral">&quot;myInDesign&quot;</span>...</div>
<div class="line">Set myPageItems = myInDesign.Documents.Item(1).Pages.Item(1).PageItems.Item(<span class="stringliteral">&quot;myLabel&quot;</span>)</div>
</div><!-- fragment --><p>If no page items on the page have the specified label, InDesign returns an empty array.</p>
<h3><a class="anchor" id="id_vb_page-item_geometry"></a>
Page-item geometry</h3>
<p>If you are working with page items, it is almost impossible to do anything without understanding the way that rulers and measurements work together to specify the location and shape of an InDesign page item. If you use the Control panel in InDesign's user interface, you probably are already familiar with InDesign's geometry, but here is a quick summary:</p>
<ul>
<li>Objects are constructed relative to the coordinates shown on the rulers.</li>
<li>Changing the zero point location by either dragging the zero point or by changing the ruler origin changes the coordinates on the rulers.</li>
<li>Page items are made up of one or more paths, which, in turn, are made up of two or more path points. Paths can be open or closed.</li>
<li>Path points contain an anchor point (the location of the point itself) and two control handles (left direction, which controls the curve of the line segment preceding the point on the path; and right direction, which controls the curve of the segment following the point). Each of these properties contains an array in the form (x,y) (where x is the horizontal location of the point, and y is the vertical location). This array holds the location, in current ruler coordinates, of the point or control handle.</li>
</ul>
<p>All of the above means that if your scripts need to construct page items, you also need to control the location of the zero point, and you may want to set the measurement units in use.</p>
<p><b>Working with paths and path points</b></p>
<p>For most simple page items, you do not need to worry about the paths and path points that define the shape of the object. Rectangles, ellipses, and text frames can be created by specifying their geometric bounds, as we did in the earlier example in this section.</p>
<p>In some cases, however, you may want to construct or change the shape of a path by specifying path point locations, you can either set the anchor point, left direction, and right direction of each path point on the path individually (as shown in the DrawRegularPolygon_Slow script), or you can use the EntirePath property of the path to set all of the path point locations at once (as shown in the DrawRegularPolygon_Fast script). The latter approach is much faster.</p>
<p>The items in the array you use for the EntirePath property can contain anchor points only, or a anchor points and control handles. Here is an example array containing only anchor point locations: </p>
<div class="fragment"><div class="line">Array(Array(x1, y1), Array(x2, y2), ...)</div>
</div><!-- fragment --><p>Where x and y specify the location of the anchor.</p>
<p>Here is an example containing fully-specified path points (i.e., arrays containing the left direction, anchor, and right direction, in that order): </p>
<div class="fragment"><div class="line">Array(Array(Array(xL1, YL1), Array(x1, y1), Array(xR1, yR1)), Array(Array(xL2, YL2), Array(x2, y2), Array(xR2, yR2)), ...)</div>
</div><!-- fragment --><p>Where xL and yL specify the left direction, x and y specify the anchor point, and xR and yR specify the right direction.</p>
<p>You can also mix the two approaches, as shown in the following example: </p>
<div class="fragment"><div class="line">Array(Array(Array(xL1, YL1), Array(x1, y1), Array(xR1, yR1)), Array(x2, y2), ...)</div>
</div><!-- fragment --><p>Note that the original path does not have to have the same number of points as you specify in the array-InDesign will add or subtract points from the path as it applies the array to the EntirePath property.</p>
<p>The AddPathPoint script shows how to add path points to a path without using the EntirePath property. </p>
<div class="fragment"><div class="line">    Rem Given a graphic line <span class="stringliteral">&quot;myGraphicLine&quot;</span>...</div>
<div class="line">    Set myPathPoint = myGraphicLine.Paths.Item(1).PathPoints.Add</div>
<div class="line">    Rem Move the path point to a specific location.</div>
<div class="line">    myPathPoint.Anchor = Array(144, 144)</div>
</div><!-- fragment --><p> The DeletePathPoint script shows how to delete a path point from a path. </p>
<div class="fragment"><div class="line">Rem Given a polygon <span class="stringliteral">&quot;myPolygon&quot;</span>, <span class="keyword">remove</span> the </div>
<div class="line">Rem last path point in the first path.</div>
<div class="line">myPolygon.Paths.Item(1).PathPoints.Item(-1).Delete</div>
</div><!-- fragment --><h2><a class="anchor" id="id_vb_grouping_page_items"></a>
Grouping Page Items</h2>
<p>In the InDesign user interface, you create groups of page items by selecting them and then choosing Group from the Object menu (or by pressing the corresponding keyboard shortcut). In InDesign scripting, you tell the object containing the page items you want to group (usually a page or spread) to group the page items, as shown in the Group script. </p>
<div class="fragment"><div class="line">    Rem Given a page <span class="stringliteral">&quot;myPage&quot;</span> containing at least two ovals and two rectangles...</div>
<div class="line">    ReDim myArray(0)</div>
<div class="line">    Rem Add the items to the array.</div>
<div class="line">    myPush myArray, myPage.Rectangles.Item(1), True</div>
<div class="line">    myPush myArray, myPage.Rectangles.Item(2), True</div>
<div class="line">    myPush myArray, myPage.Ovals.Item(1), True</div>
<div class="line">    myPush myArray, myPage.Ovals.Item(1), True</div>
<div class="line">    Rem Group the items.</div>
<div class="line">    myPage.Groups.Add myArray</div>
</div><!-- fragment --><p> To ungroup, you tell the group itself to ungroup, as shown in the Ungroup script. </p>
<div class="fragment"><div class="line">    Rem Given a group <span class="stringliteral">&quot;myGroup&quot;</span>...</div>
<div class="line">    Set myPageItems = myGroup.Ungroup</div>
</div><!-- fragment --><p> There is no need to ungroup a group to change the shape, formatting, or content of the page items in the group. Instead, simply get a reference to the page item you want to change, just as you would with any other page item.</p>
<h2><a class="anchor" id="id_vb_duplicating_and_moving_page_items"></a>
Duplicating and Moving Page Items</h2>
<p>In the InDesign user interface, you can move page items by selecting them and dragging them to a new location. You can also create copies of page items by copying and pasting, by holding down Option/Alt as you drag an object, or by choosing Duplicate, Paste In Place, or Step and Repeat from the Edit menu. In InDesign scripting, you can use the move method to change the location of page items, and the duplicate method to create a copy of a page item (and, optionally, move it to another location).</p>
<p>The move method can take one of two optional parameters: MoveTo and MoveBy. Both parameters consist of an array of two measurement units, consisting of a horizontal value and a vertical value. MoveTo specifies an absolute move to the location specified by the array, relative to the current location of the zero point. MoveBy specifies how far to move the page item relative to the current location of the page item itself. The Move script shows the difference between these two approaches. </p>
<div class="fragment"><div class="line">    Rem Given a reference to a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span>...</div>
<div class="line">    Rem Move the rectangle to the location (12, 12).</div>
<div class="line">    Rem Absolute move:</div>
<div class="line">    myRectangle.Move Array(12, 12)</div>
<div class="line">    Rem Move the rectangle *by* 12 points horizontally, 12 points vertically.</div>
<div class="line">    Rem Relative move (note empty first parameter):</div>
<div class="line">    myRectangle.Move , Array(12, 12)</div>
<div class="line">    Rem Move the rectangle to another page (rectangle appears at (0,0).</div>
<div class="line">    Set myPage = myInDesign.Documents.Item(1).Pages.Add</div>
<div class="line">    myRectangle.Move myPage</div>
<div class="line">    Rem To move a page item to another document, use the Duplicate method.</div>
</div><!-- fragment --><p> Note that the move method truly moves the object-when you move a page item to another document, it is deleted from the original document. To move the object to another while retaining the original, use the duplicate method (see below).</p>
<p>Use the duplicate method to create a copy of a page item. By default, the duplicate method creates a "clone" of an object in the same location as the original object. Optional parameters can be used with the duplicate method to move the duplicated object to a new location (including other pages in the same document, or to another document entirely). </p>
<div class="fragment"><div class="line">    Rem Given a reference to a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span>...</div>
<div class="line">    Rem Duplicate the rectangle and move the </div>
<div class="line">    Rem duplicate to the location (12, 12).</div>
<div class="line">    Rem Absolute move:</div>
<div class="line">    Set myDuplicate = myRectangle.Duplicate(Array(12, 12))</div>
<div class="line">    Rem Duplicate the rectangle and move the duplicate *by* 12</div>
<div class="line">    Rem points horizontally, 12 points vertically.</div>
<div class="line">    Rem Relative move (note empty first parameter):</div>
<div class="line">    Set myDuplicate = myRectangle.Duplicate (, Array(12, 12))</div>
<div class="line">    Rem Duplicate the rectangle to another page (rectangle appears at (0,0).</div>
<div class="line">    Set myPage = myInDesign.Documents.Item(1).Pages.Add</div>
<div class="line">    Set myDuplicate = myRectangle.Duplicate(myPage)</div>
<div class="line">    Rem Duplicate the rectangle to another document.</div>
<div class="line">    Set myDocument = myInDesign.Documents.Add</div>
<div class="line">    Set myDuplicate = myRectangle.Duplicate(myDocument.Pages.Item(1))</div>
</div><!-- fragment --><p> You can also use copy and paste in InDesign scripting, but scripts using on these methods require that you select objects (to copy) and rely on the current view to set the location of the pasted elements (when you paste). This means that scripts that use copy and paste tend to be more fragile (i.e., more likely to fail) than scripts that use duplicate and move. Whenever possible, try to write scripts that do not depend on the current view or selection state.</p>
<h3><a class="anchor" id="id_vb_creating_compound_paths"></a>
Creating compound paths</h3>
<p>InDesign can combine the paths of two or more page items into a single page item containing multiple paths using the Object &gt; Paths &gt; Make Compound Path menu option. You can do this in InDesign scripting using the MakeCompoundPath method of a page item, as shown in the following script fragment (for the complete script, refer to the MakeCompoundPath script). </p>
<div class="fragment"><div class="line">    Rem Given a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span> and an Oval <span class="stringliteral">&quot;myOval&quot;</span>...</div>
<div class="line">    myRectangle.MakeCompoundPath myOval</div>
</div><!-- fragment --><p> When you create a compound path, regardless of the types of the objects used to create the compound path, the type of the resulting object is polygon.</p>
<p>To release a compound path and convert each path in the compound path into a separate page item, use the ReleaseCompoundPath method of a page item, as shown in the following script fragment (for the complete script, refer to the ReleaseCompoundPath script). </p>
<div class="fragment"><div class="line">    Rem Given a path <span class="stringliteral">&quot;myCompoundPath&quot;</span> (all compound paths are type Rectangle)...</div>
<div class="line">    Set mPageItems = myCompoundPath.ReleaseCompoundPath</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_using_pathfinder_operations"></a>
Using Pathfinder operations</h3>
<p>The InDesign Pathfinder features offer ways to work with relationships between page items on an InDesign page. You can merge the paths of page items, or subtract the area of one page item from another page item, or create a new page item from the area of intersection of two or more page items. Every page item supports the following methods related to the Pathfinder features: AddPath, ExcludeOverlapPath, IntersectPath, MinusBack, and SubtractPath.</p>
<p>All of the Pathfinder methods work the same way&ndash;you provide an array of page items to use as the basis for the operation (just as you select a series of page items before choosing the Pathfinder operation in the user interface).</p>
<p>Note that it is very likely that the type of the object will change after you apply one of the Pathfinder operations. Which object type it will change to depends on the number and location of the points in the path or paths resulting from the operation.</p>
<p>To merge two page items into a single page item, for example, you would use something like the approach shown in the following fragment (for the complete script, refer to AddPath). </p>
<div class="fragment"><div class="line">    Rem Given a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span> and an Oval <span class="stringliteral">&quot;myOval&quot;</span>...</div>
<div class="line">    myRectangle.AddPath myOval</div>
</div><!-- fragment --><p> The ExcludeOverlapPath method creates a new path based on the non-intersecting areas of two or more overlapping page items, as shown in the following script fragment (for the complete script, refer to ExcludeOverlapPath). </p>
<div class="fragment"><div class="line">    Rem Given a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span> and an Oval <span class="stringliteral">&quot;myOval&quot;</span>...</div>
<div class="line">    myRectangle.ExcludeOverlapPath myOval</div>
</div><!-- fragment --><p> The IntersectPath method creates a new page item from the area of intersection of two or more page items, as shown in the following script fragment (for the complete script, refer to IntersectPath). </p>
<div class="fragment"><div class="line">    Rem Given a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span> and an Oval <span class="stringliteral">&quot;myOval&quot;</span>...</div>
<div class="line">    myRectangle.IntersectPath myOval</div>
</div><!-- fragment --><p> The MinusBack method removes the area of intersection of the back-most object from the page item or page items in front of it, as shown in the following script fragment (for the complete script, refer to MinusBack). </p>
<div class="fragment"><div class="line">    Rem Given a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span> and an Oval <span class="stringliteral">&quot;myOval&quot;</span>...</div>
<div class="line">    myRectangle.MinusBack myOval</div>
</div><!-- fragment --><p> The SubtractPath method removes the area of intersection of the frontmost object from the page item or page items behind it, as shown in the following script fragment (for the complete script, refer to SubtractPath). </p>
<div class="fragment"><div class="line">    Rem Given a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span> and an Oval <span class="stringliteral">&quot;myOval&quot;</span>...</div>
<div class="line">    myOval.SubtractPath myRectangle</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_converting_page-item_shapes"></a>
Converting page-item shapes</h3>
<p>InDesign page items can be converted to other shapes using the options in the Object &gt; Convert Shape menu or the Pathfinder panel (Window &gt; Object and Layout &gt; Pathfinder). In InDesign scripting, page items support the ConvertShape method, as demonstrated in the following script fragment (for the complete script, refer to ConvertShape). </p>
<div class="fragment"><div class="line">    Rem Given a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span>...</div>
<div class="line">    myRectangle.ConvertShape idConvertShapeOptions.idConvertToRoundedRectangle</div>
</div><!-- fragment --><p> The ConvertShape method also provides a way to open or close reverse paths, as shown in the following script fragment (for the complete script, refer to OpenPath). </p>
<div class="fragment"><div class="line">    Rem Given a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span>...</div>
<div class="line">    myRectangle.ConvertShape idConvertShapeOptions.idConvertToOpenPath</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_arranging_page_items"></a>
Arranging page items</h3>
<p>Page items in an InDesign layout can be arranged in front of or behind each other by adjusting their stacking order within a layer, or can be placed on different layers. The following script fragment shows how to bring objects to the front or back of their layer, and how to control the stacking order of objects relative to each other (for the complete script, refer to StackingOrder). </p>
<div class="fragment"><div class="line">    Rem Given a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span> and an oval <span class="stringliteral">&quot;myOval&quot;</span>,</div>
<div class="line">    Rem where <span class="stringliteral">&quot;myOval&quot;</span> is in front of <span class="stringliteral">&quot;myRectangle&quot;</span>, bring</div>
<div class="line">    Rem the rectangle to the front...</div>
<div class="line">    myRectangle.BringToFront</div>
</div><!-- fragment --><p> When you create a page item, you can specify its layer, but you can also move a page item from one layer to another. The ItemLayer property of the page item is the key to doing this, as shown in the following script fragment (for the complete script, refer to ItemLayer). </p>
<div class="fragment"><div class="line">    Rem Given a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span> and a layer <span class="stringliteral">&quot;myLayer&quot;</span>,</div>
<div class="line">    Rem send the rectangle to the layer...</div>
<div class="line">    myRectangle.ItemLayer = myInDesign.Documents.Item(1).Layers.Item(<span class="stringliteral">&quot;myLayer&quot;</span>)</div>
</div><!-- fragment --><p> The stacking order of layers in a document can also be changed using the Move method of the layer itself, as shown in the following script fragment (for the complete script, refer to MoveLayer). </p>
<div class="fragment"><div class="line">    Rem Given a layer <span class="stringliteral">&quot;myLayer&quot;</span>, move the layer behind</div>
<div class="line">    Rem the <span class="keywordflow">default</span> layer (the lowest layer in the document </div>
<div class="line">    Rem is Layers.Item(-1).</div>
<div class="line">    myLayer.Move idLocationOptions.idAfter, myInDesign.Documents.Item(1).Layers.Item(-1)</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_transforming_page_items"></a>
Transforming Page Items</h2>
<p>Transformations include scaling, rotation, shearing (skewing), and movement (or translation). In scripting, you apply transformations using the transform method. This one method replaces the resize, rotate, and shear methods used in versions of InDesign prior to InDesign CS3 (5.0).</p>
<h3><a class="anchor" id="id_vb_using_the_transform_method"></a>
Using the transform method</h3>
<p>The transform method requires a transformation matrix (TransformationMatrix) object that defines the transformation or series of transformations to apply to the object. A transformation matrix can contain any combination of scale, rotate, shear, or translate operations.</p>
<p>The order in which transformations are applied to an object is important. Applying transformations in differing orders can produce very different results.</p>
<p>To transform an object, you follow two steps:</p>
<ol type="1">
<li>Create a transformation matrix.</li>
<li>Apply the transformation matrix to the object using the transform method. When you do this, you also specify the coordinate system in which the transformation is to take place. For more on coordinate systems, see <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_coordinate_spaces">Coordinate spaces</a>. In addition, you specify the center of transformation, or transformation origin. For more on specifying the transformation origin, see <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_transformation_origin">Transformation origin</a>.</li>
</ol>
<p>The following scripting example demonstrates the basic process of transforming a page item. (For the complete script, see TransformExamples.) </p>
<div class="fragment"><div class="line">    Rem Rotate a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span> around its center point.</div>
<div class="line">    <span class="keyword">set</span> myRotateMatrix = myInDesign.transformationMatrices.add(, , , 27)</div>
<div class="line">    myRectangle.Transform idCoordinateSpaces.idPasteboardCoordinates, idAnchorPoint.idCenterAnchor, myRotateMatrix</div>
<div class="line">    MsgBox <span class="stringliteral">&quot;Rotated around center anchor.&quot;</span></div>
<div class="line">    myDocument.Undo</div>
<div class="line">    Rem Scale a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span> around its center point.</div>
<div class="line">    <span class="keyword">set</span> myScaleMatrix = myInDesign.TransformationMatrices.Add(.5, .5)</div>
<div class="line">    myRectangle.Transform idCoordinateSpaces.idPasteboardCoordinates, idAnchorPoint.idCenterAnchor, myScaleMatrix</div>
<div class="line">    MsgBox <span class="stringliteral">&quot;Scaled around center anchor.&quot;</span></div>
<div class="line">    myDocument.Undo</div>
<div class="line">    Rem Shear a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span> around its center point.</div>
<div class="line">    <span class="keyword">set</span> myShearMatrix = myInDesign.TransformationMatrices.Add(, , 30)</div>
<div class="line">    myRectangle.Transform idCoordinateSpaces.idPasteboardCoordinates, idAnchorPoint.idCenterAnchor, myShearMatrix</div>
<div class="line">    MsgBox <span class="stringliteral">&quot;Sheared around center anchor.&quot;</span></div>
<div class="line">    myDocument.Undo</div>
<div class="line">    Rem Rotate a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span> around a specified ruler point ([72, 72]).</div>
<div class="line">    Set myRotateMatrix = myInDesign.transformationMatrices.add(, , , 27)</div>
<div class="line">    myRectangle.Transform idCoordinateSpaces.idPasteboardCoordinates, Array(Array(72, 72), idAnchorPoint.idCenterAnchor), myRotateMatrix, , True</div>
<div class="line">    MsgBox <span class="stringliteral">&quot;Rotated around 72x, 72y.&quot;</span></div>
<div class="line">    myDocument.Undo</div>
<div class="line">    Rem Scale a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span> around a specified ruler point ([72, 72]).</div>
<div class="line">    Set myScaleMatrix = myInDesign.transformationMatrices.add(.5, .5)</div>
<div class="line">    myRectangle.Transform idCoordinateSpaces.idPasteboardCoordinates, Array(Array(72, 72), idAnchorPoint.idCenterAnchor), myScaleMatrix, , True</div>
<div class="line">    MsgBox <span class="stringliteral">&quot;Scaled around 72x, 72y&quot;</span></div>
<div class="line">    myDocument.Undo</div>
</div><!-- fragment --><p> For a script that "wraps" transformation routines in a series of easy-to-use functions, refer to the Transform script.</p>
<h3><a class="anchor" id="id_vb_working_with_transformation_matrices"></a>
Working with transformation matrices</h3>
<p>A transformation matrix cannot be changed once it has been created, but a variety of methods can interact with the transformation matrix to create a new transformation matrix based on the existing transformation matrix. In the following examples, we show how to apply transformations to a transformation matrix and replace the original matrix. (For the complete script, see TransformMatrix.)</p>
<div class="fragment"><div class="line">Rem Scale a transformation matrix by 50% in </div>
<div class="line">Rem both horizontal and vertical dimensions.</div>
<div class="line">var myTransformationMatrix = myTransformationMatrix.scaleMatrix(.5, .5);</div>
<div class="line">var myTransformationMatrix = myTransformationMatrix.scaleMatrix(.5, .5);</div>
<div class="line">Rem Rotate a transformation matrix by 45 degrees.</div>
<div class="line">myTransformationMatrix = myTransformationMatrix.rotateMatrix(45);</div>
<div class="line">Rem Shear a transformation matrix by 15 degrees.</div>
<div class="line">myTransformationMatrix = myTransformationMatrix.shearMatrix(15);</div>
</div><!-- fragment --><p>When you use the RotateMatrix method, you can use a sine or cosine value to transform the matrix, rather than an angle in degrees, as shown in the RotateMatrix script. </p>
<div class="fragment"><div class="line">    Set myTransformationMatrix = myInDesign.TransformationMatrices.Add</div>
<div class="line">    Rem rotateMatrix can take the following parameters: byAngle, byCosine, bySine</div>
<div class="line">    Rem Replace the current matrix with the rotated matrix.</div>
<div class="line">    Rem The following statements are equivalent (0.25881904510252 is the sine of 15 degrees, 0.96592582628907 is the cosine).</div>
<div class="line">    Rem myTransformationMatrix = myTransformationMatrix.rotateMatrix(15)</div>
<div class="line">    Rem myTransformationMatrix = myTransformationMatrix.rotateMatrix(, 0.96592582628907)</div>
<div class="line">    Rem myTransformationMatrix = myTransformationMatrix.rotateMatrix(, , 0.25881904510252)</div>
<div class="line">    Set myTransformationMatrix = myTransformationMatrix.RotateMatrix(15)</div>
<div class="line">    myRectangle.Transform idCoordinateSpaces.idPasteboardCoordinates, idAnchorPoint.idCenterAnchor, myTransformationMatrix</div>
</div><!-- fragment --><p> When you use the shearMatrixmethod, you can provide a slope, rather than an angle in degrees, as shown in the ShearMatrix script. </p>
<div class="fragment"><div class="line">    Set myRectangle = myInDesign.Documents.Item(1).Pages.Item(1).Rectangles.Item(1)</div>
<div class="line">    Set myTransformationMatrix = myInDesign.TransformationMatrices.Add(, , 0)</div>
<div class="line">    Rem ShearMatrix can take the following parameters: byAngle, bySlope</div>
<div class="line">    Rem Replace the current matrix with the sheared matrix.</div>
<div class="line">    Set myTransformationMatrix = myTransformationMatrix.ShearMatrix(45)</div>
<div class="line">    myRectangle.Transform idCoordinateSpaces.idPasteboardCoordinates, idAnchorPoint.idCenterAnchor, myTransformationMatrix</div>
<div class="line">    Rem The following statements are equivalent. </div>
<div class="line">    Rem slope = rise/run--so a 45 degree slope is 1.</div>
<div class="line">    Set myTransformationMatrix = myTransformationMatrix.shearMatrix(45)</div>
<div class="line">    Set myTransformationMatrix = myTransformationMatrix.shearMatrix(, 1)</div>
</div><!-- fragment --><p> You can get the inverse of a transformation matrix using the InvertMatrix method, as shown in the following example. (For the complete script, see InvertMatrix.) You can use the inverted transformation matrix to undo the effect of the matrix. </p>
<div class="fragment"><div class="line">    Set myRectangle = myInDesign.Documents.Item(1).Pages.Item(1).Rectangles.Item(1)</div>
<div class="line">    Set myTransformationMatrix = myInDesign.TransformationMatrices.Add(, , , 30, 12, 12)</div>
<div class="line">    myRectangle.Transform idCoordinateSpaces.idPasteboardCoordinates, idAnchorPoint.idCenterAnchor, myTransformationMatrix</div>
<div class="line">    Set myNewRectangle = myRectangle.Duplicate</div>
<div class="line">    Rem Move the duplicated rectangle to the location of the original </div>
<div class="line">    Rem rectangle by inverting, then applying the transformation matrix.</div>
<div class="line">    Set myTransformationMatrix = myTransformationMatrix.InvertMatrix</div>
<div class="line">    myRectangle.Transform idCoordinateSpaces.idPasteboardCoordinates, idAnchorPoint.idCenterAnchor, myTransformationMatrix</div>
</div><!-- fragment --><p> You can add transformation matrices using the CatenateMatrix method, as shown in the following example. (For the complete script, see CatenateMatrix.) </p>
<div class="fragment"><div class="line">    Rem Transformation matrix with counterclockwise rotation angle = 30.</div>
<div class="line">    Set myTransformationMatrixA = myInDesign.TransformationMatrices.Add(, , , 30)</div>
<div class="line">    Rem Transformation matrix with horizontal translation = 12, vertical translation = 12.</div>
<div class="line">    Set myTransformationMatrixB = myInDesign.TransformationMatrices.Add(, , , , 12, 12)</div>
<div class="line">    Set myRectangle = myInDesign.Documents.Item(1).Pages.Item(1).Rectangles.Item(1)</div>
<div class="line">    Set myNewRectangle = myRectangle.Duplicate</div>
<div class="line">    Rem Rotate the duplicated rectangle.</div>
<div class="line">    myNewRectangle.Transform idCoordinateSpaces.idPasteboardCoordinates, idAnchorPoint.idCenterAnchor, myTransformationMatrixA</div>
<div class="line">    Set myNewRectangle = myRectangle.Duplicate</div>
<div class="line">    Rem Move the duplicate (unrotated) rectangle.</div>
<div class="line">    myNewRectangle.Transform idCoordinateSpaces.idPasteboardCoordinates, idAnchorPoint.idCenterAnchor, myTransformationMatrixB  </div>
<div class="line">    Rem Merge the two transformation matrices.</div>
<div class="line">    Set myTransformationMatrix = myTransformationMatrixA.CatenateMatrix(myTransformationMatrixB)</div>
<div class="line">    Set myNewRectangle = myRectangle.Duplicate</div>
<div class="line">    Rem The duplicated rectangle will be both moved and rotated.</div>
<div class="line">    myNewRectangle.Transform idCoordinateSpaces.idPasteboardCoordinates, idAnchorPoint.idCenterAnchor, myTransformationMatrix   </div>
</div><!-- fragment --><p> When an object is transformed, you can get the transformation matrix that was applied to it, using the TransformValuesOf method, as shown in the following script fragment. (For the complete script, see TransformValuesOf.)</p>
<div class="fragment"><div class="line">    Set myRectangle = myInDesign.Documents.Item(1).Pages.Item(1).Rectangles.Item(1)</div>
<div class="line">    Rem Note that transformValuesOf() always returns an array containing a single transformationMatrix.</div>
<div class="line">    Set myTransformArray = myRectangle.TransformValuesOf(idCoordinateSpaces.idPasteboardCoordinates)</div>
<div class="line">    Set myTransformationMatrix = myTransformArray.Item(1)</div>
<div class="line">    myRotationAngle = myTransformationMatrix.CounterclockwiseRotationAngle</div>
<div class="line">    myShearAngle = myTransformationMatrix.ClockwiseShearAngle</div>
<div class="line">    myXScale = myTransformationMatrix.HorizontalScaleFactor</div>
<div class="line">    myYScale = myTransformationMatrix.VerticalScaleFactor</div>
<div class="line">    myXTranslate = myTransformationMatrix.HorizontalTranslation</div>
<div class="line">    myYTranslate = myTransformationMatrix.VerticalTranslation</div>
<div class="line">    myString = &quot;Rotation Angle: &quot; &amp; myRotationAngle &amp; vbCr</div>
<div class="line">    myString = myString &amp; &quot;Shear Angle: &quot; &amp; myShearAngle &amp; vbCr</div>
<div class="line">    myString = myString &amp; &quot;Horizontal Scale Factor: &quot; &amp; myXScale &amp; vbCr</div>
<div class="line">    myString = myString &amp; &quot;Vertical Scale Factor: &quot; &amp; myYScale &amp; vbCr</div>
<div class="line">    myString = myString &amp; &quot;Horizontal Translation: &quot; &amp; myXTranslate &amp; vbCr</div>
<div class="line">    myString = myString &amp; &quot;Vertical Translation: &quot; &amp; myYTranslate &amp; vbCr &amp; vbCr</div>
<div class="line">    myString = myString &amp; &quot;Note that the Horizontal Translation and&quot; &amp; vbCr</div>
<div class="line">    myString = myString &amp; &quot;Vertical Translation values are the location&quot; &amp; vbCr</div>
<div class="line">    myString = myString &amp; &quot;of the center anchor in pasteboard coordinates.&quot;</div>
<div class="line">    MsgBox myString</div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>The values in the horizontal- and vertical-translation fields of the transformation matrix returned by this method are the location of the upper-left anchor of the object, in pasteboard coordinates.</dd></dl>
<h3><a class="anchor" id="id_vb_coordinate_spaces"></a>
Coordinate spaces</h3>
<p>In the transformation scripts we presented earlier, you might have noticed the CoordinateSpaces.pasteboardCoordinates enumeration provided as a parameter for the transform method. This parameter determines the system of coordinates, or coordinate space, in which the transform operation occurs. The coordinate space can be one of the following values:</p>
<ul>
<li>idCoordinateSpaces.idPasteboardCoordinates is the coordinate space of the entire InDesign document. This coordinate space extends behind all spreads in a document. It does not correspond to InDesign's rulers or zero point, nor does it have anything to do with the pasteboard area you can see around pages in the InDesign user interface. Transformations applied to objects have no effect on this coordinate space (e.g., the angle of the horizontal and vertical axes do not change).</li>
<li>idCoordinateSpaces.idParentCoordinates is the coordinate space of the parent of the object. Any transformations applied to the parent affect the parent coordinates; for example, rotating the parent object changes the angle of the horizontal and vertical axes of this coordinate space. In this case, the parent object refers to the group or page item containing the object; if the parent of the object is a page or spread, parent coordinates are the same as spread coordinates.</li>
<li>idCoordinateSpaces.idInnerCoordinates is the coordinate space in which the object itself was created.</li>
<li>idCoordinateSpaces.idSpreadCoordinates is the coordinate space of the spread. The origin of this space is at the center of the spread, and does not correspond to the rulers you see in the user interface.</li>
</ul>
<p>The following script shows the differences between the coordinate spaces. (For the complete script, see CoordinateSpaces.) </p>
<div class="fragment"><div class="line">    Set myRectangle = myInDesign.Documents.Item(1).Pages.Item(1).Groups.Item(1).Rectangles.Item(1)<span class="stringliteral">&#39;</span></div>
<div class="line"><span class="stringliteral">    myString = &quot;The page contains a group which has been&quot; &amp; vbCr</span></div>
<div class="line"><span class="stringliteral">    myString = myString &amp; &quot;rotated 45 degrees (counterclockwise).&quot; &amp; vbCr</span></div>
<div class="line"><span class="stringliteral">    myString = myString &amp; &quot;The rectangle inside the group was&quot; &amp; vbCr</span></div>
<div class="line"><span class="stringliteral">    myString = myString &amp; &quot;rotated 45 degrees counterclockwise&quot; &amp; vbCr</span></div>
<div class="line"><span class="stringliteral">    myString = myString &amp; &quot;before it was added to the group.&quot; &amp; vbCr &amp; vbcr</span></div>
<div class="line"><span class="stringliteral">    myString = myString &amp; &quot;Watch as we apply a series of scaling&quot; &amp; vbCr</span></div>
<div class="line"><span class="stringliteral">    myString = myString &amp; &quot;operations in different coordinate spaces.&quot; &amp; vbCr &amp; vbCr</span></div>
<div class="line"><span class="stringliteral">    myString = myString &amp; &quot;(You might need to move the alert aside&quot; &amp; vbCr</span></div>
<div class="line"><span class="stringliteral">    myString = myString &amp; &quot;to see the effect of the transformations.)&quot; &amp; vbCr</span></div>
<div class="line"><span class="stringliteral">    MsgBox myString</span></div>
<div class="line"><span class="stringliteral">    Rem Create a transformation matrix with horizontal scale factor = 2.</span></div>
<div class="line"><span class="stringliteral">    Set myTransformationMatrix = myInDesign.TransformationMatrices.Add(2)</span></div>
<div class="line"><span class="stringliteral">    Rem Transform the rectangle using inner coordinates.</span></div>
<div class="line"><span class="stringliteral">    myRectangle.Transform idCoordinateSpaces.idInnerCoordinates, idAnchorPoint.idCenterAnchor, myTransformationMatrix</span></div>
<div class="line"><span class="stringliteral">    Rem Select the rectangle and display an alert.</span></div>
<div class="line"><span class="stringliteral">    myInDesign.Select myRectangle</span></div>
<div class="line"><span class="stringliteral">    MsgBox &quot;Transformed by inner coordinates.&quot;</span></div>
<div class="line"><span class="stringliteral">    Rem Undo the transformation.</span></div>
<div class="line"><span class="stringliteral">    myInDesign.Documents.Item(1).Undo</span></div>
<div class="line"><span class="stringliteral">    Rem Transform using parent coordinates.</span></div>
<div class="line"><span class="stringliteral">    myRectangle.Transform idCoordinateSpaces.idParentCoordinates, idAnchorPoint.idCenterAnchor, myTransformationMatrix</span></div>
<div class="line"><span class="stringliteral">    myInDesign.Select myRectangle</span></div>
<div class="line"><span class="stringliteral">    MsgBox &quot;Transformed by parent coordinates.&quot;</span></div>
<div class="line"><span class="stringliteral">    myInDesign.Documents.Item(1).Undo</span></div>
<div class="line"><span class="stringliteral">    Rem Transform using pasteboard coordinates.</span></div>
<div class="line"><span class="stringliteral">    myRectangle.Transform idCoordinateSpaces.idPasteboardCoordinates, idAnchorPoint.idCenterAnchor, myTransformationMatrix</span></div>
<div class="line"><span class="stringliteral">    myInDesign.Select myRectangle</span></div>
<div class="line"><span class="stringliteral">    MsgBox &quot;Transformed by pasteboard coordinates.&quot;</span></div>
<div class="line"><span class="stringliteral">    myInDesign.Documents.Item(1).Undo</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_transformation_origin"></a>
Transformation origin</h3>
<p>The transformation origin is the center point of the transformation. The transformation origin can be specified in several ways:</p>
<ul>
<li>Bounds space:<ul>
<li>anchor - An anchor point on the object itself. <div class="fragment"><div class="line">AnchorPoint.CenterAnchor</div>
</div><!-- fragment --></li>
<li>anchor, bounds type - An anchor point specified relative to the geometric bounds of the object (BoundingBoxLimits.GeometricPathBounds) or the visible bounds of the object (BoundingBoxLimits.OuterStrokeBounds). <div class="fragment"><div class="line">Array(idAnchorPoint.idBottomLeftAnchor, idBoundingBoxLimits.idOuterStrokeBounds)</div>
</div><!-- fragment --></li>
<li>anchor, bounds type, coordinate system - An anchor point specified as the geometric bounds of the object (BoundingBoxLimits.GeometricPathBounds) or the visible bounds of the object (BoundingBoxLimits.OuterStrokeBounds) in a given coordinate space. <div class="fragment"><div class="line">Array(idAnchorPoint.idBottomLeftAnchor, idBoundingBoxLimits.idOuterStrokeBounds,idCoordinateSpaces.idPasteboardCoordinates)</div>
</div><!-- fragment --></li>
</ul>
</li>
<li>(x,y), bounds type - A point specified relative to the geometric bounds of the object (BoundingBoxLimits.GeometricPathBounds) or the visible bounds of the object (BoundingBoxLimits.OuterStrokeBounds). In this case, the top-left corner of the bounding box is (0, 0); the bottom-right corner, (1, 1). The center anchor is located at (.5, .5). <div class="fragment"><div class="line">Array(Array(.5, .5), idBoundingBoxLimits.idOuterStrokeBounds)</div>
</div><!-- fragment --></li>
<li>(x, y), bounds type, coordinate space - A point specified relative to the geometric bounds of the object (BoundingBoxLimits.GeometricPathBounds) or the visible bounds of the object (BoundingBoxLimits.OuterStrokeBounds) in a given coordinate space. In this case, the top-left corner of the bounding box is (0, 0); the bottom-right corner, (1, 1). The center anchor is located at (.5, .5). <div class="fragment"><div class="line">Array(Array(.5, .5), idBoundingBoxLimits.idOuterStrokeBounds, idCoordinateSpaces.idPasteboardCoordinates)</div>
</div><!-- fragment --></li>
<li>Ruler space:<ul>
<li>(x, y), page index - A point, relative to the ruler origin on a specified page of a spread. <div class="fragment"><div class="line">Array(Array(72, 144), 1)</div>
</div><!-- fragment --></li>
</ul>
</li>
<li>(x, y), location - A point, relative to the parent page of the specified location of the object. Location can be specified as an anchor point or a coordinate pair. It can be specified relative to the object's geometric or visible bounds, and it can be specified in a given coordinate space. <div class="fragment"><div class="line">Array(Array(72, 144), idAnchorPoint.idCenterAnchor)</div>
</div><!-- fragment --></li>
<li>Transform space:<ul>
<li>(x, y) - A point in the pasteboard coordinate space. <div class="fragment"><div class="line">Array(72, 72)</div>
</div><!-- fragment --></li>
<li>(x, y), coordinate system - A point in the specified coordinate space. <div class="fragment"><div class="line">Array(Array(72, 72), idCoordinateSpaces.idParentCoordinates</div>
</div><!-- fragment --></li>
<li>((x, y)) - A point in the coordinate space given as the in parameter of the transform method. <div class="fragment"><div class="line">Array(Array(72, 72))</div>
</div><!-- fragment --></li>
</ul>
</li>
</ul>
<p>The following script example shows how to use some of the transformation origin options. (For the complete script, see TransformationOrigin.) </p>
<div class="fragment"><div class="line">    Set myPage = myInDesign.Documents.Item(1).Pages.Item(1)</div>
<div class="line">    Set myRectangle = myPage.Rectangles.Item(1)</div>
<div class="line">    myString = <span class="stringliteral">&quot;Watch as we rotate the rectangle using different anchor points,&quot;</span> &amp; vbCr</div>
<div class="line">    myString = myString &amp; <span class="stringliteral">&quot;bounds types, and coordinate spaces.&quot;</span> &amp; vbCr &amp; vbCr</div>
<div class="line">    myString = myString &amp; <span class="stringliteral">&quot;(You might need to move the alert aside&quot;</span> &amp; vbCr</div>
<div class="line">    myString = myString &amp; <span class="stringliteral">&quot;to see the effect of the transformations.)&quot;</span></div>
<div class="line">    MsgBox myString</div>
<div class="line">    Set myNewRectangle = myRectangle.Duplicate</div>
<div class="line">    Rem Create a transformation matrix with counterclockwise rotation angle = 30.</div>
<div class="line">    Set myTransformationMatrix = myInDesign.TransformationMatrices.Add(, , , 30)</div>
<div class="line">    Rem Rotate around the duplicated rectangle<span class="stringliteral">&#39;s center point.</span></div>
<div class="line"><span class="stringliteral">    myNewRectangle.Transform idCoordinateSpaces.idPasteboardCoordinates, idAnchorPoint.idCenterAnchor, myTransformationMatrix</span></div>
<div class="line"><span class="stringliteral">    Rem Select the rectangle and display an alert.</span></div>
<div class="line"><span class="stringliteral">    myInDesign.Select myNewRectangle</span></div>
<div class="line"><span class="stringliteral">    MsgBox &quot;Transformed around center anchor.&quot;</span></div>
<div class="line"><span class="stringliteral">    Rem Undo the transformation.</span></div>
<div class="line"><span class="stringliteral">    myInDesign.Documents.Item(1).Undo</span></div>
<div class="line"><span class="stringliteral">    Rem Rotate the rectangle around the ruler location [-100, -100]. </span></div>
<div class="line"><span class="stringliteral">    Rem Note that the anchor point specified here specifes the page</span></div>
<div class="line"><span class="stringliteral">    Rem containing the point--*not* that transformation point itself. </span></div>
<div class="line"><span class="stringliteral">    Rem The transformation gets the ruler coordinate [-100, -100] based</span></div>
<div class="line"><span class="stringliteral">    Rem on that page. Setting the considerRulerUnits parameter to true </span></div>
<div class="line"><span class="stringliteral">    Rem makes certain that the transformation uses the current</span></div>
<div class="line"><span class="stringliteral">    Rem ruler units.</span></div>
<div class="line"><span class="stringliteral">    myNewRectangle.Transform idCoordinateSpaces.idPasteboardCoordinates, Array(Array(-100, -100), idAnchorPoint.idTopLeftAnchor), myTransformationMatrix, , True</span></div>
<div class="line"><span class="stringliteral">    Rem Move the page guides to reflect the transformation point.</span></div>
<div class="line"><span class="stringliteral">    myPage.Guides.Item(1).Location = -100</span></div>
<div class="line"><span class="stringliteral">    myPage.Guides.Item(2).Location = -100</span></div>
<div class="line"><span class="stringliteral">    Rem Select the rectangle and display an alert.</span></div>
<div class="line"><span class="stringliteral">    myInDesign.Select myNewRectangle</span></div>
<div class="line"><span class="stringliteral">    MsgBox &quot;Rotated around -100x, -100y.&quot;</span></div>
<div class="line"><span class="stringliteral">    Rem Undo the transformation and the guide moves.</span></div>
<div class="line"><span class="stringliteral">    myInDesign. Documents.Item(1).Undo</span></div>
<div class="line"><span class="stringliteral">    myInDesign. Documents.Item(1).Undo</span></div>
<div class="line"><span class="stringliteral">    myInDesign. Documents.Item(1).Undo</span></div>
<div class="line"><span class="stringliteral">    myNewRectangle.StrokeWeight = 12</span></div>
<div class="line"><span class="stringliteral">    myBounds = myNewRectangle.visibleBounds</span></div>
<div class="line"><span class="stringliteral">    Rem Move the page guides to reflect the transformation point.</span></div>
<div class="line"><span class="stringliteral">    myPage.Guides.Item(1).Location = myBounds(1)</span></div>
<div class="line"><span class="stringliteral">    myPage.Guides.Item(2).Location = myBounds(2)</span></div>
<div class="line"><span class="stringliteral">    Rem Rotate the rectangle around the outer edge of the lower left corner.</span></div>
<div class="line"><span class="stringliteral">    myNewRectangle.Transform idCoordinateSpaces.idPasteboardCoordinates, Array(idAnchorPoint.idBottomLeftAnchor, idBoundingBoxLimits.idOuterStrokeBounds), myTransformationMatrix, idMatrixContent.idRotationValue, True</span></div>
<div class="line"><span class="stringliteral">    Rem Select the rectangle and display an alert.</span></div>
<div class="line"><span class="stringliteral">    myInDesign.Select myNewRectangle</span></div>
<div class="line"><span class="stringliteral">    MsgBox &quot;Rotated around the outside edge of the bottom left corner.&quot;</span></div>
<div class="line"><span class="stringliteral">    Rem Undo the transformation and the guide moves.</span></div>
<div class="line"><span class="stringliteral">    myInDesign. Documents.Item(1).Undo</span></div>
<div class="line"><span class="stringliteral">    myInDesign. Documents.Item(1).Undo</span></div>
<div class="line"><span class="stringliteral">    myInDesign. Documents.Item(1).Undo</span></div>
<div class="line"><span class="stringliteral">    myInDesign. Documents.Item(1).Undo</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_resolving_locations"></a>
Resolving locations</h3>
<p>Sometimes, you need to get the location of a point specified in one coordinate space in the context of another coordinate space. To do this, use the resolve method, as shown in the following script example. (For the complete script, see ResolveLocation.) </p>
<div class="fragment"><div class="line">    Set myPage = myInDesign.Documents.Item(1).Pages.Item(1)</div>
<div class="line">    Set myRectangle = myPage.Groups.Item(1).Rectangles.Item(1)</div>
<div class="line">    Rem Template <span class="keywordflow">for</span> resolve():</div>
<div class="line">    Rem PageItem.resolve (Location:any, in: CoordinateSpaces, ConsideringRulerUnits:boolean)</div>
<div class="line">    Rem Get a ruler coordinate in pasteboard coordinates.</div>
<div class="line">    <span class="stringliteral">&#39;myPageLocation = myRectangle.Resolve(Array(Array(72, 72), idAnchorPoint.idTopRightAnchor), idCoordinateSpaces.idPasteboardCoordinates, True)</span></div>
<div class="line"><span class="stringliteral">    Rem resolve() returns an array (in this case, the array containins a single item).</span></div>
<div class="line"><span class="stringliteral">    &#39;</span>myPageLocation = myPageLocation(0)</div>
<div class="line">    <span class="stringliteral">&#39;myPageLocationX = myPageLocation(0)</span></div>
<div class="line"><span class="stringliteral">    &#39;</span>myPageLocationY = myPageLocation(1)</div>
<div class="line">    <span class="stringliteral">&#39;MsgBox &quot;X: &quot; &amp; CStr(myPageLocation(0)) &amp; vbCr &amp; &quot;Y: &quot; &amp; CStr(myPageLocation(1))</span></div>
<div class="line"><span class="stringliteral">    Rem Because of the above problem, here&#39;</span>s a workaround using JavaScript.</div>
<div class="line">    myString = <span class="stringliteral">&quot;var myRectangle = app.documents.item(0).pages.item(0).groups.item(0).rectangles.item(0);&quot;</span> &amp; vbCr</div>
<div class="line">    myString = myString &amp; <span class="stringliteral">&quot;var myPageLocation = myRectangle.resolve([[72, 72], AnchorPoint.topRightAnchor], CoordinateSpaces.pasteboardCoordinates, true);&quot;</span> &amp; vbCr</div>
<div class="line">    myString = myString &amp; <span class="stringliteral">&quot;alert(&quot;</span><span class="stringliteral">&quot;X: &quot;</span><span class="stringliteral">&quot; + myPageLocation[0][0] + &quot;</span><span class="stringliteral">&quot;\rY: &quot;</span><span class="stringliteral">&quot; + myPageLocation[0][1])&quot;</span></div>
<div class="line">    myInDesign.DoScript myString, idScriptLanguage.idJavaScript</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_transforming_points"></a>
Transforming points</h3>
<p>You can transform points as well as objects, which means scripts can perform a variety of mathematical operations without having to include the calculations in the script itself. The ChangeCoordinates sample script shows how to draw a series of regular polygons using this approach: </p>
<div class="fragment"><div class="line">Rem General purpose routine <span class="keywordflow">for</span> drawing regular polygons from their center point.</div>
<div class="line">Function myDrawPolygon(myInDesign, myParent, myCenterPoint, myNumberOfPoints, myRadius, myStarPolygon, myStarInset)</div>
<div class="line">    ReDim myArray(0)</div>
<div class="line">    myPoint = Array(0, 0)</div>
<div class="line">    If myStarPolygon = True Then</div>
<div class="line">        myNumberOfPoints = myNumberOfPoints * 2</div>
<div class="line">    End If</div>
<div class="line">    myInnerRadius = myRadius * myStarInset</div>
<div class="line">    myAngle = 360 / myNumberOfPoints</div>
<div class="line">    Rem template for transform</div>
<div class="line">    Rem Add([HorizontalScaleFactor], [VerticalScaleFactor], [ClockwiseShearAngle], [CounterclockwiseRotationAngle], [HorizontalTranslation], [VerticalTranslation], [MatrixValues]) As TransformationMatrix</div>
<div class="line">    Rem Add(, , , , X)</div>
<div class="line">    Set myRotateMatrix = myInDesign.TransformationMatrices.Add()</div>
<div class="line">    Set myRotateMatrix = myRotateMatrix.RotateMatrix(CDbl(myAngle))</div>
<div class="line">    Set myOuterTranslateMatrix = myInDesign.TransformationMatrices.Add()</div>
<div class="line">    Set myOuterTranslateMatrix = myOuterTranslateMatrix.translateMatrix(myRadius, 0)    </div>
<div class="line">    Set myInnerTranslateMatrix = myInDesign.TransformationMatrices.Add()</div>
<div class="line">    Set myInnerTranslateMatrix = myInnerTranslateMatrix.translateMatrix(myInnerRadius, 0)</div>
<div class="line">    For myPointCounter = 0 To myNumberOfPoints - 1</div>
<div class="line">        Rem Translate the point to the inner/outer radius.</div>
<div class="line">        If ((myStarInset = 1) Or (myIsEven(myPointCounter) = True)) Then</div>
<div class="line">            myTransformedPoint = myOuterTranslateMatrix.ChangeCoordinates(myPoint)</div>
<div class="line">        Else</div>
<div class="line">            myTransformedPoint = myInnerTranslateMatrix.ChangeCoordinates(myPoint)</div>
<div class="line">        End If</div>
<div class="line">        myTransformedPoint = myRotateMatrix.ChangeCoordinates(myTransformedPoint)</div>
<div class="line">        myPush myArray, myTransformedPoint, False</div>
<div class="line">        Set myRotateMatrix = myRotateMatrix.RotateMatrix(CDbl(myAngle))</div>
<div class="line">    Next</div>
<div class="line">    Rem Create a new polygon.</div>
<div class="line">    Set myPolygon = myParent.Polygons.Add</div>
<div class="line">    Rem Set the entire path of the polygon to the array we&#39;ve created.</div>
<div class="line">    myPolygon.Paths.Item(1).EntirePath = myArray</div>
<div class="line">    Rem If the center point is somewhere other than [0,0],</div>
<div class="line">    Rem translate the polygon to the center point.</div>
<div class="line">    If (myCenterPoint(0) &lt;&gt; 0) Or (myCenterPoint(1) &lt;&gt; 0) Then</div>
<div class="line">        Set myTranslateMatrix = myInDesign.TransformationMatrices.Add(, , , , myCenterPoint(0), myCenterPoint(1))</div>
<div class="line">        myPolygon.Transform idCoordinateSpaces.idPasteboardCoordinates, idAnchorPoint.idCenterAnchor, myTranslateMatrix</div>
<div class="line">    End If</div>
<div class="line">    Set myDrawPolygon = myPolygon</div>
<div class="line">End Function</div>
<div class="line">Rem Generic function for adding a value to an array.</div>
<div class="line">Function myPush(myArray, myValue, myValueIsObject)</div>
<div class="line">    If Not (IsEmpty(myArray(0))) Then</div>
<div class="line">        ReDim Preserve myArray(UBound(myArray) + 1)</div>
<div class="line">    End If</div>
<div class="line">    If myValueIsObject = True Then</div>
<div class="line">        Set myArray(UBound(myArray)) = myValue</div>
<div class="line">    Else</div>
<div class="line">        myArray(UBound(myArray)) = myValue</div>
<div class="line">    End If</div>
<div class="line">End Function</div>
<div class="line">Rem This function returns true if myNumber is even, false if it is not.</div>
<div class="line">Function myIsEven(myNumber)</div>
<div class="line">    myResult = myNumber Mod 2</div>
<div class="line">    If myResult = 0 Then</div>
<div class="line">        myResult = True</div>
<div class="line">    Else</div>
<div class="line">        myResult = False</div>
<div class="line">    End If</div>
<div class="line">    myIsEven = myResult</div>
<div class="line">End Function</div>
</div><!-- fragment --><p> You also can use the ChangeCoordinate method to change the positions of curve control points, as shown in the FunWithTransformations sample script.</p>
<h3><a class="anchor" id="id_vb_transforming_again"></a>
Transforming again</h3>
<p>Just as you can apply a transformation or sequence of transformations again in the user interface, you can do so using scripting. There are four methods for applying transformations again:</p>
<ul>
<li>TransformAgain</li>
<li>TransformAgainIndividually</li>
<li>TransformSequenceAgain</li>
<li>TransformSequenceAgainIndividually</li>
</ul>
<p>The following script fragment shows how to use TransformAgain. (For the complete script, see TransformAgain.) </p>
<div class="fragment"><div class="line">    Set myPage = myInDesign.Documents.Item(1).Pages.Item(1)</div>
<div class="line">    <span class="keyword">set</span> myRectangle = myPage.Rectangles.Item(1)</div>
<div class="line">    myBounds = myRectangle.GeometricBounds</div>
<div class="line">    myX1 = myBounds(1)</div>
<div class="line">    myY1 = myBounds(0)</div>
<div class="line">    Set myRectangleA = myPage.Rectangles.Add</div>
<div class="line">    myRectangleA.GeometricBounds = Array(myY1-12, myX1-12, myY1+12, myX1+12)</div>
<div class="line">    Set myTransformationMatrix = myInDesign.TransformationMatrices.add(, , , 45)</div>
<div class="line">    myRectangleA.Transform idCoordinateSpaces.idPasteboardCoordinates, idAnchorPoint.idCenterAnchor, myTransformationMatrix</div>
<div class="line">    Set myRectangleB = myRectangleA.Duplicate</div>
<div class="line">    myRectangleB.Transform idCoordinateSpaces.idPasteboardCoordinates, Array(Array(0,0), idAnchorPoint.idTopLeftAnchor), myTransformationMatrix, , True</div>
<div class="line">    Set myRectangleC = myRectangleB.Duplicate</div>
<div class="line">    myRectangleC.TransformAgain</div>
<div class="line">    Set myRectangleD = myRectangleC.Duplicate</div>
<div class="line">    myRectangleD.transformAgain</div>
<div class="line">    Set myRectangleE = myRectangleD.Duplicate</div>
<div class="line">    myRectangleE.TransformAgain</div>
<div class="line">    set myRectangleF = myRectangleE.Duplicate</div>
<div class="line">    myRectangleF.TransformAgain</div>
<div class="line">    set myRectangleG = myRectangleF.Duplicate</div>
<div class="line">    myRectangleG.TransformAgain</div>
<div class="line">    set myRectangleH = myRectangleG.Duplicate</div>
<div class="line">    myRectangleH.TransformAgain</div>
<div class="line">    myRectangleA.Transform idCoordinateSpaces.idPasteboardCoordinates, idAnchorPoint.idCenterAnchor, myTransformationMatrix</div>
<div class="line">    myRectangleD.TransformAgain</div>
<div class="line">    myRectangleF.TransformAgain </div>
<div class="line">    myRectangleH.TransformAgain</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_resize_and_reframe"></a>
Resize and Reframe</h2>
<p>In addition to scaling page items using the TransformMethod, you can also change the size of the shape using two other methods: Resize and Reframe. These methods change the location of the path points of the page item without scaling the content or stroke weight of the page item. The following script fragment shows how to use the Resize method. For the complete script, see Resize. </p>
<div class="fragment"><div class="line">    Rem Given a reference to a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span>...</div>
<div class="line">    Set myDuplicate = myRectangle.Duplicate</div>
<div class="line">    myDuplicate.Resize idCoordinateSpaces.idInnerCoordinates, idAnchorPoint.idCenterAnchor, idResizeMethods.idMultiplyingCurrentDimensionsBy, Array(2, 2)</div>
</div><!-- fragment --><p> The following script fragment shows how to use the Reframe method. For the complete script, see Reframe. </p>
<div class="fragment"><div class="line">    Rem Given a reference to a rectangle <span class="stringliteral">&quot;myRectangle&quot;</span>...</div>
<div class="line">    Set myDuplicate = myRectangle.Duplicate</div>
<div class="line">    myTopLeft = myDuplicate.Resolve(idAnchorPoint.idTopLeftAnchor, idCoordinateSpaces.idInnerCoordinates, False)(0)</div>
<div class="line">    myBottomRight = myDuplicate.Resolve(idAnchorPoint.idBottomRightAnchor, idCoordinateSpaces.idInnerCoordinates, False)(0)</div>
<div class="line">    myWidth = myBottomRight(0) - myTopLeft(0)</div>
<div class="line">    myDuplicate.Reframe idCoordinateSpaces.idInnerCoordinates, Array(Array(myTopLeft(0) + myWidth, myTopLeft(1)), Array(myBottomRight(0) + myWidth, myBottomRight(1)))</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_working_with_articles"></a>
Working with Articles</h2>
<p>Articles provide designers and production artists an easy way to create relationships among page items. These relationships can be used to define the content to be used while exporting to ePub, HTML or Accessible PDFs; and to define the order of the content. You can create articles from a combination of existing page items within a layout, including images, graphics, or text. Once an article has been created, page items can be added, removed, or re-ordered.</p>
<h3><a class="anchor" id="id_vb_retrieving_an_article_list"></a>
Retrieving an article list</h3>
<p>To get the articles in a document, use the following script (for the complete script, see CreateArticle). </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set articles = myDocument.Articles</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_adding_new_articles"></a>
Adding new articles</h3>
<p>To add a new article to a document, use the following script (for the complete script, see CreateArticle). </p>
<div class="fragment"><div class="line">    Set article1 = myDocument.Articles.Add(<span class="stringliteral">&quot;Article1&quot;</span>, True)</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_removing_an_article"></a>
Removing an article</h3>
<p>To remove an article, tell the article to remove itself as shown in the following script (for the complete script, see RemoveArticle). </p>
<div class="fragment"><div class="line">    article.Delete</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_reordering_articles"></a>
Reordering articles</h3>
<p>To reorder articles, tell the article to move the reference article and the location relative to the reference article as shown in the following script (for the complete script, see ReorderArticles). </p>
<div class="fragment"><div class="line">    Set article1 = myDocument.Articles.Add(<span class="stringliteral">&quot;Article1&quot;</span>, True)</div>
<div class="line">    Set article2 = myDocument.Articles.Add(<span class="stringliteral">&quot;Article2&quot;</span>, True)</div>
<div class="line">    Set article3 = myDocument.Articles.Add(<span class="stringliteral">&quot;Article3&quot;</span>, True)</div>
<div class="line">    Set article4 = myDocument.Articles.Add(<span class="stringliteral">&quot;Article4&quot;</span>, True)</div>
<div class="line">    </div>
<div class="line">    Rem Reverse the order of articles.</div>
<div class="line">    Rem Move article4 to the first.</div>
<div class="line">    article4.Move idLocationOptions.idAtBeginning</div>
<div class="line">    Rem Move article1 to the end.</div>
<div class="line">    article1.Move idLocationOptions.idAtEnd</div>
<div class="line">    Rem Move article3 to the second place.</div>
<div class="line">    article3.Move idLocationOptions.idAfter, article4</div>
<div class="line">    Rem Move article2 to the third place.</div>
<div class="line">    article2.Move idLocationOptions.idBefore, article1</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_adding_new_members_to_an_article"></a>
Adding new members to an article</h3>
<p>To add new members to an article, use the following script (for the complete script, see AddRemoveArticleMember). </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set articles = myDocument.Articles</div>
<div class="line">    </div>
<div class="line">    Rem Create <span class="keyword">new</span> articles.</div>
<div class="line">    Set article1 = articles.Add(<span class="stringliteral">&quot;Article1&quot;</span>, True)</div>
<div class="line">    Set article2 = articles.Add(<span class="stringliteral">&quot;Article2&quot;</span>, True)</div>
<div class="line">    Set article3 = articles.Add(<span class="stringliteral">&quot;Article3&quot;</span>, True)</div>
<div class="line">    </div>
<div class="line">    Set myPage = myDocument.pages.item(1)</div>
<div class="line">    Set article1Members = article1.ArticleMembers</div>
<div class="line">    article1Members.Add myPage.Rectangles.item(1)</div>
<div class="line">    article1Members.Add myPage.Ovals.item(1)</div>
<div class="line">    </div>
<div class="line">    Set article2Members = article2.ArticleMembers</div>
<div class="line">    article2Members.Add myPage.Rectangles.item(2)</div>
<div class="line">    article2Members.Add myPage.Ovals.item(2)</div>
<div class="line">    </div>
<div class="line">    Set article3Members = article3.ArticleMembers</div>
<div class="line">    Rem Add group as article member.</div>
<div class="line">    article3Members.Add myPage.Groups.item(1)</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_reordering_members_of_an_article"></a>
Reordering members of an article</h3>
<p>To reorder members of an article, tell the member to move the reference object and the location relative to the reference object as shown in the following script (for the complete script, see ReorderArticleMembers). </p>
<div class="fragment"><div class="line">    Set articleMembers = article.ArticleMembers</div>
<div class="line">    articleMembers.Add myPage.Rectangles.item(1)</div>
<div class="line">    articleMembers.Add myPage.Ovals.item(1)</div>
<div class="line">    articleMembers.Add myPage.TextFrames.item(1)</div>
<div class="line">    articleMembers.Add myPage.Groups.item(1)</div>
<div class="line">    </div>
<div class="line">    articleMembers.item(1).Move idLocationOptions.idAtEnd</div>
<div class="line">    articleMembers.item(3).Move idLocationOptions.idAtBeginning</div>
<div class="line">    articleMembers.item(2).Move idLocationOptions.idAfter, articleMembers.item(3)</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_removing_members_from_an_article"></a>
Removing members from an article</h3>
<p>To remove a member from an article, tell the article member to remove itself, as shown in the following script (for the complete script, see AddRemoveArticleMember). </p>
<div class="fragment"><div class="line">    Set articleMember = article1Members.item(1)</div>
<div class="line">    articleMember.Delete</div>
</div><!-- fragment --> <h1><a class="anchor" id="id_vb_user_interfaces"></a>
User Interfaces</h1>
<p>JavaScript can create dialogs for simple yes/no questions and text entry, but you probably will need to create more complex dialogs for your scripts. InDesign scripting can add dialogs and populate them with common user-interface controls, like pop-up lists, text-entry fields, and numeric-entry fields. If you want your script to collect and act on information entered by you or any other user of your script, use the dialog object.</p>
<p>This section shows how to work with InDesign dialog scripting. The sample scripts in this section are presented in order of complexity, starting with very simple scripts and building toward more complex operations.</p>
<dl class="section note"><dt>Note</dt><dd>InDesign scripts written in JavaScript also can include user interfaces created using the Adobe ScriptUI component. This section includes some ScriptUI scripting tutorials; for more information, see Adobe JavaScript Tools Guide.</dd></dl>
<p>We assume that you have already read Adobe InDesign Scripting Tutorial and know how to create and run a script.</p>
<h2><a class="anchor" id="id_vb_dialog_overview"></a>
Dialog Overview</h2>
<p>An InDesign dialog box is an object like any other InDesign scripting object. The dialog box can contain several different types of elements (known collectively as "widgets"), as shown in the following figure. The elements of the figure are described in the table following the figure.</p>
<div class="image">
<img src="InDesign_ScriptingGuide-5.gif" alt="InDesign_ScriptingGuide-5.gif"/>
</div>
<table class="doxtable">
<tr>
<th>Dialog box element </th><th>InDesign name </th></tr>
<tr>
<td>Text-edit fields </td><td>Text editbox control </td></tr>
<tr>
<td>Numeric-entry fields </td><td>Real editbox, integer editbox, measurement editbox, percent editbox, angle editbox </td></tr>
<tr>
<td>Pop-up menus </td><td>Drop-down control </td></tr>
<tr>
<td>Control that combines a text-edit field with a pop-up menu </td><td>Combo-box control </td></tr>
<tr>
<td>Check box </td><td>Check-box control </td></tr>
<tr>
<td>Radio buttons </td><td>Radio-button control </td></tr>
</table>
<p>The dialog object itself does not directly contain the controls; that is the purpose of the dialogColumn object. dialogColumns give you a way to control the positioning of controls within a dialog box. Inside dialogColumns, you can further subdivide the dialog box into other dialogColumns or borderPanels (both of which can, if necessary, contain more dialogColumns and borderPanels).</p>
<p>Like any other InDesign scripting object, each part of a dialog box has its own properties. A checkboxControl, for example, has a property for its text (staticLabel) and another property for its state (checkedState). The dropdown control has a property (stringList) for setting the list of options that appears on the control's menu.</p>
<p>To use a dialog box in your script, create the dialog object, populate it with various controls, display the dialog box, and then gather values from the dialog-box controls to use in your script. Dialog boxes remain in InDesign's memory until they are destroyed. This means you can keep a dialog box in memory and have data stored in its properties used by multiple scripts, but it also means the dialog boxes take up memory and should be disposed of when they are not in use. In general, you should destroy a dialog-box object before your script finishes executing.</p>
<h2><a class="anchor" id="id_vb_your_first_indesign_dialog"></a>
Your First InDesign Dialog</h2>
<p>The process of creating an InDesign dialog is very simple: add a dialog, add a dialog column to the dialog, and add controls to the dialog column. The following script demonstrates the process (for the complete script, see SimpleDialog): </p>
<div class="fragment"><div class="line">    Set myInDesign = CreateObject(<span class="stringliteral">&quot;InDesign.Application.2024&quot;</span>)</div>
<div class="line">    Set myDialog = myInDesign.Dialogs.Add</div>
<div class="line">    Rem Add a dialog column.</div>
<div class="line">    With myDialog.DialogColumns.Add</div>
<div class="line">        With .StaticTexts.Add</div>
<div class="line">            .StaticLabel = &quot;This is a very simple dialog box.&quot;</div>
<div class="line">        End With</div>
<div class="line">    End With</div>
<div class="line">    Rem Show the dialog box.</div>
<div class="line">    myResult = myDialog.Show</div>
<div class="line">    Rem If the user clicked OK, display one message;</div>
<div class="line">    Rem if they clicked Cancel, display a different message.</div>
<div class="line">    If myResult = True Then</div>
<div class="line">        MsgBox(&quot;You clicked the OK button!&quot;)</div>
<div class="line">    Else</div>
<div class="line">        MsgBox(&quot;You clicked the Cancel button!&quot;)</div>
<div class="line">    End If</div>
<div class="line">    Rem Remove the dialog from memory.</div>
<div class="line">    myDialog.Destroy</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_adding_a_user_interface_to_hello_world"></a>
Adding a User Interface to "Hello World"</h2>
<p>In this example, we add a simple user interface to the Hello World tutorial script presented in <a class="el" href="id_scripting_tutorial.html">Adobe InDesign Scripting Tutorial</a>. The options in the dialog box provide a way for you to specify the sample text and change the point size of the text: </p>
<div class="fragment"><div class="line">    Set myDialog = myInDesign.Dialogs.Add</div>
<div class="line">    myDialog.CanCancel = True</div>
<div class="line">    myDialog.Name = <span class="stringliteral">&quot;Simple User Interface Example Script&quot;</span></div>
<div class="line">    Set myDialogColumn = myDialog.DialogColumns.Add</div>
<div class="line">    Set myTextEditField = myDialogColumn.TextEditboxes.Add</div>
<div class="line">    myTextEditField.EditContents = <span class="stringliteral">&quot;Hello World!&quot;</span></div>
<div class="line">    myTextEditField.MinWidth = 180</div>
<div class="line">    Rem Create a number (real) entry field.</div>
<div class="line">    Set myPointSizeField = myDialogColumn.measurementEditboxes.Add</div>
<div class="line">    myPointSizeField.EditValue = 72</div>
<div class="line">    myResult = myDialog.Show</div>
<div class="line">    If myResult = True Then</div>
<div class="line">        Rem Get the values from the dialog box controls.</div>
<div class="line">        myString = myTextEditField.EditContents</div>
<div class="line">        myPointSize = myPointSizeField.EditValue</div>
<div class="line">        Rem Remove the dialog box from memory.</div>
<div class="line">        myDialog.Destroy</div>
<div class="line">        myMakeDocument myInDesign, myString, myPointSize</div>
<div class="line">    Else</div>
<div class="line">        myDialog.Destroy</div>
<div class="line">    End If</div>
</div><!-- fragment --><p> Here is the myMakeDocument function referred to in the above fragment: </p>
<div class="fragment"><div class="line">Function myMakeDocument(myInDesign, myString, myPointSize)</div>
<div class="line">    Set myDocument = myInDesign.Documents.Add</div>
<div class="line">    Set myTextFrame = myDocument.Pages.Item(1).TextFrames.Add</div>
<div class="line">    Rem Resize the text frame to the &quot;live&quot; area of the page </div>
<div class="line">    Rem (using the function &quot;myGetBounds&quot;).</div>
<div class="line">    myBounds = myGetBounds(myDocument, myDocument.Pages.Item(1))</div>
<div class="line">    myTextFrame.GeometricBounds = myBounds</div>
<div class="line">    Rem Enter the text from the dialog box in the text frame.</div>
<div class="line">    myTextFrame.Contents = myString</div>
<div class="line">    Rem Set the size of the text to the size you entered in the dialog box.</div>
<div class="line">    myTextFrame.Texts.Item(1).PointSize = myPointSize</div>
<div class="line">End Function</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_creating_a_more_complex_user_interface"></a>
Creating a More Complex User Interface</h2>
<p>In the next example, we add more controls and different types of controls to the sample dialog box. The example creates a dialog box that resembles the following: </p>
<div class="image">
<img src="InDesign_ScriptingGuide-6.gif" alt="InDesign_ScriptingGuide-6.gif"/>
</div>
<p>For the complete script, see ComplexUI. </p>
<div class="fragment"><div class="line">    Set myDialog = myInDesign.Dialogs.Add</div>
<div class="line">    myDialog.CanCancel = True</div>
<div class="line">    myDialog.Name = <span class="stringliteral">&quot;User Interface Example Script&quot;</span></div>
<div class="line">    Rem Create a dialog column.</div>
<div class="line">    Set myDialogColumn = myDialog.DialogColumns.Add</div>
<div class="line">    Rem Create a border panel.</div>
<div class="line">    Set myBorderPanel = myDialogColumn.BorderPanels.Add</div>
<div class="line">    Rem Create a dialog column inside the border panel.</div>
<div class="line">    Set myTempDialogColumn = myBorderPanel.DialogColumns.Add</div>
<div class="line">    Set myStaticText = myTempDialogColumn.StaticTexts.Add</div>
<div class="line">    myStaticText.StaticLabel = <span class="stringliteral">&quot;Message:&quot;</span></div>
<div class="line">    Rem Create another dialog column inside the border panel.</div>
<div class="line">    Set myTempDialogColumn = myBorderPanel.DialogColumns.Add</div>
<div class="line">    Set myTextEditField = myTempDialogColumn.TextEditboxes.Add</div>
<div class="line">    myTextEditField.EditContents = <span class="stringliteral">&quot;Hello World!&quot;</span></div>
<div class="line">    myTextEditField.MinWidth = 180</div>
<div class="line">    Rem Create another border panel.</div>
<div class="line">    Set myBorderPanel = myDialogColumn.BorderPanels.Add</div>
<div class="line">    Rem Create a dialog column inside the border panel.</div>
<div class="line">    Set myTempDialogColumn = myBorderPanel.DialogColumns.Add</div>
<div class="line">    Set myStaticText = myTempDialogColumn.StaticTexts.Add</div>
<div class="line">    myStaticText.StaticLabel = <span class="stringliteral">&quot;Point Size:&quot;</span></div>
<div class="line">    Rem Create another dialog column inside the border panel.</div>
<div class="line">    Set myTempDialogColumn = myBorderPanel.DialogColumns.Add</div>
<div class="line">    Set myPointSizeField = myTempDialogColumn.RealEditboxes.Add</div>
<div class="line">    myPointSizeField.EditValue = 72</div>
<div class="line">    Rem Create another border panel.</div>
<div class="line">    Set myBorderPanel = myDialogColumn.BorderPanels.Add</div>
<div class="line">    Rem Create a dialog column inside the border panel.</div>
<div class="line">    Set myTempDialogColumn = myBorderPanel.DialogColumns.Add</div>
<div class="line">    Set myStaticText = myTempDialogColumn.StaticTexts.Add</div>
<div class="line">    myStaticText.StaticLabel = <span class="stringliteral">&quot;Vertical Justification:&quot;</span></div>
<div class="line">    Rem Create another dialog column inside the border panel.</div>
<div class="line">    Set myTempDialogColumn = myBorderPanel.DialogColumns.Add</div>
<div class="line">    Set myVerticalJustificationMenu = myTempDialogColumn.Dropdowns.Add</div>
<div class="line">    myVerticalJustificationMenu.StringList = Array(<span class="stringliteral">&quot;Top&quot;</span>, <span class="stringliteral">&quot;Center&quot;</span>, <span class="stringliteral">&quot;Bottom&quot;</span>)</div>
<div class="line">    myVerticalJustificationMenu.SelectedIndex = 0</div>
<div class="line">    Rem Create another border panel.</div>
<div class="line">    Set myBorderPanel = myDialogColumn.BorderPanels.Add</div>
<div class="line">    Rem Create a dialog column inside the border panel.</div>
<div class="line">    Set myTempDialogColumn = myBorderPanel.DialogColumns.Add</div>
<div class="line">    Set myStaticText = myTempDialogColumn.StaticTexts.Add</div>
<div class="line">    myStaticText.StaticLabel = &quot;Paragraph Alignment:&quot;</div>
<div class="line">    Rem Create another dialog column inside the border panel.</div>
<div class="line">    Set myTempDialogColumn = myBorderPanel.DialogColumns.Add</div>
<div class="line">    Set myRadioButtonGroup = myTempDialogColumn.RadiobuttonGroups.Add</div>
<div class="line">    Set myLeftRadioButton = myRadioButtonGroup.RadiobuttonControls.Add</div>
<div class="line">    myLeftRadioButton.StaticLabel = &quot;Left&quot;</div>
<div class="line">    myLeftRadioButton.CheckedState = True</div>
<div class="line">    Set myCenterRadioButton = myRadioButtonGroup.RadiobuttonControls.Add</div>
<div class="line">    myCenterRadioButton.StaticLabel = &quot;Center&quot;</div>
<div class="line">    Set myRightRadioButton = myRadioButtonGroup.RadiobuttonControls.Add</div>
<div class="line">    myRightRadioButton.StaticLabel = &quot;Right&quot;</div>
<div class="line">    Rem If the user clicked OK, then create the example document.</div>
<div class="line">    If myDialog.Show = True Then</div>
<div class="line">        Rem Get the values from the dialog box controls.</div>
<div class="line">        myString = myTextEditField.EditContents</div>
<div class="line">        myPointSize = myPointSizeField.EditValue</div>
<div class="line">        Select Case myVerticalJustificationMenu.SelectedIndex</div>
<div class="line">            Case 0</div>
<div class="line">                myVerticalJustification = idVerticalJustification.idTopAlign</div>
<div class="line">            Case 1</div>
<div class="line">                myVerticalJustification = idVerticalJustification.idCenterAlign</div>
<div class="line">            Case Else</div>
<div class="line">                myVerticalJustification = idTopAlign.idBottomAlign</div>
<div class="line">            End Select</div>
<div class="line">        Rem set the paragraph alignment of the text to the dialog radio button choice.</div>
<div class="line">        Select Case myRadioButtonGroup.SelectedButton</div>
<div class="line">            Case 0</div>
<div class="line">                myAlignment = idJustification.idLeftAlign</div>
<div class="line">            Case 1</div>
<div class="line">                myAlignment = idJustification.idCenterAlign</div>
<div class="line">            Case Else</div>
<div class="line">                myAlignment = idJustification.idRightAlign</div>
<div class="line">        End Select</div>
<div class="line">        Rem Remove the dialog box from memory.</div>
<div class="line">        myDialog.Destroy</div>
<div class="line">    Else</div>
<div class="line">        myDialog.Destroy    </div>
<div class="line">    End If</div>
</div><!-- fragment --><p> Here is the myMakeDocument function referred to in the above fragment: </p>
<div class="fragment"><div class="line">Function myMakeDocument(myInDesign, myString, myPointSize, myAlignment, myVerticalJustification)</div>
<div class="line">    Rem Create a new document.</div>
<div class="line">    Set myDocument = myInDesign.Documents.Add</div>
<div class="line">    Set myTextFrame = myDocument.Pages.Item(1).TextFrames.Add</div>
<div class="line">    Rem Resize the text frame to the &quot;live&quot; area of the </div>
<div class="line">    Rem page (using the function &quot;myGetBounds&quot;).</div>
<div class="line">    myBounds = myGetBounds(myDocument, myDocument.Pages.Item(1))</div>
<div class="line">    myTextFrame.GeometricBounds = myBounds</div>
<div class="line">    Rem Enter the text from the dialog box in the text frame.</div>
<div class="line">    myTextFrame.Contents = myString</div>
<div class="line">    Rem Set the size of the text to the size you entered </div>
<div class="line">    Rem in the dialog box.</div>
<div class="line">    myTextFrame.Texts.Item(1).PointSize = myPointSize</div>
<div class="line">    Rem Set the paragraph alignment to the alignment you </div>
<div class="line">    Rem selected in the dialog box.</div>
<div class="line">    myTextFrame.Texts.Item(1).Justification = myAlignment</div>
<div class="line">    Rem Set the text frame vertical justification to the vertical justification </div>
<div class="line">    Rem you selected in the dialog box.</div>
<div class="line">    myTextFrame.TextFramePreferences.VerticalJustification = myVerticalJustification</div>
<div class="line">End Function</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_working_with_scriptui"></a>
Working with ScriptUI</h2>
<p>JavaScripts can create and define user-interface elements using an Adobe scripting component named ScriptUI. ScriptUI gives scripters a way to create floating palettes, progress bars, and interactive dialog boxes that are far more complex than InDesign's built-in dialog object.</p>
<p>This does not mean, however, that user-interface elements written using Script UI are not accessible to JavaScript users. InDesign scripts can execute scripts written in other scripting languages using the DoScript method.</p>
<h3><a class="anchor" id="id_vb_creating_a_progress_bar_with_scriptui"></a>
Creating a progress bar with ScriptUI</h3>
<p>The following sample script shows how to create a progress bar using JavaScript and ScriptUI, then use the progress bar from another script (for the complete script, see ProgressBar): </p>
<div class="fragment"><div class="line"><span class="preprocessor">#targetengine &quot;session&quot;</span></div>
<div class="line"><span class="preprocessor"></span><span class="comment">//Because these terms are defined in the &quot;session&quot; engine,</span></div>
<div class="line"><span class="comment">//they will be available to any other JavaScript running</span></div>
<div class="line"><span class="comment">//in that instance of the engine.</span></div>
<div class="line">var myMaximumValue = 300;</div>
<div class="line">var myProgressBarWidth = 300;</div>
<div class="line">var myIncrement = myMaximumValue/myProgressBarWidth;</div>
<div class="line">myCreateProgressPanel(myMaximumValue, myProgressBarWidth);</div>
<div class="line"><span class="keyword">function</span> myCreateProgressPanel(myMaximumValue, myProgressBarWidth){</div>
<div class="line">    myProgressPanel = <span class="keyword">new</span> Window(<span class="stringliteral">&#39;window&#39;</span>, <span class="stringliteral">&#39;Progress&#39;</span>);</div>
<div class="line">    with(myProgressPanel){</div>
<div class="line">        myProgressPanel.myProgressBar = add(<span class="stringliteral">&#39;progressbar&#39;</span>, [12, 12,</div>
<div class="line">    myProgressBarWidth, 24], 0, myMaximumValue);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p> The following script fragment shows how to call the progress bar created in the above script using a separate JavaScript (for the complete script, see CallProgressBar): </p>
<div class="fragment"><div class="line">    Rem Create a document and add pages to it--</div>
<div class="line">    Rem <span class="keywordflow">if</span> you <span class="keywordflow">do</span> not <span class="keywordflow">do</span> <span class="keyword">this</span>, the progress bar</div>
<div class="line">    Rem will go by too quickly.</div>
<div class="line">    Set myDocument = myInDesign.Documents.Add</div>
<div class="line">    Rem Note that the JavaScripts must use the <span class="stringliteral">&quot;session&quot;</span></div>
<div class="line">    Rem engine <span class="keywordflow">for</span> <span class="keyword">this</span> to work.</div>
<div class="line">    myString = <span class="stringliteral">&quot;#targetengine &quot;</span><span class="stringliteral">&quot;session&quot;</span><span class="stringliteral">&quot;&quot;</span> &amp; vbCr</div>
<div class="line">    myString = myString &amp; <span class="stringliteral">&quot;myCreateProgressPanel(100, 400);&quot;</span> &amp; vbcr</div>
<div class="line">    myString = myString &amp; <span class="stringliteral">&quot;myProgressPanel.show();&quot;</span> &amp; vbcr</div>
<div class="line">    myInDesign.DoScript myString, idScriptLanguage.idJavascript</div>
<div class="line">    For myCounter = 1 to 100</div>
<div class="line">        Rem Add a page to the document.</div>
<div class="line">        myInDesign.Documents.Item(1).Pages.Add</div>
<div class="line">        myString = <span class="stringliteral">&quot;#targetengine &quot;</span><span class="stringliteral">&quot;session&quot;</span><span class="stringliteral">&quot;&quot;</span> &amp; vbCr</div>
<div class="line">        myString = myString &amp; <span class="stringliteral">&quot;myProgressPanel.myProgressBar.value = &quot;</span> </div>
<div class="line">        myString = myString &amp; cstr(myCounter) &amp; <span class="stringliteral">&quot;/myIncrement;&quot;</span> &amp; vbcr</div>
<div class="line">        myInDesign.DoScript myString, idScriptLanguage.idJavascript</div>
<div class="line">        If(myCounter = 100) Then</div>
<div class="line">            myString = &quot;<span class="preprocessor">#targetengine &quot;&quot;session&quot;&quot;&quot; &amp; vbCr</span></div>
<div class="line"><span class="preprocessor"></span>            myString = myString &amp; <span class="stringliteral">&quot;myProgressPanel.myProgressBar.value = 0;&quot;</span> &amp; vbcr</div>
<div class="line">            myString = myString &amp; <span class="stringliteral">&quot;myProgressPanel.hide();&quot;</span> &amp; vbcr</div>
<div class="line">            myInDesign.DoScript myString, idScriptLanguage.idJavascript</div>
<div class="line">            myDocument.Close idSaveOptions.idNo</div>
<div class="line">        End If</div>
<div class="line">    Next</div>
</div><!-- fragment --> <h1><a class="anchor" id="id_vb_events"></a>
Events</h1>
<p>InDesign scripting can respond to common application and document events, such as opening a file, creating a new file, printing, and importing text and graphic files from disk. In InDesign scripting, the event object responds to an event that occurs in the application. Scripts can be attached to events using the EventListener scripting object. Scripts that use events are the same as other scripts-the only difference is that they run automatically when the corresponding event occurs, rather than being run by the user (from the Scripts palette).</p>
<p>This section shows how to work with InDesign event scripting. The sample scripts in this section are presented in order of complexity, starting with very simple scripts and building toward more complex operations.</p>
<p>We assume that you have already read Adobe InDesign Scripting Tutorial and know how to create, install, and run a script.</p>
<p>For a discussion of events related to menus, see <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_menus">Menus.</a></p>
<p>The InDesign event scripting model is similar to the Worldwide Web Consortium (W3C) recommendation for Document Object Model Events. For more information, see <a href="http://www.w3c.org">http://www.w3c.org </a> .</p>
<h2><a class="anchor" id="id_vb_understanding_the_event_scripting_model"></a>
Understanding the Event Scripting Model</h2>
<p>The InDesign event scripting model consists of a series of objects that correspond to the events that occur as you work with the application. The first object is the event, which corresponds to one of a limited series of actions in the InDesign user interface (or corresponding actions triggered by scripts).</p>
<p>To respond to an event, you register an EventListener with an object capable of receiving the event. When the specified event reaches the object, the EventListener executes the script function defined in its handler function (a reference to a script file on disk).</p>
<p>You can view the available events using the Object Browser in your VBScript editor by looking at the EventEvents module.</p>
<h3><a class="anchor" id="id_vb_about_event_properties_and_event_propagation"></a>
About event properties and event propagation</h3>
<p>When an action-whether initiated by a user or by a script-triggers an event, the event can spread, or propagate, through the scripting objects capable of responding to the event. When an event reaches an object that has an EventListener registered for that event, the EventListener is triggered by the event. An event can be handled by more than one object as it propagates.</p>
<p>There are two types of event propagation:</p>
<ul>
<li>None - Only the EventListeners registered to the event target are triggered by the event. The beforeDisplay event is an example of an event that does not propagate.</li>
<li>Bubbling - The event starts propagation at its target and triggers any qualifying EventListeners registered to the target. The event then proceeds upward through the scripting object model, triggering any qualifying EventListeners registered to objects above the target in the scripting object model hierarchy.</li>
</ul>
<p>The following table provides more detail on the properties of an event and the ways in which they relate to event propagation through the scripting object model.</p>
<table class="doxtable">
<tr>
<th>Property </th><th>Description </th></tr>
<tr>
<td>Bubbles </td><td>If true, the event propagates to scripting objects above the object initiating the event. </td></tr>
<tr>
<td>Cancelable </td><td>If true, the default behavior of the event on its target can be canceled. To do this, use the PreventDefault method . </td></tr>
<tr>
<td>CurrentTarget </td><td>The current scripting object processing the event. See target in this table. </td></tr>
<tr>
<td>DefaultPrevented </td><td>If true, the default behavior of the event on the current target was prevented, thereby canceling the action. See target in this table. </td></tr>
<tr>
<td>EventPhase </td><td>The current stage of the event propagation process. </td></tr>
<tr>
<td>EventType </td><td>The type of the event, as a string (for example, "beforeNew"). </td></tr>
<tr>
<td>PropagationStopped </td><td>If true, the event has stopped propagating beyond the current target (see target in this table). To stop event propagation, use the stopPropagation method. </td></tr>
<tr>
<td>Target </td><td>The object from which the event originates. For example, the target of a beforeImport event is a document; of a beforeNew event, the application. </td></tr>
<tr>
<td>TimeStamp </td><td>The time and date when the event occurred. </td></tr>
</table>
<h2><a class="anchor" id="id_vb_working_with_event_listeners"></a>
Working with Event Listeners</h2>
<p>When you create an EventListener, you specify the event type and the event handler (as a function or file reference). The following script fragment shows how to add an EventListener for a specific event (for the complete script, see AddEventListener). </p>
<div class="fragment"><div class="line">    myInDesign.AddEventListener <span class="stringliteral">&quot;afterNew&quot;</span>, GetRef(<span class="stringliteral">&quot;myDisplayEventType&quot;</span>)</div>
</div><!-- fragment --><p> The preceding script fragment refers to the following function: </p>
<div class="fragment"><div class="line">Function myDisplayEventType(en)</div>
<div class="line">    Rem &quot;myEvent&quot; is the event passed to this function by the event listener.</div>
<div class="line">    MsgBox (&quot;This event is the &quot; &amp; en.EventType &amp; &quot; event.&quot;)</div>
<div class="line">    &#39;MsgBox (&quot;This event is the after new event.&quot;)</div>
<div class="line">End Function</div>
</div><!-- fragment --><p> To remove the EventListener created by the preceding script, run the following script (from the RemoveEventListener tutorial script): </p>
<div class="fragment"><div class="line">    myResult = myInDesign.RemoveEventListener(<span class="stringliteral">&quot;afterNew&quot;</span>, <span class="stringliteral">&quot;myDisplayEventType&quot;</span>)</div>
<div class="line">    If myResult = True Then</div>
<div class="line">        MsgBox <span class="stringliteral">&quot;Event listener removed.&quot;</span></div>
<div class="line">    Else</div>
<div class="line">        MsgBox <span class="stringliteral">&quot;Event listener not removed.&quot;</span></div>
<div class="line">    End If</div>
</div><!-- fragment --><p> When an EventListener responds to an event, the event may still be processed by other EventListeners that might be monitoring the event (depending on the propagation of the event). For example, the afterOpen event can be observed by EventListeners associated with both the application and the document. EventListeners do not persist beyond the current InDesign session. To make an EventListener available in every InDesign session, add the script to the startup scripts folder. (For more on installing scripts, see <a class="el" href="id_scripting_tutorial.html#id_installing_scripts">Installing Scripts</a> in Adobe InDesign Scripting Tutorial.) When you add an EventListener script to a document, it is not saved with the document or exported to IDML.</p>
<dl class="section note"><dt>Note</dt><dd>If you are having trouble with a script that defines an EventListener, you can either run a script that removes the EventListener or quit and restart InDesign. An event can trigger multiple EventListeners as it propagates through the scripting object model. The following sample script demonstrates an event triggering EventListeners registered to different objects (for the full script, see MultipleEventListeners): <div class="fragment"><div class="line">    myInDesign.AddEventListener <span class="stringliteral">&quot;beforeImport&quot;</span>, GetRef(<span class="stringliteral">&quot;myEventInfo&quot;</span>)</div>
<div class="line">    Set myDocument = myInDesign.Documents.Add</div>
<div class="line">    myInDesign.Documents.Item(1).AddEventListener &quot;beforeImport&quot;, GetRef(&quot;myEventInfo&quot;)</div>
</div><!-- fragment --> The myEventInfo function referred to in the preceding script contains the following script code: <div class="fragment"><div class="line">Function myEventInfo(en)</div>
<div class="line">    myString = &quot;Current Target: &quot; &amp; en.currentTarget.name</div>
<div class="line">    MsgBox(myString)</div>
<div class="line">End Function</div>
</div><!-- fragment --> When you run the preceding script and place a file, InDesign displays alerts showing, in sequence, the name of the document, then the name of the application. To remove the event listeners added by the preceding script, run the RemoveMultipleEventListeners script.</dd></dl>
<p>The following sample script creates an EventListener for each document event and displays information about the event in a simple dialog box. For the complete script, see EventListenersOn. </p>
<div class="fragment"><div class="line">    Rem Define the handler as a file named <span class="stringliteral">&quot;GetEventInfo.vbs&quot;</span> stored</div>
<div class="line">    Rem in the same folder as <span class="keyword">this</span> script.</div>
<div class="line">    myFileName = myFindFile(myInDesign, <span class="stringliteral">&quot;\GetEventInfo.vbs&quot;</span>)</div>
<div class="line">    If myFileName &lt;&gt; &quot;&quot; Then</div>
<div class="line">        myEventNames = Array(&quot;beforeQuit&quot;, &quot;afterQuit&quot;, &quot;beforeNew&quot;, &quot;afterNew&quot;, &quot;beforeOpen&quot;, &quot;afterOpen&quot;, &quot;beforeClose&quot;, &quot;afterClose&quot;, &quot;beforeSave&quot;, &quot;afterSave&quot;, &quot;beforeSaveAs&quot;, &quot;afterSaveAs&quot;, &quot;beforeSaveACopy&quot;, &quot;afterSaveACopy&quot;, &quot;beforeRevert&quot;, &quot;afterRevert&quot;, &quot;beforePrint&quot;, &quot;afterPrint&quot;, &quot;beforeExport&quot;, &quot;afterExport&quot;, &quot;beforeImport&quot;, &quot;afterImport&quot;, &quot;beforePlace&quot;, &quot;afterPlace&quot;)</div>
<div class="line">        For myCounter = 0 To UBound(myEventNames)</div>
<div class="line">            myInDesign.AddEventListener myEventNames(myCounter), myFileName, False</div>
<div class="line">            If myCounter &lt; UBound(myEventNames) Then</div>
<div class="line">                myInDesign.EventListeners.Add myEventNames(myCounter), myFileName, False</div>
<div class="line">            End If</div>
<div class="line">        Next</div>
<div class="line">    End If</div>
</div><!-- fragment --><p> The preceding script refers to the following script. The file reference in the preceding script must match the location of this script on your disk. For the complete script, see GetEventInfo.vbs. </p>
<div class="fragment"><div class="line">myEventHandler</div>
<div class="line">Function myEventHandler()</div>
<div class="line">    set myInDesign = CreateObject(&quot;InDesign.Application.2024&quot;)</div>
<div class="line">    if(myInDesign.Events.Count &gt; 0) Then</div>
<div class="line">        myDisplayEventInfo myInDesign.Events.Item(1)</div>
<div class="line">    else</div>
<div class="line">        for myCounter = 1 to myInDesign.documents.count</div>
<div class="line">            if(myInDesign.documents.item(myCounter).events.count &gt; 0) then</div>
<div class="line">                myDisplayEventInfo myInDesign.Documents.Item(myCounter).Events.Item(1)</div>
<div class="line">            end if</div>
<div class="line">        next</div>
<div class="line">    end if</div>
<div class="line">end function</div>
<div class="line">function myDisplayEventInfo(myEvent)</div>
<div class="line">    myString = &quot;Handling Event: &quot; &amp; myEvent.EventType</div>
<div class="line">    myString = myString &amp; vbCr &amp; vbCr &amp; &quot;Target: &quot; &amp; myEvent.Target &amp; &quot; &quot; &amp; myEvent.Target.Name</div>
<div class="line">    myString = myString &amp; vbCr &amp; &quot;Current: &quot; &amp; myEvent.CurrentTarget &amp; &quot; &quot; &amp; myEvent.CurrentTarget.Name</div>
<div class="line">    myString = myString &amp; vbCr &amp; vbCr &amp; &quot;Phase: &quot; &amp; myGetPhaseName(myEvent.EventPhase)</div>
<div class="line">    myString = myString &amp; vbCr &amp; &quot;Bubbles: &quot; &amp; myEvent.Bubbles</div>
<div class="line">    myString = myString &amp; vbCr &amp; vbCr &amp; &quot;Cancelable: &quot; &amp; myEvent.Cancelable</div>
<div class="line">    myString = myString &amp; vbCr &amp; &quot;Stopped: &quot; &amp; myEvent.PropagationStopped</div>
<div class="line">    myString = myString &amp; vbCr &amp; &quot;Canceled: &quot; &amp; myEvent.DefaultPrevented</div>
<div class="line">    myString = myString &amp; vbCr &amp; vbCr &amp; &quot;Time: &quot; &amp; myEvent.TimeStamp</div>
<div class="line">    MsgBox myString, vbOKOnly, &quot;Event Details&quot;</div>
<div class="line">end function</div>
<div class="line">Rem Function returns a <span class="keywordtype">string</span> corresponding to the event phase enumeration.</div>
<div class="line">Function myGetPhaseName(myEventPhase)</div>
<div class="line">    Select Case myEventPhase</div>
<div class="line">        Case idEventPhases.idAtTarget</div>
<div class="line">            myPhaseName = &quot;At Target&quot;</div>
<div class="line">        Case idEventPhases.idBubblingPhase</div>
<div class="line">            myPhaseName = &quot;Bubbling&quot;</div>
<div class="line">        Case idEventPhases.idDone</div>
<div class="line">            myPhaseName = &quot;Done&quot;</div>
<div class="line">        Case idEventPhases.idNotDispatching</div>
<div class="line">            myPhaseName = &quot;Not Dispatching&quot;</div>
<div class="line">    end select</div>
<div class="line">    myGetPhaseName = myPhaseName</div>
<div class="line">End Function</div>
</div><!-- fragment --><p> The following sample script shows how to turn off all EventListeners on the application object. For the complete script, see EventListenersOff. </p>
<div class="fragment"><div class="line">    For myCounter = 1 To myInDesign.EventListeners.Count</div>
<div class="line">        myInDesign.EventListeners.Item(1).Delete</div>
<div class="line">    Next</div>
<div class="line">    For myCounter = 1 To myInDesign.Documents.Count</div>
<div class="line">        For myDocumentEventCounter = 1 To myInDesign.Documents.Item(myCounter).EventListeners.Count</div>
<div class="line">            myInDesign.Documents.Item(myCounter).EventListeners.Item(1).Delete</div>
<div class="line">        Next</div>
<div class="line">    Next</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_sample_afternew_event_listener"></a>
Sample afterNew Event Listener</h2>
<p>The afterNew event provides a convenient place to add information to the document, such as the user name, the date the document was created, copyright information, and other job-tracking information. The following tutorial script shows how to add this kind of information to a text frame in the slug area of the first master spread in the document (for the complete script, see AfterNew). This script also adds document metadata (also known as file info or XMP information). </p>
<div class="fragment"><div class="line">    Rem Define the handler as a file named <span class="stringliteral">&quot;AfterNewHandler.vbs&quot;</span> stored</div>
<div class="line">    Rem in the same folder as <span class="keyword">this</span> script.</div>
<div class="line">    myFileName = myFindFile(myInDesign, <span class="stringliteral">&quot;\AfterNewHandler.vbs&quot;</span>)</div>
<div class="line">    If myFileName &lt;&gt; &quot;&quot; Then</div>
<div class="line">        Set myEventListener = myInDesign.EventListeners.Add(&quot;afterNew&quot;, myFileName)</div>
<div class="line">    End If</div>
</div><!-- fragment --><p> The preceding script refers to the following script. The file reference in the preceding script must match the location of this script on your disk. For the complete script, see AfterNewDoScript.vbs. </p>
<div class="fragment"><div class="line">AfterNewHandler</div>
<div class="line">Function AfterNewHandler()</div>
<div class="line">    Set myInDesign = CreateObject(&quot;InDesign.Application.2024&quot;)</div>
<div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myViewPreferences = myDocument.ViewPreferences</div>
<div class="line">    Rem Because this script will be run by the WScript shell,</div>
<div class="line">    Rem we need to use decimal values, rather than enumerations.</div>
<div class="line">    myViewPreferences.HorizontalMeasurementUnits = 2054188905</div>
<div class="line">    myViewPreferences.VerticalMeasurementUnits = 2054188905</div>
<div class="line">    myViewPreferences.RulerOrigin = 1380143215</div>
<div class="line">    Rem mySlugOffset is the distance from the bottom of the</div>
<div class="line">    Rem page to the top of the slug.</div>
<div class="line">    mySlugOffset = 24</div>
<div class="line">    Rem mySlugHeight is the height of the slug text frame.</div>
<div class="line">    mySlugHeight = 72</div>
<div class="line">    With myDocument.DocumentPreferences</div>
<div class="line">        .SlugBottomOffset = mySlugOffset + mySlugHeight</div>
<div class="line">        .SlugTopOffset = 0</div>
<div class="line">        .SlugInsideOrLeftOffset = 0</div>
<div class="line">        .SlugRightOrOutsideOffset = 0</div>
<div class="line">    End With</div>
<div class="line">    For myCounter = 1 To myDocument.MasterSpreads.Count</div>
<div class="line">        Set myMasterSpread = myDocument.MasterSpreads.Item(myCounter)</div>
<div class="line">        For myMasterPageCounter = 1 To myMasterSpread.Pages.Count</div>
<div class="line">            Set myPage = myMasterSpread.Pages.Item(myMasterPageCounter)</div>
<div class="line">            mySlugBounds = myGetSlugBounds(myDocument, myPage, mySlugOffset, mySlugHeight)</div>
<div class="line">            Set mySlugFrame = myPage.TextFrames.Add</div>
<div class="line">            mySlugFrame.GeometricBounds = mySlugBounds</div>
<div class="line">            mySlugFrame.Contents = &quot;Created by: &quot; &amp; myInDesign.UserName</div>
<div class="line">        Next</div>
<div class="line">    Next</div>
<div class="line">    With myDocument.MetadataPreferences</div>
<div class="line">        .Author = &quot;Adobe Systems&quot;</div>
<div class="line">        .Description = &quot;This is a sample document with XMP metadata.&quot;</div>
<div class="line">        .DocumentTitle = &quot;After New Handler Example&quot;</div>
<div class="line">    End With</div>
<div class="line">End Function</div>
<div class="line">Function myGetSlugBounds(myDocument, myPage, mySlugOffset, mySlugHeight)</div>
<div class="line">    myPageWidth = myDocument.DocumentPreferences.PageWidth</div>
<div class="line">    myPageHeight = myDocument.DocumentPreferences.PageHeight</div>
<div class="line">    If myPage.Side = 1818653800 Then</div>
<div class="line">        myX2 = myPage.MarginPreferences.Left</div>
<div class="line">        myX1 = myPage.MarginPreferences.Right</div>
<div class="line">    Else</div>
<div class="line">        myX1 = myPage.MarginPreferences.Left</div>
<div class="line">        myX2 = myPage.MarginPreferences.Right</div>
<div class="line">    End If</div>
<div class="line">    myX2 = myPageWidth - myX2</div>
<div class="line">    myY1 = myPageHeight + mySlugOffset</div>
<div class="line">    myY2 = myY1 + mySlugHeight</div>
<div class="line">    myGetSlugBounds = Array(myY1, myX1, myY2, myX2)</div>
<div class="line">End Function</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_sample_beforeprint_event_listener"></a>
Sample beforePrint Event Listener</h2>
<p>The beforePrint event provides a perfect place to execute a script that performs various preflight checks on a document. The following script shows how to add an event listener that checks a document for certain attributes before printing (for the complete script, see BeforePrint): </p>
<div class="fragment"><div class="line">    Rem Find the script file BeforePrintHandler.vbs in the same folder</div>
<div class="line">    Rem as <span class="keyword">this</span> script.</div>
<div class="line">    myFileName = myFindFile(myInDesign, <span class="stringliteral">&quot;\BeforePrintHandler.vbs&quot;</span>)</div>
<div class="line">    If myFileName &lt;&gt; &quot;&quot; Then</div>
<div class="line">        Set myEventListener = myInDesign.EventListeners.Add(&quot;beforePrint&quot;, myFileName)</div>
<div class="line">    End if</div>
</div><!-- fragment --><p> The preceding script refers to the following script. The file reference in the preceding script must match the location of this script on your disk. For the complete script, see BeforePrintHandler.vbs. </p>
<div class="fragment"><div class="line">Rem <span class="stringliteral">&quot;evt&quot;</span> is the <span class="keyword">event</span> passed to <span class="keyword">this</span> script by the <span class="keyword">event</span> listener.</div>
<div class="line">myBeforePrintHandler(evt)</div>
<div class="line">Function myBeforePrintHandler(myEvent)</div>
<div class="line">    Rem The parent of the event is the document.</div>
<div class="line">    Set myDocument = myEvent.parent</div>
<div class="line">    If myPreflight(myDocument) = False Then</div>
<div class="line">        myEvent.stopPropagation</div>
<div class="line">        myEvent.preventDefault</div>
<div class="line">        myString = &quot;Document did not pass preflight check.&quot; &amp; vbCr</div>
<div class="line">        myString = myString &amp; &quot;Please fix the problems and try again.&quot;</div>
<div class="line">        msgbox(myString)</div>
<div class="line">    Else</div>
<div class="line">        msgbox(&quot;Document passed preflight check. Ready to print.&quot;)</div>
<div class="line">    End If</div>
<div class="line">End Function</div>
<div class="line">Function myPreflight(myDocument)</div>
<div class="line">    myPreflightCheck = True</div>
<div class="line">    myFontCheck = myCheckFonts(myDocument)</div>
<div class="line">    myGraphicsCheck = myCheckGraphics(myDocument)</div>
<div class="line">    If ((myFontCheck = false)Or(myGraphicsCheck = false)) Then</div>
<div class="line">        myPreflightCheck = false</div>
<div class="line">    End If</div>
<div class="line">    myPreflight = myPreflightCheck</div>
<div class="line">End function</div>
<div class="line">Function myCheckFonts(myDocument)</div>
<div class="line">    myFontCheck = true</div>
<div class="line">    For myCounter = 1 To myDocument.fonts.count</div>
<div class="line">        Set myFont = myDocument.fonts.item(myCounter)</div>
<div class="line">        if myFont.status &lt;&gt; idFontStatus.idinstalled Then</div>
<div class="line">            myFontCheck = false</div>
<div class="line">        End If</div>
<div class="line">    Next</div>
<div class="line">    myCheckFonts = myFontCheck</div>
<div class="line">End function</div>
<div class="line">function myCheckGraphics(myDocument)</div>
<div class="line">    myGraphicsCheck = true</div>
<div class="line">    for myCounter = 1 To myDocument.allGraphics.count</div>
<div class="line">        set myGraphic = myDocument.allGraphics.item(myCounter)</div>
<div class="line">        If myGraphic.itemLink.status &lt;&gt; idLinkStatus.idnormal Then</div>
<div class="line">            myGraphicsCheck = false</div>
<div class="line">        End If</div>
<div class="line">    Next</div>
<div class="line">    myCheckGraphics = myGraphicsCheck</div>
<div class="line">End function</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_sample_selection_event_listeners"></a>
Sample Selection Event Listeners</h2>
<p>InDesign can respond to events related to selection. When you select or deselect objects in an InDesign document, InDesign generates the afterSelectionChanged event. When you change an attribute (the formatting or position) of the selected object or objects, InDesign generates the afterSelectionAttributeChanged event. These two events are useful when you want to create a script that responds to user actions.</p>
<p>The following script fragment shows how to get and display the type of an object when the selection changes. For the complete script, see AfterSelectionChanged. </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Add</div>
<div class="line">    myDocument.AddEventListener <span class="stringliteral">&quot;afterSelectionChanged&quot;</span>, GetRef(<span class="stringliteral">&quot;myDisplaySelectionType&quot;</span>)</div>
</div><!-- fragment --> <div class="fragment"><div class="line">Set myDocument = myInDesign.Documents.Add</div>
<div class="line">myDocument.AddEventListener <span class="stringliteral">&quot;afterSelectionChanged&quot;</span>, GetRef(<span class="stringliteral">&quot;myDisplaySelectionType&quot;</span>)</div>
</div><!-- fragment --><p>The event handler referred to in the preceding script fragment looks like this: </p>
<div class="fragment"><div class="line">Function myDisplaySelectionType(en)</div>
<div class="line">    Set myInDesign = CreateObject(&quot;InDesign.Application.2024&quot;)</div>
<div class="line">    If myInDesign.Documents.Count &gt; 0 Then</div>
<div class="line">        if myInDesign.Documents.Item(1).Selection.Count &gt; 0 Then</div>
<div class="line">            Set mySelection = myInDesign.Documents.Item(1).Selection</div>
<div class="line">            myString = &quot;Selection Contents:&quot; &amp; vbCr</div>
<div class="line">            for myCounter = 1 To mySelection.Count</div>
<div class="line">                myString = myString &amp; TypeName(mySelection.Item(myCounter)) &amp; vbCr</div>
<div class="line">            Next</div>
<div class="line">            MsgBox(myString)</div>
<div class="line">        End If</div>
<div class="line">    End If</div>
<div class="line">End Function</div>
</div><!-- fragment --><p> To remove the event listener added by the preceding script, run the RemoveAfterSelectionChanged script.</p>
<p>The following script fragment shows how to respond to a change in the attributes of a selection. In this example, the event handler checks the selection to see whether the Registration swatch has been applied. (Accidental application of the Registration swatch can cause problems at your commercial printer.) If the Registration swatch has been applied, the script asks whether the change was intentional. For the complete script, see AfterSelectionAttributeChanged. </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Add</div>
<div class="line">    myDocument.AddEventListener <span class="stringliteral">&quot;afterSelectionAttributeChanged&quot;</span>, GetRef(<span class="stringliteral">&quot;myCheckForRegistration&quot;</span>)</div>
</div><!-- fragment --><p> The event handler referred to in the preceding script fragment looks like this: </p>
<div class="fragment"><div class="line">Function myCheckForRegistration(en)</div>
<div class="line">    myRegistrationSwatchUsed = false</div>
<div class="line">    Set myInDesign = CreateObject(&quot;InDesign.Application.2024&quot;)</div>
<div class="line">    If myInDesign.Documents.Count &gt; 0 Then</div>
<div class="line">        If myInDesign.Documents.Item(1).Selection.Count &gt; 0 Then</div>
<div class="line">            Set mySelection = myInDesign.Documents.Item(1).Selection</div>
<div class="line">            For myCounter = 1 To mySelection.Count</div>
<div class="line">                Set myFillColor = mySelection.Item(myCounter).FillColor</div>
<div class="line">                Set myStrokeColor = mySelection.Item(myCounter).StrokeColor</div>
<div class="line">                If myFillColor.Name = &quot;Registration&quot; Or myStrokeColor.Name = &quot;Registration&quot; Then</div>
<div class="line">                    myRegistrationSwatchUsed = True</div>
<div class="line">                End If</div>
<div class="line">            Next</div>
<div class="line">            If myRegistrationSwatchUsed = True Then</div>
<div class="line">                MsgBox(&quot;The Registration swatch is applied to some of the&quot; &amp; vbCr &amp; &quot;objects in the selection. Did you really intend to apply this swatch?&quot;)</div>
<div class="line">            End If</div>
<div class="line">        End If</div>
<div class="line">    End If</div>
<div class="line">End Function</div>
</div><!-- fragment --><p> To remove the event listener added by the preceding script, run the RemoveAfterSelectionAttributeChanged script.</p>
<h2><a class="anchor" id="id_vb_sample_onidle_event_listener"></a>
Sample onIdle Event Listener</h2>
<p>InDesign's idle tasks execute when there are no events in the event queue for the application to process. It is easy to run idle tasks by scripting. The onIdle event provides a way to run scripting-based idle tasks. It can be used to automatically execute a script when InDesign/InCopy is idle. Its event target is IdleTask, and its event object is IdleEvent.</p>
<p>The Sleep property of the idle task is the amount of time that elapses before InDesign calls the task again. It should be obvious that you need to set the sleep time to a value high enough that it does not interfere with your work, though this value will vary depending on what tasks the script performs.</p>
<p>Setting the sleep time to zero deletes the task (though it does not remove the event listener). This is the most convenient way to stop an idle task.</p>
<p>The following script shows how to add an eventListener and show a message box from the idle task (for the complete script, see Reminder): </p>
<div class="fragment"><div class="line">    Set myIdleTask = myInDesign.IdleTasks.Add()</div>
<div class="line">    myIdleTask.Name = <span class="stringliteral">&quot;my_idle_task&quot;</span></div>
<div class="line">    myIdleTask.Sleep = 10000</div>
<div class="line">    Rem You need to fill in your own file path.</div>
<div class="line">    fileName = <span class="stringliteral">&quot;C:\scripting\OnIdleEventHandler.vbs&quot;</span></div>
<div class="line">    Set onIdleEventListener = myIdleTask.AddEventListener(<span class="stringliteral">&quot;onIdle&quot;</span>, fileName, False)</div>
<div class="line">    MsgBox(<span class="stringliteral">&quot;Created idle task &quot;</span> &amp; myIdleTask.Name &amp; <span class="stringliteral">&quot;; added event listener on &quot;</span> &amp; onIdleEventListener.EventType)</div>
</div><!-- fragment --><p> The event handler is a script file, OnIdleEventHandler.vbs. </p>
<div class="fragment"><div class="line">Rem <span class="stringliteral">&quot;evt&quot;</span> is the <span class="keyword">event</span> passed to <span class="keyword">this</span> script by the <span class="keyword">event</span> listener.</div>
<div class="line">onIdleEventHandler(evt)</div>
<div class="line">Function onIdleEventHandler(myIdleEvent)</div>
<div class="line">    Set myInDesign = CreateObject(&quot;InDesign.Application.2024&quot;)</div>
<div class="line">    If myInDesign.Documents.Count = 0 Then</div>
<div class="line">        Set myDoc = myInDesign.Documents.Add()</div>
<div class="line">        MsgBox(&quot;Created document &quot; + myDoc.Name + &quot; in idle task.&quot;)</div>
<div class="line">        Exit Function</div>
<div class="line">    End If</div>
<div class="line"></div>
<div class="line">    Set myTextFrames = myInDesign.ActiveDocument.Pages.Item(1).TextFrames</div>
<div class="line">    If myTextFrames.Count = 0 Then</div>
<div class="line">        Set myTextFrame = myTextFrames.Add()</div>
<div class="line">        myTextFrame.GeometricBounds = Array(&quot;72pt&quot;, &quot;72pt&quot;, &quot;288pt&quot;, &quot;288pt&quot;)</div>
<div class="line">        myTextFrame.Contents = &quot;Text frame created in idle task&quot;</div>
<div class="line">        MsgBox(&quot;Created a text frame in idle task.&quot;)</div>
<div class="line">        Exit Function</div>
<div class="line">    End If</div>
<div class="line"></div>
<div class="line">    Rem Delete idle task by setting its sleep time to zero.</div>
<div class="line">    myIdleEvent.Parent.Sleep = 0</div>
<div class="line">    MsgBox(&quot;Nothing to do. Delete idle task.&quot;)</div>
<div class="line">End Function</div>
</div><!-- fragment --><p> To remove the idle task created by preceding script, run the following script (for the complete script, see RemoveIdleTask): </p>
<div class="fragment"><div class="line">    taskCount = myInDesign.IdleTasks.Count</div>
<div class="line">    If taskCount = 0 Then</div>
<div class="line">        MsgBox(<span class="stringliteral">&quot;There is no idle task.&quot;</span>)</div>
<div class="line">    Else</div>
<div class="line">        myIdleTaskName = &quot;my_idle_task&quot;</div>
<div class="line">        For Each myIdleTask In myInDesign.IdleTasks</div>
<div class="line">            If myIdleTask.Name = myIdleTaskName Then</div>
<div class="line">                myIdleTask.Delete()</div>
<div class="line">            End If</div>
<div class="line">            MsgBox(&quot;Idle task &quot; &amp; myIdleTaskName &amp; &quot; removed.&quot;)</div>
<div class="line">        Next</div>
<div class="line">    End If</div>
</div><!-- fragment --><p> To remove all idle tasks, run the following script (for the complete script, see RemoveAllIdleTasks): </p>
<div class="fragment"><div class="line">    taskCount = myInDesign.IdleTasks.Count</div>
<div class="line">    If taskCount = 0 Then</div>
<div class="line">        MsgBox(<span class="stringliteral">&quot;There is no idle task.&quot;</span>)</div>
<div class="line">    Else</div>
<div class="line">        For Each myIdleTask In myInDesign.IdleTasks</div>
<div class="line">            myIdleTask.Delete()</div>
<div class="line">        Next</div>
<div class="line">        MsgBox(taskCount &amp; &quot; idle task(s) removed.&quot;)</div>
<div class="line">    End If</div>
</div><!-- fragment --><p> To list existing idle tasks, run the following script (for the complete script, see ListIdleTasks): </p>
<div class="fragment"><div class="line">    taskCount = myInDesign.IdleTasks.Count</div>
<div class="line">    If taskCount = 0 Then</div>
<div class="line">        MsgBox(<span class="stringliteral">&quot;There is no idle task.&quot;</span>)</div>
<div class="line">    Else</div>
<div class="line">        str = &quot;&quot;</div>
<div class="line">        For i = 1 To taskCount</div>
<div class="line">            Set myIdleTask = myInDesign.IdleTasks.Item(i)</div>
<div class="line">            str = str &amp;  &quot;idle task &quot; &amp; myIdleTask.<span class="keywordtype">id</span> &amp; &quot;: &quot; &amp; myIdleTask.name &amp; VbCrLf</div>
<div class="line">        Next</div>
<div class="line">        MsgBox(str)</div>
<div class="line">    End If</div>
</div><!-- fragment --> <h1><a class="anchor" id="id_vb_menus"></a>
Menus</h1>
<p>InDesign scripting can add menu items, remove menu items, perform any menu command, and attach scripts to menu items.</p>
<p>This section shows how to work with InDesign menu scripting. The sample scripts in this section are presented in order of complexity, starting with very simple scripts and building toward more complex operations.</p>
<p>We assume that you have already read Adobe InDesign Scripting Tutorial and know how to create, install, and run a script.</p>
<h2><a class="anchor" id="id_vb_understanding_the_menu_model"></a>
Understanding the Menu Model</h2>
<p>The InDesign menu-scripting model is made up of a series of objects that correspond to the menus you see in the application's user interface, including menus associated with panels as well as those displayed on the main menu bar. A menu object contains the following objects:</p>
<ul>
<li>MenuItems - The menu options shown on a menu. This does not include submenus.</li>
<li>MenuSeparators - Lines used to separate menu options on a menu.</li>
<li>Submenus - Menu options that contain further menu choices.</li>
<li>MenuElements - All MenuItems, MenuSeparators and Submenus shown on a menu.</li>
<li>EventListeners - These respond to user (or script) actions related to a menu.</li>
<li>Events - The events triggered by a menu.</li>
</ul>
<p>Every MenuItem is connected to a MenuAction through the AssociatedMenuAction property. The properties of the MenuAction define what happens when the menu item is chosen. In addition to the MenuActions defined by the user interface, InDesign scripters can create their own, ScriptMenuActions, which associate a script with a menu selection.</p>
<p>A MenuAction or ScriptMenuAction can be connected to zero, one, or more MenuItems.</p>
<p>The following diagram shows how the different menu objects relate to each other:</p>
<div class="image">
<img src="InDesign_ScriptingGuide-7.gif" alt="InDesign_ScriptingGuide-7.gif"/>
</div>
<p>To create a list (as a text file) of all menu actions, run the following script fragment (from the GetMenuActions tutorial script): </p>
<div class="fragment"><div class="line">    Set myFileSystemObject = CreateObject(<span class="stringliteral">&quot;Scripting.FileSystemObject&quot;</span>)</div>
<div class="line">    Rem You&#39;ll need to fill in a valid file path on your system.</div>
<div class="line">    Set myTextFile = myFileSystemObject.CreateTextFile(&quot;c:\menuactions.txt&quot;, True, False)</div>
<div class="line">    For myCounter = 1 To myInDesign.MenuActions.Count</div>
<div class="line">        Set myMenuAction = myInDesign.MenuActions.Item(myCounter)</div>
<div class="line">        myTextFile.WriteLine myMenuAction.Name</div>
<div class="line">    Next</div>
<div class="line">    myTextFile.Close</div>
<div class="line">    MsgBox &quot;done!&quot;</div>
</div><!-- fragment --><p> To create a list (as a text file) of all available menus, run the following script fragment (for the complete script, see GetMenuNames). These scripts can be very slow, as there are many menu names in InDesign. </p>
<div class="fragment"><div class="line">    Set myFileSystemObject = CreateObject(<span class="stringliteral">&quot;Scripting.FileSystemObject&quot;</span>)</div>
<div class="line">    Set myTextFile = myFileSystemObject.CreateTextFile(&quot;c:\menunames.txt&quot;, True, False)</div>
<div class="line">    For myMenuCounter = 1 To myInDesign.Menus.Count</div>
<div class="line">        Set myMenu = myInDesign.Menus.Item(myMenuCounter)</div>
<div class="line">        myTextFile.WriteLine myMenu.Name</div>
<div class="line">        myProcessMenu myMenu, myTextFile</div>
<div class="line">    Next</div>
<div class="line">    myTextFile.Close</div>
<div class="line">    MsgBox &quot;done!&quot;</div>
</div><!-- fragment --><div class="fragment"><div class="line">Function myProcessMenu(myMenuItem, myTextFile)</div>
<div class="line">    myString = &quot;&quot;</div>
<div class="line">    myMenuName = myMenuItem.Name</div>
<div class="line">    For myCounter = 1 To myMenuItem.MenuElements.Count</div>
<div class="line">        If TypeName(myMenuItem.MenuElements.Item(myCounter)) &lt;&gt; &quot;MenuSeparator&quot; Then</div>
<div class="line">            myString = myGetIndent(myMenuItem.MenuElements.Item(myCounter),myString, False)</div>
<div class="line">            On Error Resume Next  </div>
<div class="line">            myTextFile.WriteLine myString &amp; myMenuItem.MenuElements.Item(myCounter).Name</div>
<div class="line">            myMenuElementName = myMenuItem.MenuElements.Item(myCounter).Name</div>
<div class="line">            myString = &quot;&quot;</div>
<div class="line">            If TypeName(myMenuItem.MenuElements.Item(myCounter)) = &quot;Submenu&quot; Then</div>
<div class="line">                If myMenuItem.MenuElements.Count &gt; 0 Then</div>
<div class="line">                    myProcessMenu myMenuItem.MenuElements.Item(myCounter),myTextFile</div>
<div class="line">                End If</div>
<div class="line">            End If</div>
<div class="line">            Err.Clear</div>
<div class="line">        End If</div>
<div class="line">    Next</div>
<div class="line">End Function</div>
<div class="line">Function myGetIndent(myMenuItem, myString, myDone)</div>
<div class="line">    Do While myDone = False</div>
<div class="line">        If TypeName(myMenuItem.Parent) = &quot;Menu&quot; or TypeName(myMenuItem.Parent) = &quot;Application&quot; Then</div>
<div class="line">            myDone = True</div>
<div class="line">        Else</div>
<div class="line">            myString = myString &amp; vbTab</div>
<div class="line">            myGetIndent myMenuItem.Parent, myString, myDone</div>
<div class="line">        End If</div>
<div class="line">    Loop</div>
<div class="line">    myGetIndent = myString</div>
<div class="line">End Function</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_localization_and_menu_names"></a>
Localization and menu names</h3>
<p>In InDesign scripting, MenuItems, Menus, MenuActions, and Submenus are all referred to by name. Because of this, scripts need a method of locating these objects that is independent of the installed locale of the application. To do this, you can use an internal database of strings that refer to a specific item, regardless of locale. For example, to get the locale-independent name of a menu action, you can use the following script fragment (for the complete script, see GetKeyStrings): </p>
<div class="fragment"><div class="line">    Rem Fill in the name of the menu action you want.</div>
<div class="line">    Set myMenuAction = myInDesign.MenuActions.Item(<span class="stringliteral">&quot;Convert to Note&quot;</span>)</div>
<div class="line">    myKeyStrings = myInDesign.FindKeyStrings(myMenuAction.Name)</div>
<div class="line">    myString = <span class="stringliteral">&quot;&quot;</span></div>
<div class="line">    For Each myKeyString In myKeyStrings</div>
<div class="line">        myString = myString &amp; myKeyString &amp; vbCr</div>
<div class="line">    Next</div>
<div class="line">    MsgBox myString</div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>It is much better to get the locale-independent name of a MenuAction than of a Menus, MenuItem, or Submenu, because the title of a MenuAction is more likely to be a single string. Many of the other menu objects return multiple strings when you use the FindKeyStrings method.</dd></dl>
<p>Once you have the locale-independent string you want to use, you can include it in your scripts. Scripts that use these strings will function properly in locales other than that of your version of InDesign.</p>
<p>To translate a locale-independent string into the current locale, use the following script fragment (from the TranslateKeyString tutorial script): </p>
<div class="fragment"><div class="line">    Rem Fill in the appropriate key <span class="keywordtype">string</span> in the following line.</div>
<div class="line">    myString = myInDesign.TranslateKeyString(<span class="stringliteral">&quot;$ID/Convert To Note&quot;</span>)</div>
<div class="line">    MsgBox myString</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_running_a_menu_action_from_a_script"></a>
Running a Menu Action from a Script</h2>
<p>Any of InDesign's built-in MenuActions can be run from a script. The MenuAction does not need to be attached to a MenuItem; however, in every other way, running a MenuItem from a script is exactly the same as choosing a menu option in the user interface. For example, If selecting the menu option displays a dialog box, running the corresponding MenuAction from a script also displays a dialog box.</p>
<p>The following script shows how to run a MenuAction from a script (for the complete script, see InvokeMenuAction): </p>
<div class="fragment"><div class="line">   Rem Get a reference to a menu action.</div>
<div class="line">   Set myMenuAction = myInDesign.MenuActions.Item(<span class="stringliteral">&quot;$ID/Convert to Note&quot;</span>)  </div>
<div class="line">   Rem Run the menu action. The example action will fail <span class="keywordflow">if</span> you <span class="keywordflow">do</span> not</div>
<div class="line">   Rem have text selected.</div>
<div class="line">   myMenuAction.Invoke</div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>In general, you should not try to automate InDesign processes by scripting menu actions and user-interface selections; InDesign's scripting object model provides a much more robust and powerful way to work. Menu actions depend on a variety of user-interface conditions, like the selection and the state of the window. Scripts using the object model work with the objects in an InDesign document directly, which means they do not depend on the user interface; this, in turn, makes them faster and more consistent.</dd></dl>
<h2><a class="anchor" id="id_vb_adding_menus_and_menu_items"></a>
Adding Menus and Menu Items</h2>
<p>Scripts also can create new menus and menu items or remove menus and menu items, just as you can in the InDesign user interface. The following sample script shows how to duplicate the contents of a submenu to a new menu in another menu location (for the complete script, see CustomizeMenu): </p>
<div class="fragment"><div class="line">    Set myMainMenu = myInDesign.Menus.Item(<span class="stringliteral">&quot;Main&quot;</span>)</div>
<div class="line">    Set myTypeMenu = myMainMenu.MenuElements.Item(<span class="stringliteral">&quot;Type&quot;</span>)</div>
<div class="line">    Set myFontMenu = myTypeMenu.MenuElements.Item(<span class="stringliteral">&quot;Font&quot;</span>)</div>
<div class="line">    Set myKozukaMenu = myFontMenu.Submenus.Item(<span class="stringliteral">&quot;Kozuka Mincho Pro &quot;</span>)</div>
<div class="line">    Set mySpecialFontMenu = myMainMenu.Submenus.Add(<span class="stringliteral">&quot;Kozuka Mincho Pro&quot;</span>)</div>
<div class="line">    For myCounter = 1 To myKozukaMenu.MenuItems.Count</div>
<div class="line">    Set myAssociatedMenuAction = myKozukaMenu.MenuItems.Item(myCounter).AssociatedMenuAction</div>
<div class="line">    mySpecialFontMenu.MenuItems.Add myAssociatedMenuAction</div>
<div class="line">    Next</div>
</div><!-- fragment --><p> To remove the custom menu item created by the above script, use RemoveCustomMenu. </p>
<div class="fragment"><div class="line">    Set myMainMenu = myInDesign.menus.item(<span class="stringliteral">&quot;$ID/Main&quot;</span>)</div>
<div class="line">    On Error Resume Next</div>
<div class="line">    Set mySpecialFontMenu = myMainMenu.Submenus.Item(<span class="stringliteral">&quot;Kozuka Mincho Pro&quot;</span>)</div>
<div class="line">    mySpecialFontMenu.Delete</div>
<div class="line">    On Error Goto 0</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_menus_and_events"></a>
Menus and Events</h2>
<p>Menus and submenus generate events as they are chosen in the user interface, and MenuActions and ScriptMenuActions generate events as they are used. Scripts can install EventListeners to respond to these events. The following table shows the events for the different menu scripting components:</p>
<table class="doxtable">
<tr>
<th>Object</th><th>Event</th><th>Description  </th></tr>
<tr>
<td>Menu</td><td>beforeDisplay</td><td>Runs the attached script before the contents of the menu is shown.  </td></tr>
<tr>
<td rowspan="2" colspan="1">MenuAction</td><td>afterInvoke</td><td>Runs the attached script when the associated MenuItem is selected, but after the onInvoke event.  </td></tr>
<tr>
<td>beforeInvoke</td><td>Runs the attached script when the associated MenuItem is selected, but before the onInvoke event.  </td></tr>
<tr>
<td rowspan="4" colspan="1">ScriptMenuAction</td><td>afterInvoke</td><td>Runs the attached script when the associated MenuItem is selected, but after the onInvoke event.  </td></tr>
<tr>
<td>beforeInvoke</td><td>Runs the attached script when the associated MenuItem is selected, but before the onInvoke event.  </td></tr>
<tr>
<td>beforeDisplay</td><td>Runs the attached script before an internal request for the enabled/checked status of the ScriptMenuActionscriptMenuAction.  </td></tr>
<tr>
<td>onInvoke</td><td>Runs the attached script when the ScriptMenuAction is invoked.  </td></tr>
<tr>
<td>Submenu</td><td>beforeDisplay</td><td>Runs the attached script before the contents of the Submenu are shown.  </td></tr>
</table>
<p>For more about Events and EventListeners, see <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_events">Events.</a></p>
<p>To change the items displayed in a menu, add an EventListener for the beforeDisplay Event. When the menu is selected, the EventListener can then run a script that enables or disables menu items, changes the wording of menu item, or performs other tasks related to the menu. This mechanism is used internally to change the menu listing of available fonts, recent documents, or open windows.</p>
<h2><a class="anchor" id="id_vb_working_with_scriptmenuactions"></a>
Working with scriptMenuActions</h2>
<p>You can use ScriptMenuAction to create a new MenuAction whose behavior is implemented through the script registered to run when the onInvoke Event is triggered.</p>
<p>The following script shows how to create a ScriptMenuAction and attach it to a menu item (for the complete script, see MakeScriptMenuAction). This script simply displays an alert when the menu item is selected. </p>
<div class="fragment"><div class="line">    Set mySampleScriptAction = myInDesign.ScriptMenuActions.add(<span class="stringliteral">&quot;Display Alert&quot;</span>)</div>
<div class="line">    Rem You<span class="stringliteral">&#39;ll have to fill in your own file path for the event handler script.</span></div>
<div class="line"><span class="stringliteral">    myFileName = myFindFile(myInDesign, &quot;\Message.vbs&quot;)</span></div>
<div class="line"><span class="stringliteral">    Set myEventListener = mySampleScriptAction.EventListeners.Add(&quot;onInvoke&quot;, myFileName, false)</span></div>
<div class="line"><span class="stringliteral">    Rem If the submenu &quot;Script Menu Action&quot; does not already exist, create it.</span></div>
<div class="line"><span class="stringliteral">    Rem You might have to force InDesign to redraw the menu (by switching</span></div>
<div class="line"><span class="stringliteral">    Rem out of the application and back again) to make the menu item appear.</span></div>
<div class="line"><span class="stringliteral">    On Error Resume Next</span></div>
<div class="line"><span class="stringliteral">    Set mySampleScriptMenu = myInDesign.Menus.Item(&quot;$ID/Main&quot;).Submenus.Item(&quot;Script Menu Action&quot;)</span></div>
<div class="line"><span class="stringliteral">    If Err.Number &lt;&gt; 0 Then</span></div>
<div class="line"><span class="stringliteral">        Set mySampleScriptMenu = myInDesign.Menus.Item(&quot;$ID/Main&quot;).Submenus.Add(&quot;Script Menu Action&quot;)</span></div>
<div class="line"><span class="stringliteral">        Err.Clear</span></div>
<div class="line"><span class="stringliteral">    End If</span></div>
<div class="line"><span class="stringliteral">    On Error Goto 0</span></div>
<div class="line"><span class="stringliteral">    Set mySampleScriptMenuItem = mySampleScriptMenu.menuItems.add(mySampleScriptAction)</span></div>
</div><!-- fragment --><p> The message.vbs script file contains the following code: </p>
<div class="fragment"><div class="line">Rem <span class="stringliteral">&quot;evt&quot;</span> is the <span class="keyword">event</span> passed to <span class="keyword">this</span> script by the <span class="keyword">event</span> listener.</div>
<div class="line">MsgBox (<span class="stringliteral">&quot;This event is the &quot;</span> &amp; evt.EventType &amp; <span class="stringliteral">&quot; event.&quot;</span>)</div>
</div><!-- fragment --><p> To remove the Menu, Submenu, MenuItem, and ScriptMenuAction created by the above script, run the following script fragment (from the RemoveScriptMenuAction tutorial script): </p>
<div class="fragment"><div class="line">    On Error Resume Next</div>
<div class="line">    myInDesign.ScriptMenuActions.Item(<span class="stringliteral">&quot;Display Alert&quot;</span>).Delete</div>
<div class="line">    myInDesign.Menus.Item(<span class="stringliteral">&quot;$ID/Main&quot;</span>).Submenus.Item(<span class="stringliteral">&quot;Script Menu Action&quot;</span>).Delete</div>
<div class="line">    On Error Goto 0</div>
</div><!-- fragment --><p> You also can remove all ScriptMenuAction, as shown in the following script fragment (from the RemoveAllScriptMenuActions tutorial script). This script also removes the menu listings of the ScriptMenuAction, but it does not delete any menus or submenus you might have created. </p>
<div class="fragment"><div class="line">    For myCounter = myInDesign.ScriptMenuActions.Count To 1 Step -1</div>
<div class="line">        myInDesign.ScriptMenuActions.Item(myCounter).Delete</div>
<div class="line">    Next</div>
</div><!-- fragment --><p> You can create a list of all current ScriptMenuActions, as shown in the following script fragment (from the ListScriptMenuActions tutorial script): </p>
<div class="fragment"><div class="line">    Set myFileSystemObject = CreateObject(<span class="stringliteral">&quot;Scripting.FileSystemObject&quot;</span>)</div>
<div class="line">    Rem You&#39;ll need to fill in a valid file path for your system.</div>
<div class="line">    Set myTextFile = myFileSystemObject.CreateTextFile(&quot;c:\scriptmenuactions.txt&quot;, True, False)</div>
<div class="line">    For myCounter = 1 To myInDesign.ScriptMenuActions.Count</div>
<div class="line">        Set myScriptMenuAction = myInDesign.ScriptMenuActions.Item(myCounter)</div>
<div class="line">        myTextFile.WriteLine myScriptMenuAction.Name</div>
<div class="line">    Next</div>
<div class="line">    myTextFile.Close</div>
</div><!-- fragment --><p> ScriptMenuAction also can run scripts during their beforeDisplayEvent, in which case they are executed before an internal request for the state of the ScriptMenuAction (e.g., when the menu item is about to be displayed). Among other things, the script can then change the menu names and/or set the enabled/checked status.</p>
<p>In the following sample script, we add an EventListener to the beforeDisplay Event that checks the current selection. If there is no selection, the script in the EventListener disables the menu item. If an item is selected, the menu item is enabled, and choosing the menu item displays the type of the first item in the selection. (For the complete script, see BeforeDisplay.) </p>
<div class="fragment"><div class="line">    Rem Find the script file WhatIsSelected.vbs in the same folder as <span class="keyword">this</span> script.</div>
<div class="line">    myFileNameA = myFindFile(myInDesign, <span class="stringliteral">&quot;\WhatIsSelected.vbs&quot;</span>)</div>
<div class="line">    Rem Find the script file BeforeDisplayHandler.vbs in the same folder as this script.</div>
<div class="line">    myFileNameB = myFindFile(myInDesign, &quot;\BeforeDisplayHandler.vbs&quot;)</div>
<div class="line">    Rem If either of the two files are not found, do nothing.</div>
<div class="line">    If myFileNameA &lt;&gt; &quot;&quot; And myFileNameB &lt;&gt; &quot;&quot; Then </div>
<div class="line">        Set mySampleScriptAction = myInDesign.ScriptMenuActions.Add(&quot;Display Message&quot;)</div>
<div class="line">        Set myEventListener = mySampleScriptAction.EventListeners.Add(&quot;onInvoke&quot;, myFileNameA)</div>
<div class="line">        Set mySampleScriptMenu = myInDesign.Menus.Item(&quot;$ID/Main&quot;).Submenus.Add(&quot;Script Menu Action&quot;)</div>
<div class="line">        Set mySampleScriptMenuItem = mySampleScriptMenu.MenuItems.Add(mySampleScriptAction)</div>
<div class="line">        mySampleScriptMenu.EventListeners.Add &quot;beforeDisplay&quot;, myFileNameB</div>
<div class="line">    End If</div>
</div><!-- fragment --><p> The BeforeDisplayHander tutorial script file contains the following script: </p>
<div class="fragment"><div class="line">Set myInDesign = CreateObject(<span class="stringliteral">&quot;InDesign.Application.2024&quot;</span>)</div>
<div class="line">Set mySampleScriptAction = myInDesign.ScriptMenuActions.Item(&quot;Display Message&quot;)</div>
<div class="line">If myInDesign.Selection.Count &gt; 0 Then</div>
<div class="line">    mySampleScriptAction.Enabled = True</div>
<div class="line">Else</div>
<div class="line">    mySampleScriptAction.Enabled = False</div>
<div class="line">End If</div>
</div><!-- fragment --><p> The WhatIsSelected tutorial script file contains the following script: </p>
<div class="fragment"><div class="line">myString = TypeName(myInDesign.Selection.Item(1))</div>
<div class="line">MsgBox <span class="stringliteral">&quot;The first item in the selection is a &quot;</span> &amp; myString &amp; <span class="stringliteral">&quot;.&quot;</span></div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_a_more_complex_menu-scripting_example"></a>
A More Complex Menu-scripting Example</h2>
<p>You have probably noticed that selecting different items in the InDesign user interface changes the contents of the context menus. The following sample script shows how to modify the context menu based on the properties of the object you select. Fragments of the script are shown below; for the complete script, see LayoutContextMenu.</p>
<p>The following snippet shows how to create a new menu item on the Layout context menu (the context menu that appears when you have a page item selected). The following snippet adds a beforeDisplay EventListener which checks for the existence of a MenuItem and removes it if it already exists. We do this to ensure the MenuItem does not appear on the context menu when the selection does not contain a graphic, and to avoid adding multiple menu choices to the context menu. The EventListener then checks the selection to see if it contains a graphic; if so, it creates a new ScriptMenuItem. </p>
<div class="fragment"><div class="line">    Rem The local-independent name (aka <span class="stringliteral">&quot;key string&quot;</span>) for the </div>
<div class="line">    Rem Layout context menu is &quot;$ID/RtMouseLayout&quot;.</div>
<div class="line">    Set myLayoutContextMenu = myInDesign.Menus.Item(&quot;$ID/RtMouseLayout&quot;)</div>
<div class="line">    Rem Create the event handler for the &quot;beforeDisplay&quot; event of the Layout context menu.</div>
<div class="line">    Rem Define the handler as a file named &quot;Message.vbs&quot; stored</div>
<div class="line">    Rem in the same folder as this script.</div>
<div class="line">    myFileName = myFindFile(myInDesign, &quot;\LabelContextMenuBeforeDisplayHandler.vbs&quot;)</div>
<div class="line">    If myFileName &lt;&gt; &quot;&quot; Then</div>
<div class="line">        Set myBeforeDisplayListener = myLayoutContextMenu.addEventListener(&quot;beforeDisplay&quot;, myFileName, false)</div>
<div class="line">    End If</div>
</div><!-- fragment --><p> The LayoutContextMenuBeforeDisplayHandler.vbs file referred to in the above example contains the following: </p>
<div class="fragment"><div class="line">myBeforeDisplayHandler evt</div>
<div class="line"><span class="keyword">function</span> myBeforeDisplayHandler(myEvent)</div>
<div class="line">    ReDim myObjectList(0)</div>
<div class="line">    Set myInDesign = CreateObject(&quot;InDesign.Application.2024&quot;)</div>
<div class="line">    Set myLayoutContextMenu = myInDesign.Menus.Item(&quot;$ID/RtMouseLayout&quot;)</div>
<div class="line">    Rem Check for open documents is a basic sanity check--</div>
<div class="line">    Rem it should never be needed, as this menu won&#39;t be</div>
<div class="line">    Rem displayed unless an item is selected. But it&#39;s best</div>
<div class="line">    Rem to err on the side of safety.</div>
<div class="line">    If myInDesign.Documents.Count &gt; 0 Then</div>
<div class="line">        If myInDesign.Selection.Count &gt; 0 Then</div>
<div class="line">            Rem Scan the selection for qualifying graphics.</div>
<div class="line">            For myCounter = 1 To myInDesign.Selection.Count</div>
<div class="line">                Select Case TypeName(myInDesign.Selection.Item(myCounter))</div>
<div class="line">                    Case &quot;PDF&quot;,&quot;EPS&quot;, &quot;Image&quot;:</div>
<div class="line">                        Rem Do not add the graphic to the array if the graphic is</div>
<div class="line">                        Rem an inline or anchored graphic.</div>
<div class="line">                        Select Case TypeName(myInDesign.Selection.Item(myCounter).Parent.Parent)</div>
<div class="line">                            Case &quot;Page&quot;, &quot;Spread&quot;, &quot;Group&quot;, &quot;Rectangle&quot;, &quot;Oval&quot;, &quot;Polygon&quot;:</div>
<div class="line">                                If Not (IsEmpty(myObjectList(0))) Then</div>
<div class="line">                                    ReDim Preserve myObjectList(UBound(myObjectList) + 1)</div>
<div class="line">                                End If</div>
<div class="line">                                Set myObjectList(UBound(myObjectList)) = myInDesign.Selection.Item(myCounter)</div>
<div class="line">                         End Select</div>
<div class="line">                    Case &quot;Rectangle&quot;, &quot;Oval&quot;, &quot;Polygon&quot;:</div>
<div class="line">                        Rem Do not add the graphic to the array if the graphic is</div>
<div class="line">                        Rem an inline or anchored graphic.</div>
<div class="line">                        Select Case TypeName(myInDesign.Selection.Item(myCounter).Parent)</div>
<div class="line">                            Case &quot;Page&quot;, &quot;Spread&quot;, &quot;Group&quot;, &quot;Rectangle&quot;, &quot;Oval&quot;, &quot;Polygon&quot;:</div>
<div class="line">                                If myInDesign.selection.Item(myCounter).Graphics.Count &gt; 0 Then</div>
<div class="line">                                    If Not (IsEmpty(myObjectList(0))) Then</div>
<div class="line">                                        ReDim Preserve myObjectList(UBound(myObjectList) + 1)</div>
<div class="line">                                    End If</div>
<div class="line">                                    Set myObjectList(UBound(myObjectList)) = myInDesign.Selection.Item(myCounter).Graphics.Item(1)</div>
<div class="line">                                End If</div>
<div class="line">                        End Select</div>
<div class="line">                End Select</div>
<div class="line">            Next</div>
<div class="line">            If Not (IsEmpty(myObjectList(0))) Then</div>
<div class="line">                Rem Add the menu item if it does not already exist.</div>
<div class="line">                If myCheckForMenuItem(myLayoutContextMenu, &quot;Label Graphic&quot;) = False Then</div>
<div class="line">                    myMakeLabelGraphicMenuItem myInDesign</div>
<div class="line">                End If</div>
<div class="line">            Else</div>
<div class="line">                Rem Remove the menu item, if it exists.</div>
<div class="line">                If myCheckForMenuItem(myLayoutContextMenu, &quot;Label Graphic&quot;) = True Then</div>
<div class="line">                    myLayoutContextMenu.MenuItems.Item(&quot;Label Graphic&quot;).delete</div>
<div class="line">                End If</div>
<div class="line">            End If</div>
<div class="line">        End If</div>
<div class="line">    End If</div>
<div class="line">End Function</div>
<div class="line">Function myMakeLabelGraphicMenuItem(myInDesign)</div>
<div class="line">    myEventHandler = myFindFile(myInDesign, &quot;\LabelGraphicOnInvoke.vbs&quot;)</div>
<div class="line">    If myEventHandler &lt;&gt; &quot;&quot; Then</div>
<div class="line">        If myCheckForScriptMenuItem(myInDesign, &quot;Label Graphic&quot;) = False Then</div>
<div class="line">            Set myLabelGraphicMenuAction = myInDesign.ScriptMenuActions.add(&quot;Label Graphic&quot;)</div>
<div class="line">            Set myLabelGraphicEventListener = myLabelGraphicMenuAction.EventListeners.Add(&quot;onInvoke&quot;, myEventHandler, false)</div>
<div class="line">        End If</div>
<div class="line">        Set myLabelGraphicMenuItem = myInDesign.Menus.Item(&quot;$ID/RtMouseLayout&quot;).menuItems.add(myInDesign.scriptMenuActions.item(&quot;Label Graphic&quot;))</div>
<div class="line">    Else</div>
<div class="line">        MsgBox &quot;Could not locate event handler VBScript file. Please reinstall the InDesign example script.&quot;</div>
<div class="line">    End If  </div>
<div class="line">End Function</div>
</div><!-- fragment --><p> The LayoutContextMenuOnInvokeHandler.vbs referred to in the above example defines the script menu action that is activated when the menu item is selected (onInvoke event): </p>
<div class="fragment"><div class="line">myLabelGraphicEventHandler evt</div>
<div class="line">Function myLabelGraphicEventHandler(myEvent)</div>
<div class="line">    ReDim myObjectList(0)</div>
<div class="line">    Set myInDesign = CreateObject(&quot;InDesign.Application.2024&quot;)</div>
<div class="line">    If myInDesign.Selection.Count &gt; 0 Then</div>
<div class="line">        Rem Does the selection contain any graphics?</div>
<div class="line">        for myCounter = 1 To myInDesign.Selection.Count</div>
<div class="line">            Select Case TypeName(myInDesign.Selection.Item(myCounter))</div>
<div class="line">                Case &quot;PDF&quot;,&quot;EPS&quot;, &quot;Image&quot;:</div>
<div class="line">                    If Not (IsEmpty(myObjectList(0))) Then</div>
<div class="line">                        ReDim Preserve myObjectList(UBound(myObjectList) + 1)</div>
<div class="line">                    End If</div>
<div class="line">                    Set myObjectList(UBound(myObjectList)) = myInDesign.Selection.Item(myCounter)</div>
<div class="line">                Case &quot;Rectangle&quot;, &quot;Oval&quot;, &quot;Polygon&quot;:</div>
<div class="line">                    If myInDesign.selection.Item(myCounter).Graphics.Count &gt; 0 Then</div>
<div class="line">                        If Not (IsEmpty(myObjectList(0))) Then</div>
<div class="line">                            ReDim Preserve myObjectList(UBound(myObjectList) + 1)</div>
<div class="line">                        End If</div>
<div class="line">                        Set myObjectList(UBound(myObjectList)) = myInDesign.Selection.Item(myCounter).Graphics.Item(1)</div>
<div class="line">                    End If  </div>
<div class="line">            End Select</div>
<div class="line">        Next</div>
<div class="line">        If Not (IsEmpty(myObjectList(0))) Then</div>
<div class="line">            myDisplayDialog myInDesign, myObjectList</div>
<div class="line">        End If</div>
<div class="line">    End If</div>
<div class="line">End Function</div>
<div class="line">Rem Function that adds the label.</div>
<div class="line">Function myAddLabel(myInDesign, myGraphic, myLabelType, myLabelHeight, myLabelOffset, myLabelStyleName, myLayerName)</div>
<div class="line">    Set myDocument = myInDesign.documents.Item(1)</div>
<div class="line">    myLabelStyle = myDocument.paragraphStyles.item(myLabelStyleName)</div>
<div class="line">    Set myLink = myGraphic.ItemLink</div>
<div class="line">    Rem Create the label layer if it does not already exist.</div>
<div class="line">    On Error Resume Next</div>
<div class="line">    Set myLabelLayer = myDocument.layers.item(myLayerName)</div>
<div class="line">    If Err.Number &lt;&gt; 0 Then</div>
<div class="line">        Set myLabelLayer = myDocument.Layers.Add</div>
<div class="line">        myLabelLayer.Name = myLayerName</div>
<div class="line">        Err.Clear</div>
<div class="line">    End If</div>
<div class="line">    On Error Goto 0</div>
<div class="line">    Rem Label type defines the text that goes in the label.</div>
<div class="line">    Select Case myLabelType</div>
<div class="line">        Rem File name</div>
<div class="line">        case 0:</div>
<div class="line">            myLabel = myLink.Name</div>
<div class="line">        Rem File path</div>
<div class="line">        case 1:</div>
<div class="line">            myLabel = myLink.FilePath</div>
<div class="line">        Rem XMP description</div>
<div class="line">        case 2:</div>
<div class="line">            On Error Resume Next</div>
<div class="line">                myLabel = myLink.LinkXmp.Description</div>
<div class="line">            If Err.Number &lt;&gt; 0 Then</div>
<div class="line">                myLabel = &quot;No description available.&quot;</div>
<div class="line">                Err.Clear</div>
<div class="line">            End If</div>
<div class="line">            On Error Goto 0</div>
<div class="line">        Rem XMP author</div>
<div class="line">        case 3:</div>
<div class="line">            On Error Resume Next</div>
<div class="line">            myLabel = myLink.LinkXmp.Author</div>
<div class="line">            If Err.Number &lt;&gt; 0 Then</div>
<div class="line">                myLabel = &quot;No author available.&quot;</div>
<div class="line">                Err.Clear</div>
<div class="line">            End If</div>
<div class="line">            On Error Goto 0</div>
<div class="line">    End Select</div>
<div class="line">    Set myFrame = myGraphic.Parent</div>
<div class="line">    myBounds = myFrame.GeometricBounds</div>
<div class="line">    myX1 = myBounds(1) </div>
<div class="line">    myY1 = myBounds(2) + myLabelOffset </div>
<div class="line">    myX2 = myBounds(3) </div>
<div class="line">    myY2 = myY1 + myLabelHeight</div>
<div class="line">    Set myTextFrame = myFrame.Parent.TextFrames.Add(myLabelLayer)</div>
<div class="line">    myTextFrame.GeometricBounds = Array(myY1, myX1, myY2, myX2)</div>
<div class="line">    myTextFrame.Contents = myLabel</div>
<div class="line">    myTextFrame.TextFramePreferences.FirstBaselineOffset = idFirstBaseline.idLeadingOffset </div>
<div class="line">    myTextFrame.Paragraphs.Item(1).AppliedParagraphStyle = myInDesign.Documents.Item(1).ParagraphStyles.Item(myLabelStyle)</div>
<div class="line">End Function</div>
<div class="line">Function myDisplayDialog(myInDesign, myObjectList)</div>
<div class="line">    myLabelWidth = 100</div>
<div class="line">    myStyleNames = myGetParagraphStyleNames(myInDesign.Documents.Item(1))</div>
<div class="line">    myLayerNames = myGetLayerNames(myInDesign.Documents.Item(1))</div>
<div class="line">    Set myDialog = myInDesign.Dialogs.Add</div>
<div class="line">    myDialog.Name = &quot;LabelGraphics&quot;</div>
<div class="line">    With myDialog.DialogColumns.Add</div>
<div class="line">        Rem Label type</div>
<div class="line">        With .DialogRows.Add</div>
<div class="line">            With .DialogColumns.Add</div>
<div class="line">                With .StaticTexts.add</div>
<div class="line">                    .StaticLabel = &quot;Label Type&quot;</div>
<div class="line">                    .MinWidth = myLabelWidth</div>
<div class="line">                End With</div>
<div class="line">            End With</div>
<div class="line">            With .DialogColumns.Add</div>
<div class="line">                Set myLabelTypeDropdown = .Dropdowns.Add</div>
<div class="line">                myLabelTypeDropdown.StringList = Array(&quot;File name&quot;, &quot;File path&quot;, &quot;XMP description&quot;, &quot;XMP author&quot;)</div>
<div class="line">                myLabelTypeDropdown.SelectedIndex = 0</div>
<div class="line">            End With</div>
<div class="line">        End With</div>
<div class="line">        Rem Text frame height</div>
<div class="line">        With .DialogRows.Add</div>
<div class="line">            With .DialogColumns.Add</div>
<div class="line">                With .StaticTexts.add</div>
<div class="line">                    .StaticLabel=&quot;Label Height&quot;</div>
<div class="line">                    .MinWidth=myLabelWidth</div>
<div class="line">                End With</div>
<div class="line">            End With</div>
<div class="line">            With .DialogColumns.Add</div>
<div class="line">                Set myLabelHeightField = .MeasurementEditboxes.Add</div>
<div class="line">                myLabelHeightField.EditValue = 24</div>
<div class="line">                myLabelHeightField.EditUnits = idMeasurementUnits.idPoints</div>
<div class="line">            End With</div>
<div class="line">        End With</div>
<div class="line">        Rem Text frame offset</div>
<div class="line">        With .DialogRows.Add</div>
<div class="line">            With .DialogColumns.Add</div>
<div class="line">                With .staticTexts.add</div>
<div class="line">                    .staticLabel=&quot;Label Offset&quot;</div>
<div class="line">                    .minWidth=myLabelWidth</div>
<div class="line">                End With</div>
<div class="line">            End With</div>
<div class="line">            With .DialogColumns.Add</div>
<div class="line">                Set myLabelOffsetField = .MeasurementEditboxes.Add</div>
<div class="line">                myLabelOffsetField.editValue=0</div>
<div class="line">                myLabelOffsetField.editUnits=idMeasurementUnits.idPoints</div>
<div class="line">            End With</div>
<div class="line">        End With</div>
<div class="line">        Rem Style to apply</div>
<div class="line">        With .DialogRows.Add</div>
<div class="line">            With .DialogColumns.Add</div>
<div class="line">                With .StaticTexts.Add</div>
<div class="line">                    .StaticLabel=&quot;Label Style&quot;</div>
<div class="line">                    .MinWidth=myLabelWidth</div>
<div class="line">                End With</div>
<div class="line">            End With</div>
<div class="line">            With .DialogColumns.Add</div>
<div class="line">                Set myLabelStyleDropdown = .Dropdowns.Add</div>
<div class="line">                myLabelStyleDropdown.StringList=myStyleNames</div>
<div class="line">                myLabelStyleDropdown.SelectedIndex=0</div>
<div class="line">            End With</div>
<div class="line">        End With</div>
<div class="line">        Rem Layer</div>
<div class="line">        With .DialogRows.Add</div>
<div class="line">            With .DialogColumns.Add</div>
<div class="line">                With .StaticTexts.Add</div>
<div class="line">                    .StaticLabel=&quot;Layer&quot;</div>
<div class="line">                    .MinWidth=myLabelWidth</div>
<div class="line">                End With</div>
<div class="line">            End With</div>
<div class="line">            With .DialogColumns.Add</div>
<div class="line">                Set myLayerDropdown = .Dropdowns.Add</div>
<div class="line">                myLayerDropdown.StringList=myLayerNames</div>
<div class="line">                myLayerDropdown.SelectedIndex=0</div>
<div class="line">            End With</div>
<div class="line">        End With</div>
<div class="line">    End With</div>
<div class="line">    myResult = myDialog.show</div>
<div class="line">    If myResult = True Then</div>
<div class="line">        myLabelType = myLabelTypeDropdown.selectedIndex</div>
<div class="line">        myLabelHeight = myLabelHeightField.editValue</div>
<div class="line">        myLabelOffset = myLabelOffsetField.editValue</div>
<div class="line">        myLabelStyle = myStyleNames(myLabelStyleDropdown.selectedIndex)</div>
<div class="line">        myLayerName = myLayerNames(myLayerDropdown.selectedIndex)</div>
<div class="line">        myDialog.Destroy</div>
<div class="line">        myOldXUnits = myInDesign.documents.item(1).viewPreferences.horizontalMeasurementUnits</div>
<div class="line">        myOldYUnits = myInDesign.documents.item(1).viewPreferences.verticalMeasurementUnits</div>
<div class="line">        myInDesign.documents.item(1).viewPreferences.horizontalMeasurementUnits = idMeasurementUnits.idPoints</div>
<div class="line">        myInDesign.documents.item(1).viewPreferences.verticalMeasurementUnits = idMeasurementUnits.idPoints</div>
<div class="line">        for myCounter = 0 To UBound(myObjectList)</div>
<div class="line">            Set myGraphic = myObjectList(myCounter)</div>
<div class="line">            myAddLabel myInDesign, myGraphic, myLabelType, myLabelHeight, myLabelOffset, myLabelStyle, myLayerName</div>
<div class="line">        Next</div>
<div class="line">        myInDesign.documents.item(1).viewPreferences.horizontalMeasurementUnits = myOldXUnits</div>
<div class="line">        myInDesign.documents.item(1).viewPreferences.verticalMeasurementUnits = myOldYUnits</div>
<div class="line">    Else</div>
<div class="line">        myDialog.Destroy</div>
<div class="line">    End If</div>
<div class="line">End Function</div>
</div><!-- fragment --> <h1><a class="anchor" id="id_vb_working_with_preflight"></a>
Working with Preflight</h1>
<p>Preflight is a way to verify that you have all required files, fonts, assets (e.g., placed images and PDF files), printer settings, trapping styles, etc., before you send a publication to an output device. For example, if you placed an image as a low-resolution proxy but do not have the high-resolution original image accessible on your hard disk (or workgroup server), that may result in an error during the printing process. Preflight checks for this sort of problem. It can be run in the background as you work.</p>
<p>This section demonstrates how to interact with the preflight system using scripting. For illustration purposes, we show how to configure preflight to raise an error if the page size is something other than letter size (8.5" x 11"). We briefly highlight how it is done in the user interface, then show how to achieve the same results through scripting.</p>
<p>We assume that you have already read Adobe InDesign Scripting Tutorial and know how to create, install, and run a script.</p>
<h2><a class="anchor" id="id_vb_exploring_preflight_profiles"></a>
Exploring Preflight Profiles</h2>
<p>InDesign's preflight feature is profile based, rule driven, and parameterized. There might be one or more preflight profiles. Initially, there is one profile, [Basic], which is read-only; you cannot modify or delete it.</p>
<p>A preflight profile contains many preflight rules. Each rule has a name and multiple data objects. Each data object has a name, data type, and data value. The data value can be changed. Each rule can be configured as follows:</p>
<ul>
<li>Disabled - The preflight rule is disabled.</li>
<li>Return as error - The preflight rule returns error-level feedback.</li>
<li>Return as warning - The preflight rule returns warning-level feedback.</li>
<li>Return as informational - The preflight rule returns informational-level feedback.</li>
</ul>
<p>To check the profile in InDesign, choose Preflight Panel &gt; Define Profiles. You also can get profile information by scripting.</p>
<h3><a class="anchor" id="id_vb_listing_preflight_profiles"></a>
Listing preflight profiles</h3>
<p>This script fragment shows how to list all preflight profiles. For the complete script, see ListPreflightProfiles. </p>
<div class="fragment"><div class="line">    Set profiles = myInDesign.PreflightProfiles</div>
<div class="line">    profileCount = profiles.Count</div>
<div class="line">    str = <span class="stringliteral">&quot;Preflight profiles: &quot;</span></div>
<div class="line">    For i = 1 To profileCount</div>
<div class="line">        If i &gt; 1 Then</div>
<div class="line">            str = str &amp; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line">        End If</div>
<div class="line">        str = str &amp; profiles.Item(i).Name</div>
<div class="line">    Next</div>
<div class="line">    MsgBox(str)</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_listing_preflight_rules"></a>
Listing preflight rules</h3>
<p>This script fragment shows how to list all preflight rules in a profile. For the complete script, see ListPreflightRules. </p>
<div class="fragment"><div class="line">    Rem Assume the [Basic] profile exists</div>
<div class="line">    Set myProfile = myInDesign.PreflightProfiles.Item(1)</div>
<div class="line">    Set myRules = myProfile.PreflightProfileRules</div>
<div class="line">    ruleCount = myRules.Count</div>
<div class="line">    str = <span class="stringliteral">&quot;Preflight rules of &quot;</span> &amp; myProfile.Name + <span class="stringliteral">&quot;: &quot;</span></div>
<div class="line">    For i = 1 To ruleCount</div>
<div class="line">        If i &gt; 1 Then</div>
<div class="line">            str = str &amp; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line">        End If</div>
<div class="line">        str = str &amp; myRules.Item(i).Name</div>
<div class="line">    Next</div>
<div class="line">    MsgBox(str)</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_listing_preflight_data_objects"></a>
Listing preflight data objects</h3>
<p>This script fragment shows how to list all preflight data objects in a profile rule. For the complete script, see ListPreflightDataObjects. </p>
<div class="fragment"><div class="line">    Rem Assume the [Basic] profile exists</div>
<div class="line">    Set myProfile = myInDesign.PreflightProfiles.Item(1)</div>
<div class="line">    Rem rule ADBE_BlankPages</div>
<div class="line">    Set myRule = myProfile.PreflightProfileRules.Item(1)</div>
<div class="line">    Set dataObjects = myRule.ruleDataObjects</div>
<div class="line">    dataObjectCount = dataObjects.Count</div>
<div class="line">    str = <span class="stringliteral">&quot;Preflight rule data objects of &quot;</span> &amp; myProfile.Name + <span class="stringliteral">&quot;.&quot;</span> + myRule.Name + <span class="stringliteral">&quot;: &quot;</span></div>
<div class="line">    For i = 1 To dataObjectCount</div>
<div class="line">        If i &gt; 1 Then</div>
<div class="line">            str = str &amp; <span class="stringliteral">&quot;; &quot;</span></div>
<div class="line">        End If</div>
<div class="line">        Set dataObject = dataObjects.Item(i)</div>
<div class="line">        str = str &amp; dataObject.Name &amp; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line">        str = str &amp; getDataObjectDataType(dataObject.dataType) &amp; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line">        str = str &amp; dataObject.dataValue</div>
<div class="line">    Next</div>
<div class="line">    MsgBox(str)</div>
</div><!-- fragment --><div class="fragment"><div class="line">Function getDataObjectDataType(dataType)</div>
<div class="line">    If dataType = idRuleDataType.idBooleanDataType Then</div>
<div class="line">        getDataObjectDataType = &quot;Boolean&quot;</div>
<div class="line">    Elseif dataType = idRuleDataType.idIntegerDataType Then</div>
<div class="line">        getDataObjectDataType = &quot;Integer&quot;</div>
<div class="line">    Elseif dataType = idRuleDataType.idListDataType Then</div>
<div class="line">        getDataObjectDataType = &quot;List&quot;</div>
<div class="line">    Elseif dataType = idRuleDataType.idObjectDataType Then</div>
<div class="line">        getDataObjectDataType = &quot;Object&quot;</div>
<div class="line">    Elseif dataType = idRuleDataType.idRealDataType Then</div>
<div class="line">        getDataObjectDataType = &quot;Real&quot;</div>
<div class="line">    Elseif dataType = idRuleDataType.idShortIntegerDataType Then</div>
<div class="line">        getDataObjectDataType = &quot;Short Integer&quot;</div>
<div class="line">    Elseif dataType = idRuleDataType.idStringDataType Then</div>
<div class="line">        getDataObjectDataType = &quot;String&quot;</div>
<div class="line">    End If</div>
<div class="line">End Function</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_importing_a_preflight_profile"></a>
Importing a Preflight Profile</h2>
<p>To import a preflight profile from the Preflight panel, choose Preflight Panel &gt; Define Profiles, then choose Load Profile from the drop-down menu in the Preflight Profiles window.</p>
<div class="image">
<img src="InDesign_ScriptingGuide-8.gif" alt="InDesign_ScriptingGuide-8.gif"/>
</div>
<p>You also can load a profile with scripting. The following script fragment imports a profile called Test. For the complete script, see ImportPreflightProfile. </p>
<div class="fragment"><div class="line">    Set myProfile = myInDesign.LoadPreflightProfile(<span class="stringliteral">&quot;c:\Test.idpp&quot;</span>)</div>
<div class="line">    MsgBox(<span class="stringliteral">&quot;Preflight profile &quot;</span> &amp; myProfile.Name &amp; <span class="stringliteral">&quot; is loaded.&quot;</span>)</div>
</div><!-- fragment --><p> It is easier to create profiles using the Preflight panel than with scripting. One workflow would be to create all profiles in the user interface, export them to files, and import them using scripting. This approach avoids the challenges involved with manually adding rules via scripting.</p>
<h2><a class="anchor" id="id_vb_creating_a_preflight_profile"></a>
Creating a Preflight Profile</h2>
<p>To create a preflight profile from the Preflight panel, choose Preflight Panel &gt; Define Profiles, then choose the plus sign (+) to add a new preflight profile. Name the profile and fill in all data values for the available rules.</p>
<div class="image">
<img src="InDesign_ScriptingGuide-9.gif" alt="InDesign_ScriptingGuide-9.gif"/>
</div>
<p>You also can create a profile with scripting. The following script fragment adds a single profile called Test. For the complete script, see CreatePreflightProfile. </p>
<div class="fragment"><div class="line">    Set myProfile = myInDesign.PreflightProfiles.Add()</div>
<div class="line">    myProfile.Name = <span class="stringliteral">&quot;Test&quot;</span></div>
<div class="line">    myProfile.Description = <span class="stringliteral">&quot;Test description&quot;</span></div>
<div class="line">    MsgBox(<span class="stringliteral">&quot;Preflight profile &quot;</span> &amp; myProfile.Name &amp; <span class="stringliteral">&quot; is created.&quot;</span>)</div>
</div><!-- fragment --><p> Preflight-profile names must be unique. If the script above is executed more than once within the same InDesign instance, an error is raised, indicating that a profile with that name already exists. To avoid this, either access the existing profile using app.preflightProfiles.itemByName(), or check to see if a profile exists and remove it; see the following script fragment. For the complete script, see DeletePreflightProfile. </p>
<div class="fragment"><div class="line">Function removeProfile(myInDesign, profileName)</div>
<div class="line">    Set myProfiles= myInDesign.PreflightProfiles</div>
<div class="line">    profileCount = myProfiles.Count</div>
<div class="line">    For i = 1 To profileCount</div>
<div class="line">        If (myProfiles.Item(i).Name = profileName) Then</div>
<div class="line">            myProfiles.Item(i).Delete()</div>
<div class="line">        End If</div>
<div class="line">    Next</div>
<div class="line">End Function</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_adding_rules"></a>
Adding Rules</h2>
<p>A preflight profile contains a mutually exclusive set of rules. To add a rule to a profile, follow these steps:</p>
<ol type="1">
<li>Add a rule to a profile by name. Rules are added by name. For information on rule names, see <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_available_rules">Available Rules</a>. The following adds the ADBE_PageSizeOrientation rule to the profile. <div class="fragment"><div class="line">Rem Add a rule that requires a specific page size and orientation </div>
<div class="line">Rem (portrait or landscape).const RULE_NAME = <span class="stringliteral">&quot;ADBE_PageSizeOrientation&quot;</span></div>
<div class="line">Set myRule = myProfile.PreflightProfileRules.Add(RULE_NAME)</div>
</div><!-- fragment --></li>
<li>Set the rule's data values. Many, but not all, rules have data properties. For a complete specification of the rules available with InDesign, see <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_available_rules">Available Rules</a>. The ADBE_PageSizeOrientation rule contains particular data properties that allow you to specify a page size. The following sets the acceptable page height and width, a tolerance (fudge factor), and an option for handling page orientation. <div class="fragment"><div class="line">Rem Requires the page size to be 8.5in x 11in (Letter Size)</div>
<div class="line">Rem enters a value <span class="keywordflow">for</span> tolerance</div>
<div class="line">myRule.RuleDataObjects.Add <span class="stringliteral">&quot;tolerance&quot;</span>, idRuleDataType.idRealDataType, 0.01</div>
<div class="line">Rem Sets the width  to the point equivalent of 8.5 inches</div>
<div class="line">myRule.RuleDataObjects.Add <span class="stringliteral">&quot;width&quot;</span>, idRuleDataType.idRealDataType, 612</div>
<div class="line">Rem Sets the width  to the point equivalent of 11 inches</div>
<div class="line">myRule.RuleDataObjects.Add <span class="stringliteral">&quot;height&quot;</span>, idRuleDataType.idRealDataType, 792</div>
<div class="line">Rem <span class="keyword">true</span> = ignore orientation is checked</div>
<div class="line">myRule.RuleDataObjects.Add <span class="stringliteral">&quot;ignore_orientation&quot;</span>, idRuleDataType.idBooleanDataType, <span class="keyword">true</span></div>
</div><!-- fragment --></li>
<li>Set the rule's reporting state. This is done using the rule's flag property. There are several choices (disabled, information, warning, and error), controlled by the PreflightRuleFlag enumeration. <div class="fragment"><div class="line">Rem <span class="keyword">set</span> the rule to <span class="keywordflow">return</span> an error</div>
<div class="line">myRule.Flag = idPreflightRuleFlag.idReturnAsError</div>
</div><!-- fragment --></li>
</ol>
<h2><a class="anchor" id="id_vb_processing_a_profile"></a>
Processing a Profile</h2>
<p>In the desktop version of InDesign, preflight errors are reported in the user interface. In scripting (especially for InDesign Server), the errors are generated on demand. The following script processes an InDesign document. (For the complete script, see ProcessPreflightProfile.) If there are errors, it writes the results to a new PDF file. For an example of the output, see the figure below the script. </p>
<div class="fragment"><div class="line">    Rem Assume there is an document.</div>
<div class="line">    Set myDoc = myInDesign.Documents.Item(1)</div>
<div class="line">    Rem Use the second preflight profile</div>
<div class="line">    Set myProfile = myInDesign.PreflightProfiles.Item(2)</div>
<div class="line"></div>
<div class="line">    Rem Process the doc with the rule</div>
<div class="line">    Set myProcess = myInDesign.PreflightProcesses.Add(myDoc, myProfile)</div>
<div class="line">    myProcess.WaitForProcess()</div>
<div class="line">    results = myProcess.ProcessResults</div>
<div class="line"></div>
<div class="line">    Rem If Errors were found</div>
<div class="line">    If results &lt;&gt; <span class="stringliteral">&quot;None&quot;</span> Then</div>
<div class="line">        Rem Export the file to PDF. The <span class="stringliteral">&quot;true&quot;</span> value selects to open the file after export.</div>
<div class="line">        myProcess.SaveReport(<span class="stringliteral">&quot;c:\PreflightResults.pdf&quot;</span>)</div>
<div class="line">    End If</div>
<div class="line"></div>
<div class="line">    Rem Cleanup</div>
<div class="line">    myProcess.Delete()</div>
</div><!-- fragment --> <div class="image">
<img src="InDesign_ScriptingGuide-10.gif" alt="InDesign_ScriptingGuide-10.gif"/>
</div>
<p>If you would rather produce a text file, simply name your output file with a .txt extension.</p>
<p>Alternately, you may prefer to iterate the errors yourself. The following demonstrates how to access the errors array. For the complete script, see ProcessPreflightProfileShowErrors. </p>
<div class="fragment"><div class="line">    Rem If errors were found</div>
<div class="line">    If myResults &lt;&gt; <span class="stringliteral">&quot;None&quot;</span> Then</div>
<div class="line">        Rem array containing detailed results</div>
<div class="line">        errors = myProcess.AggregatedResults</div>
<div class="line">        Rem Show the errors in a message box.</div>
<div class="line">        str = <span class="stringliteral">&quot;Document Name: &quot;</span> &amp; errors(0) &amp; <span class="stringliteral">&quot;, Profile Name: &quot;</span> &amp; errors(1) &amp; <span class="stringliteral">&quot;, Results: [&quot;</span></div>
<div class="line">        errorResults = errors(2)</div>
<div class="line">        For i = 0 to UBound(errorResults)</div>
<div class="line">            If i &gt; 1 Then</div>
<div class="line">                str = str &amp; &quot;, &quot;</div>
<div class="line">            End If</div>
<div class="line">            str = str &amp; errorResults(i)(1)</div>
<div class="line">        Next</div>
<div class="line">        str = str &amp; &quot;]&quot;</div>
<div class="line">        MsgBox(str)</div>
<div class="line">    End If</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_custom_rules"></a>
Custom Rules</h2>
<p>It is not possible to create custom rules through the Preflight panel or scripting; however, this can be done through a C++ plug-in. The InDesign Products SDK contains a sample, PreflightRule, that demonstrates how to add custom rules with a plug-in.</p>
<h2><a class="anchor" id="id_vb_available_rules"></a>
Available Rules</h2>
<p>One of the hardest aspects of scripting rules is discovering rule names and properties. Due to the dynamic nature of rules (they really are just strings), specific rule names and properties do not appear in the Extend Script Tool Kit's Object Model Viewer. To discover this information, see <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_exploring_preflight_profiles">Exploring Preflight Profiles</a>. For your convenience, the DumpPreflightRules.jsx script is provided in the SDK to produce the following output as an HTML file (SDK\docs\references\PreflightRules.html). If you use a plug-in that adds custom rules, you can run the script to extract the new names and properties.</p>
<table class="doxtable">
<tr>
<th>Rule name </th><th>Rule properties </th></tr>
<tr>
<td>ADBE_BlankPages </td><td>"ADBE_BlankPages" </td></tr>
<tr>
<td>ADBE_BleedSlug </td><td>"ADBE_BleedSlug" </td></tr>
<tr>
<td>ADBE_BleedTrimHazard </td><td>"ADBE_BleedTrimHazard" </td></tr>
<tr>
<td>ADBE_CMYPlates </td><td>no </td></tr>
<tr>
<td>ADBE_Colorspace </td><td>"ADBE_Colorspace" </td></tr>
<tr>
<td>ADBE_ConditionIndicators </td><td>no </td></tr>
<tr>
<td>ADBE_CrossReferences </td><td>"ADBE_CrossReferences" </td></tr>
<tr>
<td>ADBE_FontUsage </td><td>"ADBE_FontUsage" </td></tr>
<tr>
<td>ADBE_ImageColorManagement </td><td>"ADBE_ImageColorManagement" </td></tr>
<tr>
<td>ADBE_ImageResolution </td><td>"ADBE_ImageResolution" </td></tr>
<tr>
<td>ADBE_InteractiveContent </td><td>no </td></tr>
<tr>
<td>ADBE_LayerVisibility </td><td>no </td></tr>
<tr>
<td>ADBE_MissingFonts </td><td>no </td></tr>
<tr>
<td>ADBE_MissingGlyph </td><td>no </td></tr>
<tr>
<td>ADBE_MissingModifiedGraphics </td><td>no </td></tr>
<tr>
<td>ADBE_OPI </td><td>no </td></tr>
<tr>
<td>ADBE_Overprint </td><td>no </td></tr>
<tr>
<td>ADBE_OversetText </td><td>no </td></tr>
<tr>
<td>ADBE_PageCount </td><td>"ADBE_PageCount" </td></tr>
<tr>
<td>ADBE_PageSizeOrientation </td><td>"ADBE_PageSizeOrientation" </td></tr>
<tr>
<td>ADBE_Registration </td><td>no </td></tr>
<tr>
<td>ADBE_ScaledGraphics </td><td>"ADBE_ScaledGraphics" </td></tr>
<tr>
<td>ADBE_ScaledType </td><td>"ADBE_ScaledType" </td></tr>
<tr>
<td>ADBE_SmallText </td><td>"ADBE_SmallText" </td></tr>
<tr>
<td>ADBE_SpellCheck </td><td>no </td></tr>
<tr>
<td>ADBE_SpotColorSetup </td><td>"ADBE_SpotColorSetup" </td></tr>
<tr>
<td>ADBE_StrokeRequirements </td><td>"ADBE_StrokeRequirements" </td></tr>
<tr>
<td>ADBE_TextOverrides </td><td>"ADBE_TextOverrides" </td></tr>
<tr>
<td>ADBE_TransparencyBlending </td><td>"ADBE_TransparencyBlending" </td></tr>
<tr>
<td>ADBE_TransparencyUsage </td><td>no </td></tr>
<tr>
<td>ADBE_WhiteOverprint </td><td>no </td></tr>
</table>
<h3><a class="anchor" id="id_vb_adbe_blankpages"></a>
ADBE_BlankPages</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value</th></tr>
<tr>
<td>Boolean </td><td>ignore_master </td><td>true </td></tr>
<tr>
<td>Boolean </td><td>ignore_nonprinting </td><td>true </td></tr>
</table>
<h3><a class="anchor" id="id_vb_adbe_bleedslug"></a>
ADBE_BleedSlug</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Real </td><td>bleed_b </td><td>9 </td></tr>
<tr>
<td>Real </td><td>bleed_b_aux </td><td>9 </td></tr>
<tr>
<td>Integer </td><td>bleed_comparison_type </td><td>3 </td></tr>
<tr>
<td>Boolean </td><td>bleed_enabled </td><td>true </td></tr>
<tr>
<td>Real </td><td>bleed_l </td><td>9 </td></tr>
<tr>
<td>Real </td><td>bleed_l_aux </td><td>9 </td></tr>
<tr>
<td>Real </td><td>bleed_r </td><td>9 </td></tr>
<tr>
<td>Real </td><td>bleed_r_aux </td><td>9 </td></tr>
<tr>
<td>Real </td><td>bleed_t </td><td>9 </td></tr>
<tr>
<td>Real </td><td>bleed_t_aux </td><td>9 </td></tr>
<tr>
<td>Real </td><td>slug_b </td><td>18 </td></tr>
<tr>
<td>Real </td><td>slug_b_aux </td><td>18 </td></tr>
<tr>
<td>Integer </td><td>slug_comparison_type </td><td>3 </td></tr>
<tr>
<td>Boolean </td><td>slug_enabled </td><td>false </td></tr>
<tr>
<td>Real </td><td>slug_l </td><td>18 </td></tr>
<tr>
<td>Real </td><td>slug_l_aux </td><td>18 </td></tr>
<tr>
<td>Real </td><td>slug_r </td><td>18 </td></tr>
<tr>
<td>Real </td><td>slug_r_aux </td><td>18 </td></tr>
<tr>
<td>Real </td><td>slug_t </td><td>18 </td></tr>
<tr>
<td>Real </td><td>slug_t_aux </td><td>18 </td></tr>
<tr>
<td>Real </td><td>tolerance </td><td>0.01 </td></tr>
</table>
<h3><a class="anchor" id="id_vb_adbe_bleedtrimhazard"></a>
ADBE_BleedTrimHazard</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Boolean </td><td>binding_enabled </td><td>false </td></tr>
<tr>
<td>Real </td><td>binding_width </td><td>1 </td></tr>
<tr>
<td>Real </td><td>live_b </td><td>18 </td></tr>
<tr>
<td>Real </td><td>live_l </td><td>18 </td></tr>
<tr>
<td>Real </td><td>live_r </td><td>18 </td></tr>
<tr>
<td>Real </td><td>live_t </td><td>18 </td></tr>
<tr>
<td>Real </td><td>tolerance </td><td>0.01 </td></tr>
</table>
<h3><a class="anchor" id="id_vb_adbe_colorspace"></a>
ADBE_Colorspace</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Boolean </td><td>no_cmyk </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_gray </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_lab </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_rgb </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_spot </td><td>false </td></tr>
</table>
<h3><a class="anchor" id="id_vb_adbe_crossreferences"></a>
ADBE_CrossReferences</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Boolean </td><td>xrefs_out_of_date </td><td>true </td></tr>
<tr>
<td>Boolean </td><td>xrefs_unresolved </td><td>true </td></tr>
</table>
<h3><a class="anchor" id="id_vb_adbe_fontusage"></a>
ADBE_FontUsage</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Boolean </td><td>no_ATC </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_Bitmap </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_CID </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_MultipleMaster </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_OpenTypeCFF </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_OpenTypeCID </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_OpenTypeTT </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_TrueType </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_Type1 </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>no_protected </td><td>true </td></tr>
</table>
<h3><a class="anchor" id="id_vb_adbe_imagecolormanagement"></a>
ADBE_ImageColorManagement</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Boolean </td><td>no_cmyk_profiles </td><td>true </td></tr>
<tr>
<td>Boolean </td><td>no_image_overrides </td><td>true </td></tr>
<tr>
<td>Boolean </td><td>overrides_exclude_uncal </td><td>true </td></tr>
</table>
<h3><a class="anchor" id="id_vb_adbe_imageresolution"></a>
ADBE_ImageResolution</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Boolean </td><td>bw_max_enabled </td><td>false </td></tr>
<tr>
<td>Real </td><td>bw_max_res </td><td>2400 </td></tr>
<tr>
<td>Boolean </td><td>bw_min_enabled </td><td>true </td></tr>
<tr>
<td>Real </td><td>bw_min_res </td><td>800 </td></tr>
<tr>
<td>Boolean </td><td>color_max_enabled </td><td>false </td></tr>
<tr>
<td>Real </td><td>color_max_res </td><td>1200 </td></tr>
<tr>
<td>Boolean </td><td>color_min_enabled </td><td>true </td></tr>
<tr>
<td>Real </td><td>color_min_res </td><td>250 </td></tr>
<tr>
<td>Boolean </td><td>gray_max_enabled </td><td>false </td></tr>
<tr>
<td>Real </td><td>gray_max_res </td><td>1200 </td></tr>
<tr>
<td>Boolean </td><td>gray_min_enabled </td><td>true </td></tr>
<tr>
<td>Real </td><td>gray_min_res </td><td>250 </td></tr>
<tr>
<td>Real </td><td>tolerance </td><td>0.5 </td></tr>
</table>
<h3><a class="anchor" id="id_vb_adbe_pagecount"></a>
ADBE_PageCount</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Integer </td><td>comparison_type </td><td>2 </td></tr>
<tr>
<td>Integer </td><td>comparison_value </td><td>1 </td></tr>
<tr>
<td>Integer </td><td>comparison_value_aux </td><td>1 </td></tr>
</table>
<h3><a class="anchor" id="id_vb_adbe_pagesizeorientation"></a>
ADBE_PageSizeOrientation</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Real </td><td>height </td><td>792 </td></tr>
<tr>
<td>Boolean </td><td>ignore_orientation </td><td>false </td></tr>
<tr>
<td>Real </td><td>tolerance </td><td>0.01 </td></tr>
<tr>
<td>Real </td><td>width </td><td>612 </td></tr>
</table>
<h3><a class="anchor" id="id_vb_adbe_scaledgraphics"></a>
ADBE_ScaledGraphics</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Real </td><td>max_scale </td><td>100.5 </td></tr>
</table>
<h3><a class="anchor" id="id_vb_adbe_scaledtype"></a>
ADBE_ScaledType</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Boolean </td><td>ignore_justification </td><td>true </td></tr>
<tr>
<td>Real </td><td>max_scale </td><td>100.5 </td></tr>
</table>
<h3><a class="anchor" id="id_vb_adbe_smalltext"></a>
ADBE_SmallText</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Real </td><td>minSize </td><td>4 </td></tr>
<tr>
<td>Boolean </td><td>minSize_trap_safe_only </td><td>false </td></tr>
</table>
<h3><a class="anchor" id="id_vb_adbe_spotcolorsetup"></a>
ADBE_SpotColorSetup</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Boolean </td><td>lab_spots </td><td>true </td></tr>
<tr>
<td>Boolean </td><td>lab_spots_enabled </td><td>false </td></tr>
<tr>
<td>Integer </td><td>max_spots </td><td>1 </td></tr>
<tr>
<td>Boolean </td><td>max_spots_enabled </td><td>true </td></tr>
</table>
<h3><a class="anchor" id="id_vb_adbe_strokerequirements"></a>
ADBE_StrokeRequirements</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Real </td><td>min_width </td><td>0.125 </td></tr>
</table>
<p>Boolean | min_width_trap_safe_only | false</p>
<h3><a class="anchor" id="id_vb_adbe_textoverrides"></a>
ADBE_TextOverrides</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Boolean </td><td>ignore_color_overrides </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>ignore_font_overrides </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>ignore_kerning_tracking_overrides </td><td>false </td></tr>
<tr>
<td>Boolean </td><td>ignore_language_overrides </td><td>false </td></tr>
</table>
<h3><a class="anchor" id="id_vb_adbe_transparencyblending"></a>
ADBE_TransparencyBlending</h3>
<table class="doxtable">
<tr>
<th>Data Type </th><th>Name </th><th>Default value </th></tr>
<tr>
<td>Integer </td><td>space </td><td>3 </td></tr>
</table>
<h1><a class="anchor" id="id_vb_creating_dynamic_documents"></a>
Creating Dynamic Documents</h1>
<p>InDesign can create documents for web and online use, also known as Rich Interactive Documents (RID). Dynamic documents contain sounds, animations, hyperlinks, and other interactive content. InDesign documents can be exported to SWF, XFL, or PDF. For SWF and XFL files, documents can include animations, buttons, multistate objects, movies, and sound clips. You can use the Preview panel in InDesign to test some types of dynamic content before exporting.</p>
<p>This section shows how to create dynamic documents using scripting. For more on exporting as PDF, SWF, and XFL, refer to <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_documents">Documents</a>.</p>
<h2><a class="anchor" id="id_vb_importing_movies_and_sounds"></a>
Importing Movies and Sounds</h2>
<p>InDesign can import movie and sound files that can then be viewed or listened to in exported PDF, SWF, or XFL documents. Movies and sounds in an InDesign document are very similar to graphics in that they exist inside container objects on an InDesign page. Unlike graphics, however, you cannot see (or hear) the content of the imported multimedia files on an InDesign page. For that, you'll need to either view the page in the Preview panel, or export the file, then open the file in a viewer capable of displaying the content (such as Acrobat Reader or a web browser).</p>
<p>Scripts can control the playback properties of a sound or movie in an exported dynamic document. You can also add a preview, or "poster," image to the page item containing the sound or movie.</p>
<p>The following script fragment shows how to import a movie and control the way that the movie is shown and played in an exported document (for the complete script, refer to PlaceMovie). </p>
<div class="fragment"><div class="line">    Rem Given a page <span class="stringliteral">&quot;myPage&quot;</span>...</div>
<div class="line">    Set myFrame = myPage.Rectangles.Add</div>
<div class="line">    myFrame.GeometricBounds = Array(72, 72, 288, 288)</div>
<div class="line">    Rem Import a movie file (you&#39;ll have to provide a valid file path on your system)</div>
<div class="line">    Set myMovie = myFrame.Place(&quot;c:\movie.avi&quot;).item(1)</div>
<div class="line">    Rem Set movie properties.</div>
<div class="line">    myMovie.EmbedInPDF = True</div>
<div class="line">    myMovie.ShowControls = True</div>
<div class="line">    Rem Add a preview image. You&#39;ll have to provide a valid path on your system.</div>
<div class="line">    myMovie.PosterFile = &quot;c:\movie poster.jpg&quot;</div>
</div><!-- fragment --><p> The following script fragment shows how to import a sound file and control the playback and display of the sound in an exported document (for the complete script, refer to PlaceSound). </p>
<div class="fragment"><div class="line">    Rem Given a page <span class="stringliteral">&quot;myPage&quot;</span>...</div>
<div class="line">    Rem Import a sound file (you<span class="stringliteral">&#39;ll have to provide a valid file path on your system)</span></div>
<div class="line"><span class="stringliteral">    Set mySound = myPage.Place(&quot;c:\sound.mp3&quot;, Array(72, 72)).Item(1)</span></div>
<div class="line"><span class="stringliteral">    Rem Set sound properties.</span></div>
<div class="line"><span class="stringliteral">    mySound.EmbedInPDF = True</span></div>
<div class="line"><span class="stringliteral">    mySound.DoNotPrintPoster = True</span></div>
<div class="line"><span class="stringliteral">    mySound.SoundLoop = True</span></div>
<div class="line"><span class="stringliteral">    mySound.StopOnPageTurn = True</span></div>
<div class="line"><span class="stringliteral">    Rem Add a preview image. You&#39;</span>ll have to provide a valid path on your system.</div>
<div class="line">    mySound.PosterFile = <span class="stringliteral">&quot;c:\sound poster.jpg&quot;</span></div>
</div><!-- fragment --><p> Buttons can be used to control the playback of sounds and movies. For information on how to script buttons, see the next section.</p>
<h2><a class="anchor" id="id_vb_creating_buttons"></a>
Creating Buttons</h2>
<p>Buttons are often used for navigation in dynamic documents. Buttons contain three states, known as "Normal," "Rollover," and "Click," which, in turn, can contain page items such as rectangles, ovals, text frames, or images. The button can display only one state at a time; the other states are displayed when triggered by mouse actions.</p>
<p>Behaviors control what the button does when you perform a specific mouse action. Behaviors correspond to the Actions shown in the Buttons panel in InDesign's user interface. Buttons can contain multiple behaviors.</p>
<p>The following script fragment shows how to create a simple button that displays the next page in an exported PDF or SWF (for the complete script, refer to SimpleButton). This button makes use of only the Normal state. </p>
<div class="fragment"><div class="line">    Rem Given a page <span class="stringliteral">&quot;myPage&quot;</span> and a document containing the color <span class="stringliteral">&quot;Red&quot;</span>...</div>
<div class="line">    Rem Make a button by converting a page item.</div>
<div class="line">    Set myRightArrow = myPage.Polygons.Add</div>
<div class="line">    myRightArrow.fillColor = myDocument.Colors.Item(<span class="stringliteral">&quot;Red&quot;</span>)</div>
<div class="line">    myRightArrow.name = <span class="stringliteral">&quot;GoToNextPageButton&quot;</span></div>
<div class="line">    myRightArrow.Paths.Item(1).EntirePath = Array(Array(72, 72), Array(144, 108), Array(72, 144))</div>
<div class="line">    Set myButton = myPage.Buttons.Add</div>
<div class="line">    myButton.geometricBounds = Array(72, 72, 144, 144)</div>
<div class="line">    myButton.States.Item(1).AddItemsToState myRightArrow</div>
<div class="line">    Set myGoToNextPageBehavior = myButton.GotoNextPageBehaviors.Add</div>
<div class="line">    myGoToNextPageBehavior.behaviorEvent = idBehaviorEvents.idMouseUp</div>
</div><!-- fragment --><p> The following script fragment shows how to create a somewhat more complicated button, containing page items that change the appearance of each of the three button states. For the complete script, refer to ButtonStates. </p>
<div class="fragment"><div class="line">    Rem Given a page <span class="stringliteral">&quot;myPage&quot;</span> in a document <span class="stringliteral">&quot;myDocument,&quot;</span> containing the colors</div>
<div class="line">    Rem <span class="stringliteral">&quot;Blue&quot;</span> and <span class="stringliteral">&quot;Red&quot;</span>...</div>
<div class="line">    Rem Make a button <span class="stringliteral">&quot;from scratch.&quot;</span></div>
<div class="line">    Set myButton = myPage.Buttons.Add</div>
<div class="line">    myButton.GeometricBounds = Array(72, 72, 144, 144)</div>
<div class="line">    myButton.Name = &quot;GoToNextPageButton&quot;</div>
<div class="line">    Set myRightArrow = myButton.States.Item(1).Polygons.Add</div>
<div class="line">    myRightArrow.fillColor = myDocument.Colors.Item(&quot;Red&quot;)</div>
<div class="line">    myRightArrow.Paths.Item(1).EntirePath = Array(Array(72, 72), Array(144, 108), Array(72, 144))</div>
<div class="line">    Rem Add the Rollover state.</div>
<div class="line">    Set myRolloverState = myButton.States.Add</div>
<div class="line">    Rem Add a shadow to the polygon in the Rollover state.</div>
<div class="line">    Set myRolloverArrow = myRolloverState.Polygons.Add</div>
<div class="line">    myRolloverArrow.FillColor = myDocument.Colors.Item(&quot;Red&quot;)</div>
<div class="line">    myRolloverArrow.Paths.Item(1).EntirePath = Array(Array(72, 72), Array(144, 108), Array(72, 144))</div>
<div class="line">    Set myFillTransparencySettings = myRolloverArrow.FillTransparencySettings</div>
<div class="line">    myFillTransparencySettings.DropShadowSettings.Mode = idShadowMode.idDrop</div>
<div class="line">    myFillTransparencySettings.DropShadowSettings.Angle = 90</div>
<div class="line">    myFillTransparencySettings.DropShadowSettings.XOffset = 0</div>
<div class="line">    myFillTransparencySettings.DropShadowSettings.YOffset = 0</div>
<div class="line">    myFillTransparencySettings.DropShadowSettings.Size = 6</div>
<div class="line">    Rem Add a shadow to the polygon in the Click state.</div>
<div class="line">    Set myClickState = myButton.States.Add</div>
<div class="line">    Set myClickArrow = myClickState.Polygons.Add</div>
<div class="line">    myClickArrow.FillColor = myDocument.Colors.Item(&quot;Blue&quot;)</div>
<div class="line">    myClickArrow.Paths.Item(1).EntirePath = Array(Array(72, 72), Array(144, 108), Array(72, 144))</div>
<div class="line">    Rem Set the behavior for the button.</div>
<div class="line">    Set myGoToNextPageBehavior = myButton.GotoNextPageBehaviors.Add</div>
<div class="line">    myGoToNextPageBehavior.BehaviorEvent = idBehaviorEvents.idMouseUp</div>
</div><!-- fragment --><p> Buttons can be used to control the playback of movie and sound files. The following script fragment shows an example of using a set of buttons to control the playback of a moving file (for the complete script, refer to MovieControl). </p>
<div class="fragment"><div class="line">    Rem Given a page <span class="stringliteral">&quot;myPage&quot;</span> in a document <span class="stringliteral">&quot;myDocument,&quot;</span></div>
<div class="line">    Rem containing the colors <span class="stringliteral">&quot;Gray&quot;</span> and <span class="stringliteral">&quot;Red&quot;</span>...</div>
<div class="line">    Set myFrame = myPage.Rectangles.Add</div>
<div class="line">    myFrame.geometricBounds = Array(72, 72, 288, 288)</div>
<div class="line">    Rem Import a movie file (you&#39;ll have to provide a valid file path on your system)</div>
<div class="line">    myFrame.Place &quot;c:\movie.avi&quot;</div>
<div class="line">    Rem Create the movie &quot;Start&quot; button.</div>
<div class="line">    Set myPlayButton = myPage.Buttons.Add</div>
<div class="line">    myPlayButton.geometricBounds = Array(294, 186, 354, 282)</div>
<div class="line">    myPlayButton.name = &quot;PlayMovieButton&quot;</div>
<div class="line">    Set myRightArrow = myPlayButton.States.Item(1).Polygons.Add</div>
<div class="line">    myRightArrow.fillColor = myDocument.Colors.Item(&quot;Gray&quot;)</div>
<div class="line">    myRightArrow.Paths.Item(1).EntirePath = Array(Array(186, 294), Array(186, 354), Array(282, 324))</div>
<div class="line">    Rem Add the Rollover state.</div>
<div class="line">    Set myRolloverState = myPlayButton.States.Add</div>
<div class="line">    Rem Add a shadow to the polygon in the Rollover state.</div>
<div class="line">    Set myRolloverArrow = myRolloverState.Polygons.Add</div>
<div class="line">    myRolloverArrow.fillColor = myDocument.Colors.Item(&quot;Gray&quot;)</div>
<div class="line">    myRolloverArrow.Paths.Item(1).EntirePath = Array(Array(186, 294), Array(186, 354), Array(282, 324))</div>
<div class="line">    Set myFillTransparencySettings = myRolloverArrow.FillTransparencySettings</div>
<div class="line">    myFillTransparencySettings.DropShadowSettings.Mode = idShadowMode.idDrop</div>
<div class="line">    myFillTransparencySettings.DropShadowSettings.Angle = 90</div>
<div class="line">    myFillTransparencySettings.DropShadowSettings.XOffset = 0</div>
<div class="line">    myFillTransparencySettings.DropShadowSettings.YOffset = 0</div>
<div class="line">    myFillTransparencySettings.DropShadowSettings.Size = 6</div>
<div class="line">    Rem Add a shadow to the polygon in the Click state.</div>
<div class="line">    set myClickState = myPlayButton.States.Add()</div>
<div class="line">    Set myClickArrow = myClickState.Polygons.Add</div>
<div class="line">    myClickArrow.fillColor = myDocument.Colors.Item(&quot;Red&quot;)</div>
<div class="line">    myClickArrow.Paths.Item(1).EntirePath = Array(Array(186, 294), Array(186, 354), Array(282, 324))</div>
<div class="line">    Rem Set the behavior for the button.</div>
<div class="line">    Set myMovieStartBehavior = myPlayButton.MovieBehaviors.Add</div>
<div class="line">    myMovieStartBehavior.MovieItem = myFrame.Movies.Item(1)</div>
<div class="line">    myMovieStartBehavior.behaviorEvent = idBehaviorEvents.idMouseUp</div>
<div class="line">    myMovieStartBehavior.operation = idMoviePlayOperations.idPlay</div>
<div class="line">    Rem Create the movie &quot;Stop&quot; button.</div>
<div class="line">    Set myStopButton = myPage.Buttons.Add</div>
<div class="line">    myStopButton.geometricBounds = Array(294, 78, 354, 174)</div>
<div class="line">    myStopButton.name = &quot;StopMovieButton&quot;</div>
<div class="line">    Set myNormalRectangle = myStopButton.States.Item(1).Rectangles.Add</div>
<div class="line">    myNormalRectangle.geometricBounds = Array(294, 78, 354, 174)</div>
<div class="line">    myNormalRectangle.fillColor = myDocument.Colors.Item(&quot;Gray&quot;)</div>
<div class="line">    Set myRolloverState = myStopButton.States.Add</div>
<div class="line">    Set myRolloverRectangle = myRolloverState.Rectangles.Add</div>
<div class="line">    myRolloverRectangle.geometricBounds = Array(294, 78, 354, 174)</div>
<div class="line">    myRolloverRectangle.fillColor = myDocument.Colors.Item(&quot;Gray&quot;)</div>
<div class="line">    Set myFillTransparencySettings = myRolloverRectangle.FillTransparencySettings</div>
<div class="line">    myFillTransparencySettings.DropShadowSettings.Mode = idShadowMode.idDrop</div>
<div class="line">    myFillTransparencySettings.DropShadowSettings.Angle = 90</div>
<div class="line">    myFillTransparencySettings.DropShadowSettings.XOffset = 0</div>
<div class="line">    myFillTransparencySettings.DropShadowSettings.YOffset = 0</div>
<div class="line">    myFillTransparencySettings.DropShadowSettings.Size = 6</div>
<div class="line">    Set myClickState = myStopButton.States.Add</div>
<div class="line">    Set myClickRectangle = myClickState.Rectangles.Add</div>
<div class="line">    myClickRectangle.geometricBounds = Array(294, 78, 354, 174)</div>
<div class="line">    myClickRectangle.fillColor = myDocument.Colors.Item(&quot;Red&quot;)</div>
<div class="line">    Set myMovieStopBehavior = myStopButton.MovieBehaviors.Add</div>
<div class="line">    myMovieStopBehavior.MovieItem = myFrame.Movies.Item(1)</div>
<div class="line">    myMovieStopBehavior.behaviorEvent = idBehaviorEvents.idMouseUp</div>
<div class="line">    myMovieStopBehavior.operation = idMoviePlayOperations.idStop</div>
</div><!-- fragment --><p> Buttons are also important in controlling the appearance of multistate objects, as we'll demonstrate in the next section.</p>
<h2><a class="anchor" id="id_vb_creating_multistate_objects"></a>
Creating Multistate Objects</h2>
<p>Multistate objects (or MSOs) are similar to buttons in that they contains states, and that only one state can be visible at a time. They are unlike buttons in that they can contain any number of states; buttons can contain three states, at most. Multistate objects rely on buttons to change the way they display their states.</p>
<p>The following script fragment shows how to create a simple multistate object and add a button to control the display of the states in the object (for the complete script, refer to MakeMultiStateObject). </p>
<div class="fragment"><div class="line">    Rem Given a document <span class="stringliteral">&quot;myDocument&quot;</span> and a page <span class="stringliteral">&quot;myPage&quot;</span> and</div>
<div class="line">    Rem four colors <span class="stringliteral">&quot;myColorA,&quot;</span> <span class="stringliteral">&quot;myColorB,&quot;</span> <span class="stringliteral">&quot;myColorC,&quot;</span> and <span class="stringliteral">&quot;myColorD&quot;</span>...</div>
<div class="line">    Set myMSO = myPage.MultiStateObjects.Add</div>
<div class="line">    myMSO.name = <span class="stringliteral">&quot;Spinner&quot;</span></div>
<div class="line">    myMSO.geometricBounds = Array(72, 72, 144, 144)</div>
<div class="line">    Rem New multi-state objects contain two states when they&#39;re created. Add two more.</div>
<div class="line">    myMSO.States.Item(1).name = &quot;Up&quot;</div>
<div class="line">    myMSO.States.Item(2).name = &quot;Right&quot;</div>
<div class="line">    Rem Add two more states.</div>
<div class="line">    Set myDownState = myMSO.States.Add</div>
<div class="line">    myDownState.name = &quot;Down&quot;</div>
<div class="line">    Set myLeftState = myMSO.States.Add</div>
<div class="line">    myLeftState.name = &quot;Left&quot;</div>
<div class="line">    Rem Add page items to the states.</div>
<div class="line">    Set myPolygon = myMSO.States.Item(1).Polygons.Add</div>
<div class="line">    myPolygon.fillColor = myColorA</div>
<div class="line">    myPolygon.strokeColor = myDocument.Swatches.Item(&quot;None&quot;)</div>
<div class="line">    myPolygon.Paths.Item(1).EntirePath = Array(Array(72, 144), Array(144, 144), Array(108, 72))</div>
<div class="line">    Set myPolygon = myMSO.States.Item(2).Polygons.Add</div>
<div class="line">    myPolygon.fillColor = myColorB</div>
<div class="line">    myPolygon.strokeColor = myDocument.Swatches.Item(&quot;None&quot;)</div>
<div class="line">    myPolygon.Paths.Item(1).EntirePath = Array(Array(72, 72), Array(72, 144), Array(144, 108))</div>
<div class="line">    Set myPolygon = myMSO.States.Item(3).Polygons.Add</div>
<div class="line">    myPolygon.fillColor = myColorC</div>
<div class="line">    myPolygon.strokeColor = myDocument.Swatches.Item(&quot;None&quot;)</div>
<div class="line">    myPolygon.Paths.Item(1).EntirePath = Array(Array(72, 72), Array(108, 144), Array(144, 72))</div>
<div class="line">    Set myPolygon = myMSO.States.Item(4).Polygons.Add</div>
<div class="line">    myPolygon.fillColor = myColorD</div>
<div class="line">    myPolygon.strokeColor = myDocument.Swatches.Item(&quot;None&quot;)</div>
</div><!-- fragment --><p> Typically, you'll control the display of the states in a multistate object using a button. The following script fragment shows how to do this (for the complete script, refer to MultiStateObjectControl). </p>
<div class="fragment"><div class="line">    Rem Given a document <span class="stringliteral">&quot;myDocument&quot;</span> and a page <span class="stringliteral">&quot;myPage&quot;</span> and</div>
<div class="line">    Rem four colors <span class="stringliteral">&quot;myColorA,&quot;</span> <span class="stringliteral">&quot;myColorB,&quot;</span> <span class="stringliteral">&quot;myColorC,&quot;</span> and <span class="stringliteral">&quot;myColorD&quot;</span>...</div>
<div class="line">    Set myMSO = myPage.MultiStateObjects.Add</div>
<div class="line">    myMSO.name = <span class="stringliteral">&quot;Spinner&quot;</span></div>
<div class="line">    myMSO.geometricBounds = Array(72, 72, 144, 144)</div>
<div class="line">    Rem New multi-state objects contain two states when they&#39;re created. Add two more.</div>
<div class="line">    myMSO.States.Item(1).name = &quot;Up&quot;</div>
<div class="line">    myMSO.States.Item(2).name = &quot;Right&quot;</div>
<div class="line">    Rem Add two more states.</div>
<div class="line">    Set myDownState = myMSO.States.Add</div>
<div class="line">    myDownState.name = &quot;Down&quot;</div>
<div class="line">    Set myLeftState = myMSO.States.Add</div>
<div class="line">    myLeftState.name = &quot;Left&quot;</div>
<div class="line">    Rem Add page items to the states.</div>
<div class="line">    Set myPolygon = myMSO.States.Item(1).Polygons.Add</div>
<div class="line">    myPolygon.fillColor = myColorA</div>
<div class="line">    myPolygon.strokeColor = myDocument.Swatches.Item(&quot;None&quot;)</div>
<div class="line">    myPolygon.Paths.Item(1).EntirePath = Array(Array(72, 144), Array(144, 144), Array(108, 72))</div>
<div class="line">    Set myPolygon = myMSO.States.Item(2).Polygons.Add</div>
<div class="line">    myPolygon.fillColor = myColorB</div>
<div class="line">    myPolygon.strokeColor = myDocument.Swatches.Item(&quot;None&quot;)</div>
<div class="line">    myPolygon.Paths.Item(1).EntirePath = Array(Array(72, 72), Array(72, 144), Array(144, 108))</div>
<div class="line">    Set myPolygon = myMSO.States.Item(3).Polygons.Add</div>
<div class="line">    myPolygon.fillColor = myColorC</div>
<div class="line">    myPolygon.strokeColor = myDocument.Swatches.Item(&quot;None&quot;)</div>
<div class="line">    myPolygon.Paths.Item(1).EntirePath = Array(Array(72, 72), Array(108, 144), Array(144, 72))</div>
<div class="line">    Set myPolygon = myMSO.States.Item(4).Polygons.Add</div>
<div class="line">    myPolygon.fillColor = myColorD</div>
<div class="line">    myPolygon.strokeColor = myDocument.Swatches.Item(&quot;None&quot;)</div>
<div class="line">    myPolygon.Paths.Item(1).EntirePath = Array(Array(144, 72), Array(72, 108), Array(144, 144))</div>
<div class="line">    Set myButton = myPage.Buttons.Add</div>
<div class="line">    myButton.geometricBounds = Array(72, 72, 144, 144)</div>
<div class="line">    Rem var myNormalState = myButton.states.item(0)</div>
<div class="line">    Rem myNormalState.rectangles.add({geometricBounds:Array(72, 72, 144, 144)})</div>
<div class="line">    Set myRolloverState = myButton.States.Add</div>
<div class="line">    Set myRolloverRectangle = myRolloverState.Rectangles.Add</div>
<div class="line">    myRolloverRectangle.geometricBounds = Array(72, 72, 144, 144)</div>
<div class="line">    Set myFillTransparencySettings = myRolloverRectangle.StrokeTransparencySettings</div>
<div class="line">    myFillTransparencySettings.DropShadowSettings.Mode = idShadowMode.idDrop</div>
<div class="line">    myFillTransparencySettings.DropShadowSettings.Angle = 90</div>
<div class="line">    myFillTransparencySettings.DropShadowSettings.XOffset = 0</div>
<div class="line">    myFillTransparencySettings.DropShadowSettings.YOffset = 0</div>
<div class="line">    myFillTransparencySettings.DropShadowSettings.Size = 6</div>
<div class="line">    Set myClickState = myButton.States.Add</div>
<div class="line">    Set myNextStateBehavior = myButton.GotoNextStateBehaviors.Add</div>
<div class="line">    myNextStateBehavior.associatedMultiStateObject = myMSO</div>
<div class="line">    myNextStateBehavior.behaviorEvent = idBehaviorEvents.idMouseDown</div>
<div class="line">    myNextStateBehavior.enableBehavior = True</div>
<div class="line">    myNextStateBehavior.loopsToNextOrPrevious = True</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_working_with_animation"></a>
Working with Animation</h2>
<p>Page items can be animated, adding motion to the dynamic documents you create using InDesign. You apply animation to objects using motion presets, define the movement of animated objects using motion paths, and control the duration of the animation using timing settings, timing lists, and timing groups.</p>
<p>The AnimationSettings of an object control the animation that will be applied to the object. When animation settings have been applied to an object, InDesign sets the HasCustomSettings property of the object to true; if the object is not to be animated, this property is false.</p>
<p>The point at which an animation begins to play, relative to the event that triggers the animation, is controlled by the objects and properties of the TimingSettings object attached to the page item or to one of its parent containers (usually the spread).</p>
<h3><a class="anchor" id="id_vb_basic_animation"></a>
Basic animation</h3>
<p>The following script fragment shows how to create a simple animation (for the complete script, refer to SimpleAnimation). The most basic forms of animation can be applied without using timing settings. </p>
<div class="fragment"><div class="line">    Rem Given a document <span class="stringliteral">&quot;myDocument&quot;</span> and a page <span class="stringliteral">&quot;myPage&quot;</span> and a color <span class="stringliteral">&quot;myColorA&quot;</span>...</div>
<div class="line">    Rem Add a page items to animate.</div>
<div class="line">    Set myPolygon = myPage.Polygons.Add</div>
<div class="line">    myPolygon.fillColor = myColorA</div>
<div class="line">    myPolygon.strokeColor = myDocument.Swatches.Item(<span class="stringliteral">&quot;None&quot;</span>)</div>
<div class="line">    myPolygon.Paths.Item(1).EntirePath = Array(Array(72, 72), Array(72, 144), Array(144, 108))</div>
<div class="line">    Rem Create a motion path.</div>
<div class="line">    myMotionPathPoints = Array(Array(Array(Array(108, 108), Array(108, 108), Array(108, 108)), Array(Array(516, 108), Array(516, 108), Array(516, 108))), True)</div>
<div class="line">    Rem Set animation preferences for the polygon. We havent&#39; set a dynamic trigger</div>
<div class="line">    Rem for the animation, so the polygon&#39;s animation will be triggered by</div>
<div class="line">    Rem DynamicTriggerEvents.onPageLoad (the default).</div>
<div class="line">    myPolygon.AnimationSettings.Duration = 2</div>
<div class="line">    myPolygon.AnimationSettings.MotionPathPoints = myMotionPathPoints</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_timingsettings"></a>
TimingSettings</h3>
<p>The TimingSettings objects of spreads, pages, and page items control the timing of the animation(s) applied to the object and to any objects contained by the object. TimingSettings contain:</p>
<ul>
<li>TimingLists, which define the trigger event (page load, page click, and so on) that start the animation. TimingGroups, which associate a page item or series of page items with a specific timing and define the sequence in which animations are shown.</li>
<li>TimingGroups contain TimingTargets, which define the objects associated with a given TimingGroup. TimingTargets also specify a delay value for the animation applied to the page item, relative to the start of the animation of the TimingGroup (for the first item in the TimingGroup), or from the start of the previous item in the TimingGroup (for other items in the TimingGroup).</li>
</ul>
<p>The following script fragment shows how to control the timing of the animation of an object using the various timing objects (for the complete script, refer to TimingSettings). Note that the parameters used to create a TimingGroup specify the properties of the first TimingTarget in the TimingGroup; subsequent TimingTargets, if any, can be added separately. </p>
<div class="fragment"><div class="line">    Rem Given a document <span class="stringliteral">&quot;myDocument&quot;</span> and a page <span class="stringliteral">&quot;myPage&quot;</span> and the color <span class="stringliteral">&quot;myColorA&quot;</span>,</div>
<div class="line">    Rem <span class="stringliteral">&quot;myColorB&quot;</span>, and <span class="stringliteral">&quot;myColorC&quot;</span>...</div>
<div class="line">    Rem Add a page items to animate.</div>
<div class="line">    Set myPolygonA = myPage.Polygons.Add</div>
<div class="line">    myPolygonA.fillColor = myColorA</div>
<div class="line">    myPolygonA.strokeColor = myDocument.Swatches.Item(<span class="stringliteral">&quot;None&quot;</span>)</div>
<div class="line">    myPolygonA.Paths.Item(1).EntirePath = Array(Array(72, 72), Array(72, 144), Array(144, 108))</div>
<div class="line">    Set myPolygonB = myPage.Polygons.Add</div>
<div class="line">    myPolygonB.fillColor = myColorB</div>
<div class="line">    myPolygonB.strokeColor = myDocument.Swatches.Item(&quot;None&quot;)</div>
<div class="line">    myPolygonB.Paths.Item(1).EntirePath = Array(Array(72, 72), Array(72, 144), Array(144, 108))</div>
<div class="line">    Set myPolygonC = myPage.Polygons.Add</div>
<div class="line">    myPolygonC.fillColor = myColorC</div>
<div class="line">    myPolygonC.strokeColor = myDocument.Swatches.Item(&quot;None&quot;)</div>
<div class="line">    myPolygonC.Paths.Item(1).EntirePath = Array(Array(72, 72), Array(72, 144), Array(144, 108))</div>
<div class="line">    Rem Create a motion path.</div>
<div class="line">    myMotionPathPoints = Array(Array(Array(Array(108, 108), Array(108, 108), Array(108, 108)), Array(Array(516, 108), Array(516, 108), Array(516, 108))), True)</div>
<div class="line">    Rem Set animation preferences for the polygons.</div>
<div class="line">    myPolygonA.AnimationSettings.Duration = 2</div>
<div class="line">    myPolygonA.AnimationSettings.MotionPathPoints = myMotionPathPoints</div>
<div class="line">    myPolygonB.AnimationSettings.Duration = 2</div>
<div class="line">    myPolygonB.AnimationSettings.MotionPathPoints = myMotionPathPoints</div>
<div class="line">    myPolygonC.AnimationSettings.Duration = 2</div>
<div class="line">    myPolygonC.AnimationSettings.MotionPathPoints = myMotionPathPoints</div>
<div class="line">    Set myTimingSettings = myPage.Parent.TimingSettings</div>
<div class="line">    Rem Remove the default timing list.</div>
<div class="line">    myTimingSettings.TimingLists.Item(1).Delete</div>
<div class="line">    Rem Add a new timing list that triggers when the page is clicked.</div>
<div class="line">    Set myTimingList = myTimingSettings.TimingLists.Add(idDynamicTriggerEvents.idOnPageClick)</div>
<div class="line">    Rem Add the polygons to a single timing group.</div>
<div class="line">    Set myTimingGroup = myTimingList.TimingGroups.Add(myPolygonA, 0)</div>
<div class="line">    myTimingGroup.TimingTargets.Add myPolygonB, 2</div>
<div class="line">    myTimingGroup.TimingTargets.Add myPolygonC, 2</div>
</div><!-- fragment --><p> Note that attempting to add a page item whose HasCustomSettings property (in the AnimationSettings object of the page item) is false to a TimingTarget generates an error.</p>
<p>The following script fragment shows how to control the sequence of animations applied to objects on a page (for the complete script, refer to MultipleTimingGroups). Note that the order in which TimingGroups are added to a TimingList determines the order in which the animations play when the trigger event specified in the TimingList occurs. Some trigger events, such as idDynamicTriggerEvents.idOnPageLoad, trigger the animations in the TimingList (in sequence); others, such as idDynamicTriggerEvents.idOnPageClick, trigger the animations one by one, in sequence, with each instance of the event. For example, a TimingList containing five TimingGroups, each containing a single TimingTarget, and having the trigger event idDynamicTriggerEvents.idOnPageClick requires five mouse clicks to process all the animations. </p>
<div class="fragment"><div class="line">    Rem Given a document <span class="stringliteral">&quot;myDocument&quot;</span> and a page <span class="stringliteral">&quot;myPage&quot;</span> and the color <span class="stringliteral">&quot;myColorA&quot;</span>,</div>
<div class="line">    Rem <span class="stringliteral">&quot;myColorB&quot;</span>, and <span class="stringliteral">&quot;myColorC&quot;</span>...</div>
<div class="line">    Rem Add a page items to animate.</div>
<div class="line">    Set myPolygonA = myPage.Polygons.Add</div>
<div class="line">    myPolygonA.fillColor = myColorA</div>
<div class="line">    myPolygonA.strokeColor = myDocument.Swatches.Item(<span class="stringliteral">&quot;None&quot;</span>)</div>
<div class="line">    myPolygonA.Paths.Item(1).EntirePath = Array(Array(72, 72), Array(72, 144), Array(144, 108))</div>
<div class="line">    Set myPolygonB = myPage.Polygons.Add</div>
<div class="line">    myPolygonB.fillColor = myColorB</div>
<div class="line">    myPolygonB.strokeColor = myDocument.Swatches.Item(&quot;None&quot;)</div>
<div class="line">    myPolygonB.Paths.Item(1).EntirePath = Array(Array(72, 72), Array(72, 144), Array(144, 108))</div>
<div class="line">    Set myPolygonC = myPage.Polygons.Add</div>
<div class="line">    myPolygonC.fillColor = myColorC</div>
<div class="line">    myPolygonC.strokeColor = myDocument.Swatches.Item(&quot;None&quot;)</div>
<div class="line">    myPolygonC.Paths.Item(1).EntirePath = Array(Array(72, 72), Array(72, 144), Array(144, 108))</div>
<div class="line">    Set myPolygonD = myPage.Polygons.Add</div>
<div class="line">    myPolygonD.fillColor = myColorA</div>
<div class="line">    myPolygonD.strokeColor = myDocument.Swatches.Item(&quot;None&quot;)</div>
<div class="line">    myPolygonD.Paths.Item(1).EntirePath = Array(Array(72, 144), Array(72, 216), Array(144, 180))</div>
<div class="line">    Set myPolygonE = myPage.Polygons.Add</div>
<div class="line">    myPolygonE.fillColor = myColorB</div>
<div class="line">    myPolygonE.strokeColor = myDocument.Swatches.Item(&quot;None&quot;)</div>
<div class="line">    myPolygonE.Paths.Item(1).EntirePath = Array(Array(72, 144), Array(72, 216), Array(144, 180))</div>
<div class="line">    Set myPolygonF = myPage.Polygons.Add</div>
<div class="line">    myPolygonF.fillColor = myColorC</div>
<div class="line">    myPolygonF.strokeColor = myDocument.Swatches.Item(&quot;None&quot;)</div>
<div class="line">    myPolygonF.Paths.Item(1).EntirePath = Array(Array(72, 144), Array(72, 216), Array(144, 180))</div>
<div class="line">    Rem Create a motion path.</div>
<div class="line">    myMotionPathPointsA = Array(Array(Array(Array(108, 108), Array(108, 108), Array(108, 108)), Array(Array(516, 108), Array(516, 108), Array(516, 108))), True)</div>
<div class="line">    myMotionPathPointsB = Array(Array(Array(Array(108, 180), Array(108, 180), Array(108, 180)), Array(Array(516, 180), Array(516, 180), Array(516, 180))), True)</div>
<div class="line">    Rem Set animation preferences for the polygons.</div>
<div class="line">    Rem DynamicTriggerEvents.onPageLoad (the default).</div>
<div class="line">    myPolygonA.AnimationSettings.Duration = 2</div>
<div class="line">    myPolygonA.AnimationSettings.MotionPathPoints = myMotionPathPointsA</div>
<div class="line">    myPolygonB.AnimationSettings.Duration = 2</div>
<div class="line">    myPolygonB.AnimationSettings.MotionPathPoints = myMotionPathPointsA</div>
<div class="line">    myPolygonC.AnimationSettings.Duration = 2</div>
<div class="line">    myPolygonC.AnimationSettings.MotionPathPoints = myMotionPathPointsA</div>
<div class="line">    myPolygonD.AnimationSettings.Duration = 2</div>
<div class="line">    myPolygonD.AnimationSettings.MotionPathPoints = myMotionPathPointsB</div>
<div class="line">    myPolygonE.AnimationSettings.Duration = 2</div>
<div class="line">    myPolygonE.AnimationSettings.MotionPathPoints = myMotionPathPointsB</div>
<div class="line">    myPolygonF.AnimationSettings.Duration = 2</div>
<div class="line">    myPolygonF.AnimationSettings.MotionPathPoints = myMotionPathPointsB</div>
<div class="line">    Set myTimingSettings = myPage.Parent.TimingSettings</div>
<div class="line">    Rem Remove the default timing list.</div>
<div class="line">    myTimingSettings.TimingLists.Item(1).Delete</div>
<div class="line">    Rem Add a new timing list that triggers when the page is clicked.</div>
<div class="line">    Set myTimingList = myTimingSettings.TimingLists.Add(idDynamicTriggerEvents.idOnPageClick)</div>
<div class="line">    Rem Add the polygons to a single timing group.</div>
<div class="line">    Set myTimingGroupA = myTimingList.TimingGroups.Add(myPolygonA, 0)</div>
<div class="line">    myTimingGroupA.TimingTargets.Add myPolygonB, 2</div>
<div class="line">    myTimingGroupA.TimingTargets.Add myPolygonC, 2</div>
<div class="line">    Rem myTimingGroupB will play on the second page click.</div>
<div class="line">    Set myTimingGroupB = myTimingList.TimingGroups.Add(myPolygonD, 0)</div>
<div class="line">    myTimingGroupB.TimingTargets.Add myPolygonE, 2</div>
<div class="line">    myTimingGroupB.TimingTargets.Add myPolygonF, 2</div>
</div><!-- fragment --><p> A given TimingSettings object can contain multiple TimingList objects, each of which responds to a different trigger event. The following script fragment shows a series of animations triggered by idDynamicTriggerEvents.idOnPageLoad, by idDynamicTriggerEvents.idOnPageClick (for the complete script, refer to MultipleTimingLists). </p>
<div class="fragment"><div class="line">    Rem Given a document <span class="stringliteral">&quot;myDocument&quot;</span> and a page <span class="stringliteral">&quot;myPage&quot;</span> containg 6 polygons:</div>
<div class="line">    Rem <span class="stringliteral">&quot;myPolygonA&quot;</span>, <span class="stringliteral">&quot;myPolygonB&quot;</span>, <span class="stringliteral">&quot;myPolygonC&quot;</span>, <span class="stringliteral">&quot;myPolygonD&quot;</span>, <span class="stringliteral">&quot;myPolygonE&quot;</span>, <span class="stringliteral">&quot;myPolygonF&quot;</span>.</div>
<div class="line">    Rem Add a page items to animate.</div>
<div class="line">    Set myTimingSettings = myPage.Parent.TimingSettings</div>
<div class="line">    Rem At <span class="keyword">this</span> point, all of the polygons have already been added as timing targets</div>
<div class="line">    Rem of the <span class="keywordflow">default</span> timing list. Change the delay of myPolygonB and myPolygonC,</div>
<div class="line">    Rem which are the targets of the second and third timing groups (item(1) and item(2)).</div>
<div class="line">    Set myTimingListA = myTimingSettings.TimingLists.Item(1)</div>
<div class="line">    Set myTimingGroup = myTimingListA.TimingGroups.Item(1)</div>
<div class="line">    myTimingGroup.TimingTargets.Item(1).DelaySeconds = 2</div>
<div class="line">    Set myTimingGroup = myTimingListA.TimingGroups.Item(2)</div>
<div class="line">    myTimingGroup.TimingTargets.Item(1).DelaySeconds = 2</div>
<div class="line">    Rem Remove the last three timing groups in the timing list.</div>
<div class="line">    Rem We have to <span class="keywordflow">do</span> <span class="keyword">this</span>, because we don<span class="stringliteral">&#39;t want these polygons to be</span></div>
<div class="line"><span class="stringliteral">    Rem animated when the page loads.</span></div>
<div class="line"><span class="stringliteral">    myTimingListA.TimingGroups.Item(-1).Delete</span></div>
<div class="line"><span class="stringliteral">    myTimingListA.TimingGroups.Item(-1).Delete</span></div>
<div class="line"><span class="stringliteral">    myTimingListA.TimingGroups.Item(-1).Delete</span></div>
<div class="line"><span class="stringliteral">    Rem Add a new timing list that triggers when the page is clicked.</span></div>
<div class="line"><span class="stringliteral">    Set myTimingListB = myTimingSettings.TimingLists.Add(idDynamicTriggerEvents.idonPageClick)</span></div>
<div class="line"><span class="stringliteral">    Set myTimingGroupB = myTimingListB.TimingGroups.Add(myPolygonD, 0)</span></div>
<div class="line"><span class="stringliteral">    myTimingGroupB.TimingTargets.Add myPolygonE, 2</span></div>
<div class="line"><span class="stringliteral">    myTimingGroupB.TimingTargets.Add myPolygonF, 2</span></div>
</div><!-- fragment --><p> In the previous examples, we've worked with the TimingSettings of the spread containing the page items we want to animate. When you want to animate a page item when a user clicks the item, you'll need to use the TimingSettings of the page item itself, as shown in the following script fragment (for the complete script, refer to PageItemTimingSettings). </p>
<div class="fragment"><div class="line">    Rem Given a document <span class="stringliteral">&quot;myDocument&quot;</span> and a page <span class="stringliteral">&quot;myPage&quot;</span> containg a polygon <span class="stringliteral">&quot;myPolygonA&quot;</span>...</div>
<div class="line">    Rem Remove the <span class="keywordflow">default</span> timing list in the timing settings <span class="keywordflow">for</span> the spread.</div>
<div class="line">    Rem Set animation preferences <span class="keywordflow">for</span> the polygon.</div>
<div class="line">    myPolygonA.AnimationSettings.Duration = 2</div>
<div class="line">    myPolygonA.AnimationSettings.MotionPathPoints = myMotionPathPointsA</div>
<div class="line">    myPage.Parent.TimingSettings.TimingLists.Item(1).Delete</div>
<div class="line">    Set myTimingSettings = myPolygonA.TimingSettings</div>
<div class="line">    Set myTimingList = myTimingSettings.TimingLists.Add(idDynamicTriggerEvents.idOnClick)</div>
<div class="line">    Set myTimingGroup = myTimingList.TimingGroups.Add(myPolygonA, 0)</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_animating_transformations"></a>
Animating transformations</h3>
<p>Page items can change size, rotation or skewing angles, opacity, and visibility as their animation plays. The AnimationSettings of the page item contain properties (such as RotationArray or HiddenAfter) that define the transformations that are applied during animation. The following script fragment shows how to make a page item rotate as it follows a motion path (for the complete script, refer to AnimateRotation). </p>
<div class="fragment"><div class="line">    Rem Given a document <span class="stringliteral">&quot;myDocument&quot;</span> and a page <span class="stringliteral">&quot;myPage&quot;</span> and the color <span class="stringliteral">&quot;myColorA&quot;</span>...</div>
<div class="line">    Rem Add a page items to animate.</div>
<div class="line">    Set myPolygonA = myPage.Polygons.Add</div>
<div class="line">    myPolygonA.FillColor = myColorA</div>
<div class="line">    myPolygonA.StrokeColor = myDocument.Swatches.Item(<span class="stringliteral">&quot;None&quot;</span>)</div>
<div class="line">    myPolygonA.Paths.Item(1).EntirePath = Array(Array(72, 72), Array(72, 144), Array(144, 108))</div>
<div class="line">    Rem Create a motion path.</div>
<div class="line">    myMotionPathPoints = Array(Array(Array(Array(108, 108), Array(108, 108), Array(108, 108)), Array(Array(516, 108), Array(516, 108), Array(516, 108))), True)</div>
<div class="line">    Rem Set animation preferences for the polygon.</div>
<div class="line">    myPolygonA.AnimationSettings.Duration = 2</div>
<div class="line">    myPolygonA.AnimationSettings.MotionPathPoints = myMotionPathPoints</div>
<div class="line">    Rem Assuming 24 Frames Per Second (FPS)</div>
<div class="line">    Rem 23 = 1 second, 47 = 2 seconds, 71 = 3 seconds, 95 = 4 seconds, 119 = 5 seconds, 143 = 6 seconds</div>
<div class="line">    Rem Since the duration of our animation is 2 seconds, the following line will</div>
<div class="line">    Rem make the polygon rotate 360 degrees from the start to the end</div>
<div class="line">    Rem of the animation.</div>
<div class="line">    myPolygonA.AnimationSettings.RotationArray = Array(Array(0, 0), Array(47, 360))</div>
<div class="line">    Set myTimingSettings = myPage.Parent.TimingSettings</div>
<div class="line">    Rem Remove the default timing list.</div>
<div class="line">    myTimingSettings.TimingLists.Item(1).Delete</div>
<div class="line">    Rem Add a new timing list that triggers when the page is clicked.</div>
<div class="line">    Set myTimingList = myTimingSettings.TimingLists.Add(idDynamicTriggerEvents.idOnPageClick)</div>
<div class="line">    Rem Add the polygons to a single timing group.</div>
<div class="line">    Set myTimingGroup = myTimingList.TimingGroups.Add(myPolygonA, 0)</div>
</div><!-- fragment --><p> Scripting offers more control over animation than can be achieved with InDesign's user interface. A scripted animation can, for example, apply transformations at each key frame of a given motion path. For more on this topic, see <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_key_frames">Key frames</a> later in this section.</p>
<h3><a class="anchor" id="id_vb_motion_presets"></a>
Motion presets</h3>
<p>In the preceding examples, we've constructed motion paths and specified animation settings as if we were creating animations from the basic level in InDesign's user interface. But InDesign can also use motion presets to define the animation of page items in a layout. A motion preset can apply a number of animation properties at once, as seen in the following script fragment (for the complete script, refer to MotionPreset). InDesign comes with a large number of motion presets, and you can add new presets using either the user interface or scripting. </p>
<div class="fragment"><div class="line">    Rem Given a page containing the ovals <span class="stringliteral">&quot;myOvalA&quot;</span>...</div>
<div class="line">    Set myMotionPreset = app.MotionPresets.Item(<span class="stringliteral">&quot;move-right-grow&quot;</span>)</div>
<div class="line">    myOvalA.AnimationSettings.Duration = 2</div>
<div class="line">    myOvalA.AnimationSettings.PlaysLoop = True</div>
<div class="line">    myOvalA.AnimationSettings.Preset = myMotionPreset</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_design_options"></a>
Design options</h3>
<p>Design options affect the way that an animated object appears, relative to the motion specified in the object's animation settings. The following script fragment shows how the design options for an animated shape can affect the playback of the animation (for the complete script, refer to DesignOptions). </p>
<div class="fragment"><div class="line">    Rem Given a page containing the ovals <span class="stringliteral">&quot;myOvalA&quot;</span> and <span class="stringliteral">&quot;myOvalB&quot;</span>...</div>
<div class="line">    Set myMotionPreset = myInDesign.MotionPresets.Item(<span class="stringliteral">&quot;move-right-grow&quot;</span>)</div>
<div class="line">    myOvalA.AnimationSettings.Duration = 2</div>
<div class="line">    myOvalA.AnimationSettings.PlaysLoop = True</div>
<div class="line">    myOvalA.AnimationSettings.Preset = myMotionPreset</div>
<div class="line">    myOvalA.AnimationSettings.DesignOption = idDesignOptions.idFromCurrentAppearance</div>
<div class="line">    myOvalB.AnimationSettings.Duration = 2</div>
<div class="line">    myOvalB.AnimationSettings.PlaysLoop = True</div>
<div class="line">    myOvalB.AnimationSettings.Preset = myMotionPreset</div>
<div class="line">    myOvalB.AnimationSettings.DesignOption = idDesignOptions.idToCurrentAppearance</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_key_frames"></a>
Key frames</h3>
<p>Key frames are points in the timeline of an animation. With InDesign scripting, you can add key frames at any time in the animation, which gives you the ability to apply changes to objects as they are animated. Key frames are part of the motion path applied to an animated page item, and are specified relative to the duration and speed of the animation. For example, for an animation with a duration of two seconds, playing at 24 frames per second, the last frame in the animation is frame 48.</p>
<p>The following script fragment shows how to add key frames to a motion path, and how to change the transformations applied to an animated page item at each key frame. For the complete script, refer to TransformAnimation. </p>
<div class="fragment"><div class="line">    Rem Given a page containing ovals <span class="stringliteral">&quot;myOvalA,&quot;</span> <span class="stringliteral">&quot;myOvalB,&quot;</span> and <span class="stringliteral">&quot;myOvalC&quot;</span>...</div>
<div class="line">    Rem The motion path is constructed relative to the center of the object, and key frames</div>
<div class="line">    Rem are based on the duration of the animation divided by the number of frames per second</div>
<div class="line">    Rem (usually 24). The following array sets key frames at the start, midpoint, and end</div>
<div class="line">    Rem of a path.</div>
<div class="line">    myMotionPath = Array(Array(0, Array(Array(0, 0), Array(0, 0), Array(0, 0))), Array(23, Array(Array(234, 0), Array(234, 0), Array(234, 0))), Array(47, Array(Array(468, 0), Array(468, 0), Array(468, 0))))</div>
<div class="line">    myOvalA.AnimationSettings.Duration = 2</div>
<div class="line">    myOvalA.AnimationSettings.MotionPath = myMotionPath</div>
<div class="line">    Rem The transformation changes at each key frame.</div>
<div class="line">    Rem scaleXArray in the form Array(Array(keyframe, scale_percentage), Array(keyframe, scalePercentage), ...)</div>
<div class="line">    myOvalA.AnimationSettings.ScaleXArray = Array(Array(0, 100), Array(23, 200), Array(47, 100))</div>
<div class="line">    Rem scaleYArray in the form Array(Array(keyframe, scale_percentage), Array(keyframe, scalePercentage), ...)</div>
<div class="line">    myOvalA.AnimationSettings.ScaleYArray = Array(Array(0, 100), Array(23, 200), Array(47, 100))</div>
<div class="line">    Rem opacityArray in the form Array(Array(keyframe, opacity), Array(keyframe, opacity),...)</div>
<div class="line">    myOvalA.AnimationSettings.OpacityArray = Array(Array(0, 100), Array(23, 20), Array(47, 100))</div>
<div class="line">    myOvalA.AnimationSettings.PlaysLoop = True</div>
<div class="line">    myOvalB.AnimationSettings.Duration = 2</div>
<div class="line">    myOvalB.AnimationSettings.MotionPath = myMotionPath</div>
<div class="line">    myOvalB.AnimationSettings.ScaleXArray = Array(Array(0, 200), Array(23, 300), Array(47, 50))</div>
<div class="line">    myOvalB.AnimationSettings.ScaleYArray = Array(Array(0, 200), Array(23, 300), Array(47, 50))</div>
<div class="line">    myOvalB.AnimationSettings.OpacityArray = Array(Array(0, 10), Array(23, 80), Array(47, 60))</div>
<div class="line">    myOvalB.AnimationSettings.PlaysLoop = True</div>
<div class="line">    myOvalC.AnimationSettings.Duration = 2</div>
<div class="line">    myOvalC.AnimationSettings.MotionPath = myMotionPath</div>
<div class="line">    myOvalC.AnimationSettings.ScaleXArray = Array(Array(0, 50), Array(23, 200), Array(47, 400))</div>
<div class="line">    myOvalC.AnimationSettings.ScaleYArray = Array(Array(0, 50), Array(23, 200), Array(47, 400))</div>
<div class="line">    myOvalC.AnimationSettings.OpacityArray = Array(Array(0, 100), Array(23, 40), Array(47, 80))</div>
<div class="line">    myOvalC.AnimationSettings.PlaysLoop = True</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_adding_page_transitions"></a>
Adding Page Transitions</h2>
<p>Page transitions are special effects that appear when you change pages in an exported dynamic document. Adding page transitions using scripting is easy, as shown in the following script fragment (for the complete script, refer to PageTransitions). </p>
<div class="fragment"><div class="line">    Rem Given a document <span class="stringliteral">&quot;myDocument&quot;</span> containing at least two spreads...</div>
<div class="line">    For myCounter = 1 To myDocument.Spreads.Count</div>
<div class="line">        myDocument.Spreads.Item(myCounter).PageTransitionType = idPageTransitionTypeOptions.idPageTurnTransition</div>
<div class="line">        Rem This page transition option does not support the pageTransitionDirection or pageTransitionDuration</div>
<div class="line">        Rem properties. If you chose idPageTransitionTypeOptions.idWipeTransition (<span class="keywordflow">for</span> example), you would be</div>
<div class="line">        Rem able to <span class="keyword">set</span> those options, as shown in the next two lines:</div>
<div class="line">        Rem myDocument.spreads.item(myCounter).pageTransitionDirection = idPageTransitionDirectionOptions.idLeftToRight</div>
<div class="line">        Rem myDocument.spreads.item(myCounter).pageTransitionDuration = idPageTransitionDurationOptions.idMedium</div>
<div class="line">    Next</div>
</div><!-- fragment --> <h1><a class="anchor" id="id_vb_xml"></a>
XML</h1>
<p>Extensible Markup Language, or XML, is a text-based mark-up system created and managed by the World Wide Web Consortium (www.w3.org). Like Hypertext Markup Language (HTML), XML uses angle brackets to indicate markup tags (for example, &lt;article&gt; or &lt;para&gt;). While HTML has a predefined set of tags, XML allows you to describe content more precisely by creating custom tags.</p>
<p>Because of its flexibility, XML increasingly is used as a format for storing data. InDesign includes a complete set of features for importing XML data into page layouts, and these features can be controlled using scripting.</p>
<p>We assume that you have already read Adobe InDesign Scripting Tutorial and know how to create and run a script. We also assume that you have some knowledge of XML, DTDs, and XSLT.</p>
<h2><a class="anchor" id="id_vb_overview"></a>
Overview</h2>
<p>Because XML is entirely concerned with content and explicitly not concerned with formatting, making XML work in a page-layout context is challenging. InDesign's approach to XML is quite complete and flexible, but it has a few limitations:</p>
<ul>
<li>Once XML elements are imported into an InDesign document, they become InDesign elements that correspond to the XML structure. The InDesign representations of the XML elements are not the same thing as the XML elements themselves.</li>
<li>Each XML element can appear only once in a layout. If you want to duplicate the information of the XML element in the layout, you must duplicate the XML element itself.</li>
<li>The order in which XML elements appear in a layout largely depends on the order in which they appear in the XML structure.</li>
<li>Any text that appears in a story associated with an XML element becomes part of that element's data.</li>
</ul>
<h2><a class="anchor" id="id_vb_the_best_approach_to_scripting_xml_in_indesign"></a>
The Best Approach to Scripting XML in InDesign</h2>
<p>You might want to do most of the work on an XML file outside InDesign, before you import the file into an InDesign layout. Working with XML outside InDesign, you can use a wide variety of excellent tools, such as XML editors and parsers.</p>
<p>When you need to rearrange or duplicate elements in a large XML data structure, the best approach is to transform the XML using XSLT. You can do this as you import the XML file.</p>
<p>If the XML data is already formatted in an InDesign document, you probably will want to use XML rules if you are doing more than the simplest of operations. XML rules can search the XML structure in a document and process matching XML elements much faster than a script that does not use XML rules.</p>
<p>For more on working with XML rules, see <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_xml_rules">XML Rules.</a></p>
<h2><a class="anchor" id="id_vb_scripting_xml_elements"></a>
Scripting XML Elements</h2>
<p>This section shows how to set XML preferences and XML import preferences, import XML, create XML elements, and add XML attributes. The scripts in this section demonstrate techniques for working with the XML content itself; for scripts that apply formatting to XML elements, see <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_adding_xml_elements_to_a_layout">Adding XML Elements to a Layout</a>.</p>
<h3><a class="anchor" id="id_vb_setting_xml_preferences"></a>
Setting XML preferences</h3>
<p>You can control the appearance of the InDesign structure panel using the XML view-preferences object, as shown in the following script fragment (from the XMLViewPreferences tutorial script): </p>
<div class="fragment"><div class="line">   Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">   Set myXMLViewPreferences = myDocument.XMLViewPreferences</div>
<div class="line">   myXMLViewPreferences.ShowAttributes = True</div>
<div class="line">   myXMLViewPreferences.ShowStructure = True</div>
<div class="line">   myXMLViewPreferences.ShowTaggedFrames = True</div>
<div class="line">   myXMLViewPreferences.ShowTagMarkers = True</div>
<div class="line">   myXMLViewPreferences.ShowTextSnippets = True</div>
</div><!-- fragment --><p> You also can specify XML tagging preset preferences (the default tag names and user-interface colors for tables and stories) using the XML preferences object., as shown in the following script fragment (from the XMLPreferences tutorial script): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myXMLPreferences = myDocument.XMLPreferences</div>
<div class="line">    myXMLPreferences.DefaultCellTagColor = idUIColors.idBlue</div>
<div class="line">    myXMLPreferences.DefaultCellTagName = <span class="stringliteral">&quot;cell&quot;</span></div>
<div class="line">    myXMLPreferences.DefaultImageTagColor = idUIColors.idBrickRed</div>
<div class="line">    myXMLPreferences.DefaultImageTagName = <span class="stringliteral">&quot;image&quot;</span></div>
<div class="line">    myXMLPreferences.DefaultStoryTagColor = idUIColors.idCharcoal</div>
<div class="line">    myXMLPreferences.DefaultStoryTagName = <span class="stringliteral">&quot;text&quot;</span></div>
<div class="line">    myXMLPreferences.DefaultTableTagColor = idUIColors.idCuteTeal</div>
<div class="line">    myXMLPreferences.DefaultTableTagName = <span class="stringliteral">&quot;table&quot;</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_setting_xml_import_preferences"></a>
Setting XML import preferences</h3>
<p>Before importing an XML file, you can set XML import preferences that can apply an XSLT transform, govern the way white space in the XML file is handled, or create repeating text elements. You do this using the XML import-preferences object, as shown in the following script fragment (from the XMLImportPreferences tutorial script): </p>
<div class="fragment"><div class="line">   Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">   Set myXMLImportPreferences = myDocument.XMLImportPreferences</div>
<div class="line">   myXMLImportPreferences.AllowTransform = False</div>
<div class="line">   myXMLImportPreferences.CreateLinkToXML = False</div>
<div class="line">   myXMLImportPreferences.IgnoreUnmatchedIncoming = True</div>
<div class="line">   myXMLImportPreferences.IgnoreWhitespace = True</div>
<div class="line">   myXMLImportPreferences.ImportCALSTables = True</div>
<div class="line">   myXMLImportPreferences.ImportStyle = idXMLImportStyles.idMergeImport</div>
<div class="line">   myXMLImportPreferences.ImportTextIntoTables = False</div>
<div class="line">   myXMLImportPreferences.ImportToSelected = False</div>
<div class="line">   myXMLImportPreferences.RemoveUnmatchedExisting = False</div>
<div class="line">   myXMLImportPreferences.RepeatTextElements = True</div>
<div class="line">   Rem The following properties are only used when the</div>
<div class="line">   Rem AllowTransform <span class="keyword">property</span> is <span class="keyword">set</span> to True.</div>
<div class="line">   Rem myXMLImportPreferences.TransformFilename = <span class="stringliteral">&quot;c:\myTransform.xsl&quot;</span></div>
<div class="line">   Rem If you have defined parameters in your XSL file, then you can pass</div>
<div class="line">   Rem parameters to the file during the XML <span class="keyword">import</span> process. For each parameter,</div>
<div class="line">   Rem enter an array containing two strings. The first <span class="keywordtype">string</span> is the name of the</div>
<div class="line">   Rem parameter, the second is the value of the parameter.</div>
<div class="line">   Rem myXMLImportPreferences.TransformParameters = Array(Array(<span class="stringliteral">&quot;format&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>))</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_importing_xml"></a>
Importing XML</h3>
<p>Once you set the XML import preferences the way you want them, you can import an XML file, as shown in the following script fragment (from the ImportXML tutorial script): </p>
<div class="fragment"><div class="line">    myDocument.ImportXML <span class="stringliteral">&quot;c:\test.xml&quot;</span></div>
</div><!-- fragment --><p> When you need to import the contents of an XML file into a specific XML element, use the importXML method of the XML element, rather than the corresponding method of the document. See the following script fragment (from the ImportXMLIntoElement tutorial script): </p>
<div class="fragment"><div class="line">    Set myRootXMLElement = myDocument.XMLElements.Item(1)</div>
<div class="line">    Set myLastXMLElement = myRootXMLElement.XMLElements.Item(-1)</div>
<div class="line">    myLastXMLElement.ImportXML <span class="stringliteral">&quot;c:\xml_test.xml&quot;</span></div>
</div><!-- fragment --><p> You also can set the ImportToSelected property of the XMLImportPreferences object to true, then select the XML element, and then import the XML file, as shown in the following script fragment (from the ImportXMLIntoSelectedElement tutorial script): </p>
<div class="fragment"><div class="line">   Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">   Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">   Set myTextFrame = myPage.TextFrames.Item(1)</div>
<div class="line">   Rem You<span class="stringliteral">&#39;ll have to fill in your own file path.</span></div>
<div class="line"><span class="stringliteral">   myDocument.ImportXML &quot;c:\test.xml&quot;</span></div>
<div class="line"><span class="stringliteral">   Set myRootXMLElement = myDocument.XMLElements.Item(1)</span></div>
<div class="line"><span class="stringliteral">   Set myLastXMLElement = myRootXMLElement.XMLElements.Item(-1)</span></div>
<div class="line"><span class="stringliteral">   Rem Select the XML element</span></div>
<div class="line"><span class="stringliteral">   myDocument.Select myLastXMLElement, idSelectionOptions.idReplaceWith</span></div>
<div class="line"><span class="stringliteral">   myDocument.XMLImportPreferences.ImportToSelected = True</span></div>
<div class="line"><span class="stringliteral">   myDocument.ImportXML &quot;c:\test.xml&quot;</span></div>
<div class="line"><span class="stringliteral">   myRootXMLElement.PlaceXML myTextFrame</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_creating_an_xml_tag"></a>
Creating an XML tag</h3>
<p>XML tags are the names of the XML elements you want to create in a document. When you import XML, the element names in the XML file are added to the list of XML tags in the document. You also can create XML tags directly, as shown in the following script fragment (from the MakeXMLTags tutorial script): </p>
<div class="fragment"><div class="line">   Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">   Rem You can create an XML tag without specifying a color <span class="keywordflow">for</span> the tag.</div>
<div class="line">   Set myXMLTagA = myDocument.XMLTags.Add(<span class="stringliteral">&quot;XML_Tag_A&quot;</span>)</div>
<div class="line">   Rem You can define the highlight color of the XML tag <span class="keyword">using</span> the UIColors enumeration...</div>
<div class="line">   Set myXMLTagB = myDocument.XMLTags.Add(<span class="stringliteral">&quot;XML_Tag_B&quot;</span>, idUIColors.idGray)</div>
<div class="line">   Rem ...or you can provide an RGB array to <span class="keyword">set</span> the color of the tag.</div>
<div class="line">   Set myXMLTagC = myDocument.XMLTags.Add(<span class="stringliteral">&quot;XML_Tag_C&quot;</span>, Array(0, 92, 128))</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_loading_xml_tags"></a>
Loading XML tags</h3>
<p>You can import XML tags from an XML file without importing the XML contents of the file. You might want to do this to work out a tag-to-style or style-to-tag mapping before you import the XML data., as shown in the following script fragment (from the LoadXMLTags tutorial script): </p>
<div class="fragment"><div class="line">    myDocument.LoadXMLTags <span class="stringliteral">&quot;c:\xml_tags.xml&quot;</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_saving_xml_tags"></a>
Saving XML tags</h3>
<p>Just as you can load XML tags from a file, you can save XML tags to a file, as shown in the following script. When you do this, only the tags themselves are saved in the XML file; document data is not included. As you would expect, this process is much faster than exporting XML, and the resulting file is much smaller. The following sample script shows how to save XML tags (for the complete script, see SaveXMLTags): </p>
<div class="fragment"><div class="line">   myDocument.SaveXMLTags <span class="stringliteral">&quot;c:\xml_tags.xml&quot;</span>, <span class="stringliteral">&quot;Tag set created August 18, 2008&quot;</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_creating_an_xml_element"></a>
Creating an XML element</h3>
<p>Ordinarily, you create XML elements by importing an XML file, but you also can create an XML element using InDesign scripting, as shown in the following script fragment (from the CreateXMLElement tutorial script): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myXMLTagA = myDocument.XMLTags.Add(<span class="stringliteral">&quot;XML_tag_A&quot;</span>)</div>
<div class="line">    Set myXMLElementA = myDocument.XMLElements.Item(1).XMLElements.Add(myXMLTagA)</div>
<div class="line">    myXMLElementA.Contents = <span class="stringliteral">&quot;This is an XML element containing text.&quot;</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_moving_an_xml_element"></a>
Moving an XML element</h3>
<p>You can move XML elements within the XML structure using the move method, as shown in the following script fragment (from the MoveXMLElement tutorial script): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myRootXMLElement = myDocument.xmlElements.item(1)</div>
<div class="line">    Rem Move the XML element containing <span class="stringliteral">&quot;A&quot;</span> to after the XML element containing <span class="stringliteral">&quot;C&quot;</span></div>
<div class="line">    Set myXMLElementA = myRootXMLElement.xmlElements.item(1)</div>
<div class="line">    myXMLElementA.move idLocationOptions.idAfter, myRootXMLElement.xmlElements.item(3)</div>
<div class="line">    Rem Move the XML element containing <span class="stringliteral">&quot;D&quot;</span> to the beginning of its parent.</div>
<div class="line">    myRootXMLElement.xmlElements.item(-1).move idLocationOptions.idAtBeginning</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_deleting_an_xml_element"></a>
Deleting an XML element</h3>
<p>Deleting an XML element removes it from both the layout and the XML structure, as shown in the following script fragment (from the DeleteXMLElement tutorial script). </p>
<div class="fragment"><div class="line">    Rem Delete the XML element containing <span class="stringliteral">&quot;A&quot;</span></div>
<div class="line">    myRootXMLElement.xmlElements.item(1).Delete</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_duplicating_an_xml_element"></a>
Duplicating an XML element</h3>
<p>When you duplicate an XML element, the new XML element appears immediately after the original XML element in the XML structure, as shown in the following script fragment (from the DuplicateXMLElement tutorial script): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myRootXMLElement = myDocument.xmlElements.item(1)</div>
<div class="line">    Rem Duplicate the XML element containing <span class="stringliteral">&quot;A&quot;</span></div>
<div class="line">    Set myNewXMLElement = myRootXMLElement.xmlElements.item(1).duplicate</div>
<div class="line">    Rem Change the content of the duplicated XML element.</div>
<div class="line">    myNewXMLElement.contents = myNewXMLElement.contents + <span class="stringliteral">&quot; duplicate&quot;</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_removing_items_from_the_xml_structure"></a>
Removing items from the XML structure</h3>
<p>To break the association between a page item or text and an XML element, use the untag method, as shown in the following script. The objects are not deleted, but they are no longer tied to an XML element (which is deleted). Any content of the deleted XML element becomes associated with the parent XML element. If the XML element is the root XML element, any layout objects (text or page items) associated with the XML element remain in the document. (For the complete script, see UntagXMLElement.) </p>
<div class="fragment"><div class="line">    Set myXMLElement = myDocument.xmlElements.item(1).xmlElements.item(1)</div>
<div class="line">    myXMLElement.Untag</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_creating_an_xml_comment"></a>
Creating an XML comment</h3>
<p>XML comments are used to make notes in XML data structures. You can add an XML comment using something like the following script fragment (from the MakeXMLComment tutorial script): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myRootXMLElement = myDocument.xmlElements.item(1)</div>
<div class="line">    Set myXMLElementB = myRootXMLElement.xmlElements.item(2)</div>
<div class="line">    myXMLElementB.xmlComments.add(<span class="stringliteral">&quot;This is an XML comment. It will not appear in the layout!&quot;</span>)</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_creating_an_xml_processing_instruction"></a>
Creating an XML processing instruction</h3>
<p>A processing instruction (PI) is an XML element that contains directions for the application reading the XML document. XML processing instructions are ignored by InDesign but can be inserted in an InDesign XML structure for export to other applications. An XML document can contain multiple processing instructions.</p>
<p>An XML processing instruction has two parts, target and value. The following is an example: </p>
<div class="fragment"><div class="line">&lt;?xml-stylesheet type=<span class="stringliteral">&quot;text/css&quot;</span> href=<span class="stringliteral">&quot;generic.css&quot;</span>?&gt;</div>
</div><!-- fragment --><p>The following script fragment shows how to add an XML processing instruction (for the complete script, see MakeProcessingInstruction): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myRootXMLElement = myDocument.xmlElements.item(1)</div>
<div class="line">    Set myXMLProcessingInstruction = myRootXMLElement.xmlInstructions.add(<span class="stringliteral">&quot;xml-stylesheet type=&quot;</span><span class="stringliteral">&quot;text/css&quot;</span><span class="stringliteral">&quot; &quot;</span>, <span class="stringliteral">&quot;href=&quot;</span><span class="stringliteral">&quot;generic.css&quot;</span><span class="stringliteral">&quot;&quot;</span>)  </div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_working_with_xml_attributes"></a>
Working with XML attributes</h3>
<p>XML attributes are "metadata" that can be associated with an XML element. To add an XML attribute to an XML element, use something like the following script fragment (from the MakeXMLAttribute tutorial script). An XML element can have any number of XML attributes, but each attribute name must be unique within the element (that is, you cannot have two attributes named "id"). </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myRootXMLElement = myDocument.xmlElements.item(1)</div>
<div class="line">    Set myXMLElementB = myRootXMLElement.xmlElements.item(2)</div>
<div class="line">    myXMLElementB.xmlAttributes.add <span class="stringliteral">&quot;example_attribute&quot;</span>, <span class="stringliteral">&quot;This is an XML attribute. It will not appear in the layout!&quot;</span></div>
</div><!-- fragment --><p> In addition to creating attributes directly using scripting, you can convert XML elements to attributes. When you do this, the text contents of the XML element become the value of an XML attribute added to the parent of the XML element. Because the name of the XML element becomes the name of the attribute, this method can fail when an attribute with that name already exists in the parent of the XML element. If the XML element contains page items, those page items are deleted from the layout.</p>
<p>When you convert an XML attribute to an XML element, you can specify the location where the new XML element is added. The new XML element can be added to the beginning or end of the parent of the XML attribute. By default, the new element is added at the beginning of the parent element.</p>
<p>You also can specify am XML mark-up tag for the new XML element. If you omit this parameter, the new XML element is created with the same XML tag as XML element containing the XML attribute.</p>
<p>The following script shows how to convert an XML element to an XML attribute (for the complete script, see ConvertElementToAttribute): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myRootXMLElement = myDocument.xmlElements.item(1)</div>
<div class="line">    myRootXMLElement.xmlElements.item(-1).convertToAttribute</div>
</div><!-- fragment --><p> You also can convert an XML attribute to an XML element, as shown in the following script fragment (from the ConvertAttributeToElement tutorial script): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myRootXMLElement = myDocument.xmlElements.item(1)</div>
<div class="line">    Set myXMLElementB = myRootXMLElement.xmlElements.item(2)</div>
<div class="line">    myXMLElementB.xmlAttributes.item(1).convertToElement idXMLElementLocation.idElementEnd, myDocument.xmlTags.item(<span class="stringliteral">&quot;xml_element&quot;</span>)</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_working_with_xml_stories"></a>
Working with XML stories</h3>
<p>When you import XML elements that were not associated with a layout element (a story or page item), they are stored in an XML story. You can work with text in unplaced XML elements just as you would work with the text in a text frame. The following script fragment shows how this works (for the complete script, see XMLStory): </p>
<div class="fragment"><div class="line">    Set myXMLStory = myDocument.xmlStories.item(1)</div>
<div class="line">    Rem Though the text has not yet been placed in the layout, all text</div>
<div class="line">    Rem properties are available.</div>
<div class="line">    myXMLStory.paragraphs.item(1).pointSize = 72</div>
<div class="line">    Rem Place the XML element in the layout to see the result.</div>
<div class="line">    myDocument.xmlElements.item(1).xmlElements.item(1).placeXML myPage.textFrames.item(1)</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_exporting_xml"></a>
Exporting XML</h3>
<p>To export XML from an InDesign document, export either the entire XML structure in the document or one XML element (including any child XML elements it contains). The following script fragment shows how to do this (for the complete script, see ExportXML): </p>
<div class="fragment"><div class="line">    Rem Export the entire XML structure in the document.</div>
<div class="line">    Rem You<span class="stringliteral">&#39;ll have to fill in your own file path.</span></div>
<div class="line"><span class="stringliteral">    myDocument.export idExportFormat.idXML, &quot;c:\completeDocumentXML.xml&quot;</span></div>
<div class="line"><span class="stringliteral">    Rem Export a specific XML element and its child XML elements.</span></div>
<div class="line"><span class="stringliteral">    Set myXMLElement = myDocument.xmlElements.item(1).xmlElements.item(-1)</span></div>
<div class="line"><span class="stringliteral">    myXMLElement.export idExportFormat.idXML, &quot;c:\partialDocumentXML.xml&quot;</span></div>
</div><!-- fragment --><p> In addition, you can use the ExportFromSelected property of the XMLExportPreferences object to export an XML element selected in the user interface. The following script fragment shows how to do this (for the complete script, see ExportSelectedXMLElement): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    myDocument.select(myDocument.XMLElements.item(1).XMLElements.item(2))</div>
<div class="line">    myDocument.xmlExportPreferences.ExportFromSelected = True</div>
<div class="line">    Rem You<span class="stringliteral">&#39;ll have to fill in your own file path.</span></div>
<div class="line"><span class="stringliteral">    myDocument.export idExportFormat.idXML, &quot;c:\selectedXMLElement.xml&quot;</span></div>
<div class="line"><span class="stringliteral">    myDocument.xmlExportPreferences.exportFromSelected = false</span></div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_adding_xml_elements_to_a_layout"></a>
Adding XML Elements to a Layout</h2>
<p>Previously, we covered the process of getting XML data into InDesign documents and working with the XML structure in a document. In this section, we discuss techniques for getting XML information into a page layout and applying formatting to it.</p>
<h3><a class="anchor" id="id_vb_associating_xml_elements_with_page_items_and_text"></a>
Associating XML elements with page items and text</h3>
<p>To associate a page item or text with an existing XML element, use the PlaceXML method. This replaces the content of the page item with the content of the XML element, as shown in the following script fragment (from the PlaceXML tutorial script): </p>
<div class="fragment"><div class="line">    myDocument.xmlElements.item(1).placeXML myPage.textFrames.item(1)</div>
</div><!-- fragment --><p> To associate an existing page item or text object with an existing XML element, use the markup method. This merges the content of the page item or text with the content of the XML element (if any). The following script fragment shows how to use the markup method (for the complete script, see Markup): </p>
<div class="fragment"><div class="line">    myDocument.xmlElements.item(1).xmlElements.item(1).markup myPage.textFrames.item(1)</div>
</div><!-- fragment --><p> *Placing XML into page items**</p>
<p>Another way to associate an XML element with a page item is to use the PlaceIntoFrame method. With this method, you can create a frame as you place the XML, as shown in the following script fragment (for the complete script, see PlaceIntoFrame): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    Rem PlaceIntoFrame has two parameters:</div>
<div class="line">    Rem On: The page, spread, or master spread on which to create the frame</div>
<div class="line">    Rem GeometricBounds: The bounds of the <span class="keyword">new</span> frame (in page coordinates).</div>
<div class="line">    myDocument.xmlElements.item(1).xmlElements.item(1).PlaceIntoFrame myPage, Array(72, 72, 288, 288)</div>
</div><!-- fragment --><p> To associate an XML element with an inline page item (i.e., an anchored object), use the PlaceIntoCopy method, as shown in the following script fragment (from the PlaceIntoCopy tutorial script): </p>
<div class="fragment"><div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    Rem Function PlaceIntoCopy(On, PlacePoint, CopyItem As PageItem, [RetainExistingFrame As Boolean = False]) As PageItem  </div>
<div class="line">    Set myXMLElement = myDocument.xmlElements.item(1)</div>
<div class="line">    myXMLElement.placeIntoCopy myPage, Array(288, 72), myPage.textFrames.item(1), True</div>
</div><!-- fragment --><p> To associate an existing page item (or a copy of an existing page item) with an XML element and insert the page item into the XML structure at the location of the element, use the PlaceIntoInlineCopy method, as shown in the following script fragment (from the PlaceIntoInlineCopy tutorial script): </p>
<div class="fragment"><div class="line">    Set myTextFrame = myPage.TextFrames.Item(1)</div>
<div class="line">    Set myXMLTag = myDocument.XMLTags.Add(<span class="stringliteral">&quot;XMLElement&quot;</span>)</div>
<div class="line">    Set myXMLElement = myDocument.XMLElements.Item(1).XMLElements.Add(myXMLTag)</div>
<div class="line">    myXMLElement.Texts.Item(1).Contents = <span class="stringliteral">&quot;This is an XML element.&quot;</span></div>
<div class="line">    myDocument.XMLElements.Item(1).PlaceXML myTextFrame</div>
<div class="line">    Set myXMLElement = myDocument.XMLElements.Item(1).XMLElements.Add(myXMLTag)</div>
<div class="line">    myXMLElement.Contents = <span class="stringliteral">&quot;This is the second XML element.&quot;</span></div>
<div class="line">    myXMLElement.PlaceIntoInlineCopy myTextFrame, False</div>
<div class="line">    Rem Resize the frame so that you can see the result.</div>
<div class="line">    myTextFrame.GeometricBounds = myGetBounds(myDocument, myPage)</div>
</div><!-- fragment --><p> To associate an XML element with a new inline frame, use the PlaceIntoInlineFrame method, as shown in the following script fragment (from the PlaceIntoInlineFrame tutorial script): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myXMLElement = myDocument.xmlElements.item(1).xmlElements.item(3)</div>
<div class="line">    myXMLElement.placeIntoInlineFrame Array(72, 24)</div>
</div><!-- fragment --><p> <b>Inserting text in and around XML text elements</b></p>
<p>When you place XML data into an InDesign layout, you often need to add white space (for example, return and tab characters) and static text (labels like "name" or "address") to the text of your XML elements. The following sample script shows how to add text in and around XML elements (for the complete script, see InsertTextAsContent): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myXMLElement = myDocument.xmlElements.item(1).xmlElements.item(1)</div>
<div class="line">    Rem By inserting the <span class="keywordflow">return</span> character after the XML element, the character</div>
<div class="line">    Rem becomes part of the content of the parent XML element, not of the element itself.</div>
<div class="line">    myXMLElement.insertTextAsContent vbcr, idXMLElementPosition.idAfterElement</div>
<div class="line">    Set myXMLElement = myDocument.xmlElements.item(1).xmlElements.item(2)</div>
<div class="line">    myXMLElement.insertTextAsContent <span class="stringliteral">&quot;Static text: &quot;</span>, idXMLElementPosition.idBeforeElement</div>
<div class="line">    myXMLElement.insertTextAsContent vbcr, idXMLElementPosition.idAfterElement</div>
<div class="line">    Rem To add text inside the element, <span class="keyword">set</span> the location option to beginning or end.</div>
<div class="line">    Set myXMLElement = myDocument.xmlElements.item(1).xmlElements.item(3)</div>
<div class="line">    myXMLElement.insertTextAsContent <span class="stringliteral">&quot;Text at the start of the element: &quot;</span>, idXMLElementPosition.idElementStart</div>
<div class="line">    myXMLElement.insertTextAsContent <span class="stringliteral">&quot; Text at the end of the element.&quot;</span>, idXMLElementPosition.idElementEnd</div>
<div class="line">    myXMLElement.insertTextAsContent vbcr, idXMLElementPosition.idAfterElement</div>
<div class="line">    Rem Add <span class="keyword">static</span> text outside the element.</div>
<div class="line">    Set myXMLElement = myDocument.xmlElements.item(1).xmlElements.item(4)</div>
<div class="line">    myXMLElement.insertTextAsContent <span class="stringliteral">&quot;Text before the element: &quot;</span>, idXMLElementPosition.idBeforeElement</div>
<div class="line">    myXMLElement.insertTextAsContent <span class="stringliteral">&quot; Text after the element.&quot;</span>, idXMLElementPosition.idAfterElement</div>
<div class="line">    Rem To insert text inside the text of an element, work with the text objects contained by the element.</div>
<div class="line">    myXMLElement.words.item(3).insertionPoints.item(1).contents = <span class="stringliteral">&quot;(the third word of) &quot;</span></div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_marking_up_existing_layouts"></a>
Marking up existing layouts</h3>
<p>In some cases, an XML publishing project does not start with an XML file-especially when you need to convert an existing page layout to XML. For this type of project, you can mark up existing page-layout content and add it to an XML structure. You can then export this structure for further processing by XML tools outside InDesign.</p>
<p><b>Mapping tags to styles</b></p>
<p>One of the quickest ways to apply formatting to XML text elements is to use XMLImportMaps, also known as tag-to-style mapping. When you do this, you can associate a specific XML tag with a paragraph or character style. When you use the MapXMLTagsToStyles method of the document, InDesign applies the style to the text, as shown in the following script fragment (from the MapTagsToStyles tutorial script): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Rem Create a tag to style mapping.</div>
<div class="line">    myDocument.XMLImportMaps.Add myDocument.XMLTags.Item(<span class="stringliteral">&quot;heading_1&quot;</span>), myDocument.ParagraphStyles.Item(<span class="stringliteral">&quot;heading 1&quot;</span>)</div>
<div class="line">    myDocument.XMLImportMaps.Add myDocument.XMLTags.Item(<span class="stringliteral">&quot;heading_2&quot;</span>), myDocument.ParagraphStyles.Item(<span class="stringliteral">&quot;heading 2&quot;</span>)</div>
<div class="line">    myDocument.XMLImportMaps.Add myDocument.XMLTags.Item(<span class="stringliteral">&quot;para_1&quot;</span>), myDocument.ParagraphStyles.Item(<span class="stringliteral">&quot;para 1&quot;</span>)</div>
<div class="line">    myDocument.XMLImportMaps.Add myDocument.XMLTags.Item(<span class="stringliteral">&quot;body_text&quot;</span>), myDocument.ParagraphStyles.Item(<span class="stringliteral">&quot;body text&quot;</span>)</div>
<div class="line">    Rem Apply the tag to style mapping.</div>
<div class="line">    myDocument.MapXMLTagsToStyles</div>
</div><!-- fragment --><p> <b>Mapping styles to tags</b></p>
<p>When you have formatted text that is not associated with any XML elements, and you want to move that text into an XML structure, use style-to-tag mapping, which associates paragraph and character styles with XML tags. To do this, use XMLExportMap objects to create the links between XML tags and styles, then use the MapStylesToXMLTags method to create the corresponding XML elements, as shown in the following script fragment (from the MapStylesToTags tutorial script): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Rem Create a tag to style mapping.</div>
<div class="line">    myDocument.XMLExportMaps.Add myDocument.ParagraphStyles.Item(<span class="stringliteral">&quot;heading 1&quot;</span>), myDocument.XMLTags.Item(<span class="stringliteral">&quot;heading_1&quot;</span>)</div>
<div class="line">    myDocument.XMLExportMaps.Add myDocument.ParagraphStyles.Item(<span class="stringliteral">&quot;heading 2&quot;</span>), myDocument.XMLTags.Item(<span class="stringliteral">&quot;heading_2&quot;</span>)</div>
<div class="line">    myDocument.XMLExportMaps.Add myDocument.ParagraphStyles.Item(<span class="stringliteral">&quot;para 1&quot;</span>), myDocument.XMLTags.Item(<span class="stringliteral">&quot;para_1&quot;</span>)</div>
<div class="line">    myDocument.XMLExportMaps.Add myDocument.ParagraphStyles.Item(<span class="stringliteral">&quot;body text&quot;</span>), myDocument.XMLTags.Item(<span class="stringliteral">&quot;body_text&quot;</span>)</div>
<div class="line">    Rem Apply the style to tag mapping.</div>
<div class="line">    myDocument.MapStylesToXMLTags</div>
</div><!-- fragment --><p> Another approach is simply to have your script create a new XML tag for each paragraph or character style in the document, and then apply the style to tag mapping, as shown in the following script fragment (from the MapAllStylesToTags tutorial script): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Rem Create tags that match the style names in the document,</div>
<div class="line">    Rem creating an XMLExportMap <span class="keywordflow">for each</span> tag/style pair.</div>
<div class="line">    For myCounter = 1 To myDocument.ParagraphStyles.Count</div>
<div class="line">        Set myParagraphStyle = myDocument.ParagraphStyles.Item(myCounter)</div>
<div class="line">        myParagraphStyleName = myParagraphStyle.Name</div>
<div class="line">        myXMLTagName = Replace(myParagraphStyleName, <span class="stringliteral">&quot; &quot;</span>, <span class="stringliteral">&quot;_&quot;</span>)</div>
<div class="line">        myXMLTagName = Replace(myXMLTagName, &quot;[&quot;, &quot;&quot;)</div>
<div class="line">        myXMLTagName = Replace(myXMLTagName, &quot;]&quot;, &quot;&quot;)</div>
<div class="line">        Set myXMLTag = myDocument.XMLTags.Add(myXMLTagName)</div>
<div class="line">        myDocument.XMLExportMaps.Add myParagraphStyle, myXMLTag</div>
<div class="line">    Next</div>
<div class="line">    Rem Apply the tag to style mapping.</div>
<div class="line">    myDocument.MapStylesToXMLTags</div>
</div><!-- fragment --><p> <b>Marking up graphics</b></p>
<p>The following script fragment shows how to associate an XML element with a graphic (for the complete script, see MarkingUpGraphics): </p>
<div class="fragment"><div class="line">    Set myXMLTag = myDocument.XMLTags.Add(<span class="stringliteral">&quot;graphic&quot;</span>)</div>
<div class="line">    Set myGraphic = myPage.Place(<span class="stringliteral">&quot;c:\test.tif&quot;</span>)</div>
<div class="line">    Rem The place method returns a collection. We placed a single graphic,</div>
<div class="line">    Rem so <span class="keyword">get</span> the first item in the collection.</div>
<div class="line">    Set myGraphic = myGraphic.Item(1)</div>
<div class="line">    Set myXMLElement = myDocument.XMLElements.Item(1).XMLElements.Add(myXMLTag)</div>
<div class="line">    Rem the parent of the graphic is the graphic frame.</div>
<div class="line">    myGraphic.parent.markup myXMLElement</div>
<div class="line">    Rem You can also associate the graphic with a <span class="keyword">new</span> XML element as you create the element.</div>
<div class="line">    Rem Set myXMLElement = myDocument.XMLElements.Item(1).XMLElements.Add(myXMLTag, myGraphic)</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_applying_styles_to_xml_elements"></a>
Applying styles to XML elements</h3>
<p>In addition to using tag-to-style and style-to-tag mappings or applying styles to the text and page items associated with XML elements, you also can apply styles to XML elements directly. The following script fragment shows how to use three methods: ApplyParagraphStyle, ApplyCharacterStyle, and ApplyObjectStyle. (For the complete script, see ApplyStylesToXMLElements.) </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)   </div>
<div class="line">    Rem Add XML elements.</div>
<div class="line">    Set myRootXMLElement = myDocument.XMLElements.Item(1)</div>
<div class="line">    Set myXMLElementA = myRootXMLElement.XMLElements.Add(myDocument.XMLTags.Item(<span class="stringliteral">&quot;heading_1&quot;</span>))</div>
<div class="line">    myXMLElementA.Contents = <span class="stringliteral">&quot;Heading 1&quot;</span></div>
<div class="line">    myXMLElementA.ApplyParagraphStyle myDocument.ParagraphStyles.Item(<span class="stringliteral">&quot;heading 1&quot;</span>), True</div>
<div class="line">    myXMLElementA.InsertTextAsContent vbCr, idXMLElementPosition.idAfterElement</div>
<div class="line">    Set myXMLElementB = myRootXMLElement.XMLElements.Add(myDocument.XMLTags.Item(<span class="stringliteral">&quot;para_1&quot;</span>))</div>
<div class="line">    myXMLElementB.Contents = <span class="stringliteral">&quot;This is the first paragraph in the article.&quot;</span></div>
<div class="line">    myXMLElementB.ApplyParagraphStyle myDocument.ParagraphStyles.Item(<span class="stringliteral">&quot;para 1&quot;</span>), True</div>
<div class="line">    myXMLElementB.InsertTextAsContent vbCr, idXMLElementPosition.idAfterElement</div>
<div class="line">    Set myXMLElementC = myRootXMLElement.XMLElements.Add(myDocument.XMLTags.Item(<span class="stringliteral">&quot;body_text&quot;</span>))</div>
<div class="line">    myXMLElementC.Contents = <span class="stringliteral">&quot;This is the second paragraph in the article.&quot;</span></div>
<div class="line">    myXMLElementC.ApplyParagraphStyle myDocument.ParagraphStyles.Item(<span class="stringliteral">&quot;body text&quot;</span>), True</div>
<div class="line">    myXMLElementC.InsertTextAsContent vbCr, idXMLElementPosition.idAfterElement</div>
<div class="line">    Set myXMLElementD = myRootXMLElement.XMLElements.Add(myDocument.XMLTags.Item(<span class="stringliteral">&quot;heading_2&quot;</span>))</div>
<div class="line">    myXMLElementD.Contents = <span class="stringliteral">&quot;Heading 2&quot;</span></div>
<div class="line">    myXMLElementD.ApplyParagraphStyle myDocument.ParagraphStyles.Item(<span class="stringliteral">&quot;heading 2&quot;</span>), True</div>
<div class="line">    myXMLElementD.InsertTextAsContent vbCr, idXMLElementPosition.idAfterElement</div>
<div class="line">    Set myXMLElementE = myRootXMLElement.XMLElements.Add(myDocument.XMLTags.Item(<span class="stringliteral">&quot;para_1&quot;</span>))</div>
<div class="line">    myXMLElementE.Contents = <span class="stringliteral">&quot;This is the first paragraph following the subhead.&quot;</span></div>
<div class="line">    myXMLElementE.ApplyParagraphStyle myDocument.ParagraphStyles.Item(<span class="stringliteral">&quot;para 1&quot;</span>), True</div>
<div class="line">    myXMLElementE.InsertTextAsContent vbCr, idXMLElementPosition.idAfterElement</div>
<div class="line">    Set myXMLElementF = myRootXMLElement.XMLElements.Add(myDocument.XMLTags.Item(<span class="stringliteral">&quot;body_text&quot;</span>))</div>
<div class="line">    myXMLElementF.Contents = <span class="stringliteral">&quot;This is the second paragraph following the subhead.&quot;</span></div>
<div class="line">    myXMLElementF.ApplyParagraphStyle myDocument.ParagraphStyles.Item(<span class="stringliteral">&quot;body text&quot;</span>), True</div>
<div class="line">    myXMLElementF.InsertTextAsContent vbCr, idXMLElementPosition.idAfterElement</div>
<div class="line">    Set myXMLElementG = myXMLElementF.XMLElements.Add(myDocument.XMLTags.Item(<span class="stringliteral">&quot;body_text&quot;</span>))</div>
<div class="line">    myXMLElementG.Contents = <span class="stringliteral">&quot;Note:&quot;</span></div>
<div class="line">    Set myXMLElementG = myXMLElementG.Move(idLocationOptions.idAtBeginning, myXMLElementF)</div>
<div class="line">    myXMLElementG.InsertTextAsContent <span class="stringliteral">&quot; &quot;</span>, idXMLElementPosition.idAfterElement</div>
<div class="line">    myXMLElementG.ApplyCharacterStyle myDocument.CharacterStyles.Item(<span class="stringliteral">&quot;Emphasis&quot;</span>), True</div>
<div class="line">    Set myTextFrame = myPage.TextFrames.Add</div>
<div class="line">    myTextFrame.GeometricBounds = myGetBounds(myDocument, myPage)</div>
<div class="line">    Set myStory = myTextFrame.ParentStory</div>
<div class="line">    Rem Associate the root XML element with the story.</div>
<div class="line">    myRootXMLElement.PlaceXML myStory</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_working_with_xml_tables"></a>
Working with XML tables</h3>
<p>InDesign automatically imports XML data into table cells when the data is marked up using HTML standard table tags. If you cannot use the default table mark-up or prefer not to use it, InDesign can convert XML elements to a table using the ConvertElementToTable method.</p>
<p>To use this method, the XML elements to be converted to a table must conform to a specific structure. Each row of the table must correspond to a specific XML element, and that element must contain a series of XML elements corresponding to the cells in the row. The following script fragment shows how to use this method (for the complete script, see ConvertXMLElementToTable). The XML element used to denote the table row is consumed by this process. </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    Rem Create a series of XML tags.</div>
<div class="line">    Set myRowTag = myDocument.XMLTags.Add(<span class="stringliteral">&quot;row&quot;</span>)</div>
<div class="line">    Set myCellTag = myDocument.XMLTags.Add(<span class="stringliteral">&quot;cell&quot;</span>)</div>
<div class="line">    Set myTableTag = myDocument.XMLTags.Add(<span class="stringliteral">&quot;table&quot;</span>)</div>
<div class="line">    Rem Add XML elements.</div>
<div class="line">    Set myRootXMLElement = myDocument.XMLElements.Item(1)</div>
<div class="line">    With myRootXMLElement</div>
<div class="line">        Set myTableXMLElement = .XMLElements.Add(myTableTag)</div>
<div class="line">        With myTableXMLElement</div>
<div class="line">            For myRowCounter = 1 To 6</div>
<div class="line">                With .XMLElements.Add(myRowTag)</div>
<div class="line">                    .Contents = <span class="stringliteral">&quot;Row &quot;</span> + CStr(myRowCounter)</div>
<div class="line">                    For myCellCounter = 1 To 4</div>
<div class="line">                        With .XMLElements.Add(myCellTag)</div>
<div class="line">                            .Contents = &quot;Cell &quot; + CStr(myCellCounter)</div>
<div class="line">                        End With</div>
<div class="line">                    Next</div>
<div class="line">                End With</div>
<div class="line">            Next</div>
<div class="line">        End With</div>
<div class="line">    End With</div>
<div class="line">    Set myTable = myTableXMLElement.ConvertElementToTable(myRowTag, myCellTag)</div>
<div class="line">    Set myTextFrame = myDocument.TextFrames.Add</div>
<div class="line">    myTextFrame.GeometricBounds = myGetBounds(myDocument, myPage)</div>
<div class="line">    myDocument.XMLElements.Item(1).PlaceXML myTextFrame</div>
</div><!-- fragment --><p> Once you are working with a table containing XML elements, you can apply table styles and cell styles to the XML elements directly, rather than having to apply the styles to the tables or cells associated with the XML elements. To do this, use the ApplyTableStyle and ApplyCellStyle methods, as shown in the following script fragment (from the ApplyTableStyles tutorial script): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">    Set myRootXMLElement = myDocument.XMLElements.Item(1)</div>
<div class="line">    Set myTableXMLElement = myRootXMLElement.XMLElements.Item(1)</div>
<div class="line">    Set myRowTag = myDocument.XMLTags.Item(<span class="stringliteral">&quot;Row&quot;</span>)</div>
<div class="line">    Set myCellTag = myDocument.XMLTags.Item(<span class="stringliteral">&quot;Cell&quot;</span>)</div>
<div class="line">    Set myTableStyle = myDocument.TableStyles.Item(<span class="stringliteral">&quot;myTableStyle&quot;</span>)</div>
<div class="line">    Set myCellStyle = myDocument.CellStyles.Item(<span class="stringliteral">&quot;myCellStyle&quot;</span>)</div>
<div class="line">    Set myTable = myTableXMLElement.convertElementToTable(myRowTag, myCellTag)</div>
<div class="line">    Set myTableXMLElement = myDocument.xmlElements.item(1).xmlElements.item(1)</div>
<div class="line">    myTableXMLElement.applyTableStyle(myTableStyle)</div>
<div class="line">    myTableXMLElement.xmlElements.item(1).applyCellStyle(myCellStyle)</div>
<div class="line">    myTableXMLElement.xmlElements.item(6).applyCellStyle(myCellStyle)</div>
<div class="line">    myTableXMLElement.xmlElements.item(11).applyCellStyle(myCellStyle)</div>
<div class="line">    myTableXMLElement.xmlElements.item(16).applyCellStyle(myCellStyle)</div>
<div class="line">    myTableXMLElement.xmlElements.item(17).applyCellStyle(myCellStyle)</div>
<div class="line">    myTableXMLElement.xmlElements.item(22).applyCellStyle(myCellStyle)</div>
<div class="line">    Rem  Add text elements.</div>
<div class="line">    Set myPage = myDocument.pages.item(1)</div>
<div class="line">    Set myTextFrame = myPage.textFrames.add</div>
<div class="line">    myTextFrame.GeometricBounds = myGetBounds(myDocument, myPage)</div>
<div class="line">    Set myStory = myTextFrame.parentStory</div>
<div class="line">    myStory.placeXML myRootXMLElement</div>
<div class="line">    myTable.alternatingFills = idAlternatingFillsTypes.idAlternatingRows</div>
</div><!-- fragment --> <h1><a class="anchor" id="id_vb_xml_rules"></a>
XML Rules</h1>
<p>The InDesign XML- rules feature provides a powerful set of scripting tools for working with the XML content of your documents. XML rules also greatly simplify the process of writing scripts to work with XML elements and dramatically improve performance of finding, changing, and formatting XML elements.</p>
<p>While XML rules can be triggered by application events, like open, place, and close, typically you will run XML rules after importing XML into a document. (For more information on attaching scripts to events, see <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_events">Events.</a>)</p>
<p>We assume that you have already read Adobe InDesign Scripting Tutorial and know how to create and run a script. We also assume that you have some knowledge of XML and have read <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_xml">XML</a></p>
<h2><a class="anchor" id="id_vb_overview"></a>
Overview</h2>
<p>InDesign's XML rules feature has three parts:</p>
<ul>
<li>XML rules processor (a scripting object) - Locates XML elements in an XML structure using XPath and applies the appropriate XML rule(s). It is important to note that a script can contain multiple XML rule processor objects, and each rule-processor object is associated with a given XML rule set.</li>
<li>Glue code - A set of routines provided by Adobe to make the process of writing XML rules and interacting with the XML rules-processor easier.</li>
<li>XML rules - The XML actions you add to a script. XML rules are written in scripting code. A rule combines an XPath-based condition and a function to apply when the condition is met. The "apply" function can perform any set of operations that can be defined in InDesign scripting, including changing the XML structure; applying formatting; and creating new pages, page items, or documents.</li>
</ul>
<p>A script can define any number of rules and apply them to the entire XML structure of an InDesign document or any subset of elements within the XML structure. When an XML rule is triggered by an XML rule processor, the rule can apply changes to the matching XML element or any other object in the document.</p>
<p>You can think of the XML rules feature as being something like XSLT. Just as XSLT uses XPath to locate XML elements in an XML structure, then transforms the XML elements in some way, XML rules use XPath to locate and act on XML elements inside InDesign. Just as an XSLT template uses an XML parser outside InDesign to apply transformations to XML data, InDesign's XML Rules Processor uses XML rules to apply transformations to XML data inside InDesign.</p>
<h3><a class="anchor" id="id_vb_why_use_xml_rules"></a>
Why use XML rules?</h3>
<p>In prior releases of InDesign, you could not use XPath to navigate the XML structure in your InDesign files. Instead, you needed to write recursive script functions to iterate through the XML structure, examining each element in turn. This was difficult and slow.</p>
<p>XML rules makes it easy to find XML elements in the structure, by using XPath and relying on InDesign's XML-rules processors to find XML elements. An XML-rule processor handles the work of iterating through the XML elements in your document, and it can do so much faster than a script.</p>
<h3><a class="anchor" id="id_vb_xml-rules_programming_model"></a>
XML-rules programming model</h3>
<p>An XML rule contains three things:</p>
<ol type="1">
<li>A name (as a string).</li>
<li>An XPath statement (as a string).</li>
<li>An apply function.</li>
</ol>
<p>The XPath statement defines the location in the XML structure; when the XML rules processor finds a matching element, it executes the apply function defined in the rule.</p>
<p>Here is a sample XML rule: </p>
<div class="fragment"><div class="line">Class RuleName</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = <span class="stringliteral">&quot;RuleNameAsString&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = <span class="stringliteral">&quot;ValidXPathSpecifier&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Public Function  apply (myXMLElement, myRulesProcessor)</div>
<div class="line">        Rem Do something here.</div>
<div class="line">        Rem Return true to stop further processing of the XML element.</div>
<div class="line">        apply = False</div>
<div class="line">    End Function</div>
<div class="line">End Class</div>
</div><!-- fragment --><p> In the above example, RuleNameAsString is the name of the rule and matches the RuleName; ValidXPathSpecifier is an XPath expression. Later in this section, we present a series of functioning XML-rule examples.</p>
<dl class="section note"><dt>Note</dt><dd>XML rules support a limited subset of XPath 1.0. See "XPath limitations" in <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_overview">XML Rules Overview</a>.</dd></dl>
<p><b>XML-rule sets</b></p>
<p>An XML-rule set is an array of one or more XML rules to be applied by an XML-rules processor. The rules are applied in the order in which they appear in the array. Here is a sample XML-rule set: </p>
<div class="fragment"><div class="line">myRuleSet = Array(<span class="keyword">new</span> SortByName, <span class="keyword">new</span> AddStaticText, <span class="keyword">new</span> LayoutElements, <span class="keyword">new</span> FormatElements)</div>
</div><!-- fragment --><p> In the above example, the rules listed in the myRuleSet array are defined elsewhere in the script. Later in this section, we present several functioning scripts containing XML-rule sets.</p>
<p>'<b>Glue</b>' <b>code</b></p>
<p>In addition to the XML-rules processor object built into InDesign's scripting model, Adobe provides a set of functions intended to make the process of writing XML rules much easier. These functions are defined within the glue code.vbs file:</p>
<ul>
<li>__processRuleSet(root, ruleSet) - To execute a set of XML rules, your script must call the __processRuleSet function and provide an XML element and an XML rule set. The XML element defines the point in the XML structure at which to begin processing the rules.</li>
<li>__processChildren(ruleProcessor) - This function directs the XML-rules processor to apply matching XML rules to child elements of the matched XML element. This allows the rule applied to a parent XML element to execute code after the child XML elements are processed. By default, when an XML-rules processor applies a rule to the c hildren of an XML element, control does not return to the rule. You can use the __processChildren function to return control to the apply function of the rule after the child XML elements are processed.</li>
<li>__skipChildren(ruleProcessor) - This function tells the processor not to process any descendants of the current XML element using the XML rule. Use this function when you want to move or delete the current XML element or improve performance by skipping irrelevant parts of an XML structure.</li>
</ul>
<p><b>Iterating through an XML structure</b></p>
<p>The XML-rules processor iterates through the XML structure of a document by processing each XML element in the order in which it appears in the XML hierarchy of the document. The XML-rules processor uses a forward-only traversal of the XML structure, and it visits each XML element in the structure twice (in the order parent-child-parent, just like the normal ordering of nested tags in an XML file). For any XML element, the XML-rules processor tries to apply all matching XML rules in the order in which they are added to the current XML rule set.</p>
<p>The __processRuleSet function applies rules to XML elements in "depth first" order; that is, XML elements and their child elements are processed in the order in which they appear in the XML structure. For each "branch" of the XML structure, the XML-rules processor visits each XML element before moving on to the next branch.</p>
<p>After an XML rule is applied to an XML element, the XML-rules processor continues searching for rules to apply to the descendents of that XML element. An XML rule can alter this behavior by using the __skipChildren or __processChildren function, or by changing the operation of other rules.</p>
<p>To see how all these functions work together, import the DepthFirstProcessingOrder.xml file into a new document, then run the DepthFirstProcessingOrder.jsx script. InDesign creates a text frame, that lists the attribute names of each element in the sample XML file in the order in which they were visited by each rule. You can use this script in conjunction with the AddAttribute tutorial script to troubleshoot XML traversal problems in your own XML documents (you must edit the AddAttribute script to suit your XML structure).</p>
<p>Normal iteration (assuming a rule that matches every XML element in the structure) is shown in the following figure:</p>
<div class="image">
<img src="InDesign_ScriptingGuide-11.gif" alt="InDesign_ScriptingGuide-11.gif"/>
</div>
<p>Iteration with __processChildren (assuming a rule that matches every XML element in the structure) is shown in the following figure:</p>
<div class="image">
<img src="InDesign_ScriptingGuide-12.gif" alt="InDesign_ScriptingGuide-12.gif"/>
</div>
<p>Iteration given the following rule set is shown in the figure after the script fragment. The rule set includes two rules that match every element, including one that uses __processChildren. Every element is processed twice. (For the complete script, see ProcessChildren.) </p>
<div class="fragment"><div class="line">Rem XML rules follow.</div>
<div class="line">Class NormalRule</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = <span class="stringliteral">&quot;NormalRule&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = <span class="stringliteral">&quot;//XMLElement&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Public Function apply(myXMLElement, myRuleProcessor)</div>
<div class="line">        With myXMLElement</div>
<div class="line">            myStory.InsertionPoints.Item(-1).Contents = .XMLAttributes.Item(1).Value &amp; vbCr</div>
<div class="line">        End With</div>
<div class="line">        apply = false</div>
<div class="line">    End Function </div>
<div class="line">End Class</div>
<div class="line">Class ProcessChildrenRule</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = &quot;ProcessChildrenRule&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = &quot;<span class="comment">//XMLElement&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Public Function apply(myXMLElement, myRuleProcessor)</div>
<div class="line">        glueCode_processChildren(myRuleProcessor)</div>
<div class="line">        With myXMLElement</div>
<div class="line">            myXMLElement.XMLattributes.Item(1).Value</div>
<div class="line">            myStory.InsertionPoints.Item(-1).Contents = .XMLAttributes.Item(1).Value &amp; vbCr</div>
<div class="line">        End With</div>
<div class="line">        apply = false</div>
<div class="line">    End Function </div>
<div class="line">End Class</div>
</div><!-- fragment --> <div class="image">
<img src="InDesign_ScriptingGuide-13.gif" alt="InDesign_ScriptingGuide-13.gif"/>
</div>
<p><b>Changing structure during iteration</b></p>
<p>When an XML-rules processor finds a matching XML element and applies an XML rule, the rule can change the XML structure of the document. This can conflict with the process of applying other rules, if the affected XML elements in the structure are part of the current path of the XML-rules processor. To prevent errors that might cause the XML-rules processor to become invalid, the following limitations are placed on XML structure changes you might make within an XML rule:</p>
<ul>
<li>Deleting an ancestor XML element - To delete an ancestor XML element of the matched XML element, create a separate rule that matches and processes the ancestor XML element.</li>
<li>Inserting a parent XML element - To add an ancestor XML element to the matched XML element, do so after processing the current XML element. The ancestor XML element you add is not processed by the XML-rules processor during this rule iteration (as it appears "above" the current element in the hierarchy).</li>
<li>Deleting the current XML element - You cannot delete or move the matched XML element until any child XML elements contained by the element are processed. To make this sort of change, use the __skipChildren function before making the change.</li>
<li>No repetitive processing - Changes to nodes that were already processed will not cause the XML rule to be evaluated again.</li>
</ul>
<p><b>Handling multiple matching rules</b></p>
<p>When multiple rules match an XML element, the XML-rules processor can apply some or all of the matching rules. XML rules are applied in the order in which they appear in the rule set, up to the point that one of the rule apply functions returns true. In essence, returning true means the element was processed. Once a rule returns true, any other XML rules matching the XML element are ignored. You can alter this behavior and allow the next matching rule to be applied, by having the XML rule apply function return false.</p>
<p>When an apply function returns false, you can control the matching behavior of the XML rule based on a condition other than the XPath property defined in the XML rule, like the state of another variable in the script.</p>
<p><b>XPath limitations</b></p>
<p>InDesign's XML rules support a limited subset of the XPath 1.0 specification, specifically including the following capabilities:</p>
<ul>
<li>Find an element by name, specifying a path from the root; for example, /doc/title.</li>
<li>Find paths with wildcards and node matches; for example,/doc/* /subtree/node().</li>
<li>Find an element with a specified attribute that matches a specified value; for example, /doc/para[@font='Courier'].</li>
<li>Find an element with a specified attribute that does not match a specified value; for example, /doc/para[@font !='Courier'].</li>
<li>Find a child element by numeric position (but not last()); for example, /doc/para[3].</li>
<li>Find self or any descendent; for example, //para.</li>
<li>Find comment as a terminal; for example, /doc/comment().</li>
<li>Find PI by target or any; for example, /doc/processing-instruction('foo').</li>
<li>Find multiple predicates; for example, /doc/para[@font='Courier'][@size=5][2].</li>
<li>Find along following-sibling axes; for example,/doc/note/following-sibling::*.</li>
</ul>
<p>Due to the one-pass nature of this implementation, the following XPath expressions are specifically excluded:</p>
<ul>
<li>No ancestor or preceding-sibling axes, including..,ancestor::, preceding-sibling::.</li>
<li>No path specifications in predicates; for example, foo[bar/c].</li>
<li>No last() function.</li>
<li>No text() function or text comparisons; however, you can use InDesign scripting to examine the text content of an XML element matched by a given XML rule.</li>
<li>No compound Boolean predicates; for example, foo[@bar=font or @c=size].</li>
<li>No relational predicates; for example,foo[@bar&lt;font or @c&gt;3].</li>
<li>No relative paths; for example, doc/chapter.</li>
</ul>
<p><b>Error handling</b></p>
<p>Because XML rules are part of the InDesign scripting model, scripts that use rules do not differ in nature from ordinary scripts, and they benefit from the same error-handling mechanism. When InDesign generates an error, an XML-rules script behaves no differently than any other script. InDesign errors can be captured in the script using whatever tools the scripting language provides to achieve that; for example, try...catch blocks.</p>
<p>InDesign does include a series of errors specific to XML-rules processing. An InDesign error can occur at XML-rules processor initialization, when a rule uses a non-conforming XPath specifier (see "XPath limitations" in <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_overview">XML Rules Overview</a> ). An InDesign error also can be caused by a model change that invalidates the state of an XML-rules processor. XML structure changes caused by the operation of XML rules can invalidate the XML-rules processor. These changes to the XML structure can be caused by the script containing the XML-rules processor, another concurrently executing script, or a user action initiated from the user interface.</p>
<p>XML structure changes that invalidate an XML-rules processor lead to errors when the XML-rules processor's iteration resumes. The error message indicates which XML structural change caused the error.</p>
<p><b>XML rules flow of control</b></p>
<p>As a script containing XML rules executes, the flow of control passes from the script function containing the XML rules to each XML rule, and from each rule to the functions defined in the glue code. Those functions pass control to the XML-rules processor which, in turn, iterates through the XML elements in the structure. Results and errors are passed back up the chain until they are handled by a function or cause a scripting error. The following diagram provides a simplified overview of the flow of control in an XML-rules script:</p>
<div class="image">
<img src="InDesign_ScriptingGuide-14.gif" alt="InDesign_ScriptingGuide-14.gif"/>
</div>
<h2><a class="anchor" id="id_vb_xml_rules_examples"></a>
XML Rules Examples</h2>
<p>Because XML rules rely on XPath statements to find qualifying XML elements, XML rules are closely tied to the structure of the XML in a document. This means it is almost impossible to demonstrate a functional XML-rules script without having an XML structure to test it against. In the remainder of this section, we present a series of XML-rules exercises based on a sample XML data file. For our example, we use the product list of an imaginary integrated-circuit manufacturer. Each record in the XML data file has the following structure: </p>
<div class="fragment"><div class="line">&lt;device&gt;</div>
<div class="line">    &lt;name&gt;&lt;/name&gt;</div>
<div class="line">    &lt;type&gt;&lt;/type&gt;</div>
<div class="line">    &lt;part_number&gt;&lt;/part_number&gt;</div>
<div class="line">    &lt;supply_voltage&gt;</div>
<div class="line">        &lt;minimum&gt;&lt;/minimum&gt;</div>
<div class="line">        &lt;maximum&gt;&lt;/maximum&gt;</div>
<div class="line">    &lt;/supply_voltage&gt;</div>
<div class="line">    &lt;package&gt;</div>
<div class="line">        &lt;type&gt;&lt;/type&gt;</div>
<div class="line">        &lt;pins&gt;&lt;/pins&gt;</div>
<div class="line">    &lt;/package&gt;</div>
<div class="line">    &lt;price&gt;&lt;/price&gt;</div>
<div class="line">    &lt;description&gt;&lt;/description&gt;</div>
<div class="line">&lt;/device&gt;</div>
</div><!-- fragment --><p>The scripts are presented in order of complexity, starting with a very simple script and building toward more complex operations.</p>
<h3><a class="anchor" id="id_vb_setting_up_a_sample_document"></a>
Setting up a sample document</h3>
<p>Before you run each script in this section, import the XMLRulesExampleData.xml data file into a document. When you import the XML, turn on the Do Not Import Contents of Whitespace-Only Elements option in the XML Import Options dialog box. Save the file, then choose File &gt; Revert before running each sample script in this section. Alternately, run the following script before you run each sample XML-rule script (see the XMLRulesExampleSetup.jsx script file): </p>
<div class="fragment"><div class="line">main();</div>
<div class="line"><span class="keyword">function</span> main(){</div>
<div class="line">    var myDocument = app.documents.add();</div>
<div class="line">    myDocument.xmlImportPreferences.allowTransform = <span class="keyword">false</span>;</div>
<div class="line">    myDocument.xmlImportPreferences.ignoreWhitespace = <span class="keyword">true</span>;</div>
<div class="line">    var myScriptPath = myGetScriptPath();</div>
<div class="line">    var myFilePath = myScriptPath.path + <span class="stringliteral">&quot;/XMLRulesExampleData.xml&quot;</span></div>
<div class="line">    myDocument.importXML(File(myFilePath));</div>
<div class="line">    var myBounds = myGetBounds(myDocument, myDocument.pages.item(0));</div>
<div class="line">    myDocument.xmlElements.item(0).placeIntoFrame(myDocument.pages.item(0), myBounds);</div>
<div class="line">    <span class="keyword">function</span> myGetBounds(myDocument, myPage){</div>
<div class="line">        var myWidth = myDocument.documentPreferences.pageWidth;</div>
<div class="line">        var myHeight = myDocument.documentPreferences.pageHeight;</div>
<div class="line">        var myX1 = myPage.marginPreferences.left;</div>
<div class="line">        var myY1 = myPage.marginPreferences.top;</div>
<div class="line">        var myX2 = myWidth - myPage.marginPreferences.right;</div>
<div class="line">        var myY2 = myHeight - myPage.marginPreferences.bottom;</div>
<div class="line">        <span class="keywordflow">return</span> [myY1, myX1, myY2, myX2];</div>
<div class="line">    }</div>
<div class="line">    <span class="keyword">function</span> myGetScriptPath() {</div>
<div class="line">        <span class="keywordflow">try</span> {</div>
<div class="line">            <span class="keywordflow">return</span> app.activeScript;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span>(myError){</div>
<div class="line">            <span class="keywordflow">return</span> File(myError.fileName);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_getting_started_with_xml_rules"></a>
Getting started with XML rules</h3>
<p>Here is a very simple XML rule-it does nothing more than add a return character after every XML element in the document. The XML-rule set contains one rule. For the complete script, see AddReturns. </p>
<div class="fragment"><div class="line">   Set myInDesign = CreateObject(<span class="stringliteral">&quot;InDesign.Application.2024&quot;</span>)</div>
<div class="line">   Set myDocument = myInDesign.ActiveDocument</div>
<div class="line">   myFilePath = myInDesign.FilePath</div>
<div class="line">   myFilePath = myFilePath &amp; &quot;\Scripts\Xml rules\glue code.vbs&quot;</div>
<div class="line">   Rem Use the Include function to load the glue code file.</div>
<div class="line">   Include myFilePath</div>
<div class="line">   Set myAddReturns = new AddReturns</div>
<div class="line">   myRuleSet = Array(myAddReturns)</div>
<div class="line">   Rem The fourth parameter of __processRuleSet is a</div>
<div class="line">   Rem prefix mapping table; we&#39;ll leave it empty.</div>
<div class="line">   glueCode_ProcessRuleSet myInDesign, myDocument.XMLElements.Item(1), myRuleSet, Array() </div>
</div><!-- fragment --><div class="fragment"><div class="line">Rem XML rule <span class="stringliteral">&quot;AddReturns&quot;</span></div>
<div class="line">Class AddReturns</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = <span class="stringliteral">&quot;AddReturns&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = <span class="stringliteral">&quot;//*&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Public Function apply (myXMLElement, myRulesProcessor)</div>
<div class="line">        With myXMLElement</div>
<div class="line">            Rem Add a return character at the end of the XML element.</div>
<div class="line">            .InsertTextAsContent vbcr, idXMLElementPosition.idElementEnd</div>
<div class="line">        End With</div>
<div class="line">        apply = False</div>
<div class="line">    End Function </div>
<div class="line">End Class</div>
<div class="line">Function Include(myScriptFilePath)</div>
<div class="line">    Set myFileSystemObject = CreateObject(&quot;Scripting.FileSystemObject&quot;)</div>
<div class="line">    Set myScriptFile = myFileSystemObject.OpenTextFile(myScriptFilePath)</div>
<div class="line">    myScriptContents = myScriptFile.ReadAll</div>
<div class="line">    ExecuteGlobal myScriptContents</div>
<div class="line">End Function</div>
</div><!-- fragment --><p> <b>Adding white space and static text</b></p>
<p>The following XML rule script is similar to the previous script, in that it adds white space and static text. It is somewhat more complex, however, in that it treats some XML elements differently based on their element names. For the complete script, see AddReturnsAndStaticText. </p>
<div class="fragment"><div class="line">   Set myInDesign = CreateObject(<span class="stringliteral">&quot;InDesign.Application.2024&quot;</span>)</div>
<div class="line">   Set myDocument = myInDesign.ActiveDocument</div>
<div class="line">   myFilePath = myInDesign.FilePath</div>
<div class="line">   myFilePath = myFilePath &amp; &quot;\Scripts\Xml rules\glue code.vbs&quot;</div>
<div class="line">   Rem Use the Include function to load the glue code file.</div>
<div class="line">   Include myFilePath</div>
<div class="line">   myRuleSet = Array(new ProcessDevice,new ProcessName,new ProcessType,_</div>
<div class="line">   new ProcessPartNumber,new ProcessSupplyVoltage,new ProcessPackageType,_</div>
<div class="line">   new ProcessPackageOne,new ProcessPackages,new ProcessPrice)</div>
<div class="line">   Rem The fourth parameter of __processRuleSet is a</div>
<div class="line">   Rem prefix mapping table; we&#39;ll leave it empty.</div>
<div class="line">   glueCode_ProcessRuleSet myInDesign, myDocument.XMLElements.Item(1), myRuleSet, Array() </div>
</div><!-- fragment --><div class="fragment"><div class="line">Class ProcessDevice</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = <span class="stringliteral">&quot;ProcessDevice&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = <span class="stringliteral">&quot;/devices/device&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Public Function  apply (myXMLElement, myRulesProcessor)</div>
<div class="line">        With myXMLElement</div>
<div class="line">            .InsertTextAsContent vbcr, idXMLElementPosition.idAfterElement</div>
<div class="line">        End With</div>
<div class="line">        apply = False</div>
<div class="line">    End Function </div>
<div class="line">End Class</div>
<div class="line">Class ProcessName</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = &quot;ProcessName&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = &quot;/devices/device/name&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Function  apply (myXMLElement, myRulesProcessor)</div>
<div class="line">        With myXMLElement</div>
<div class="line">            Rem Add static text at the beginning of the element.</div>
<div class="line">            .InsertTextAsContent &quot;Device Name:&quot;, idXMLElementPosition.idBeforeElement</div>
<div class="line">            Rem Add a return character at the end of the element.</div>
<div class="line">            .InsertTextAsContent vbcr, idXMLElementPosition.idAfterElement</div>
<div class="line">        End With</div>
<div class="line">        apply = False</div>
<div class="line">    End Function </div>
<div class="line">End Class</div>
<div class="line">Class ProcessType</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = &quot;ProcessType&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = &quot;/devices/device/type&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Function  apply (myXMLElement, myRulesProcessor)</div>
<div class="line">        With myXMLElement</div>
<div class="line">            Rem Add static text at the beginning of the element.</div>
<div class="line">            .InsertTextAsContent &quot;Circuit Type:&quot;, idXMLElementPosition.idBeforeElement</div>
<div class="line">            Rem Add a return character at the end of the element.</div>
<div class="line">            .InsertTextAsContent vbcr, idXMLElementPosition.idAfterElement</div>
<div class="line">        End With</div>
<div class="line">        apply = False</div>
<div class="line">    End Function </div>
<div class="line">End Class</div>
<div class="line">Class ProcessPartNumber</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = &quot;ProcessPartNumber&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = &quot;/devices/device/part_number&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Function  apply (myXMLElement, myRulesProcessor)</div>
<div class="line">        With myXMLElement</div>
<div class="line">            Rem Add static text at the beginning of the element.</div>
<div class="line">            .InsertTextAsContent &quot;Part Number:&quot;, idXMLElementPosition.idBeforeElement</div>
<div class="line">            Rem Add a return character at the end of the element.</div>
<div class="line">            .InsertTextAsContent vbcr, idXMLElementPosition.idAfterElement</div>
<div class="line">        End With</div>
<div class="line">        apply = False</div>
<div class="line">    End Function </div>
<div class="line">End Class</div>
<div class="line">Rem Adds static text around the &quot;minimum&quot; and &quot;maximum&quot;</div>
<div class="line">Rem XML elements of the &quot;supply_voltage&quot; XML element.</div>
<div class="line"></div>
<div class="line">Class ProcessSupplyVoltage</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = &quot;ProcessSupplyVoltage&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = &quot;/devices/device/supply_voltage&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Function  apply (myXMLElement, myRulesProcessor)</div>
<div class="line">        With myXMLElement</div>
<div class="line">            .InsertTextAsContent &quot;Supply Voltage: From &quot;, idXMLElementPosition.idBeforeElement          </div>
<div class="line">            With myXMLElement.XMLElements.Item(1)</div>
<div class="line">                .InsertTextAsContent &quot; to &quot;, idXMLElementPosition.idAfterElement</div>
<div class="line">            End with</div>
<div class="line">            With myXMLElement.XMLElements.Item(-1)</div>
<div class="line">                Rem Add static text to the end of the voltage range.</div>
<div class="line">                .InsertTextAsContent &quot; volts&quot;, idXMLElementPosition.idAfterElement</div>
<div class="line">            End with</div>
<div class="line">            Rem Add a return at the end of the XML element.</div>
<div class="line">            .InsertTextAsContent vbcr, idXMLElementPosition.idAfterElement</div>
<div class="line">        End With</div>
<div class="line">        apply = True</div>
<div class="line">    End Function </div>
<div class="line">End Class</div>
<div class="line">Rem Insert a dash between the &quot;type&quot; and &quot;pins&quot; elements.</div>
<div class="line">Class ProcessPackageType</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = &quot;ProcessPackageType&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = &quot;/devices/device/package/type&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Function  apply (myXMLElement, myRulesProcessor)</div>
<div class="line">        With myXMLElement</div>
<div class="line">            .InsertTextAsContent &quot;-&quot;, idXMLElementPosition.idAfterElement</div>
<div class="line">        End With</div>
<div class="line">        apply = true</div>
<div class="line">    End Function </div>
<div class="line">End Class</div>
<div class="line">Rem Process the first &quot;package&quot; element.</div>
<div class="line">Class ProcessPackageOne</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = &quot;ProcessPackageOne&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = &quot;/devices/device/package[1]&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Function  apply (myXMLElement, myRulesProcessor)</div>
<div class="line">        With myXMLElement</div>
<div class="line">            .InsertTextAsContent &quot;Package: &quot;, idXMLElementPosition.idBeforeElement</div>
<div class="line">        End With</div>
<div class="line">        apply = true</div>
<div class="line">    End Function </div>
<div class="line">End Class</div>
<div class="line">Rem Process the remaining &quot;package&quot; elements.</div>
<div class="line">Class ProcessPackages</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = &quot;ProcessPackages&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = &quot;/devices/device/package&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Function  apply (myXMLElement, myRulesProcessor)</div>
<div class="line">        With myXMLElement</div>
<div class="line">            .InsertTextAsContent&quot;, &quot;, idXMLElementPosition.idBeforeElement</div>
<div class="line">        End With</div>
<div class="line">        apply = True</div>
<div class="line">    End Function </div>
<div class="line">End Class</div>
<div class="line">Class ProcessPrice</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = &quot;ProcessPrice&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = &quot;/devices/device/price&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Function  apply (myXMLElement, myRulesProcessor)</div>
<div class="line">        With myXMLElement</div>
<div class="line">            Rem Add a return at the start of the XML element.</div>
<div class="line">            .InsertTextAsContent vbCr &amp; &quot;Price: $&quot;, idXMLElementPosition.idBeforeElement</div>
<div class="line">            Rem .InsertTextAsContent &quot;Price: $&quot;, idXMLElementPosition.idBeforeElement</div>
<div class="line">            .InsertTextAsContent vbcr, idXMLElementPosition.idAfterElement</div>
<div class="line">        End With</div>
<div class="line">        apply = False</div>
<div class="line">    End Function </div>
<div class="line">End Class</div>
<div class="line">Function Include(myScriptFilePath)</div>
<div class="line">    Set myFileSystemObject = CreateObject(&quot;Scripting.FileSystemObject&quot;)</div>
<div class="line">    Set myScriptFile = myFileSystemObject.OpenTextFile(myScriptFilePath)</div>
<div class="line">    myScriptContents = myScriptFile.ReadAll</div>
<div class="line">    ExecuteGlobal myScriptContents</div>
<div class="line">End Function</div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>The above script uses scripting logic to add commas between repeating elements (in the ProcessPackages XML rule). If you have a sequence of similar elements at the same level, you can use forward-axis matching to do the same thing. Given the following example XML structure: <div class="fragment"><div class="line">&lt;xmlElement&gt;</div>
<div class="line">    &lt;item&gt;1&lt;/item&gt;</div>
<div class="line">    &lt;item&gt;2&lt;/item&gt;</div>
<div class="line">    &lt;item&gt;3&lt;/item&gt;</div>
<div class="line">    &lt;item&gt;4&lt;/item&gt;</div>
<div class="line">&lt;/xmlElement&gt;</div>
</div><!-- fragment --> To add commas between each item XML element in a layout, you could use an XML rule like the following (from the ListProcessing tutorial script): <div class="fragment"><div class="line">   Set myInDesign = CreateObject(<span class="stringliteral">&quot;InDesign.Application.2024&quot;</span>)</div>
<div class="line">   Set myDocument = myInDesign.ActiveDocument</div>
<div class="line">   myFilePath = myInDesign.FilePath</div>
<div class="line">   myFilePath = myFilePath &amp; &quot;\Scripts\Xml rules\glue code.vbs&quot;</div>
<div class="line">   Rem Use the Include function to load the glue code file.</div>
<div class="line">   Include myFilePath</div>
<div class="line">   myRuleSet = Array(new ListItems)</div>
<div class="line">   glueCode_ProcessRuleSet myInDesign, myDocument.XMLElements.Item(1), myRuleSet, Array() </div>
</div><!-- fragment --><div class="fragment"><div class="line">Class ListItems</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = <span class="stringliteral">&quot;ListItems&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = <span class="stringliteral">&quot;/xmlElement/item[1]/following-sibling::*&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Public Function  apply (myXMLElement, myRulesProcessor)</div>
<div class="line">        With myXMLElement</div>
<div class="line">            .InsertTextAsContent &quot;, &quot;, idXMLElementPosition.idBeforeElement</div>
<div class="line">        End With</div>
<div class="line">        apply = False</div>
<div class="line">    End Function </div>
<div class="line">End Class</div>
</div><!-- fragment --> </dd></dl>
<h3><a class="anchor" id="id_vb_changing_the_xml_structure_using_xml_rules"></a>
Changing the XML structure using XML rules</h3>
<p>Because the order of XML elements is significant in InDesign's XML implementation, you might need to use XML rules to change the sequence of elements in the structure. In general, large-scale changes to the structure of an XML document are best done using an XSLT file to transform the document before or during XML import into InDesign.</p>
<p>The following XML rule script shows how to use the move method to accomplish this. Note the use of the __skipChildren function from the glue code to prevent the XML-rules processor from becoming invalid. For the complete script, see MoveXMLElement. </p>
<div class="fragment"><div class="line">   Set myInDesign = CreateObject(<span class="stringliteral">&quot;InDesign.Application.2024&quot;</span>)</div>
<div class="line">   If myInDesign.Documents.Count &gt; 0 Then</div>
<div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    myFilePath = myInDesign.FilePath</div>
<div class="line">    myFilePath = myFilePath &amp; &quot;\Scripts\Xml rules\glue code.vbs&quot;</div>
<div class="line">    Rem Use the Include function to load the glue code file.</div>
<div class="line">    Include myFilePath</div>
<div class="line">    myRuleSet = Array(new MoveElement)</div>
<div class="line">    glueCode_ProcessRuleSet myInDesign, myDocument.XMLElements.Item(1), myRuleSet, Array()</div>
<div class="line">   End If</div>
</div><!-- fragment --><div class="fragment"><div class="line">Class MoveElement</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = <span class="stringliteral">&quot;MoveElement&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = <span class="stringliteral">&quot;/devices/device/part_number&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Rem Moves the part_number XML element to the start of </div>
<div class="line">    Rem the device XML element (the parent).</div>
<div class="line">    Public Function  apply (myXMLElement, myRuleProcessor)</div>
<div class="line">        Rem Because this rule makes changes to the XML structure,</div>
<div class="line">        Rem you must use _skipChildren to avoid invalidating</div>
<div class="line">        Rem the XML element references.</div>
<div class="line">        glueCode_skipChildren(myRuleProcessor)</div>
<div class="line">        With myXMLElement</div>
<div class="line">            .Move idLocationOptions.idAtBeginning, myXMLElement.parent</div>
<div class="line">        End With</div>
<div class="line">        apply = false</div>
<div class="line">    End Function </div>
<div class="line">End Class</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_duplicating_xml_elements_with_xml_rules"></a>
Duplicating XML elements with XML rules</h3>
<p>XML elements have a one-to-one relationship with their expression in a layout. If you want the content of an XML element to appear more than once in a layout, you need to duplicate the element. The following script shows how to duplicate elements using XML rules. For the complete script, see DuplicateXMLElement. Again, this rule uses __skipChildren to avoid invalid XML object references. </p>
<div class="fragment"><div class="line">   Set myInDesign = CreateObject(<span class="stringliteral">&quot;InDesign.Application.2024&quot;</span>)</div>
<div class="line">   If myInDesign.Documents.Count &gt; 0 Then</div>
<div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    myFilePath = myInDesign.FilePath</div>
<div class="line">    myFilePath = myFilePath &amp; &quot;\Scripts\Xml rules\glue code.vbs&quot;</div>
<div class="line">    Rem Use the Include function to load the glue code file.</div>
<div class="line">    Include myFilePath</div>
<div class="line">    myRuleSet = Array(new DuplicateElement)</div>
<div class="line">    glueCode_ProcessRuleSet myInDesign, myDocument.XMLElements.Item(1), myRuleSet, Array()</div>
<div class="line">   End If</div>
</div><!-- fragment --><div class="fragment"><div class="line">Class DuplicateElement</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = <span class="stringliteral">&quot;DuplicateElement&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = <span class="stringliteral">&quot;/devices/device/part_number&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Rem Moves the part_number XML element to the start of </div>
<div class="line">    Rem the device XML element (the parent).</div>
<div class="line">    Public Function  apply (myXMLElement, myRuleProcessor)</div>
<div class="line">        Rem Because this rule makes changes to the XML structure,</div>
<div class="line">        Rem you must use _skipChildren to avoid invalidating</div>
<div class="line">        Rem the XML element references.</div>
<div class="line">        glueCode_skipChildren(myRuleProcessor)</div>
<div class="line">        With myXMLElement</div>
<div class="line">            .Duplicate</div>
<div class="line">        End With</div>
<div class="line">        apply = false</div>
<div class="line">    End Function </div>
<div class="line">End Class</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_xml_rules_and_xml_attributes"></a>
XML rules and XML attributes</h3>
<p>The following XML rule adds attributes to XML elements based on the content of their "name" element. When you need to find an element by its text contents, copying or moving XML element contents to XML attributes attached to their parent XML element can be very useful in XML-rule scripting. While the subset of XPath supported by XML rules cannot search the text of an element, it can find elements by a specified attribute value. For the complete script, see AddAttribute. </p>
<div class="fragment"><div class="line">   Set myInDesign = CreateObject(<span class="stringliteral">&quot;InDesign.Application.2024&quot;</span>)</div>
<div class="line">   If myInDesign.Documents.Count &gt; 0 Then</div>
<div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    myFilePath = myInDesign.FilePath</div>
<div class="line">    myFilePath = myFilePath &amp; &quot;\Scripts\Xml rules\glue code.vbs&quot;</div>
<div class="line">    Rem Use the Include function to load the glue code file.</div>
<div class="line">    Include myFilePath</div>
<div class="line">    myRuleSet = Array(new AddAttribute)</div>
<div class="line">    glueCode_ProcessRuleSet myInDesign, myDocument.XMLElements.Item(1), myRuleSet, Array()</div>
<div class="line">   End If</div>
</div><!-- fragment --><div class="fragment"><div class="line">Class AddAttribute</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = <span class="stringliteral">&quot;AddAttribute&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = <span class="stringliteral">&quot;/devices/device/part_number&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Rem Adds the content of the XML element to an attribute </div>
<div class="line">    Rem of the parent of the XML element. This can make finding</div>
<div class="line">    Rem the element by its content much easier and faster.</div>
<div class="line">    Public Function  apply (myXMLElement, myRuleProcessor)</div>
<div class="line">        With myXMLElement</div>
<div class="line">            Set myParent = .Parent</div>
<div class="line">            myString = myXMLElement.Texts.Item(1).Contents</div>
<div class="line">            Set myXMLAttribute = .Parent.XMLAttributes.Add(&quot;part_number&quot;, myString)</div>
<div class="line">        End With</div>
<div class="line">        apply = false</div>
<div class="line">    End Function </div>
<div class="line">End Class</div>
</div><!-- fragment --><p> In the previous XML rule, we copied the data from an XML element into an XML attribute attached to its parent XML element. Instead, what if we want to move the XML element data into an attribute and remove the XML element itself? Use the convertToAttribute method, as shown in the following script (from the ConvertToAttribute tutorial script): </p>
<div class="fragment"><div class="line">   Set myInDesign = CreateObject(<span class="stringliteral">&quot;InDesign.Application.2024&quot;</span>)</div>
<div class="line">   If myInDesign.Documents.Count &gt; 0 Then</div>
<div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    myFilePath = myInDesign.FilePath</div>
<div class="line">    myFilePath = myFilePath &amp; &quot;\Scripts\Xml rules\glue code.vbs&quot;</div>
<div class="line">    Rem Use the Include function to load the glue code file.</div>
<div class="line">    Include myFilePath</div>
<div class="line">    myRuleSet = Array(new ConvertToAttribute)</div>
<div class="line">    glueCode_ProcessRuleSet myInDesign, myDocument.XMLElements.Item(1), myRuleSet, Array()</div>
<div class="line">   End If</div>
</div><!-- fragment --><div class="fragment"><div class="line">Class ConvertToAttribute</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = <span class="stringliteral">&quot;ConvertToAttribute&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = <span class="stringliteral">&quot;/devices/device/part_number&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Rem Converts an XML element to an attribute </div>
<div class="line">    Rem of the parent of the XML element.</div>
<div class="line">    Public Function  apply (myXMLElement, myRuleProcessor)</div>
<div class="line">        glueCode_skipChildren(myRuleProcessor)</div>
<div class="line">        With myXMLElement</div>
<div class="line">            .ConvertToAttribute</div>
<div class="line">        End With</div>
<div class="line">        apply = true</div>
<div class="line">    End Function </div>
<div class="line">End Class</div>
</div><!-- fragment --><p> To move data from an XML attribute to an XML element, use the convertToElement method, as described in <a class="el" href="id_vb_adobe_indesign_cc_scripting_guide_vbscript.html#id_vb_xml">XML</a>.</p>
<h3><a class="anchor" id="id_vb_applying_multiple_matching_rules"></a>
Applying multiple matching rules</h3>
<p>When the apply function of an XML rule returns true, the XML-rules processor does not apply any further XML rules to the matched XML element. When the apply function returns false, however, the XML-rules processor can apply other rules to the XML element. The following script shows an example of an XML-rule apply function that returns false. This script contains two rules that will match every XML element in the document. The only difference between them is that the first rule applies a color and returns false, while the second rule applies a different color to every other XML element (based on the state of a variable, myCounter). For the complete script, see ReturningFalse. </p>
<div class="fragment"><div class="line">   myCounter = 0</div>
<div class="line">   Set myInDesign = CreateObject(<span class="stringliteral">&quot;InDesign.Application.2024&quot;</span>)</div>
<div class="line">   If myInDesign.Documents.Count &gt; 0 Then</div>
<div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Rem Define two colors.</div>
<div class="line">    Set myColorA = myAddColor(myDocument, &quot;ColorA&quot;, idColorModel.idProcess, Array(0, 100, 80, 0))</div>
<div class="line">    Set myColorB = myAddColor(myDocument, &quot;ColorB&quot;, idColorModel.idProcess, Array(100, 0, 80, 0))   </div>
<div class="line">    myFilePath = myInDesign.FilePath</div>
<div class="line">    myFilePath = myFilePath &amp; &quot;\Scripts\Xml rules\glue code.vbs&quot;</div>
<div class="line">    Rem Use the Include function to load the glue code file.</div>
<div class="line">    Include myFilePath</div>
<div class="line">    myRuleSet = Array(new ReturnFalse, new ReturnTrue)</div>
<div class="line">    glueCode_ProcessRuleSet myInDesign, myDocument.XMLElements.Item(1), myRuleSet, Array()</div>
<div class="line">   End If</div>
</div><!-- fragment --><div class="fragment"><div class="line">   Rem Adds a color to the text of every element in the structure.</div>
<div class="line">   Class ReturnFalse</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = <span class="stringliteral">&quot;ReturnFalse&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = <span class="stringliteral">&quot;//*&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Public Function  apply (myXMLElement, myRuleProcessor)</div>
<div class="line">        Set myInDesign = CreateObject(&quot;InDesign.Application.2024&quot;)</div>
<div class="line">        Set myColorA = myInDesign.Documents.Item(1).Colors.Item(&quot;ColorA&quot;)</div>
<div class="line">        With myXMLElement</div>
<div class="line">            .Texts.Item(1).FillColor = myColorA</div>
<div class="line">        End With</div>
<div class="line">        Rem Leaves the XML element available to further processing.</div>
<div class="line">        apply = false</div>
<div class="line">    End Function </div>
<div class="line">   End Class</div>
<div class="line">   Rem Adds a color to the text of every other element in the structure.</div>
<div class="line">   Class ReturnTrue</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = &quot;ReturnTrue&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = &quot;<span class="comment">//*&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Public Function  apply (myXMLElement, myRuleProcessor)</div>
<div class="line">        With myXMLElement</div>
<div class="line">            Rem Test based on the global variable &quot;myCounter&quot;</div>
<div class="line">            If myCounter Mod 2 = 0 Then</div>
<div class="line">                Set myInDesign = CreateObject(&quot;InDesign.Application.2024&quot;)</div>
<div class="line">                Set myColorB = myInDesign.Documents.Item(1).Colors.Item(&quot;ColorB&quot;)</div>
<div class="line">                .Texts.Item(1).FillColor = myColorB</div>
<div class="line">            End If</div>
<div class="line">            myCounter = myCounter + 1</div>
<div class="line">        End With</div>
<div class="line">        Rem Do not process the element with any further matching rules.</div>
<div class="line">        apply = true</div>
<div class="line">    End Function </div>
<div class="line">   End Class</div>
<div class="line">   Function Include(myScriptFilePath)</div>
<div class="line">    Set myFileSystemObject = CreateObject(&quot;Scripting.FileSystemObject&quot;)</div>
<div class="line">    Set myScriptFile = myFileSystemObject.OpenTextFile(myScriptFilePath)</div>
<div class="line">    myScriptContents = myScriptFile.ReadAll</div>
<div class="line">    ExecuteGlobal myScriptContents</div>
<div class="line">   End Function</div>
<div class="line">   Function myAddColor(myDocument, myColorName, myColorModel, myColorValue)</div>
<div class="line">       On Error Resume Next</div>
<div class="line">       Set myColor = myDocument.colors.Item(myColorName)</div>
<div class="line">       If Err.Number &lt;&gt; 0 Then</div>
<div class="line">           Set myColor = myDocument.colors.Add</div>
<div class="line">        myColor.Name = myColorName</div>
<div class="line">        Err.Clear</div>
<div class="line">       End If</div>
<div class="line">       On Error GoTo 0</div>
<div class="line">       myColor.model = myColorModel</div>
<div class="line">       myColor.colorValue = myColorValue</div>
<div class="line">       Set myAddColor = myColor</div>
<div class="line">   End Function</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_finding_xml_elements"></a>
Finding XML elements</h3>
<p>As noted earlier, the subset of XPath supported by XML rules does not allow for searching the text contents of XML elements. To get around this limitation, you can either use attributes to find the XML elements you want or search the text of the matching XML elements. The following script shows how to match XML elements using attributes. This script applies a color to the text of elements it finds, but a practical script would do more. For the complete script, see FindXMLElementByAttribute. </p>
<div class="fragment"><div class="line">   Set myInDesign = CreateObject(<span class="stringliteral">&quot;InDesign.Application.2024&quot;</span>)</div>
<div class="line">   If myInDesign.Documents.Count &gt; 0 Then</div>
<div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Rem Define two colors.</div>
<div class="line">    Set myColorA = myAddColor(myDocument, &quot;ColorA&quot;, idColorModel.idProcess, Array(0, 100, 80, 0))</div>
<div class="line">    myFilePath = myInDesign.FilePath</div>
<div class="line">    myFilePath = myFilePath &amp; &quot;\Scripts\Xml rules\glue code.vbs&quot;</div>
<div class="line">    Rem Use the Include function to load the glue code file.</div>
<div class="line">    Include myFilePath</div>
<div class="line">    myRuleSet = Array(new AddAttribute)</div>
<div class="line">    glueCode_ProcessRuleSet myInDesign, myDocument.XMLElements.Item(1), myRuleSet, Array()</div>
<div class="line">    Rem Now that the attributes have been added, find and format</div>
<div class="line">    Rem the XML element whose attribute content matches a specific <span class="keywordtype">string</span>.</div>
<div class="line">    myRuleSet = Array(new FindAttribute)</div>
<div class="line">    glueCode_ProcessRuleSet myInDesign, myDocument.XMLElements.Item(1), myRuleSet, Array()</div>
<div class="line">   End If</div>
</div><!-- fragment --><div class="fragment"><div class="line">Class AddAttribute</div>
<div class="line">   Public Property Get name</div>
<div class="line">      name = <span class="stringliteral">&quot;AddAttribute&quot;</span></div>
<div class="line">   End Property</div>
<div class="line">   Public Property Get xpath</div>
<div class="line">      xpath = <span class="stringliteral">&quot;/devices/device/part_number&quot;</span></div>
<div class="line">   End Property</div>
<div class="line">   Rem Adds the content of the XML element to an attribute </div>
<div class="line">   Rem of the parent of the XML element. This can make finding</div>
<div class="line">   Rem the element by its content much easier and faster.</div>
<div class="line">   Public Function  apply (myXMLElement, myRuleProcessor)</div>
<div class="line">      With myXMLElement</div>
<div class="line">         Set myParent = .Parent</div>
<div class="line">         myString = myXMLElement.Texts.Item(1).Contents</div>
<div class="line">         Set myXMLAttribute = .Parent.XMLAttributes.Add(&quot;part_number&quot;, myString)</div>
<div class="line">      End With</div>
<div class="line">      apply = false</div>
<div class="line">   End Function </div>
<div class="line">End Class</div>
<div class="line">Class FindAttribute</div>
<div class="line">   Public Property Get name</div>
<div class="line">      name = &quot;FindAttribute&quot;</div>
<div class="line">   End Property</div>
<div class="line">   Public Property Get xpath</div>
<div class="line">      xpath = &quot;/devices/device[@part_number = &#39;DS001&#39;]&quot;</div>
<div class="line">   End Property</div>
<div class="line">   Rem Applies a color to the text of an XML element</div>
<div class="line">   Rem (to show that we found it).</div>
<div class="line">   Public Function  apply (myXMLElement, myRuleProcessor)</div>
<div class="line">      Set myInDesign = CreateObject(&quot;InDesign.Application.2024&quot;)</div>
<div class="line">      Set myColorA = myInDesign.Documents.Item(1).Colors.Item(&quot;ColorA&quot;)</div>
<div class="line">      With myXMLElement</div>
<div class="line">         .Texts.Item(1).FillColor = myColorA</div>
<div class="line">      End With</div>
<div class="line">      apply = false</div>
<div class="line">   End Function </div>
<div class="line">End Class</div>
</div><!-- fragment --><p> The following script shows how to use the findText method to find and format XML content (for the complete script, see FindXMLElementByFindText): </p>
<div class="fragment"><div class="line">   Set myInDesign = CreateObject(<span class="stringliteral">&quot;InDesign.Application.2024&quot;</span>)</div>
<div class="line">   If myInDesign.Documents.Count &gt; 0 Then</div>
<div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Rem Define two colors.</div>
<div class="line">    Set myColorA = myAddColor(myDocument, &quot;ColorA&quot;, idColorModel.idProcess, Array(0, 100, 80, 0))</div>
<div class="line">    myFilePath = myInDesign.FilePath</div>
<div class="line">    myFilePath = myFilePath &amp; &quot;\Scripts\Xml rules\glue code.vbs&quot;</div>
<div class="line">    Rem Use the Include function to load the glue code file.</div>
<div class="line">    Include myFilePath</div>
<div class="line">    myRuleSet = Array(new FindByFindText)</div>
<div class="line">    glueCode_ProcessRuleSet myInDesign, myDocument.XMLElements.Item(1), myRuleSet, Array()</div>
<div class="line">   End If</div>
</div><!-- fragment --><div class="fragment"><div class="line">Class FindByFindText</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = <span class="stringliteral">&quot;FindByFindText&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = <span class="stringliteral">&quot;/devices/device/description&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Public Function  apply (myXMLElement, myRuleProcessor)</div>
<div class="line">        Set myInDesign = CreateObject(&quot;InDesign.Application.2024&quot;)</div>
<div class="line">        With myXMLElement       </div>
<div class="line">            myResetFindText myInDesign</div>
<div class="line">            If .Texts.Item(1).contents &lt;&gt; &quot;&quot; Then</div>
<div class="line">                Rem Set the find options.</div>
<div class="line">                myInDesign.FindChangeTextOptions.CaseSensitive = False</div>
<div class="line">                myInDesign.FindChangeTextOptions.IncludeFootnotes = False</div>
<div class="line">                myInDesign.FindChangeTextOptions.IncludeHiddenLayers = False</div>
<div class="line">                myInDesign.FindChangeTextOptions.IncludeLockedLayersForFind = False</div>
<div class="line">                myInDesign.FindChangeTextOptions.IncludeLockedStoriesForFind = False</div>
<div class="line">                myInDesign.FindChangeTextOptions.IncludeMasterPages = False</div>
<div class="line">                myInDesign.FindChangeTextOptions.WholeWord = False</div>
<div class="line">                Rem Search for the word &quot;triangle&quot; in the content of the element.</div>
<div class="line">                myInDesign.FindTextPreferences.FindWhat = &quot;triangle&quot;</div>
<div class="line">                Set myFoundItems = .FindText</div>
<div class="line">                If myFoundItems.Count &gt; 0 Then</div>
<div class="line">                    Set myColorA = myInDesign.Documents.Item(1).Colors.Item(&quot;ColorA&quot;)</div>
<div class="line">                    .Texts.Item(1).FillColor = myColorA</div>
<div class="line">                End If</div>
<div class="line">                myResetFindText myInDesign</div>
<div class="line">            End If</div>
<div class="line">        End With</div>
<div class="line">        apply = false</div>
<div class="line">    End Function </div>
<div class="line">End Class</div>
<div class="line">Function myResetFindText(myInDesign)</div>
<div class="line">&#39;   myInDesign.FindTextPreferences = idNothingEnum.idNothing</div>
<div class="line">&#39;   myInDesign.ChangeTextPreferences = idNothingEnum.idNothing</div>
<div class="line">    myInDesign.FindTextPreferences = 1851876449</div>
<div class="line">    myInDesign.ChangeTextPreferences = 1851876449</div>
<div class="line"></div>
<div class="line">End Function</div>
</div><!-- fragment --><p> The following script shows how to use the findGrep method to find and format XML content (for the complete script, see FindXMLElementByFindGrep): </p>
<div class="fragment"><div class="line">   Set myInDesign = CreateObject(<span class="stringliteral">&quot;InDesign.Application.2024&quot;</span>)</div>
<div class="line">   If myInDesign.Documents.Count &gt; 0 Then</div>
<div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Rem Define two colors.</div>
<div class="line">    Set myColorA = myAddColor(myDocument, &quot;ColorA&quot;, idColorModel.idProcess, Array(0, 100, 80, 0))</div>
<div class="line">    myFilePath = myInDesign.FilePath</div>
<div class="line">    myFilePath = myFilePath &amp; &quot;\Scripts\Xml rules\glue code.vbs&quot;</div>
<div class="line">    Rem Use the Include function to load the glue code file.</div>
<div class="line">    Include myFilePath</div>
<div class="line">    myRuleSet = Array(new FindByFindGrep)</div>
<div class="line">    glueCode_ProcessRuleSet myInDesign, myDocument.XMLElements.Item(1), myRuleSet, Array()</div>
<div class="line">   End If</div>
</div><!-- fragment --><div class="fragment"><div class="line">Class FindByFindGrep</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = <span class="stringliteral">&quot;FindByFindGrep&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = <span class="stringliteral">&quot;/devices/device/description&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Public Function  apply (myXMLElement, myRuleProcessor)</div>
<div class="line">        Set myInDesign = CreateObject(&quot;InDesign.Application.2024&quot;)</div>
<div class="line">        With myXMLElement       </div>
<div class="line">            myResetFindGrep myInDesign</div>
<div class="line">            If .Texts.Item(1).contents &lt;&gt; &quot;&quot; Then</div>
<div class="line">                Rem Search for the regular expression:</div>
<div class="line">                Rem &quot;(?i)pulse.*?triangle|triangle.*?pulse&quot; </div>
<div class="line">                Rem in the content of the element.</div>
<div class="line">                myInDesign.FindGrepPreferences.FindWhat = &quot;(?i)pulse.*?triangle|triangle.*?pulse&quot;</div>
<div class="line">                Set myFoundItems = .FindGrep</div>
<div class="line">                Set myColorA = myInDesign.Documents.Item(1).Colors.Item(&quot;ColorA&quot;)</div>
<div class="line">                If myFoundItems.Count &gt; 0 Then</div>
<div class="line">                    .Texts.Item(1).FillColor = myColorA</div>
<div class="line">                End If</div>
<div class="line">                myResetFindGrep myInDesign</div>
<div class="line">            End If</div>
<div class="line">        End With</div>
<div class="line">        apply = false</div>
<div class="line">    End Function </div>
<div class="line">End Class</div>
<div class="line">Function myResetFindGrep(myInDesign)</div>
<div class="line">    myInDesign.FindTextPreferences = idNothingEnum.idNothing</div>
<div class="line">    myInDesign.ChangeTextPreferences = idNothingEnum.idNothing</div>
<div class="line">End Function</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_extracting_xml_elements_with_xml_rules"></a>
Extracting XML elements with XML rules</h3>
<p>XSLT often is used to extract a specific subset of data from an XML file. You can accomplish the same thing using XML rules. The following sample script shows how to duplicate a set of sample XML elements and move them to another position in the XML element hierarchy. Note that you must add the duplicated XML elements at a point in the XML structure that will not be matched by the XML rule, or you run the risk of creating an endless loop. For the complete script, see ExtractSubset. </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    myFilePath = myInDesign.FilePath</div>
<div class="line">    myFilePath = myFilePath &amp; <span class="stringliteral">&quot;\Scripts\Xml rules\glue code.vbs&quot;</span></div>
<div class="line">    Rem Use the Include <span class="keyword">function</span> to load the glue code file.</div>
<div class="line">    Include myFilePath</div>
<div class="line">    Set myXMLTag = myMakeXMLTag(myDocument, <span class="stringliteral">&quot;VCOs&quot;</span>)</div>
<div class="line">    Set myContainerElement = myDocument.XMLElements.Item(1).XMLElements.Add(myXMLTag)</div>
<div class="line">    myRuleSet = Array(new ExtractVCO)</div>
<div class="line">    glueCode_ProcessRuleSet myInDesign, myDocument.XMLElements.Item(1), myRuleSet, Array()</div>
</div><!-- fragment --><div class="fragment"><div class="line">Class ExtractVCO</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = <span class="stringliteral">&quot;ExtractVCO&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = <span class="stringliteral">&quot;/devices/device/type&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Public Function  apply (myXMLElement, myRuleProcessor)</div>
<div class="line">        With myXMLElement</div>
<div class="line">            If .Texts.Item(1).Contents = &quot;VCO&quot; Then</div>
<div class="line">                Set myDestination = myXMLElement.Parent.Parent.XMLElements.Item(-1)</div>
<div class="line">                Set myNewElement = .Parent.Duplicate</div>
<div class="line">                myNewElement.Move idLocationOptions.idAtEnd, myDestination</div>
<div class="line">            End If</div>
<div class="line">        End With</div>
<div class="line">        apply = false</div>
<div class="line">    End Function </div>
<div class="line">End Class</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_applying_formatting_with_xml_rules"></a>
Applying formatting with XML rules</h3>
<p>The previous XML-rule examples have shown basic techniques for finding XML elements, rearranging the order of XML elements, and adding text to XML elements. Because XML rules are part of scripts, they can perform almost any action-from applying text formatting to creating entirely new page items, pages, and documents. The following XML-rule examples show how to apply formatting to XML elements using XML rules and how to create new page items based on XML-rule matching.</p>
<p>The following script adds static text and applies formatting to the example XML data (for the complete script, see XMLRulesApplyFormatting): </p>
<div class="fragment"><div class="line">   Set myInDesign = CreateObject(<span class="stringliteral">&quot;InDesign.Application.2024&quot;</span>)</div>
<div class="line">   If myInDesign.Documents.Count &gt; 0 Then</div>
<div class="line">    myFilePath = myInDesign.FilePath</div>
<div class="line">    myFilePath = myFilePath &amp; &quot;\Scripts\Xml rules\glue code.vbs&quot;</div>
<div class="line">    Rem Use the Include function to load the glue code file.</div>
<div class="line">    Include myFilePath</div>
<div class="line">   </div>
<div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Rem Document setup</div>
<div class="line">    With myDocument.ViewPreferences</div>
<div class="line">        .HorizontalMeasurementUnits = idMeasurementUnits.idPoints</div>
<div class="line">        .VerticalMeasurementUnits = idMeasurementUnits.idPoints</div>
<div class="line">    End With </div>
<div class="line">    Rem Create a color.</div>
<div class="line">    Set myColor = myAddColor(myDocument, &quot;Red&quot;, idColorModel.idProcess, Array(0, 100, 100, 0))</div>
<div class="line">    Rem Create a series of paragraph styles.</div>
<div class="line">    Set myParagraphStyle = myMakeParagraphStyle(myDocument, &quot;DeviceName&quot;)</div>
<div class="line">    myParagraphStyle.PointSize =24</div>
<div class="line">    myParagraphStyle.Leading = 24</div>
<div class="line">    myParagraphStyle.FillColor = myColor</div>
<div class="line">    myParagraphStyle.SpaceBefore = 24</div>
<div class="line">    Set myParagraphStyle = myMakeParagraphStyle(myDocument, &quot;DeviceType&quot;)</div>
<div class="line">    myParagraphStyle.PointSize =12</div>
<div class="line">    myParagraphStyle.Leading = 12</div>
<div class="line">    myParagraphStyle.FontStyle = &quot;Bold&quot;</div>
<div class="line">    Set myParagraphStyle = myMakeParagraphStyle(myDocument, &quot;PartNumber&quot;)</div>
<div class="line">    myParagraphStyle.PointSize =12</div>
<div class="line">    myParagraphStyle.Leading = 12</div>
<div class="line">    myParagraphStyle.FontStyle = &quot;Bold&quot;</div>
<div class="line">    Set myParagraphStyle = myMakeParagraphStyle(myDocument, &quot;Voltage&quot;)</div>
<div class="line">    myParagraphStyle.PointSize =10</div>
<div class="line">    myParagraphStyle.Leading = 12</div>
<div class="line">    myParagraphStyle.FontStyle = &quot;Bold&quot;</div>
<div class="line">    Set myParagraphStyle = myMakeParagraphStyle(myDocument, &quot;DevicePackage&quot;)</div>
<div class="line">    myParagraphStyle.PointSize =10</div>
<div class="line">    myParagraphStyle.Leading = 12</div>
<div class="line">    Set myParagraphStyle = myMakeParagraphStyle(myDocument, &quot;Price&quot;)</div>
<div class="line">    myParagraphStyle.PointSize =10</div>
<div class="line">    myParagraphStyle.Leading = 12</div>
<div class="line">    myParagraphStyle.FontStyle = &quot;Bold&quot;</div>
<div class="line">    myRuleSet = Array(new ProcessDevice, new ProcessName, new ProcessType, new ProcessPartNumber, new ProcessSupplyVoltage, new ProcessPrice, new ProcessPackageType, new ProcessPackageOne, new ProcessPackages)</div>
<div class="line">    glueCode_ProcessRuleSet myInDesign, myDocument.XMLElements.Item(1), myRuleSet, Array()</div>
<div class="line">   End If</div>
</div><!-- fragment --><div class="fragment"><div class="line">Class ProcessDevice</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = <span class="stringliteral">&quot;ProcessDevice&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = <span class="stringliteral">&quot;/devices/device&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Public Function  apply (myXMLElement, myRuleProcessor)</div>
<div class="line">        With myXMLElement</div>
<div class="line">            .InsertTextAsContent vbCr, idXMLElementPosition.idAfterElement</div>
<div class="line">        End With</div>
<div class="line">        apply = false</div>
<div class="line">    End Function </div>
<div class="line">End Class</div>
<div class="line"></div>
<div class="line">Class ProcessName</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = &quot;ProcessName&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = &quot;/devices/device/name&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Function  apply (myXMLElement, myRuleProcessor)</div>
<div class="line">        Set myInDesign = CreateObject(&quot;InDesign.Application.2024&quot;)</div>
<div class="line">        Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">        With myXMLElement</div>
<div class="line">            .InsertTextAsContent vbCr, idXMLElementPosition.idAfterElement</div>
<div class="line">            .ApplyParagraphStyle myDocument.ParagraphStyles.Item(&quot;DeviceName&quot;)</div>
<div class="line">        End With</div>
<div class="line">        apply = true</div>
<div class="line">    End Function </div>
<div class="line">End Class</div>
<div class="line"></div>
<div class="line">Class ProcessType</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = &quot;ProcessType&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = &quot;/devices/device/type&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Function  apply (myXMLElement, myRuleProcessor)</div>
<div class="line">        Set myInDesign = CreateObject(&quot;InDesign.Application.2024&quot;)</div>
<div class="line">        Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">        With myXMLElement</div>
<div class="line">            .InsertTextAsContent &quot;Circuit Type: &quot;, idXMLElementPosition.idBeforeElement</div>
<div class="line">            .InsertTextAsContent vbCr, idXMLElementPosition.idAfterElement</div>
<div class="line">            .ApplyParagraphStyle myDocument.ParagraphStyles.Item(&quot;DeviceType&quot;)</div>
<div class="line">        End With</div>
<div class="line">        apply = true</div>
<div class="line">    End Function </div>
<div class="line">End Class</div>
<div class="line"></div>
<div class="line">Class ProcessPartNumber</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = &quot;ProcessPartNumber&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = &quot;/devices/device/part_number&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Function  apply (myXMLElement, myRuleProcessor)</div>
<div class="line">        Set myInDesign = CreateObject(&quot;InDesign.Application.2024&quot;)</div>
<div class="line">        Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">        With myXMLElement</div>
<div class="line">            .InsertTextAsContent &quot;Part Number: &quot;, idXMLElementPosition.idBeforeElement</div>
<div class="line">            .InsertTextAsContent vbCr, idXMLElementPosition.idAfterElement</div>
<div class="line">            .ApplyParagraphStyle myDocument.ParagraphStyles.Item(&quot;PartNumber&quot;)</div>
<div class="line">        End With</div>
<div class="line">        apply = true</div>
<div class="line">    End Function </div>
<div class="line">End Class</div>
<div class="line"></div>
<div class="line">Class ProcessSupplyVoltage</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = &quot;ProcessPartNumber&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = &quot;/devices/device/supply_voltage&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Function  apply (myXMLElement, myRuleProcessor)</div>
<div class="line">        Set myInDesign = CreateObject(&quot;InDesign.Application.2024&quot;)</div>
<div class="line">        Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">        With myXMLElement</div>
<div class="line">            .InsertTextAsContent &quot;Supply Voltage From: &quot;, idXMLElementPosition.idBeforeElement</div>
<div class="line">            With .XMLElements.Item(1)</div>
<div class="line">                .InsertTextAsContent &quot; to &quot;, idXMLElementPosition.idAfterElement</div>
<div class="line">            End With</div>
<div class="line">            With .XMLElements.Item(-1)</div>
<div class="line">                .InsertTextAsContent &quot; volts&quot;, idXMLElementPosition.idAfterElement</div>
<div class="line">            End With</div>
<div class="line">            .InsertTextAsContent vbCr, idXMLElementPosition.idAfterElement</div>
<div class="line">            .ApplyParagraphStyle myDocument.ParagraphStyles.Item(&quot;Voltage&quot;)</div>
<div class="line">        End With</div>
<div class="line">        apply = true</div>
<div class="line">    End Function </div>
<div class="line">End Class</div>
<div class="line"></div>
<div class="line">Class ProcessPackageType</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = &quot;ProcessPackageType&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = &quot;/devices/device/package/type&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Function  apply (myXMLElement, myRulesProcessor)</div>
<div class="line">        With myXMLElement</div>
<div class="line">            .InsertTextAsContent &quot;-&quot;, idXMLElementPosition.idAfterElement</div>
<div class="line">        End With</div>
<div class="line">        apply = true</div>
<div class="line">    End Function </div>
<div class="line">End Class</div>
<div class="line">Rem Process the first &quot;package&quot; element.</div>
<div class="line">Class ProcessPackageOne</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = &quot;ProcessPackageOne&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = &quot;/devices/device/package[1]&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Function  apply (myXMLElement, myRulesProcessor)</div>
<div class="line">        Set myInDesign = CreateObject(&quot;InDesign.Application.2024&quot;)</div>
<div class="line">        Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">        With myXMLElement</div>
<div class="line">            .InsertTextAsContent &quot;Package: &quot;, idXMLElementPosition.idBeforeElement</div>
<div class="line">            Rem Because we have already added a return to the</div>
<div class="line">            Rem end of this element as part of the ProcessPrice</div>
<div class="line">            Rem rule, we can savly apply a paragrpah style.</div>
<div class="line">            .ApplyParagraphStyle myDocument.ParagraphStyles.Item(&quot;DevicePackage&quot;)</div>
<div class="line">        End With</div>
<div class="line">        apply = true</div>
<div class="line">    End Function </div>
<div class="line">End Class</div>
<div class="line">Rem Process the remaining &quot;package&quot; elements.</div>
<div class="line">Class ProcessPackages</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = &quot;ProcessPackages&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = &quot;/devices/device/package&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Function  apply (myXMLElement, myRulesProcessor)</div>
<div class="line">        With myXMLElement</div>
<div class="line">            .InsertTextAsContent&quot;, &quot;, idXMLElementPosition.idBeforeElement</div>
<div class="line">        End With</div>
<div class="line">        apply = True</div>
<div class="line">    End Function </div>
<div class="line">End Class</div>
<div class="line">Class ProcessPrice</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = &quot;ProcessPrice&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = &quot;/devices/device/price&quot;</div>
<div class="line">    End Property</div>
<div class="line">    Public Function  apply (myXMLElement, myRulesProcessor)</div>
<div class="line">        Set myInDesign = CreateObject(&quot;InDesign.Application.2024&quot;)</div>
<div class="line">        Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">        With myXMLElement</div>
<div class="line">            Rem Add a return at the start of the XML element.</div>
<div class="line">            .InsertTextAsContent vbCr &amp; &quot;Price: $&quot;, idXMLElementPosition.idBeforeElement</div>
<div class="line">            .InsertTextAsContent vbcr, idXMLElementPosition.idAfterElement</div>
<div class="line">            .ApplyParagraphStyle myDocument.ParagraphStyles.Item(&quot;Price&quot;)           </div>
<div class="line">        End With</div>
<div class="line">        apply = False</div>
<div class="line">    End Function </div>
<div class="line">End Class</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_creating_page_items_with_xml_rules"></a>
Creating page items with XML rules</h3>
<p>The following script creates new page items, inserts the content of XML elements in the page items, adds static text, and applies formatting. We include only the relevant XML-rule portions of the script here; for more information, see the complete script (XMLRulesLayout).</p>
<p>The first rule creates a new text frame for each "device" XML element: </p>
<div class="fragment"><div class="line">Class ProcessDevice</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = <span class="stringliteral">&quot;ProcessDevice&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = <span class="stringliteral">&quot;/devices/device&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Public Function  apply (myXMLElement, myRuleProcessor)</div>
<div class="line">        Set myInDesign = CreateObject(&quot;InDesign.Application.2024&quot;)</div>
<div class="line">        Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">        With myXMLElement</div>
<div class="line">            .InsertTextAsContent vbCr, idXMLElementPosition.idAfterElement</div>
<div class="line">            If myDocument.Pages.Item(1).TextFrames.Count &gt; 0 Then</div>
<div class="line">                Set myPage = myDocument.Pages.Add</div>
<div class="line">                myBounds = myGetBounds(myDocument, myPage)</div>
<div class="line">                Set myTextFrame = .PlaceIntoFrame(myPage, myBounds)</div>
<div class="line">                myTextFrame.TextFramePreferences.FirstBaselineOffset = idFirstBaseline.idLeadingOffset</div>
<div class="line">            Else</div>
<div class="line">                Set myPage = myDocument.Pages.Item(1)</div>
<div class="line">                myBounds = myGetBounds(myDocument, myPage)</div>
<div class="line">                Set myTextFrame = .PlaceIntoFrame(myPage, myBounds)</div>
<div class="line">                myTextFrame.TextFramePreferences.FirstBaselineOffset = idFirstBaseline.idLeadingOffset</div>
<div class="line">            End If</div>
<div class="line">        End With</div>
<div class="line">        apply = false</div>
<div class="line">    End Function </div>
<div class="line">End Class</div>
</div><!-- fragment --><p> The "ProcessType" rule moves the "type" XML element to a new frame on the page: </p>
<div class="fragment"><div class="line">Class ProcessType</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = <span class="stringliteral">&quot;ProcessType&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = <span class="stringliteral">&quot;/devices/device/type&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Public Function  apply (myXMLElement, myRuleProcessor)</div>
<div class="line">        Set myInDesign = CreateObject(&quot;InDesign.Application.2024&quot;)</div>
<div class="line">        Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">        With myXMLElement</div>
<div class="line">            Set myPage = myDocument.Pages.Item(-1)</div>
<div class="line">            myBounds = myGetBounds(myDocument, myPage)</div>
<div class="line">            myX1 = myBounds(1)</div>
<div class="line">            myY1 = myBounds(0)</div>
<div class="line">            myBounds = Array(myY1-24, myX1, myY1, myX1 + 48)</div>
<div class="line">            Set myTextFrame = .PlaceIntoFrame(myPage, myBounds)</div>
<div class="line">            myTextFrame.TextFramePreferences.InsetSpacing = Array(6, 6, 6, 6)</div>
<div class="line">            myTextFrame.FillColor = myDocument.Swatches.Item(&quot;Red&quot;)</div>
<div class="line">            .ApplyParagraphStyle myDocument.ParagraphStyles.Item(&quot;DeviceType&quot;)</div>
<div class="line">        End With</div>
<div class="line">        apply = true</div>
<div class="line">    End Function </div>
<div class="line">End Class</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_creating_tables_using_xml_rules"></a>
Creating Tables using XML Rules</h2>
<p>You can use the ConvertElementToTable method to turn an XML element into a table. This method has a limitation in that it assumes that all of the XML elements inside the table conform to a very specific set of XML tags-one tag for a row element; another for a cell, or column element. Typically, the XML data we want to put into a table does not conform to this structure: it is likely that the XML elements we want to arrange in columns use heterogeneous XML tags (price, part number, etc.).</p>
<p>To get around this limitation, we can "wrap" each XML element we want to add to a table row using a container XML element, as shown in the following script fragments (see XMLRulesTable). In this example, a specific XML rule creates an XML element for each row. </p>
<div class="fragment"><div class="line">Class ProcessDevice</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = <span class="stringliteral">&quot;ProcessDevice&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = <span class="stringliteral">&quot;//device[@type = &#39;VCO&#39;]&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Rem Create a <span class="keyword">new</span> row <span class="keywordflow">for</span> every device whose type is <span class="stringliteral">&quot;VCO&quot;</span></div>
<div class="line">    Public Function  apply (myXMLElement, myRuleProcessor)</div>
<div class="line">        Set myInDesign = CreateObject(&quot;InDesign.Application.2024&quot;)</div>
<div class="line">        Set myRowTag = myInDesign.Documents.Item(1).XmlTags.Item(&quot;Row&quot;)</div>
<div class="line">        Set myNewRowElement = myContainerElement.XMLElements.Add(myRowTag)</div>
<div class="line">        apply = false</div>
<div class="line">    End Function </div>
<div class="line">End Class</div>
</div><!-- fragment --><p> Successive rules move and format their content into container elements inside the row XML element. </p>
<div class="fragment"><div class="line">Class ProcessPrice</div>
<div class="line">    Public Property Get name</div>
<div class="line">        name = <span class="stringliteral">&quot;ProcessPrice&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Public Property Get xpath</div>
<div class="line">        xpath = <span class="stringliteral">&quot;//device[@type = &#39;VCO&#39;]/price&quot;</span></div>
<div class="line">    End Property</div>
<div class="line">    Public Function  apply (myXMLElement, myRuleProcessor)</div>
<div class="line">        glueCode_skipChildren(myRuleProcessor)</div>
<div class="line">        With myXMLElement</div>
<div class="line">            Set myInDesign = CreateObject(&quot;InDesign.Application.2024&quot;)</div>
<div class="line">            Set myCellTag = myInDesign.Documents.Item(1).XmlTags.Item(&quot;Column&quot;)</div>
<div class="line">            Set myLastElement = myContainerElement.XMLElements.Item(-1)</div>
<div class="line">            Set myNewElement = myLastElement.XMLElements.add(myCellTag)</div>
<div class="line">            Set myPriceElement = .Move(idLocationOptions.idAtBeginning, myNewElement)</div>
<div class="line">            myPriceElement.InsertTextAsContent &quot;$&quot;, idXMLElementPosition.idBeforeElement</div>
<div class="line">        End With</div>
<div class="line">        apply = true</div>
<div class="line">    End Function</div>
<div class="line">End Class</div>
</div><!-- fragment --><p> Once all of the specified XML elements have been "wrapped," we can convert the container element to a table. </p>
<div class="fragment"><div class="line">    Set myTable = myContainerElement.ConvertElementToTable(myRowTag, myCellTag)</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_scripting_the_xml-rules_processor_object"></a>
Scripting the XML-rules Processor Object</h2>
<p>While we have provided a set of utility functions in glue code.vbs, you also can script the XML-rules processor object directly. You might want do this to develop your own support routines for XML rules or to use the XML-rules processor in other ways.</p>
<p>When you script XML elements outside the context of XML rules, you cannot locate elements using XPath. You can, however, create an XML rule that does nothing more than return matching XML elements, and apply the rule using an XML-rules processor, as shown in the following script. (This script uses the same XML data file as the sample scripts in previous sections.) For the complete script, see XMLRulesProcessor. </p>
<div class="fragment"><div class="line">   myXPath = Array(<span class="stringliteral">&quot;/devices/device&quot;</span>)</div>
<div class="line">   myXMLMatches = mySimulateXPath(myXPath)</div>
<div class="line">   Rem At this point, myXMLMatches contains all of the XML elements</div>
<div class="line">   Rem that matched the XPath expression provided in myXPath.</div>
<div class="line">   Rem In a real script, you could now process the elements.</div>
<div class="line">   Rem For this example, however, we&#39;ll simply display a message.</div>
<div class="line">   If IsEmpty(myXMLMatches(0)) = False Then</div>
<div class="line">    MsgBox &quot;Found &quot; &amp; CStr(UBound(myXMLMatches)+1) &amp; &quot; matching elements.&quot;</div>
<div class="line">   Else</div>
<div class="line">    MsgBox &quot;Did not find any matching XML elements.&quot;</div>
<div class="line">   End if</div>
</div><!-- fragment --><div class="fragment"><div class="line">Function mySimulateXPath(myXPath)</div>
<div class="line">    ReDim myMatchingElements(0)</div>
<div class="line">    Set myInDesign = CreateObject(&quot;InDesign.Application.2024&quot;)</div>
<div class="line">    Set myRuleProcessor = myInDesign.XMLRuleProcessors.Add(myXPath)</div>
<div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myRootXMLElement = myDocument.XMLElements.Item(1)</div>
<div class="line">    Set myMatchData = myRuleProcessor.StartProcessingRuleSet(myRootXMLElement)</div>
<div class="line">    Do While TypeName(myMatchData) &lt;&gt; &quot;Nothing&quot;</div>
<div class="line">        Set myXMLElement = myMatchData.Element</div>
<div class="line">        If IsEmpty(myMatchingElements(0)) = False Then</div>
<div class="line">            ReDim Preserve myMatchingElements(UBound(myMatchingElements) + 1)</div>
<div class="line">        End If</div>
<div class="line">        Set myMatchingElements(UBound(myMatchingElements)) = myXMLElement</div>
<div class="line">        Set myMatchData = myRuleProcessor.FindNextMatch</div>
<div class="line">    Loop</div>
<div class="line">    mySimulateXPath = myMatchingElements</div>
<div class="line">End Function</div>
</div><!-- fragment --> <h1><a class="anchor" id="id_vb_track_changes"></a>
Track Changes</h1>
<p>Writers can track, show, hide, accept, and reject changes as a document moves through the writing and editing process. All changes are recorded and visualized to make it easier to review a document.</p>
<p>This tutorial shows how to script the most common operations involving tracking changes.</p>
<p>We assume that you have already read Adobe InDesign Scripting Tutorial and know how to create, install, and run a script. We also assume that you have some knowledge of working with text in InDesign and understand basic typesetting terms.</p>
<h2><a class="anchor" id="id_vb_tracking_changes"></a>
Tracking Changes</h2>
<p>This section shows how to navigate tracked changes, accept changes, and reject changes using scripting.</p>
<p>Whenever anyone adds, deletes, or moves text within an existing story, the change is marked in galley and story views.</p>
<h3><a class="anchor" id="id_vb_navigating_tracked_changes"></a>
Navigating tracked changes</h3>
<p>If the story contains a record of tracked changes, the user can navigate sequentially through tracked changes. The following script show how to navigate the tracked changes (for the complete script, refer to GetTrackchange).</p>
<p>The script below uses the nextItem method to navigate to the change following the insertion point: </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myStory = myDocument.Stories.Item(1)</div>
<div class="line">    If(myStory.TrackChanges=<span class="keyword">true</span> ) Then</div>
<div class="line">        Set myChange = myStory.Changes.Item(1)</div>
<div class="line">        If(myStory.Changes.Count&gt;1) Then</div>
<div class="line">            Set myChange0 = myStory.Changes.NextItem(myChange)</div>
<div class="line">            End If</div>
<div class="line">    End If</div>
</div><!-- fragment --><p> In the script below, we use the previousItem method to navigate to the change following the insertion point: </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myStory = myDocument.Stories.Item(1)</div>
<div class="line">    If(myStory.TrackChanges=<span class="keyword">true</span> ) Then</div>
<div class="line">        Set myChange = myStory.Changes.Item(1)</div>
<div class="line">        If(myStory.Changes.Count&gt;1) Then</div>
<div class="line">            Set myChange0 = myStory.Changes.PreviousItem(myChange)</div>
<div class="line">            End If</div>
<div class="line">    End If</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_accepting_and_reject_tracked_changes"></a>
Accepting and reject tracked changes</h3>
<p>When changes are made to a story, by you or others, the change-tracking feature enables you to review all changes and decide whether to incorporate them into the story. You can accept and reject changes-added, deleted, or moved text-made by any user.</p>
<p>In the following script, the change is accepted (for the complete script, refer to AcceptChange): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myStory = myDocument.Stories.Item(1)</div>
<div class="line">    Set myChange = myStory.Changes.Item(1)</div>
<div class="line">    myChange.Accept</div>
</div><!-- fragment --><p> In the following script, the change is rejected (for the complete script, refer to RejectChange): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myStory = myDocument.Stories.Item(1)</div>
<div class="line">    Set myChange = myStory.Changes.Item(1)</div>
<div class="line">    myChange.Reject</div>
</div><!-- fragment --> <h3><a class="anchor" id="id_vb_information_about_tracked_changes"></a>
Information about tracked changes</h3>
<p>Change information includes include date and time. The following script shows the information of a tracked change (for the complete script, refer to GetChangeInfo): </p>
<div class="fragment"><div class="line">    Set myDocument = myInDesign.Documents.Item(1)</div>
<div class="line">    Set myStory = myDocument.Stories.Item(1)</div>
<div class="line">    Set myChange = myStory.Changes.Item(1)</div>
<div class="line">    With myChange</div>
<div class="line">        Rem idChangeTypes.idDeletedText (Read Only) Deleted text.</div>
<div class="line">        Rem idChangeTypes.idInsertedText (Read Only) Insert text.</div>
<div class="line">        Rem idChangeTypes.idMovedText (Read Only) Moved text.</div>
<div class="line">        myTypes = .ChangeType</div>
<div class="line">        Rem Characters  A collection of Characters.</div>
<div class="line">        Set myCharacters = .Characters</div>
<div class="line">        Rem Character = myCharacters.Item(0);</div>
<div class="line">        myDate = .Date</div>
<div class="line">        Rem InsertionPoints A collection of insertion points.</div>
<div class="line">        Rem  insertpoint = myInsertionPoints.Item(0);</div>
<div class="line">        Set myInsertionPoints = .InsertionPoints</div>
<div class="line">        Rem Lines (Read Only) A collection of lines.</div>
<div class="line">        Set myLines = .Lines</div>
<div class="line">        Rem Paragraphs (Read Only) A collection of paragraphs.</div>
<div class="line">        Set myParagraphs =.Paragraphs</div>
<div class="line">        Rem InsertionPoints A collection of insertion points.</div>
<div class="line">        Rem  myInsertpoint = myInsertionPoints.Item(0);</div>
<div class="line">        Set myStoryOffset = .StoryOffset</div>
<div class="line">        Rem TtextColumns (Read Only) A collection of text columns.</div>
<div class="line">        Set myTextColumns = .TextColumns</div>
<div class="line">        Rem TextStyleRanges (Read Only) A collection of text style ranges.</div>
<div class="line">        </div>
<div class="line">        Set myTextStyleRanges = .TextStyleRanges</div>
<div class="line">        Rem TextVariableInstances (Read Only) A collection of text variable instances.</div>
<div class="line">        Set myTextVariableInstances = .TextVariableInstances</div>
<div class="line">        </div>
<div class="line">        Rem Texts (Read Only) A collection of text objects.</div>
<div class="line">        </div>
<div class="line">        Set myTexts = .Texts</div>
<div class="line">        Rem The user who made the change. Note: Valid only when track changes is <span class="keyword">true</span>.</div>
<div class="line">        myUserName = .UserName</div>
<div class="line">        Rem Words  A collection of words</div>
<div class="line">        Set myWords = .Words</div>
<div class="line">    End With</div>
</div><!-- fragment --> <h2><a class="anchor" id="id_vb_preferences_for_tracking_changes"></a>
Preferences for Tracking Changes</h2>
<p>Track-changes preferences are user settings for tracking changes. For example, you can define which changes are tracked (adding, deleting, or moving text). You can specify the appearance of each type of tracked change, and you can have changes identified with colored change bars in the margins. The following script shows how to set and get these preferences (for the complete script, refer to GetChangePreference): </p>
<div class="fragment"><div class="line">    Set myTrackChangesPreference =  myInDesign.TrackChangesPreferences</div>
<div class="line">    With myTrackChangesPreference</div>
<div class="line">        Rem  Property AddedBackgroundColorChoice As idChangeBackgroundColorChoices, The background color option <span class="keywordflow">for</span> added text.</div>
<div class="line">        Rem  idChangeBackgroundColorChoices, Background color options <span class="keywordflow">for</span> changed text.</div>
<div class="line">        Rem idChangeBackgroundUsesChangePrefColor  The background color <span class="keywordflow">for</span> changed text is the same as the track changes preferences background color. For information, see background color <span class="keywordflow">for</span> added text, background color <span class="keywordflow">for</span> deleted text, or background color <span class="keywordflow">for</span> moved text.</div>
<div class="line">        Rem  idChangeBackgroundUsesGalleyBackgroundColor  The background color <span class="keywordflow">for</span> changed text is the same as the galley background color.</div>
<div class="line">        Rem  idChangeBackgroundUsesUserColor  The background color <span class="keywordflow">for</span> changed text is the same as the color assigned to the current user.  </div>
<div class="line">        myAddedBackgroundColorChoice = .AddedBackgroundColorChoice</div>
<div class="line">        .AddedBackgroundColorChoice =idChangeBackgroundColorChoices.idChangeBackgroundUsesChangePrefColor </div>
<div class="line">        Rem idChangeTextColorChoices,Changed text color options.</div>
<div class="line">        Rem  Property AddedTextColorChoice As idChangeTextColorChoices, The color option <span class="keywordflow">for</span> added text.</div>
<div class="line">        Rem idChangeUsesChangePrefColor,The text color <span class="keywordflow">for</span> changed text is the same as the text color defined in track changes preferences. For information, see text color <span class="keywordflow">for</span> added text, text color <span class="keywordflow">for</span> deleted text, or text color <span class="keywordflow">for</span> moved text. </div>
<div class="line">        Rem idChangeUsesGalleyTextColor,The text color <span class="keywordflow">for</span> changed text is the same as the galley text color.</div>
<div class="line">        myAddedTextColorChoice = .AddedTextColorChoice</div>
<div class="line">        .AddedTextColorChoice = idChangeTextColorChoices.idChangeUsesChangePrefColor </div>
<div class="line">        Rem BackgroundColorForAddedText,The background color <span class="keywordflow">for</span> added text, specified as an InDesign UI color. Note: Valid only when added background color choice is change background uses change pref color. Type: Array of 3 Doubles (0 - 255) or idInDesignUIColors enumerator</div>
<div class="line">        myBackgroundColorForAddedText = .BackgroundColorForAddedText</div>
<div class="line">        .BackgroundColorForAddedText = idUIColors.idGray</div>
<div class="line">        Rem BackgroundColorForDeletedText, The background color for deleted text, specified as an InDesign UI color. Note: Valid only when deleted background color choice is change background uses change pref color</div>
<div class="line">        myBackgroundColorForDeletedText = .BackgroundColorForDeletedText</div>
<div class="line">        .BackgroundColorForDeletedText = idUIColors.idRed</div>
<div class="line">        Rem BackgroundColorForMovedText,The background color for moved text, specified as an InDesign UI color. Note: Valid only when moved background color choice is change background uses change pref color</div>
<div class="line">        myBackgroundColorForMovedText = .BackgroundColorForMovedText</div>
<div class="line">        .BackgroundColorForMovedText = idUIColors.idPink</div>
<div class="line">        Rem ChangeBarColor, The change bar color, specified as an InDesign UI color. </div>
<div class="line">        myChangeBarColor = .ChangeBarColor</div>
<div class="line">        .ChangeBarColor = idUIColors.idCharcoal</div>
<div class="line">    </div>
<div class="line">        Rem DeletedBackgroundColorChoice,The background color option for deleted text.</div>
<div class="line">        Rem idChangeBackgroundUsesChangePrefColor  The background color for changed text is the same as the track changes preferences background color. For information, see background color for added text, background color for deleted text, or background color for moved text.</div>
<div class="line">        Rem  idChangeBackgroundUsesGalleyBackgroundColor  The background color for changed text is the same as the galley background color.</div>
<div class="line">        Rem  idChangeBackgroundUsesUserColor  The background color for changed text is the same as the color assigned to the current user. </div>
<div class="line">        myDeletedBackgroundColorChoice = .DeletedBackgroundColorChoice</div>
<div class="line">        .DeletedBackgroundColorChoice =  idChangeBackgroundColorChoices.idChangeBackgroundUsesUserColor</div>
<div class="line">        </div>
<div class="line">        Rem DeletedTextColorChoice, The color option for deleted text.</div>
<div class="line">        Rem idChangeUsesChangePrefColor,The text color for changed text is the same as the text color defined in track changes preferences. For information, see text color for added text, text color for deleted text, or text color for moved text. </div>
<div class="line">        Rem idChangeUsesGalleyTextColor,The text color for changed text is the same as the galley text color.</div>
<div class="line">        myDeletedTextColorChoice = .DeletedTextColorChoice</div>
<div class="line">        .DeletedTextColorChoice = idChangeTextColorChoices.idChangeUsesChangePrefColor</div>
<div class="line">        </div>
<div class="line">        Rem LocationForChangeBar,The change bar location.</div>
<div class="line">        Rem  idChangebarLocations,Change bar location options.</div>
<div class="line">        Rem idLeftAlign, Change bars are in the left margin.</div>
<div class="line">        Rem idRightAlign, Change bars are in the right margin</div>
<div class="line">        myLocationForChangeBar = .LocationForChangeBar</div>
<div class="line">        .LocationForChangeBar = idChangebarLocations.idLeftAlign</div>
<div class="line">        </div>
<div class="line">        Rem MarkingForAddedText, The marking that identifies added text.</div>
<div class="line">        Rem idChangeMarkings, Marking options for changed text.</div>
<div class="line">        Rem idOutline,   Outlines changed text.</div>
<div class="line">        Rem idNone, Does not mark changed text.</div>
<div class="line">        Rem idStrikethrough, Uses a strikethrough to mark changed text.</div>
<div class="line">        Rem idUnderlineSingle, Underlines changed text.</div>
<div class="line">        myMarkingForAddedText = .MarkingForAddedText</div>
<div class="line">        .MarkingForAddedText =idChangeMarkings.idStrikethrough </div>
<div class="line"></div>
<div class="line">        Rem MarkingForDeletedText, The marking that identifies deleted text.</div>
<div class="line">        Rem idChangeMarkings, Marking options for changed text.</div>
<div class="line">        Rem idOutline,   Outlines changed text.</div>
<div class="line">        Rem idNone, Does not mark changed text.</div>
<div class="line">        Rem idStrikethrough, Uses a strikethrough to mark changed text.</div>
<div class="line">        Rem idUnderlineSingle, Underlines changed text.</div>
<div class="line">        myMarkingForDeletedText = .MarkingForDeletedText</div>
<div class="line">        .MarkingForDeletedText = idChangeMarkings.idUnderlineSingle</div>
<div class="line">        </div>
<div class="line">        Rem MarkingForMovedText, The marking that identifies moved text.</div>
<div class="line">        Rem idChangeMarkings, Marking options for changed text.</div>
<div class="line">        Rem idOutline,   Outlines changed text.</div>
<div class="line">        Rem idNone, Does not mark changed text.</div>
<div class="line">        Rem idStrikethrough, Uses a strikethrough to mark changed text.</div>
<div class="line">        Rem idUnderlineSingle, Underlines changed text.</div>
<div class="line">        myMarkingForMovedText = .MarkingForMovedText</div>
<div class="line">        .MarkingForMovedText =  idChangeMarkings.idOutline</div>
<div class="line">        </div>
<div class="line">        Rem MovedBackgroundColorChoice,The background color option for moved text.</div>
<div class="line">        Rem idChangeBackgroundUsesChangePrefColor  The background color for changed text is the same as the track changes preferences background color. For information, see background color for added text, background color for deleted text, or background color for moved text.</div>
<div class="line">        Rem  idChangeBackgroundUsesGalleyBackgroundColor  The background color for changed text is the same as the galley background color.</div>
<div class="line">        Rem  idChangeBackgroundUsesUserColor  The background color for changed text is the same as the color assigned to the current user. </div>
<div class="line">        myMovedBackgroundColorChoice = .MovedBackgroundColorChoice</div>
<div class="line">        .MovedBackgroundColorChoice = idChangeBackgroundColorChoices.idChangeBackgroundUsesChangePrefColor</div>
<div class="line">        </div>
<div class="line">        Rem MovedTextColorChoice, The color option for moved text.</div>
<div class="line">        Rem idChangeUsesChangePrefColor,The text color for changed text is the same as the text color defined in track changes preferences. For information, see text color for added text, text color for deleted text, or text color for moved text. </div>
<div class="line">        Rem idChangeUsesGalleyTextColor,The text color for changed text is the same as the galley text color.</div>
<div class="line">        myMovedTextColorChoice = .MovedTextColorChoice</div>
<div class="line">        .MovedTextColorChoice = idChangeTextColorChoices.idChangeUsesChangePrefColor </div>
<div class="line">        </div>
<div class="line">        Rem if true, displays added text.</div>
<div class="line">        myShowAddedText = .ShowAddedText</div>
<div class="line">        .ShowAddedText = true</div>
<div class="line">    </div>
<div class="line">        Rem  If true, displays change bars.</div>
<div class="line">        myShowChangeBars  = .ShowChangeBars</div>
<div class="line">        .ShowChangeBars = true</div>
<div class="line">      </div>
<div class="line">        Rem ShowDeletedText, If true, displays deleted text.</div>
<div class="line">        myShowDeletedText = .ShowDeletedText</div>
<div class="line">        .ShowDeletedText = true</div>
<div class="line">        </div>
<div class="line">        Rem ShowMovedText,If true, displays moved text.</div>
<div class="line">        myShowMovedText = .ShowMovedText</div>
<div class="line">        .ShowMovedText = true</div>
<div class="line">        </div>
<div class="line">        Rem SpellCheckDeletedText, If true, includes deleted text when using the Spell Check command.</div>
<div class="line">        mySpellCheckDeletedText = .SpellCheckDeletedText</div>
<div class="line">        .SpellCheckDeletedText = true</div>
<div class="line"></div>
<div class="line">        Rem TextColorForAddedText, The color for added text, specified as an InDesign UI color. Note: Valid only when added text color choice is change uses change pref color. </div>
<div class="line">        myTextColorForAddedText =  .TextColorForAddedText</div>
<div class="line">        .TextColorForAddedText =  idUIColors.idBlue</div>
<div class="line">        </div>
<div class="line">        Rem  TextColorForDeletedText,The color for deleted text.</div>
<div class="line">        myTextColorForDeletedText = .TextColorForDeletedText</div>
<div class="line">        .TextColorForDeletedText = idUIColors.idYellow</div>
<div class="line">        </div>
<div class="line">        Rem  TextColorForMovedText,The color for moved text.</div>
<div class="line">        myTextColorForMovedText = .TextColorForMovedText</div>
<div class="line">        .TextColorForMovedText =  idUIColors.idGreen</div>
<div class="line">    End With</div>
</div><!-- fragment --></div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sun Mar 3 2024 02:53:08 for InDesign Scripting SDK by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.3.1 </li>
  </ul>
</div>
</body>
</html>
